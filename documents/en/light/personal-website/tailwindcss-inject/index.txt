1:"$Sreact.fragment"
2:I[38735,["1899","static/chunks/1899-38fe6771109eb8a8.js","7177","static/chunks/app/layout-3eed8318d7b0d3da.js"],"default"]
3:I[19945,["1899","static/chunks/1899-38fe6771109eb8a8.js","7177","static/chunks/app/layout-3eed8318d7b0d3da.js"],"default"]
4:I[65337,["1899","static/chunks/1899-38fe6771109eb8a8.js","7177","static/chunks/app/layout-3eed8318d7b0d3da.js"],"default"]
5:I[96190,["1899","static/chunks/1899-38fe6771109eb8a8.js","7177","static/chunks/app/layout-3eed8318d7b0d3da.js"],"ClientProviders"]
6:I[87555,[],""]
7:I[51901,["8039","static/chunks/app/error-dda32be1d095a86c.js"],"default"]
8:I[31295,[],""]
9:I[6874,["6874","static/chunks/6874-fbe9a08eb79b991c.js","4345","static/chunks/app/not-found-9ff98b2ccf24cac7.js"],""]
a:I[94970,[],"ClientSegmentRoot"]
b:I[44065,["206","static/chunks/206-4f4cbf4d7156f437.js","3092","static/chunks/app/documents/layout-28408791defde09e.js"],"default"]
e:I[59665,[],"MetadataBoundary"]
10:I[59665,[],"OutletBoundary"]
13:I[74911,[],"AsyncMetadataOutlet"]
15:I[39460,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","5650","static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js"],"default"]
16:I[88610,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","4209","static/chunks/app/loading-68f227fb49b3ac8c.js"],"default"]
17:I[59665,[],"ViewportBoundary"]
19:I[26614,[],""]
:HL["/MilkWind-Website/_next/static/css/fe7e5644f748258b.css","style"]
:HL["/MilkWind-Website/_next/static/css/38943437573ce53c.css","style"]
:HL["/MilkWind-Website/_next/static/css/5eacd01f773eed7f.css","style"]
0:{"P":null,"b":"mO0HfhVKUIqGG57hUXa3f","p":"/MilkWind-Website","c":["","documents","en","light","personal-website","tailwindcss-inject",""],"i":false,"f":[[["",{"children":["documents",{"children":[["slug","en/light/personal-website/tailwindcss-inject","c"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/fe7e5644f748258b.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/38943437573ce53c.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_d71c80 __variable_744f1f font-sans antialiased min-h-screen bg-background text-foreground","suppressHydrationWarning":true,"children":[["$","$L2",null,{}],["$","$L3",null,{}],["$","$L4",null,{}],["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$7","errorStyles":[],"errorScripts":[],"template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"z-10 relative min-h-screen flex items-center justify-center bg-background p-8","children":["$","div",null,{"className":"text-center max-w-md","children":[["$","div",null,{"className":"text-8xl font-bold text-primary mb-4","children":"404"}],["$","h2",null,{"className":"text-2xl font-bold text-foreground mb-4","children":"Page Not Found"}],["$","p",null,{"className":"text-foreground/70 mb-8","children":"The page you're looking for doesn't exist or has been moved to a different location."}],["$","div",null,{"className":"flex flex-col sm:flex-row gap-4 justify-center","children":[["$","$L9",null,{"href":"/","className":"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors","children":"Go Home"}],["$","$L9",null,{"href":"/works","className":"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors","children":"View Works"}]]}],["$","div",null,{"className":"absolute inset-0 overflow-hidden pointer-events-none -z-10","children":[["$","div",null,{"className":"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float"}],["$","div",null,{"className":"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float","style":{"animationDelay":"1s"}}],["$","div",null,{"className":"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float","style":{"animationDelay":"2s"}}]]}]]}]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]}]]}],{"children":["documents",["$","$1","c",{"children":[null,["$","$La",null,{"Component":"$b","slots":{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@c"}]]}],{"children":[["slug","en/light/personal-website/tailwindcss-inject","c"],["$","$1","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$Ld",["$","$Le",null,{"children":"$Lf"}],[["$","link","0",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/5eacd01f773eed7f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L10",null,{"children":["$L11","$L12",["$","$L13",null,{"promise":"$@14"}]]}]]}],{},null,false]},null,false]},[["$","$L15","l",{}],[],[]],false]},[["$","$L16","l",{}],[],[]],false],["$","$1","h",{"children":[null,["$","$1","f5bFC9Iy-85RcheE5N1yA",{"children":[["$","$L17",null,{"children":"$L18"}],null]}],null]}],false]],"m":"$undefined","G":["$19","$undefined"],"s":false,"S":true}
1a:"$Sreact.suspense"
1b:I[74911,[],"AsyncMetadata"]
c:{}
f:["$","$1a",null,{"fallback":null,"children":["$","$L1b",null,{"promise":"$@1c"}]}]
1d:I[57340,["5584","static/chunks/b498d07c-095637f0f10883c6.js","2415","static/chunks/2415-689c103fb3d2c28d.js","6874","static/chunks/6874-fbe9a08eb79b991c.js","9554","static/chunks/9554-b714f9de28e85d30.js","1873","static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js"],"DocumentPageClient"]
1e:T36820,<h1 id="style-injection-phoenix-rising-from-tailwindcss-preflight’s-destruction" class="group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight">
            <a href="#style-injection-phoenix-rising-from-tailwindcss-preflight’s-destruction" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Style Injection: Phoenix Rising from TailwindCSS Preflight’s Destruction">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Style Injection: Phoenix Rising from TailwindCSS Preflight’s Destruction
        </h1>
<p class="text-base leading-7 mb-4 text-foreground">You can’t have your fish and bear’s paw at the same time. — Impossible! I want them all!</p>
<p class="text-base leading-7 mb-4 text-foreground">Imagine a sunny spring day… when you eagerly render your carefully crafted MDX documents to a webpage, only to discover that all your headings, paragraphs, and code blocks have become “naked HTML” without any styling! Well — congratulations, you’ve encountered the “dark side” of TailwindCSS Preflight. This seemingly harmless CSS reset mechanism is like an overly enthusiastic cleaner who treats all your home decorations as garbage to be thrown away!</p>
<p class="text-base leading-7 mb-4 text-foreground">For this, your most convenient solution might be to coax TailwindCSS: “Alright, alright, the CSS rendering authority is in your hands, I’ll follow your lead! Let’s compromise with MDX and inject some of your stuff into her!”</p>
<p class="text-base leading-7 mb-4 text-foreground">If your mind went to the gutter, that’s your problem, not mine (shrugs, with a cheeky face).</p>
<p class="text-base leading-7 mb-4 text-foreground">So… ta-da! The style injection system is born!</p>
<p class="text-base leading-7 mb-4 text-foreground">Back to the main topic, in this article, I’ll start from the root of the problem and gradually delve into every technical detail, comprehensively dissecting this art of document style renaissance. (Is it really that grand?)</p>
<h2 id="root-cause-analysis-the-double-edged-sword-effect-of-preflight" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#root-cause-analysis-the-double-edged-sword-effect-of-preflight" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Root Cause Analysis: The Double-Edged Sword Effect of Preflight">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Root Cause Analysis: The Double-Edged Sword Effect of Preflight
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Before diving into the solution, we need to understand Preflight’s working mechanism.</p>
<h3 id="tailwindcss-preflight-mechanism-analysis" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#tailwindcss-preflight-mechanism-analysis" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to TailwindCSS Preflight Mechanism Analysis">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            TailwindCSS Preflight Mechanism Analysis
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="css" data-code="%2F*%20Example%20of%20Preflight%20reset%20styles%20*%2F%0Ah1%2C%20h2%2C%20h3%2C%20h4%2C%20h5%2C%20h6%20%7B%0Afont-size%3A%20inherit%3B%0Afont-weight%3A%20inherit%3B%0A%7D%0Ap%2C%20blockquote%2C%20dl%2C%20dd%2C%20h1%2C%20h2%2C%20h3%2C%20h4%2C%20h5%2C%20h6%2C%20hr%2C%20figure%2C%20p%2C%20pre%20%7B%0Amargin%3A%200%3B%0A%7D%0Aol%2C%20ul%20%7B%0Alist-style%3A%20none%3B%0Amargin%3A%200%3B%0Apadding%3A%200%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">css</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-css"><span class="hljs-comment inline">/* Example of Preflight reset styles */</span>
<span class="hljs-selector-tag inline">h1</span>, <span class="hljs-selector-tag inline">h2</span>, <span class="hljs-selector-tag inline">h3</span>, <span class="hljs-selector-tag inline">h4</span>, <span class="hljs-selector-tag inline">h5</span>, <span class="hljs-selector-tag inline">h6</span> {
  <span class="hljs-attribute inline">font-size</span>: inherit;
  <span class="hljs-attribute inline">font-weight</span>: inherit;
}

<span class="hljs-selector-tag inline">p</span>, <span class="hljs-selector-tag inline">blockquote</span>, <span class="hljs-selector-tag inline">dl</span>, <span class="hljs-selector-tag inline">dd</span>, <span class="hljs-selector-tag inline">h1</span>, <span class="hljs-selector-tag inline">h2</span>, <span class="hljs-selector-tag inline">h3</span>, <span class="hljs-selector-tag inline">h4</span>, <span class="hljs-selector-tag inline">h5</span>, <span class="hljs-selector-tag inline">h6</span>, hr, <span class="hljs-selector-tag inline">figure</span>, <span class="hljs-selector-tag inline">p</span>, pre {
  <span class="hljs-attribute inline">margin</span>: <span class="hljs-number inline">0</span>;
}

<span class="hljs-selector-tag inline">ol</span>, <span class="hljs-selector-tag inline">ul</span> {
  <span class="hljs-attribute inline">list-style</span>: none;
  <span class="hljs-attribute inline">margin</span>: <span class="hljs-number inline">0</span>;
  <span class="hljs-attribute inline">padding</span>: <span class="hljs-number inline">0</span>;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Preflight’s design intention</strong> is to eliminate browser default style differences, providing a “clean canvas.” This idea is great in itself — maintaining a consistent starting point across different browsers, avoiding various strange default style differences.</p>
<p class="text-base leading-7 mb-4 text-foreground">But! When we use Remarkable to convert MDX to HTML, the generated structure is semantic HTML:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="html" data-code="h1%3ETitleh1%3E%0Ap%3EParagraph%20contentp%3E%0Acode%3ECode%20snippetcode%3E%0Aul%3E%0Ali%3EList%20itemli%3E%0Aul%3E">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">html</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-html"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">h1</span>&gt;</span>Title<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">h1</span>&gt;</span>
<span class="hljs-tag inline">&lt;<span class="hljs-name inline">p</span>&gt;</span>Paragraph content<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">p</span>&gt;</span>
<span class="hljs-tag inline">&lt;<span class="hljs-name inline">code</span>&gt;</span>Code snippet<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">code</span>&gt;</span>
<span class="hljs-tag inline">&lt;<span class="hljs-name inline">ul</span>&gt;</span>
  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">li</span>&gt;</span>List item<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">li</span>&gt;</span>
<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">ul</span>&gt;</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">These HTML tags should originally have browser default styles to make them look like “headings,” “paragraphs,” “code.” But once Preflight steps in, it directly resets all default styles — all text looks the same, without hierarchy or emphasis, like a document with rendering issues.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why can’t we simply disable Preflight?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">Disabling Preflight seems like the simplest solution, but this would bring bigger problems:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Default style differences between browsers would reappear</li>
<li class="text-foreground leading-relaxed">Your other UI components might experience unexpected styling issues</li>
<li class="text-foreground leading-relaxed">Many of TailwindCSS’s utility classes are designed based on reset foundation styles</li>
</ul>
<h3 id="mdx-to-html-rendering-pipeline" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mdx-to-html-rendering-pipeline" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to MDX to HTML Rendering Pipeline">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            MDX to HTML Rendering Pipeline
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Let’s summarize the complete pipeline where the problem occurs:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="MDX%20Source%20File%20%E2%86%92%20Remarkable%20Parsing%20%E2%86%92%20HTML%20String%20%E2%86%92%20Preflight%20Reset%20%E2%86%92%20Style-less%20Result">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-variable constant_ inline">MDX</span> <span class="hljs-title class_ inline">Source</span> <span class="hljs-title class_ inline">File</span> → <span class="hljs-title class_ inline">Remarkable</span> <span class="hljs-title class_ inline">Parsing</span> → <span class="hljs-variable constant_ inline">HTML</span> <span class="hljs-title class_ inline">String</span> → <span class="hljs-title class_ inline">Preflight</span> <span class="hljs-title class_ inline">Reset</span> → <span class="hljs-title class_ inline">Style</span>-less <span class="hljs-title class_ inline">Result</span>
</code></pre>
            </div>
        
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">MDX Source File</strong>: Contains semantic Markdown syntax</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Remarkable Parsing</strong>: Generates clean HTML structure without CSS class names</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">HTML String</strong>: Inserted into React components for rendering</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Preflight Reset</strong>: TailwindCSS’s base layer removes all default styles</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Final Result</strong>: A bunch of unstyled HTML elements</li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why do traditional CSS class name approaches fail here?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">You might think: “Why not just add CSS class names to these tags?” The problem is:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Remarkable generates HTML as strings, not React components</li>
<li class="text-foreground leading-relaxed">We can’t manually add class names to each tag in Markdown syntax</li>
<li class="text-foreground leading-relaxed">Even if we could, it would make Markdown lose its simplicity</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">This leads to the necessity of style injection — we need a system that can automatically add appropriate TailwindCSS class names to generated HTML tags.</p>
<h2 id="style-mapping-configuration-design" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#style-mapping-configuration-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Style Mapping Configuration Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Style Mapping Configuration Design
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Before writing complex injection algorithms, we need to design a highly flexible configuration system (<del class="line-through opacity-60">I can write however I want, all styles are under my control!</del>).</p>
<h3 id="json-configuration-file" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#json-configuration-file" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to JSON Configuration File">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            JSON Configuration File
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="json" data-code="%7B%0A%22h1%22%3A%20%22text-4xl%20font-bold%20mt-8%20mb-4%20text-foreground%20leading-tight%22%2C%0A%22h2%22%3A%20%22text-3xl%20font-semibold%20mt-6%20mb-3%20text-foreground%20leading-tight%22%2C%0A%22p%22%3A%20%22text-base%20leading-7%20mb-4%20text-foreground%22%2C%0A%22code%22%3A%20%22bg-surface%20text-primary%20px-1.5%20py-0.5%20rounded%20text-sm%20font-mono%22%2C%0A%22ul%22%3A%20%22list-disc%20list-inside%20mb-4%20pl-6%20space-y-2%22%2C%0A%22li%22%3A%20%22text-foreground%20leading-relaxed%22%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">json</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-json"><span class="hljs-punctuation inline">{</span>
  <span class="hljs-attr inline">&quot;h1&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-4xl font-bold mt-8 mb-4 text-foreground leading-tight&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;h2&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;p&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-base leading-7 mb-4 text-foreground&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;code&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;bg-surface text-primary px-1.5 py-0.5 rounded text-sm font-mono&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;ul&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;list-disc list-inside mb-4 pl-6 space-y-2&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;li&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-foreground leading-relaxed&quot;</span>
<span class="hljs-punctuation inline">}</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Tag to Style Class Mapping Strategy</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Each HTML tag corresponds to a TailwindCSS class name string. This one-to-one mapping relationship is simple and direct, avoiding complex conditional judgments.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Theme System Adaptation Design Considerations</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Notice that each style class uses theme system color variables:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="text-foreground%0Abg-surface%0Atext-primary">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-keyword inline">text</span>-foreground
bg-<span class="hljs-keyword inline">surface</span>
<span class="hljs-keyword inline">text</span>-primary
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">These class names map to CSS custom properties, ensuring that document content can seamlessly adapt to new color schemes when themes switch.</p>
<h2 id="core-injection-algorithm-regex-driven-capture-and-replace" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#core-injection-algorithm-regex-driven-capture-and-replace" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Core Injection Algorithm: Regex-Driven Capture and Replace">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Core Injection Algorithm: Regex-Driven Capture and Replace
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">From my personal experience, at least 95% of matching needs can be generated by AI using regex. (scratches head, pondering)</p>
<h3 id="tag-matching-regex-magic" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#tag-matching-regex-magic" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Tag Matching Regex Magic">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Tag Matching Regex Magic
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20tagRegex%20%3D%20new%20RegExp(%60%24%7Btag%7D(%5C%5Cs%5B%5E%3E%5D*)%3F(%3F%3A%3E%7C%5C%5Cs*%2F%3E)%60%2C%20'gi')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> tagRegex = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RegExp</span>(<span class="hljs-string inline">`&lt;<span class="hljs-subst inline">${tag}</span>(\\s[^&gt;]*)?(?:&gt;|\\s*/&gt;)`</span>, <span class="hljs-string inline">&#x27;gi&#x27;</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Character-by-character regex analysis:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>&lt;${tag}</code>: Match opening angle bracket and tag name</li>
<li class="text-foreground leading-relaxed"><code>(\\s[^&gt;]*)?</code>: Optional attribute part
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>\\s</code>: At least one whitespace character</li>
<li class="text-foreground leading-relaxed"><code>[^&gt;]*</code>: Any number of non-<code>&gt;</code> characters (attribute content)</li>
<li class="text-foreground leading-relaxed"><code>?</code>: The entire attribute part is optional</li>
</ul></li>
<li class="text-foreground leading-relaxed"><code>(?:&gt;|\\s*/&gt;)</code> Non-capturing group, match ending part
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>&gt;</code>: Regular tag ending</li>
<li class="text-foreground leading-relaxed"><code>|</code>: Or</li>
<li class="text-foreground leading-relaxed"><code>\\s*/&gt;</code>: Self-closing tag ending (may have spaces)</li>
</ul></li>
<li class="text-foreground leading-relaxed"><code>gi</code>: Global match, case-insensitive</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why match opening tags instead of complete tag pairs?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">Because we only need to add <code>class</code> attributes in opening tags; closing tags don’t need modification. This design avoids considering complex nested matching and supports self-closing tags (like <code>&lt;img/&gt;</code>, <code>&lt;br/&gt;</code>).</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Different handling for self-closing and regular tags</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The <code>(?:&gt;|\\s*/&gt;)</code> part in the regex handles both cases simultaneously, without requiring additional conditional judgments.</p>
<h3 id="class-name-injection-algorithm" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#class-name-injection-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Class Name Injection Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Class Name Injection Algorithm
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="styledContent%20%3D%20styledContent.replace(tagRegex%2C%20(match)%20%3D%3E%20%7B%0A%2F%2F%20Prevent%20duplicate%20injection%20check%0Aif%20(match.includes(classes.split('%20')%5B0%5D))%20%7B%0Areturn%20match%3B%0A%7D%0A%2F%2F%20Check%20if%20class%20attribute%20already%20exists%0Aconst%20classMatch%20%3D%20match.match(%2Fclass%3D%5B%22'%5D(%5B%5E%22'%5D*)%5B%22'%5D%2F)%3B%0Aif%20(classMatch)%20%7B%0A%2F%2F%20Logic%20for%20merging%20existing%20class%20names%0Aconst%20existingClasses%20%3D%20classMatch%5B1%5D%3B%0Aconst%20newClasses%20%3D%20classes.split('%20').filter(cls%20%3D%3E%20!existingClasses.includes(cls)).join('%20')%3B%0Aif%20(newClasses)%20%7B%0Areturn%20match.replace(%2Fclass%3D%5B%22'%5D(%5B%5E%22'%5D*)%5B%22'%5D%2F%2C%20%60class%3D%22%241%20%24%7BnewClasses%7D%22%60)%3B%0A%7D%0Areturn%20match%3B%0A%7D%20else%20%7B%0A%2F%2F%20Logic%20for%20adding%20new%20class%20names%0Aif%20(match.endsWith('%2F%3E'))%20%7B%0A%2F%2F%20Self-closing%20tag%0Areturn%20match.replace(%2F%5Cs*%5C%2F%3E%24%2F%2C%20%60%20class%3D%22%24%7Bclasses%7D%22%20%2F%3E%60)%3B%0A%7D%20else%20%7B%0A%2F%2F%20Regular%20opening%20tag%0Areturn%20match.replace(%2F%3E%24%2F%2C%20%60%20class%3D%22%24%7Bclasses%7D%22%3E%60)%3B%0A%7D%0A%7D%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript">styledContent = styledContent.<span class="hljs-title function_ inline">replace</span>(tagRegex, <span class="hljs-function inline">(<span class="hljs-params inline">match</span>) =&gt;</span> {
    <span class="hljs-comment inline">// Prevent duplicate injection check</span>
    <span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">includes</span>(classes.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27; &#x27;</span>)[<span class="hljs-number inline">0</span>])) {
        <span class="hljs-keyword inline">return</span> match;
    }

    <span class="hljs-comment inline">// Check if class attribute already exists</span>
    <span class="hljs-keyword inline">const</span> classMatch = match.<span class="hljs-title function_ inline">match</span>(<span class="hljs-regexp inline">/class=[&quot;&#x27;]([^&quot;&#x27;]*)[&quot;&#x27;]/</span>);

    <span class="hljs-keyword inline">if</span> (classMatch) {
        <span class="hljs-comment inline">// Logic for merging existing class names</span>
        <span class="hljs-keyword inline">const</span> existingClasses = classMatch[<span class="hljs-number inline">1</span>];
        <span class="hljs-keyword inline">const</span> newClasses = classes.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27; &#x27;</span>).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">cls</span> =&gt;</span> !existingClasses.<span class="hljs-title function_ inline">includes</span>(cls)).<span class="hljs-title function_ inline">join</span>(<span class="hljs-string inline">&#x27; &#x27;</span>);
        <span class="hljs-keyword inline">if</span> (newClasses) {
            <span class="hljs-keyword inline">return</span> match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/class=[&quot;&#x27;]([^&quot;&#x27;]*)[&quot;&#x27;]/</span>, <span class="hljs-string inline">`class=&quot;$1 <span class="hljs-subst inline">${newClasses}</span>&quot;`</span>);
        }
        <span class="hljs-keyword inline">return</span> match;
    } <span class="hljs-keyword inline">else</span> {
        <span class="hljs-comment inline">// Logic for adding new class names</span>
        <span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">endsWith</span>(<span class="hljs-string inline">&#x27;/&gt;&#x27;</span>)) {
            <span class="hljs-comment inline">// Self-closing tag</span>
            <span class="hljs-keyword inline">return</span> match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s*\/&gt;$/</span>, <span class="hljs-string inline">` class=&quot;<span class="hljs-subst inline">${classes}</span>&quot; /&gt;`</span>);
        } <span class="hljs-keyword inline">else</span> {
            <span class="hljs-comment inline">// Regular opening tag</span>
            <span class="hljs-keyword inline">return</span> match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&gt;$/</span>, <span class="hljs-string inline">` class=&quot;<span class="hljs-subst inline">${classes}</span>&quot;&gt;`</span>);
        }
    }
});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Judgment logic for class name merging vs addition</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The system first checks if the tag already has a <code>class</code> attribute:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Has</strong>: Merge new class names with existing ones, avoiding duplicates</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Doesn’t have</strong>: Directly add new <code>class</code> attribute</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Duplicate class name deduplication algorithm</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20newClasses%20%3D%20classes.split('%20').filter(cls%20%3D%3E%20!existingClasses.includes(cls)).join('%20')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> newClasses = classes.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27; &#x27;</span>).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">cls</span> =&gt;</span> !existingClasses.<span class="hljs-title function_ inline">includes</span>(cls)).<span class="hljs-title function_ inline">join</span>(<span class="hljs-string inline">&#x27; &#x27;</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">This line ensures no duplicate class names are added.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Attribute quote handling</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The regex <code>/class=[&quot;']([^&quot;']*)[&quot;']/</code> supports both single and double quotes, ensuring compatibility in different situations.</p>
<h3 id="anti-duplicate-injection-protection-mechanism" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#anti-duplicate-injection-protection-mechanism" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Anti-Duplicate Injection Protection Mechanism">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Anti-Duplicate Injection Protection Mechanism
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="if%20(match.includes(classes.split('%20')%5B0%5D))%20%7B%0Areturn%20match%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">includes</span>(classes.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27; &#x27;</span>)[<span class="hljs-number inline">0</span>])) {
    <span class="hljs-keyword inline">return</span> match;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why is checking the first class name sufficient?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">This is a judgment method that can only be used in situations with two states (injected/not injected). Suppose the algorithm injects class names <code>&quot;text-4xl font-bold mt-8 mb-4&quot;</code> for <code>h1</code> tags, then during checking, we only need to check if <code>text-4xl</code> already exists.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Performance optimization vs accuracy trade-off</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Although theoretically there could be false positives (other places also use <code>text-4xl</code>), this probability is extremely low in practice, while the performance improvement is significant.</p>
<h2 id="code-block-enhancement-this-little-box-is-code’s-forever-home" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#code-block-enhancement-this-little-box-is-code’s-forever-home" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Code Block Enhancement: This Little Box is Code’s Forever Home">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Code Block Enhancement: This Little Box is Code’s Forever Home
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Regular style injection can only give people something passable to look at, but for code blocks, programmers’ obsession demands more features — syntax highlighting, copy functionality, theme switching, and modern interactive experiences.</p>
<h3 id="code-block-recognition-and-deconstruction" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#code-block-recognition-and-deconstruction" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Code Block Recognition and Deconstruction">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Code Block Recognition and Deconstruction
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20preCodeRegex%20%3D%20%2F%5D*%3F)%3E(%5B%5Cs%5CS%5D*%3F)%2Fg%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> preCodeRegex = <span class="hljs-regexp inline">/&lt;pre&gt;&lt;code([^&gt;]*?)&gt;([\s\S]*?)&lt;\/code&gt;&lt;\/pre&gt;/g</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Nested Tag Regex Matching Challenge</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Code block HTML structure is nested: <code>&lt;pre&gt;&lt;code&gt;content&lt;/code&gt;&lt;/pre&gt;</code>. This regex needs to:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Precisely match the beginning <code>&lt;pre&gt;&lt;code&gt;</code></li>
<li class="text-foreground leading-relaxed">Capture <code>&lt;code&gt;</code> tag attributes (containing language information)</li>
<li class="text-foreground leading-relaxed">Capture code content (may include line breaks)</li>
<li class="text-foreground leading-relaxed">Match the ending <code>&lt;/code&gt;&lt;/pre&gt;</code></li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Importance of non-greedy matching</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The <code>?</code> in <code>([\s\S]*?)</code> achieves non-greedy matching, ensuring proper matching when there are multiple code blocks.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Attribute extraction technique</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><code>([^&gt;]*?)</code> captures all attributes within the <code>&lt;code&gt;</code> tag, preparing for subsequent language identification.</p>
<h3 id="language-identifier-extraction-algorithm" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#language-identifier-extraction-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Language Identifier Extraction Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Language Identifier Extraction Algorithm
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20languageMatch%20%3D%20attributes.match(%2Fclass%3D%5B%22'%5D(%5B%5E%22'%5D*language-(%5B%5E%22'%5Cs%5D%2B)%5B%5E%22'%5D*)%5B%22'%5D%2F)%3B%0Aconst%20language%20%3D%20languageMatch%20%3F%20languageMatch%5B2%5D%20%3A%20''%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> languageMatch = attributes.<span class="hljs-title function_ inline">match</span>(<span class="hljs-regexp inline">/class=[&quot;&#x27;]([^&quot;&#x27;]*language-([^&quot;&#x27;\s]+)[^&quot;&#x27;]*)[&quot;&#x27;]/</span>);
<span class="hljs-keyword inline">const</span> language = languageMatch ? languageMatch[<span class="hljs-number inline">2</span>] : <span class="hljs-string inline">&#x27;&#x27;</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">highlight.js Class Name Convention Analysis</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">highlight.js uses the <code>language-xxx</code> class name format to identify code languages, such as:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>language-typescript</code></li>
<li class="text-foreground leading-relaxed"><code>language-javascript</code></li>
<li class="text-foreground leading-relaxed"><code>language-python</code></li>
<li class="text-foreground leading-relaxed">…</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Complex Regex Group Capture</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">First capture group <code>([^&quot;']*language-([^&quot;'\s]+)[^&quot;']*)</code>: Captures entire class attribute value</li>
<li class="text-foreground leading-relaxed">Second capture group <code>([^&quot;'\s]+)</code>: Captures specific language name</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Graceful degradation with default values</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">If language cannot be identified, it defaults to displaying <code>'code'</code>, ensuring UI consistency.</p>
<h3 id="html-entity-restoration-processing" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#html-entity-restoration-processing" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to HTML Entity Restoration Processing">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            HTML Entity Restoration Processing
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20cleanContent%20%3D%20content%0A.replace(%2F%26lt%3B%2Fg%2C%20')%0A.replace(%2F%26gt%3B%2Fg%2C%20'%3E')%0A.replace(%2F%26amp%3B%2Fg%2C%20'%26')%0A.replace(%2F%22%2Fg%2C%20'%22')%0A.replace(%2F'%2Fg%2C%20%22'%22)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> cleanContent = content
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;lt;/g</span>, <span class="hljs-string inline">&#x27;&lt;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;gt;/g</span>, <span class="hljs-string inline">&#x27;&gt;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;amp;/g</span>, <span class="hljs-string inline">&#x27;&amp;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;quot;/g</span>, <span class="hljs-string inline">&#x27;&quot;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;#x27;/g</span>, <span class="hljs-string inline">&quot;&#x27;&quot;</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why HTML entity restoration is needed?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">Remarkable converts special characters to HTML entities when processing code content to prevent XSS attacks. But in copy functionality, users expect original code, not HTML entities.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Importance of replacement order</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Note that <code>&amp;amp;</code> replacement must be last, because other entities (like <code>&amp;lt;</code>) contain <code>&amp;</code> characters themselves. Wrong order would cause double replacement.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">URL encoding application in data attributes</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="data-code%3D%22%24%7BencodeURIComponent(cleanContent)%7D%22">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript">data-code=<span class="hljs-string inline">&quot;${encodeURIComponent(cleanContent)}&quot;</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Cleaned code is stored in data attributes through URL encoding, ensuring copy functionality can retrieve correct content.</p>
<h3 id="enhanced-code-block-html-structure-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#enhanced-code-block-html-structure-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Enhanced Code Block HTML Structure Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Enhanced Code Block HTML Structure Design
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The generated enhanced code block has a complex HTML structure:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="html" data-code="div%20class%3D%22enhanced-codeblock%20relative%20mb-6%20rounded-lg%20border%20bg-background%20border-gray-200...%22%3E%0Adiv%20class%3D%22codeblock-header%20flex%20items-center%20justify-between%20px-4%20py-2%20bg-surface...%22%3E%0Aspan%20class%3D%22codeblock-language%20text-xs%20font-medium%20text-foreground%20opacity-70...%22%3Etypescriptspan%3E%0Abutton%20class%3D%22codeblock-copy-btn%20inline-flex%20items-center%20bg-background%20hover%3Abg-surface%20text-foreground%20hover%3Atext-primary...%22%3E%0Abutton%3E%0Adiv%3E%0Apre%20class%3D%22codeblock-content%20p-4%20overflow-x-auto%20bg-surface%20text-foreground...%22%3E%0Acode%20class%3D%22language-typescript%22%3EOriginal%20code%20contentcode%3E%0Apre%3E%0Adiv%3E">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">html</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-html"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200...&quot;</span>&gt;</span>
    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;codeblock-header flex items-center justify-between px-4 py-2 bg-surface...&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;codeblock-language text-xs font-medium text-foreground opacity-70...&quot;</span>&gt;</span>typescript<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;codeblock-copy-btn inline-flex items-center bg-background hover:bg-surface text-foreground hover:text-primary...&quot;</span>&gt;</span>
            <span class="hljs-comment inline">&lt;!-- SVG icons and text --&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">pre</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;codeblock-content p-4 overflow-x-auto bg-surface text-foreground...&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">code</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;language-typescript&quot;</span>&gt;</span>Original code content<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">code</span>&gt;</span>
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">pre</span>&gt;</span>
<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">CSS Grid vs Flexbox layout choice</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The header area uses Flexbox (<code>flex items-center justify-between</code>) to achieve alignment of language identifier and copy button at both ends, which is more suitable for this one-dimensional layout than Grid.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Theme system seamless switching mechanism</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Each element uses theme system color variables:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="css" data-code="bg-background%0Abg-surface%0Atext-foreground%0Atext-primary">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">css</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-css">bg-<span class="hljs-attribute inline">background</span>
bg-surface
<span class="hljs-selector-tag inline">text</span>-foreground
<span class="hljs-selector-tag inline">text</span>-primary
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">These class names connect to the theme system through CSS custom properties, ensuring automatic adaptation during theme switching.</p>
<h3 id="dynamic-theme-switching-implementation-mechanism" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#dynamic-theme-switching-implementation-mechanism" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Dynamic Theme Switching Implementation Mechanism">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Dynamic Theme Switching Implementation Mechanism
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">To make code blocks responsive to theme changes, there’s also a dynamic CSS injection system:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Theme%20detection%20and%20CSS%20injection%0Afunction%20injectThemeCSS()%20%7B%0Aconst%20existingStyle%20%3D%20document.getElementById('codeblock-theme-styles')%3B%0Aif%20(existingStyle)%20%7B%0AexistingStyle.remove()%3B%0A%7D%0A%2F%2F%20Detect%20current%20theme%0Aconst%20isDark%20%3D%20document.documentElement.classList.contains('dark')%3B%0A%2F%2F%20Generate%20theme-appropriate%20CSS%0Aconst%20themeStyles%20%3D%20%60%0A.enhanced-codeblock%20%7B%0Abackground-color%3A%20var(--color-background)%20!important%3B%0Aborder-color%3A%20%24%7BisDark%20%3F%20'%23374151'%20%3A%20'%23e5e7eb'%7D%20!important%3B%0A%7D%0A.codeblock-header%20%7B%0Abackground-color%3A%20var(--color-surface)%20!important%3B%0Aborder-bottom-color%3A%20%24%7BisDark%20%3F%20'%23374151'%20%3A%20'%23e5e7eb'%7D%20!important%3B%0A%7D%0A.codeblock-copy-btn%20%7B%0Abackground-color%3A%20var(--color-background)%20!important%3B%0Acolor%3A%20var(--color-foreground)%20!important%3B%0A%7D%0A.codeblock-copy-btn%3Ahover%20%7B%0Abackground-color%3A%20var(--color-surface)%20!important%3B%0Acolor%3A%20var(--color-primary)%20!important%3B%0A%7D%0A.codeblock-content%20%7B%0Abackground-color%3A%20var(--color-surface)%20!important%3B%0Acolor%3A%20var(--color-foreground)%20!important%3B%0A%7D%0A%60%3B%0A%2F%2F%20Inject%20into%20document%20head%0Aconst%20styleElement%20%3D%20document.createElement('style')%3B%0AstyleElement.id%20%3D%20'codeblock-theme-styles'%3B%0AstyleElement.textContent%20%3D%20themeStyles%3B%0Adocument.head.appendChild(styleElement)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Theme detection and CSS injection</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">injectThemeCSS</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">const</span> existingStyle = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">getElementById</span>(<span class="hljs-string inline">&#x27;codeblock-theme-styles&#x27;</span>);
    <span class="hljs-keyword inline">if</span> (existingStyle) {
        existingStyle.<span class="hljs-title function_ inline">remove</span>();
    }
    
    <span class="hljs-comment inline">// Detect current theme</span>
    <span class="hljs-keyword inline">const</span> isDark = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">documentElement</span>.<span class="hljs-property inline">classList</span>.<span class="hljs-title function_ inline">contains</span>(<span class="hljs-string inline">&#x27;dark&#x27;</span>);
    
    <span class="hljs-comment inline">// Generate theme-appropriate CSS</span>
    <span class="hljs-keyword inline">const</span> themeStyles = <span class="hljs-string inline">`
        .enhanced-codeblock {
            background-color: var(--color-background) !important;
            border-color: <span class="hljs-subst inline">${isDark ? <span class="hljs-string inline">&#x27;#374151&#x27;</span> : <span class="hljs-string inline">&#x27;#e5e7eb&#x27;</span>}</span> !important;
        }
        .codeblock-header {
            background-color: var(--color-surface) !important;
            border-bottom-color: <span class="hljs-subst inline">${isDark ? <span class="hljs-string inline">&#x27;#374151&#x27;</span> : <span class="hljs-string inline">&#x27;#e5e7eb&#x27;</span>}</span> !important;
        }
        .codeblock-copy-btn {
            background-color: var(--color-background) !important;
            color: var(--color-foreground) !important;
        }
        .codeblock-copy-btn:hover {
            background-color: var(--color-surface) !important;
            color: var(--color-primary) !important;
        }
        .codeblock-content {
            background-color: var(--color-surface) !important;
            color: var(--color-foreground) !important;
        }
    `</span>;
    
    <span class="hljs-comment inline">// Inject into document head</span>
    <span class="hljs-keyword inline">const</span> styleElement = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">createElement</span>(<span class="hljs-string inline">&#x27;style&#x27;</span>);
    styleElement.<span class="hljs-property inline">id</span> = <span class="hljs-string inline">&#x27;codeblock-theme-styles&#x27;</span>;
    styleElement.<span class="hljs-property inline">textContent</span> = themeStyles;
    <span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">head</span>.<span class="hljs-title function_ inline">appendChild</span>(styleElement);
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Theme change listening mechanism</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Listen%20to%20DOM%20changes%2C%20detect%20theme%20switching%0Aconst%20observer%20%3D%20new%20MutationObserver(function(mutations)%20%7B%0Amutations.forEach(function(mutation)%20%7B%0Aif%20(mutation.type%20%3D%3D%3D%20'attributes'%20%26%26%0Amutation.attributeName%20%3D%3D%3D%20'class'%20%26%26%0Amutation.target%20%3D%3D%3D%20document.documentElement)%20%7B%0AsetTimeout(injectThemeCSS%2C%2010)%3B%0A%7D%0A%7D)%3B%0A%7D)%3B%0Aobserver.observe(document.documentElement%2C%20%7B%0Aattributes%3A%20true%2C%0AattributeFilter%3A%20%5B'class'%5D%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Listen to DOM changes, detect theme switching</span>
<span class="hljs-keyword inline">const</span> observer = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">MutationObserver</span>(<span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">mutations</span>) {
    mutations.<span class="hljs-title function_ inline">forEach</span>(<span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">mutation</span>) {
        <span class="hljs-keyword inline">if</span> (mutation.<span class="hljs-property inline">type</span> === <span class="hljs-string inline">&#x27;attributes&#x27;</span> &amp;&amp; 
            mutation.<span class="hljs-property inline">attributeName</span> === <span class="hljs-string inline">&#x27;class&#x27;</span> &amp;&amp; 
            mutation.<span class="hljs-property inline">target</span> === <span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">documentElement</span>) {
            <span class="hljs-built_in inline">setTimeout</span>(injectThemeCSS, <span class="hljs-number inline">10</span>);
        }
    });
});

observer.<span class="hljs-title function_ inline">observe</span>(<span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">documentElement</span>, {
    <span class="hljs-attr inline">attributes</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">attributeFilter</span>: [<span class="hljs-string inline">&#x27;class&#x27;</span>]
});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why use dynamic CSS injection instead of static class names?</strong></p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Real-time response</strong>: Immediately update styles when theme switches, no need to re-render components</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Performance optimization</strong>: Avoid lots of conditional class name judgments</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Flexibility</strong>: Can dynamically adjust border colors and other details based on theme state</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Priority control</strong>: Use <code>!important</code> to ensure theme styles take precedence over default styles</li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Advantages of CSS custom properties</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The theme system sets CSS custom properties on the root element through <code>ThemeProvider</code>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="Object.entries(currentTheme.colors).forEach((%5Bkey%2C%20value%5D)%20%3D%3E%20%7B%0Aroot.style.setProperty(%60--color-%24%7Bkey%7D%60%2C%20value)%3B%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-title class_ inline">Object</span>.<span class="hljs-title function_ inline">entries</span>(currentTheme.<span class="hljs-property inline">colors</span>).<span class="hljs-title function_ inline">forEach</span>(<span class="hljs-function inline">(<span class="hljs-params inline">[key, value]</span>) =&gt;</span> {
    root.<span class="hljs-property inline">style</span>.<span class="hljs-title function_ inline">setProperty</span>(<span class="hljs-string inline">`--color-<span class="hljs-subst inline">${key}</span>`</span>, value);
});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">This way code blocks can automatically get current theme color values through <code>var(--color-background)</code>, <code>var(--color-surface)</code>, etc.</p>
<h2 id="client-side-interaction-scripts-monitoring-and-notifications" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#client-side-interaction-scripts-monitoring-and-notifications" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Client-Side Interaction Scripts: Monitoring and Notifications">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Client-Side Interaction Scripts: Monitoring and Notifications
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Enhanced code block copy, notifications, and dynamic feature initialization.</p>
<h3 id="gracefully-degradable-copy-functionality" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#gracefully-degradable-copy-functionality" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Gracefully Degradable Copy Functionality">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Gracefully Degradable Copy Functionality
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="if%20(navigator.clipboard%20%26%26%20navigator.clipboard.writeText)%20%7B%0Aawait%20navigator.clipboard.writeText(code)%3B%0A%7D%20else%20%7B%0A%2F%2F%20Compatibility%20fallback%20solution%0Aconst%20textArea%20%3D%20document.createElement('textarea')%3B%0AtextArea.value%20%3D%20code%3B%0AtextArea.style.position%20%3D%20'fixed'%3B%0AtextArea.style.left%20%3D%20'-999999px'%3B%0AtextArea.style.top%20%3D%20'-999999px'%3B%0Adocument.body.appendChild(textArea)%3B%0AtextArea.focus()%3B%0AtextArea.select()%3B%0Adocument.execCommand('copy')%3B%0AtextArea.remove()%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">if</span> (navigator.<span class="hljs-property inline">clipboard</span> &amp;&amp; navigator.<span class="hljs-property inline">clipboard</span>.<span class="hljs-property inline">writeText</span>) {
    <span class="hljs-keyword inline">await</span> navigator.<span class="hljs-property inline">clipboard</span>.<span class="hljs-title function_ inline">writeText</span>(code);
} <span class="hljs-keyword inline">else</span> {
    <span class="hljs-comment inline">// Compatibility fallback solution</span>
    <span class="hljs-keyword inline">const</span> textArea = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">createElement</span>(<span class="hljs-string inline">&#x27;textarea&#x27;</span>);
    textArea.<span class="hljs-property inline">value</span> = code;
    textArea.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">position</span> = <span class="hljs-string inline">&#x27;fixed&#x27;</span>;
    textArea.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = <span class="hljs-string inline">&#x27;-999999px&#x27;</span>;
    textArea.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">top</span> = <span class="hljs-string inline">&#x27;-999999px&#x27;</span>;
    <span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">body</span>.<span class="hljs-title function_ inline">appendChild</span>(textArea);
    textArea.<span class="hljs-title function_ inline">focus</span>();
    textArea.<span class="hljs-title function_ inline">select</span>();
    <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">execCommand</span>(<span class="hljs-string inline">&#x27;copy&#x27;</span>);
    textArea.<span class="hljs-title function_ inline">remove</span>();
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Modern Clipboard API vs Traditional Solution Comparison</strong>:</p>
<table class="w-full border-collapse mb-4 shadow-sm rounded-lg overflow-hidden">
<thead class="bg-surface">
<tr class="border-b border-gray-200"><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Feature</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Clipboard API</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">document.execCommand</th></tr>
</thead>
<tbody class="bg-background divide-y divide-gray-200">
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">Security</td><td class="px-4 py-3 text-sm text-foreground">Requires HTTPS or localhost</td><td class="px-4 py-3 text-sm text-foreground">Relatively lenient</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">Async Support</td><td class="px-4 py-3 text-sm text-foreground">Native Promise</td><td class="px-4 py-3 text-sm text-foreground">Synchronous operation</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">Browser Support</td><td class="px-4 py-3 text-sm text-foreground">Modern browsers</td><td class="px-4 py-3 text-sm text-foreground">Wide support but deprecated</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">User Experience</td><td class="px-4 py-3 text-sm text-foreground">No user interaction needed</td><td class="px-4 py-3 text-sm text-foreground">Requires focus and select</td></tr>
</tbody>
</table>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Error handling for async operations</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="try%20%7B%0Aawait%20navigator.clipboard.writeText(code)%3B%0AshowToast('Code%20copied%20to%20clipboard!'%2C%20'success')%3B%0A%7D%20catch%20(err)%20%7B%0Aconsole.error('Failed%20to%20copy%20code%3A'%2C%20err)%3B%0AshowToast('Copy%20failed'%2C%20'error')%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">await</span> navigator.<span class="hljs-property inline">clipboard</span>.<span class="hljs-title function_ inline">writeText</span>(code);
    <span class="hljs-title function_ inline">showToast</span>(<span class="hljs-string inline">&#x27;Code copied to clipboard!&#x27;</span>, <span class="hljs-string inline">&#x27;success&#x27;</span>);
} <span class="hljs-keyword inline">catch</span> (err) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Failed to copy code:&#x27;</span>, err);
    <span class="hljs-title function_ inline">showToast</span>(<span class="hljs-string inline">&#x27;Copy failed&#x27;</span>, <span class="hljs-string inline">&#x27;error&#x27;</span>);
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Security policy impact on copy functionality</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Modern browser security policies require the Clipboard API to only work in secure contexts (HTTPS), which is why we need fallback solutions.</p>
<h3 id="dynamic-content-listening-mutationobserver" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#dynamic-content-listening-mutationobserver" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Dynamic Content Listening: MutationObserver">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Dynamic Content Listening: MutationObserver
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20observer%20%3D%20new%20MutationObserver(function(mutations)%20%7B%0Alet%20shouldReinitialize%20%3D%20false%3B%0Amutations.forEach(function(mutation)%20%7B%0Amutation.addedNodes.forEach(function(node)%20%7B%0Aif%20(node.nodeType%20%3D%3D%3D%201%20%26%26%20(node.classList.contains('enhanced-codeblock')%20%7C%7C%20node.querySelector('.enhanced-codeblock')))%20%7B%0AshouldReinitialize%20%3D%20true%3B%0A%7D%0A%7D)%3B%0A%7D)%3B%0Aif%20(shouldReinitialize)%20%7B%0A%2F%2F%20Debounce%20mechanism%0AclearTimeout(window%5B'__codeblock_reinit_timeout__'%5D)%3B%0Awindow%5B'__codeblock_reinit_timeout__'%5D%20%3D%20setTimeout(initializeCodeBlocks%2C%20100)%3B%0A%7D%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> observer = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">MutationObserver</span>(<span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">mutations</span>) {
    <span class="hljs-keyword inline">let</span> shouldReinitialize = <span class="hljs-literal inline">false</span>;
    mutations.<span class="hljs-title function_ inline">forEach</span>(<span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">mutation</span>) {
        mutation.<span class="hljs-property inline">addedNodes</span>.<span class="hljs-title function_ inline">forEach</span>(<span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">node</span>) {
            <span class="hljs-keyword inline">if</span> (node.<span class="hljs-property inline">nodeType</span> === <span class="hljs-number inline">1</span> &amp;&amp; (node.<span class="hljs-property inline">classList</span>.<span class="hljs-title function_ inline">contains</span>(<span class="hljs-string inline">&#x27;enhanced-codeblock&#x27;</span>) || node.<span class="hljs-title function_ inline">querySelector</span>(<span class="hljs-string inline">&#x27;.enhanced-codeblock&#x27;</span>))) {
                shouldReinitialize = <span class="hljs-literal inline">true</span>;
            }
        });
    });
    
    <span class="hljs-keyword inline">if</span> (shouldReinitialize) {
        <span class="hljs-comment inline">// Debounce mechanism</span>
        <span class="hljs-built_in inline">clearTimeout</span>(<span class="hljs-variable language_ inline">window</span>[<span class="hljs-string inline">&#x27;__codeblock_reinit_timeout__&#x27;</span>]);
        <span class="hljs-variable language_ inline">window</span>[<span class="hljs-string inline">&#x27;__codeblock_reinit_timeout__&#x27;</span>] = <span class="hljs-built_in inline">setTimeout</span>(initializeCodeBlocks, <span class="hljs-number inline">100</span>);
    }
});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why DOM change listening is needed?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">In React applications, components may dynamically update content. If new code blocks are added, we need to rebind event listeners for them.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Debounce mechanism performance optimization</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">When DOM changes frequently, the debounce mechanism ensures the initialization function isn’t called excessively, avoiding performance issues and UI anomalies.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Memory leak protection strategy</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="if%20(!window%5B'__codeblock_observers__'%5D)%20%7B%0Awindow%5B'__codeblock_observers__'%5D%20%3D%20new%20Set()%3B%0A%7D%0Aif%20(!window%5B'__codeblock_observers__'%5D.has(observerId))%20%7B%0Awindow%5B'__codeblock_observers__'%5D.add(observerId)%3B%0A%2F%2F%20Create%20observer%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">window</span>[<span class="hljs-string inline">&#x27;__codeblock_observers__&#x27;</span>]) {
    <span class="hljs-variable language_ inline">window</span>[<span class="hljs-string inline">&#x27;__codeblock_observers__&#x27;</span>] = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Set</span>();
}

<span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">window</span>[<span class="hljs-string inline">&#x27;__codeblock_observers__&#x27;</span>].<span class="hljs-title function_ inline">has</span>(observerId)) {
    <span class="hljs-variable language_ inline">window</span>[<span class="hljs-string inline">&#x27;__codeblock_observers__&#x27;</span>].<span class="hljs-title function_ inline">add</span>(observerId);
    <span class="hljs-comment inline">// Create observer</span>
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Use a global Set to track already created observers, avoiding memory leaks from duplicate creation.</p>
<h3 id="toast-notification-system-implementation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#toast-notification-system-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Toast Notification System Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Toast Notification System Implementation
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="function%20showToast(message%2C%20type%20%3D%20'success')%20%7B%0A%2F%2F%20Remove%20existing%20notifications%0Aconst%20existingToasts%20%3D%20document.querySelectorAll('.copy-toast')%3B%0AexistingToasts.forEach(toast%20%3D%3E%20toast.remove())%3B%0A%2F%2F%20Create%20new%20notification%0Aconst%20toast%20%3D%20document.createElement('div')%3B%0Atoast.className%20%3D%20'copy-toast%20fixed%20top-4%20right-4%20z-%5B9999%5D%20px-4%20py-2%20rounded-lg%20shadow-lg%20transition-all%20duration-300%20transform%20translate-x-full%20opacity-0'%3B%0A%2F%2F%20Animation%20effects%0AsetTimeout(()%20%3D%3E%20%7B%0Atoast.classList.remove('translate-x-full'%2C%20'opacity-0')%3B%0A%7D%2C%2010)%3B%0A%2F%2F%20Auto%20removal%0AsetTimeout(()%20%3D%3E%20%7B%0Atoast.classList.add('translate-x-full'%2C%20'opacity-0')%3B%0AsetTimeout(()%20%3D%3E%20toast.remove()%2C%20300)%3B%0A%7D%2C%203000)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">showToast</span>(<span class="hljs-params inline">message, <span class="hljs-keyword inline">type</span> = <span class="hljs-string inline">&#x27;success&#x27;</span></span>) {
    <span class="hljs-comment inline">// Remove existing notifications</span>
    <span class="hljs-keyword inline">const</span> existingToasts = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">querySelectorAll</span>(<span class="hljs-string inline">&#x27;.copy-toast&#x27;</span>);
    existingToasts.<span class="hljs-title function_ inline">forEach</span>(<span class="hljs-function inline"><span class="hljs-params inline">toast</span> =&gt;</span> toast.<span class="hljs-title function_ inline">remove</span>());
    
    <span class="hljs-comment inline">// Create new notification</span>
    <span class="hljs-keyword inline">const</span> toast = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">createElement</span>(<span class="hljs-string inline">&#x27;div&#x27;</span>);
    toast.<span class="hljs-property inline">className</span> = <span class="hljs-string inline">&#x27;copy-toast fixed top-4 right-4 z-[9999] px-4 py-2 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full opacity-0&#x27;</span>;
    
    <span class="hljs-comment inline">// Animation effects</span>
    <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        toast.<span class="hljs-property inline">classList</span>.<span class="hljs-title function_ inline">remove</span>(<span class="hljs-string inline">&#x27;translate-x-full&#x27;</span>, <span class="hljs-string inline">&#x27;opacity-0&#x27;</span>);
    }, <span class="hljs-number inline">10</span>);
    
    <span class="hljs-comment inline">// Auto removal</span>
    <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        toast.<span class="hljs-property inline">classList</span>.<span class="hljs-title function_ inline">add</span>(<span class="hljs-string inline">&#x27;translate-x-full&#x27;</span>, <span class="hljs-string inline">&#x27;opacity-0&#x27;</span>);
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> toast.<span class="hljs-title function_ inline">remove</span>(), <span class="hljs-number inline">300</span>);
    }, <span class="hljs-number inline">3000</span>);
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Floating notification positioning strategy</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Use <code>fixed top-4 right-4</code> to fix notifications in the top-right corner of the viewport, ensuring visibility at any scroll position.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">CSS animation performance considerations</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Use <code>transform</code> instead of changing <code>top</code>/<code>right</code> values for animations, leveraging GPU acceleration for better performance.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Z-index layer management</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><code>z-[9999]</code> ensures notifications display above all other elements, including possible modals and dropdown menus.</p>
<h2 id="table-of-contents-generation-document-navigation-construction" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#table-of-contents-generation-document-navigation-construction" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Table of Contents Generation: Document Navigation Construction">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Table of Contents Generation: Document Navigation Construction
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">To some extent, this is actually part of JS reverse engineering.</p>
<h3 id="title-extraction-regex" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#title-extraction-regex" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Title Extraction Regex">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Title Extraction Regex
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20headingRegex%20%3D%20%2F%5D*)%3F%3E%5B%5Cs%5CS%5D*%3F%2Fgi%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> headingRegex = <span class="hljs-regexp inline">/&lt;h([1-6])(?:\s[^&gt;]*)?&gt;[\s\S]*?&lt;\/h[1-6]&gt;/gi</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Multi-line content matching</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Title content may contain line breaks, nested HTML tags, and other complex structures. <code>[\s\S]*?</code> ensures matching content that includes line breaks.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Nested HTML handling</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Titles may contain inline tags like <code>&lt;code&gt;</code>, <code>&lt;strong&gt;</code>. The regex needs to accurately match complete title structures.</p>
<h3 id="precise-text-content-extraction" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#precise-text-content-extraction" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Precise Text Content Extraction">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Precise Text Content Extraction
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20text%20%3D%20tagContent%0A.replace(%2F%5D*%3E%2Fg%2C%20'')%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Remove%20HTML%20tags%0A.replace(%2F%26lt%3B%2Fg%2C%20')%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Decode%20HTML%20entities%0A.replace(%2F%26gt%3B%2Fg%2C%20'%3E')%0A.replace(%2F%26amp%3B%2Fg%2C%20'%26')%0A.replace(%2F%22%2Fg%2C%20'%22')%0A.replace(%2F'%2Fg%2C%20%22'%22)%0A.replace(%2F'%2Fg%2C%20%22'%22)%0A.replace(%2F%20%2Fg%2C%20'%20')%0A.replace(%2F%5Cs%2B%2Fg%2C%20'%20')%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Normalize%20whitespace%0A.trim()%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> text = tagContent
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&lt;[^&gt;]*&gt;/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>)           <span class="hljs-comment inline">// Remove HTML tags</span>
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;lt;/g</span>, <span class="hljs-string inline">&#x27;&lt;&#x27;</span>)            <span class="hljs-comment inline">// Decode HTML entities</span>
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;gt;/g</span>, <span class="hljs-string inline">&#x27;&gt;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;amp;/g</span>, <span class="hljs-string inline">&#x27;&amp;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;quot;/g</span>, <span class="hljs-string inline">&#x27;&quot;&#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;#x27;/g</span>, <span class="hljs-string inline">&quot;&#x27;&quot;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;#39;/g</span>, <span class="hljs-string inline">&quot;&#x27;&quot;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;nbsp;/g</span>, <span class="hljs-string inline">&#x27; &#x27;</span>)
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s+/g</span>, <span class="hljs-string inline">&#x27; &#x27;</span>)              <span class="hljs-comment inline">// Normalize whitespace</span>
    .<span class="hljs-title function_ inline">trim</span>();
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">HTML tag stripping algorithm</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><code>/&lt;[^&gt;]*&gt;/g</code> removes all HTML tags, keeping pure text content for TOC items.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Entity decoding coverage solution</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Covers common HTML entities, ensuring correct display of TOC text.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Whitespace normalization processing</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><code>\s+</code> matches all types of whitespace characters (spaces, tabs, line breaks), uniformly replacing them with single spaces.</p>
<h3 id="id-generation-algorithm-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#id-generation-algorithm-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to ID Generation Algorithm Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            ID Generation Algorithm Design
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="let%20id%20%3D%20text%0A.toLowerCase()%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Convert%20to%20lowercase%0A.replace(%2F%5B%5E%5Cw%5Cs%5Cu00A0-%5CuFFFF-%5D%2Fg%2C%20'')%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Keep%20letters%2C%20numbers%2C%20and%20Unicode%20characters%0A.replace(%2F%5Cs%2B%2Fg%2C%20'-')%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Convert%20spaces%20to%20hyphens%0A.replace(%2F-%2B%2Fg%2C%20'-')%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Merge%20multiple%20hyphens%0A.replace(%2F%5E-%2B%7C-%2B%24%2Fg%2C%20'')%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Remove%20leading%2Ftrailing%20hyphens">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">let</span> id = text
    .<span class="hljs-title function_ inline">toLowerCase</span>()                                       <span class="hljs-comment inline">// Convert to lowercase</span>
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/[^\w\s\u00A0-\uFFFF-]/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>)               <span class="hljs-comment inline">// Keep letters, numbers, and Unicode characters</span>
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s+/g</span>, <span class="hljs-string inline">&#x27;-&#x27;</span>)                                <span class="hljs-comment inline">// Convert spaces to hyphens</span>
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/-+/g</span>, <span class="hljs-string inline">&#x27;-&#x27;</span>)                                 <span class="hljs-comment inline">// Merge multiple hyphens</span>
    .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/^-+|-+$/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>);                            <span class="hljs-comment inline">// Remove leading/trailing hyphens</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">URL-safe ID generation rules</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Only keep letters, numbers, Unicode characters (supports Chinese, etc.)</li>
<li class="text-foreground leading-relaxed">Convert spaces to hyphens</li>
<li class="text-foreground leading-relaxed">Remove special characters to avoid URL issues</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Internationalization character support strategy</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The <code>\u00A0-\uFFFF</code> range covers most Unicode characters, ensuring titles in Chinese, Japanese, etc., can correctly generate IDs.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">ID conflict resolution mechanism</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="let%20uniqueId%20%3D%20id%3B%0Alet%20counter%20%3D%201%3B%0Awhile%20(toc.some(item%20%3D%3E%20item.id%20%3D%3D%3D%20uniqueId))%20%7B%0AuniqueId%20%3D%20%60%24%7Bid%7D-%24%7Bcounter%7D%60%3B%0Acounter%2B%2B%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">let</span> uniqueId = id;
<span class="hljs-keyword inline">let</span> counter = <span class="hljs-number inline">1</span>;
<span class="hljs-keyword inline">while</span> (toc.<span class="hljs-title function_ inline">some</span>(<span class="hljs-function inline"><span class="hljs-params inline">item</span> =&gt;</span> item.<span class="hljs-property inline">id</span> === uniqueId)) {
    uniqueId = <span class="hljs-string inline">`<span class="hljs-subst inline">${id}</span>-<span class="hljs-subst inline">${counter}</span>`</span>;
    counter++;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Ensure ID uniqueness by adding numeric suffixes.</p>
<h2 id="anchor-generation-navigable-document-implementation" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#anchor-generation-navigable-document-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Anchor Generation: Navigable Document Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Anchor Generation: Navigable Document Implementation
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Only when Staraglar plus Felgen can successfully summon Tadius. Missing any one makes the other a useless blank board… Well, even if Tadius is summoned, it’s quite ordinary, but it’s better than nothing.</p>
<h3 id="anchor-html-structure-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#anchor-html-structure-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Anchor HTML Structure Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Anchor HTML Structure Design
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="return%20%60%24%7Btag%7D%20id%3D%22%24%7BtocItem.id%7D%22%20class%3D%22group%20relative%22%3E%0A%24%7BtocItem.id%7D%22%20class%3D%22absolute%20-left-6%20top-0%20opacity-0%20group-hover%3Aopacity-100%20transition-opacity%20text-primary%2F60%20hover%3Atext-primary%22%20aria-label%3D%22Link%20to%20%24%7BtocItem.text%7D%22%3E%0A%24%7Bcontent%7D%0A%24%7Btag%7D%3E%60%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">return</span> <span class="hljs-string inline">`&lt;<span class="hljs-subst inline">${tag}</span> id=&quot;<span class="hljs-subst inline">${tocItem.id}</span>&quot; class=&quot;group relative&quot;&gt;
    &lt;a href=&quot;#<span class="hljs-subst inline">${tocItem.id}</span>&quot; class=&quot;absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary&quot; aria-label=&quot;Link to <span class="hljs-subst inline">${tocItem.text}</span>&quot;&gt;
        &lt;svg class=&quot;w-5 h-5&quot; fill=&quot;currentColor&quot; viewBox=&quot;0 0 20 20&quot;&gt;
            &lt;path fill-rule=&quot;evenodd&quot; d=&quot;M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z&quot; clip-rule=&quot;evenodd&quot; /&gt;
        &lt;/svg&gt;
    &lt;/a&gt;
    <span class="hljs-subst inline">${content}</span>
&lt;/<span class="hljs-subst inline">${tag}</span>&gt;`</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">CSS Group selector</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">The <code>group</code> class combined with <code>group-hover:opacity-100</code> achieves the effect of “anchor links only show when mouse hovers over the title.”</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Relative positioning control</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><code>absolute -left-6 top-0</code> positions the anchor icon 6 units to the left of the title, where there’s at least some empty space.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">SVG icon selection and optimization</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Uses the SVG version of link icons, <code>fill=&quot;currentColor&quot;</code> ensures icon color stays consistent with text color.</p>
<h3 id="comprehensive-accessibility-considerations" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#comprehensive-accessibility-considerations" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Comprehensive Accessibility Considerations">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Comprehensive Accessibility Considerations
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="html" data-code="aria-label%3D%22Link%20to%20%24%7BtocItem.text%7D%22">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">html</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-html">aria-label=&quot;Link to ${tocItem.text}&quot;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Screen reader support</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><code>aria-label</code> provides link description information for visually impaired users.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Keyboard navigation friendliness</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Anchor links can be focused via Tab key and activated with Enter key, ensuring keyboard users can use them normally.</p>
<h2 id="complete-source-code-analysis" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#complete-source-code-analysis" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete Source Code Analysis">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete Source Code Analysis
        </h2>
<h3 id="style-injection-core-module" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#style-injection-core-module" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Style Injection Core Module">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Style Injection Core Module
        </h3>
<pre><code class="language-typescript"><span class="hljs-comment inline">// src/lib/utils/styleInject.ts</span>
<span class="hljs-keyword inline">import</span> markdownStyles <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;../../../public/styles/markdown.json&#x27;</span>;

<span class="hljs-comment inline">/**
 * Main style injection function: Inject Tailwind CSS classes into HTML elements
 * Solves display issues after Preflight reset styles
 */</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">styleInject</span>(<span class="hljs-params inline"><span class="hljs-attr inline">htmlContent</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">translations</span>?: <span class="hljs-built_in inline">any</span></span>): <span class="hljs-built_in inline">string</span> {
    <span class="hljs-keyword inline">let</span> styledContent = htmlContent;

    <span class="hljs-comment inline">// Step 1: Process code block enhancement functionality</span>
    styledContent = <span class="hljs-title function_ inline">processCodeBlocks</span>(styledContent, translations);

    <span class="hljs-comment inline">// Step 2: Inject style classes for other HTML tags</span>
    <span class="hljs-title class_ inline">Object</span>.<span class="hljs-title function_ inline">entries</span>(markdownStyles).<span class="hljs-title function_ inline">forEach</span>(<span class="hljs-function inline">(<span class="hljs-params inline">[tag, classes]</span>) =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (<span class="hljs-keyword inline">typeof</span> classes === <span class="hljs-string inline">&#x27;string&#x27;</span> &amp;&amp; classes.<span class="hljs-title function_ inline">trim</span>()) {
            <span class="hljs-comment inline">// Skip tags already processed by enhanced code blocks</span>
            <span class="hljs-keyword inline">if</span> (tag === <span class="hljs-string inline">&#x27;pre&#x27;</span> || tag === <span class="hljs-string inline">&#x27;code&#x27;</span>) {
                <span class="hljs-keyword inline">return</span>;
            }

            <span class="hljs-comment inline">// Create regex for matching this tag</span>
            <span class="hljs-keyword inline">const</span> tagRegex = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RegExp</span>(<span class="hljs-string inline">`&lt;<span class="hljs-subst inline">${tag}</span>(\\s[^&gt;]*)?(?:&gt;|\\s*/&gt;)`</span>, <span class="hljs-string inline">&#x27;gi&#x27;</span>);

            styledContent = styledContent.<span class="hljs-title function_ inline">replace</span>(tagRegex, <span class="hljs-function inline">(<span class="hljs-params inline">match</span>) =&gt;</span> {
                <span class="hljs-comment inline">// Prevent duplicate injection check</span>
                <span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">includes</span>(classes.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27; &#x27;</span>)[<span class="hljs-number inline">0</span>])) {
                    <span class="hljs-keyword inline">return</span> match;
                }

                <span class="hljs-comment inline">// Check if class attribute already exists</span>
                <span class="hljs-keyword inline">const</span> classMatch = match.<span class="hljs-title function_ inline">match</span>(<span class="hljs-regexp inline">/class=[&quot;&#x27;]([^&quot;&#x27;]*)[&quot;&#x27;]/</span>);

                <span class="hljs-keyword inline">if</span> (classMatch) {
                    <span class="hljs-comment inline">// Merge existing class names</span>
                    <span class="hljs-keyword inline">const</span> existingClasses = classMatch[<span class="hljs-number inline">1</span>];
                    <span class="hljs-keyword inline">const</span> newClasses = classes.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27; &#x27;</span>).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">cls</span> =&gt;</span> !existingClasses.<span class="hljs-title function_ inline">includes</span>(cls)).<span class="hljs-title function_ inline">join</span>(<span class="hljs-string inline">&#x27; &#x27;</span>);
                    <span class="hljs-keyword inline">if</span> (newClasses) {
                        <span class="hljs-keyword inline">return</span> match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/class=[&quot;&#x27;]([^&quot;&#x27;]*)[&quot;&#x27;]/</span>, <span class="hljs-string inline">`class=&quot;$1 <span class="hljs-subst inline">${newClasses}</span>&quot;`</span>);
                    }
                    <span class="hljs-keyword inline">return</span> match;
                } <span class="hljs-keyword inline">else</span> {
                    <span class="hljs-comment inline">// Add new class attribute</span>
                    <span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">endsWith</span>(<span class="hljs-string inline">&#x27;/&gt;&#x27;</span>)) {
                        <span class="hljs-keyword inline">return</span> match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s*\/&gt;$/</span>, <span class="hljs-string inline">` class=&quot;<span class="hljs-subst inline">${classes}</span>&quot; /&gt;`</span>);
                    } <span class="hljs-keyword inline">else</span> {
                        <span class="hljs-keyword inline">return</span> match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&gt;$/</span>, <span class="hljs-string inline">` class=&quot;<span class="hljs-subst inline">${classes}</span>&quot;&gt;`</span>);
                    }
                }
            });
        }
    });

    <span class="hljs-keyword inline">return</span> styledContent;
}

<span class="hljs-comment inline">/**
 * Code block enhancement processing function
 * Converts regular code blocks into enhanced code blocks with copy functionality and theme support
 */</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">processCodeBlocks</span>(<span class="hljs-params inline"><span class="hljs-attr inline">htmlContent</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">translations</span>?: <span class="hljs-built_in inline">any</span></span>): <span class="hljs-built_in inline">string</span> {
    <span class="hljs-keyword inline">const</span> preCodeRegex = <span class="hljs-regexp inline">/&lt;pre&gt;&lt;code([^&gt;]*?)&gt;([\s\S]*?)&lt;\/code&gt;&lt;\/pre&gt;/g</span>;
    <span class="hljs-keyword inline">return</span> htmlContent.<span class="hljs-title function_ inline">replace</span>(preCodeRegex, <span class="hljs-function inline">(<span class="hljs-params inline">match, attributes, content</span>) =&gt;</span> {
        <span class="hljs-comment inline">// Avoid duplicate processing</span>
        <span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27;data-enhanced-codeblock&#x27;</span>)) {
            <span class="hljs-keyword inline">return</span> match;
        }

        <span class="hljs-comment inline">// Extract language information</span>
        <span class="hljs-keyword inline">const</span> languageMatch = attributes.<span class="hljs-title function_ inline">match</span>(<span class="hljs-regexp inline">/class=[&quot;&#x27;]([^&quot;&#x27;]*language-([^&quot;&#x27;\s]+)[^&quot;&#x27;]*)[&quot;&#x27;]/</span>);
        <span class="hljs-keyword inline">const</span> language = languageMatch ? languageMatch[<span class="hljs-number inline">2</span>] : <span class="hljs-string inline">&#x27;&#x27;</span>;

        <span class="hljs-comment inline">// Clean HTML entities</span>
        <span class="hljs-keyword inline">const</span> cleanContent = content
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;lt;/g</span>, <span class="hljs-string inline">&#x27;&lt;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;gt;/g</span>, <span class="hljs-string inline">&#x27;&gt;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;amp;/g</span>, <span class="hljs-string inline">&#x27;&amp;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;quot;/g</span>, <span class="hljs-string inline">&#x27;&quot;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;#x27;/g</span>, <span class="hljs-string inline">&quot;&#x27;&quot;</span>);

        <span class="hljs-comment inline">// Get internationalization text</span>
        <span class="hljs-keyword inline">const</span> copyText = translations?.<span class="hljs-property inline">codeblock</span>?.<span class="hljs-property inline">copy</span> || <span class="hljs-string inline">&#x27;Copy&#x27;</span>;
        <span class="hljs-keyword inline">const</span> copyTooltip = translations?.<span class="hljs-property inline">codeblock</span>?.<span class="hljs-property inline">copyTooltip</span> || <span class="hljs-string inline">&#x27;Copy code&#x27;</span>;

        <span class="hljs-comment inline">// Generate enhanced code block HTML structure</span>
        <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">`
            &lt;div class=&quot;enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm&quot; data-enhanced-codeblock=&quot;true&quot; data-language=&quot;<span class="hljs-subst inline">${language}</span>&quot; data-code=&quot;<span class="hljs-subst inline">${<span class="hljs-built_in inline">encodeURIComponent</span>(cleanContent)}</span>&quot;&gt;
                &lt;div class=&quot;codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700&quot;&gt;
                    &lt;span class=&quot;codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70&quot;&gt;<span class="hljs-subst inline">${language || <span class="hljs-string inline">&#x27;code&#x27;</span>}</span>&lt;/span&gt;
                    &lt;button class=&quot;codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95&quot; title=&quot;<span class="hljs-subst inline">${copyTooltip}</span>&quot;&gt;
                        &lt;svg class=&quot;copy-icon w-4 h-4&quot; fill=&quot;currentColor&quot; viewBox=&quot;0 0 20 20&quot;&gt;
                            &lt;path d=&quot;M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z&quot; /&gt;
                            &lt;path d=&quot;M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z&quot; /&gt;
                        &lt;/svg&gt;
                        &lt;svg class=&quot;copied-icon w-4 h-4 hidden&quot; fill=&quot;currentColor&quot; viewBox=&quot;0 0 20 20&quot;&gt;
                            &lt;path fill-rule=&quot;evenodd&quot; d=&quot;M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z&quot; clip-rule=&quot;evenodd&quot; /&gt;
                        &lt;/svg&gt;
                        &lt;span class=&quot;copy-text&quot;&gt;<span class="hljs-subst inline">${copyText}</span>&lt;/span&gt;
                    &lt;/button&gt;
                &lt;/div&gt;
                &lt;pre class=&quot;codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground&quot;&gt;&lt;code<span class="hljs-subst inline">${attributes}</span>&gt;<span class="hljs-subst inline">${content}</span>&lt;/code&gt;&lt;/pre&gt;
            &lt;/div&gt;
        `</span>;
    });
}

<span class="hljs-comment inline">/**
 * Extract table of contents structure
 */</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">extractTOC</span>(<span class="hljs-params inline"><span class="hljs-attr inline">htmlContent</span>: <span class="hljs-built_in inline">string</span></span>): <span class="hljs-title class_ inline">Array</span>&lt;{ <span class="hljs-attr inline">id</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">text</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">level</span>: <span class="hljs-built_in inline">number</span> }&gt; {
    <span class="hljs-keyword inline">const</span> <span class="hljs-attr inline">toc</span>: <span class="hljs-title class_ inline">Array</span>&lt;{ <span class="hljs-attr inline">id</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">text</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">level</span>: <span class="hljs-built_in inline">number</span> }&gt; = [];
    <span class="hljs-keyword inline">const</span> headingRegex = <span class="hljs-regexp inline">/&lt;h([1-6])(?:\s[^&gt;]*)?&gt;[\s\S]*?&lt;\/h[1-6]&gt;/gi</span>;
    <span class="hljs-keyword inline">let</span> match;

    <span class="hljs-keyword inline">while</span> ((match = headingRegex.<span class="hljs-title function_ inline">exec</span>(htmlContent)) !== <span class="hljs-literal inline">null</span>) {
        <span class="hljs-keyword inline">const</span> level = <span class="hljs-built_in inline">parseInt</span>(match[<span class="hljs-number inline">1</span>]);
        <span class="hljs-keyword inline">const</span> fullMatch = match[<span class="hljs-number inline">0</span>];
        <span class="hljs-keyword inline">const</span> tagContent = fullMatch.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&lt;h[1-6](?:\s[^&gt;]*)?&gt;|&lt;\/h[1-6]&gt;/gi</span>, <span class="hljs-string inline">&#x27;&#x27;</span>);

        <span class="hljs-keyword inline">const</span> text = tagContent
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&lt;[^&gt;]*&gt;/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;lt;/g</span>, <span class="hljs-string inline">&#x27;&lt;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;gt;/g</span>, <span class="hljs-string inline">&#x27;&gt;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;amp;/g</span>, <span class="hljs-string inline">&#x27;&amp;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;quot;/g</span>, <span class="hljs-string inline">&#x27;&quot;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;#x27;/g</span>, <span class="hljs-string inline">&quot;&#x27;&quot;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;#39;/g</span>, <span class="hljs-string inline">&quot;&#x27;&quot;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&amp;nbsp;/g</span>, <span class="hljs-string inline">&#x27; &#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s+/g</span>, <span class="hljs-string inline">&#x27; &#x27;</span>)
            .<span class="hljs-title function_ inline">trim</span>();

        <span class="hljs-keyword inline">if</span> (!text) <span class="hljs-keyword inline">continue</span>;

        <span class="hljs-keyword inline">let</span> id = text
            .<span class="hljs-title function_ inline">toLowerCase</span>()
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/[^\w\s\u00A0-\uFFFF-]/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s+/g</span>, <span class="hljs-string inline">&#x27;-&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/-+/g</span>, <span class="hljs-string inline">&#x27;-&#x27;</span>)
            .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/^-+|-+$/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>);

        <span class="hljs-keyword inline">let</span> uniqueId = id;
        <span class="hljs-keyword inline">let</span> counter = <span class="hljs-number inline">1</span>;
        <span class="hljs-keyword inline">while</span> (toc.<span class="hljs-title function_ inline">some</span>(<span class="hljs-function inline"><span class="hljs-params inline">item</span> =&gt;</span> item.<span class="hljs-property inline">id</span> === uniqueId)) {
            uniqueId = <span class="hljs-string inline">`<span class="hljs-subst inline">${id}</span>-<span class="hljs-subst inline">${counter}</span>`</span>;
            counter++;
        }

        <span class="hljs-keyword inline">if</span> (text &amp;&amp; uniqueId) {
            toc.<span class="hljs-title function_ inline">push</span>({<span class="hljs-attr inline">id</span>: uniqueId, text, level});
        }
    }

    <span class="hljs-keyword inline">return</span> toc;
}

<span class="hljs-comment inline">/**
 * Add anchor links to headings
 */</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">addHeadingAnchors</span>(<span class="hljs-params inline"><span class="hljs-attr inline">htmlContent</span>: <span class="hljs-built_in inline">string</span></span>): <span class="hljs-built_in inline">string</span> {
    <span class="hljs-keyword inline">const</span> tocItems = <span class="hljs-title function_ inline">extractTOC</span>(htmlContent);
    
    <span class="hljs-keyword inline">if</span> (tocItems.<span class="hljs-property inline">length</span> === <span class="hljs-number inline">0</span>) {
        <span class="hljs-keyword inline">return</span> htmlContent;
    }

    <span class="hljs-keyword inline">const</span> headingRegex = <span class="hljs-regexp inline">/&lt;h([1-6])(?:\s[^&gt;]*)?&gt;[\s\S]*?&lt;\/h[1-6]&gt;/gi</span>;
    <span class="hljs-keyword inline">let</span> tocIndex = <span class="hljs-number inline">0</span>;

    <span class="hljs-keyword inline">return</span> htmlContent.<span class="hljs-title function_ inline">replace</span>(headingRegex, <span class="hljs-function inline">(<span class="hljs-params inline">match, level</span>) =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (tocIndex &gt;= tocItems.<span class="hljs-property inline">length</span>) <span class="hljs-keyword inline">return</span> match;
        <span class="hljs-keyword inline">if</span> (match.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27; id=&#x27;</span>)) <span class="hljs-keyword inline">return</span> match;

        <span class="hljs-keyword inline">const</span> tocItem = tocItems[tocIndex];
        tocIndex++;

        <span class="hljs-keyword inline">const</span> tag = <span class="hljs-string inline">`h<span class="hljs-subst inline">${level}</span>`</span>;
        <span class="hljs-keyword inline">const</span> content = match.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/&lt;h[1-6](?:\s[^&gt;]*)?&gt;|&lt;\/h[1-6]&gt;/gi</span>, <span class="hljs-string inline">&#x27;&#x27;</span>);

        <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">`&lt;<span class="hljs-subst inline">${tag}</span> id=&quot;<span class="hljs-subst inline">${tocItem.id}</span>&quot; class=&quot;group relative&quot;&gt;
            &lt;a href=&quot;#<span class="hljs-subst inline">${tocItem.id}</span>&quot; class=&quot;absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary&quot; aria-label=&quot;Link to <span class="hljs-subst inline">${tocItem.text}</span>&quot;&gt;
                &lt;svg class=&quot;w-5 h-5&quot; fill=&quot;currentColor&quot; viewBox=&quot;0 0 20 20&quot;&gt;
                    &lt;path fill-rule=&quot;evenodd&quot; d=&quot;M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z&quot; clip-rule=&quot;evenodd&quot; /&gt;
                &lt;/svg&gt;
            &lt;/a&gt;
            <span class="hljs-subst inline">${content}</span>
        &lt;/<span class="hljs-subst inline">${tag}</span>&gt;`</span>;
    });
}

<span class="hljs-comment inline">/**
 * Generate client-side interaction scripts
 * Includes copy functionality, theme switching, DOM monitoring, etc.
 */</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">getCodeBlockScript</span>(<span class="hljs-params inline"><span class="hljs-attr inline">translations</span>?: <span class="hljs-built_in inline">any</span></span>): <span class="hljs-built_in inline">string</span> {
    <span class="hljs-keyword inline">const</span> copySuccessText = translations?.<span class="hljs-property inline">codeblock</span>?.<span class="hljs-property inline">copySuccess</span> || <span class="hljs-string inline">&#x27;Code copied to clipboard!&#x27;</span>;
    <span class="hljs-keyword inline">const</span> copyErrorText = translations?.<span class="hljs-property inline">codeblock</span>?.<span class="hljs-property inline">copyError</span> || <span class="hljs-string inline">&#x27;Failed to copy code&#x27;</span>;
    
    <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">`
        &lt;script&gt;
            (function() {
                // Theme CSS injection function
                function injectThemeCSS() {
                    const existingStyle = document.getElementById(&#x27;codeblock-theme-styles&#x27;);
                    if (existingStyle) {
                        existingStyle.remove();
                    }
                    
                    const isDark = document.documentElement.classList.contains(&#x27;dark&#x27;);
                    
                    const themeStyles = \`
                        .enhanced-codeblock {
                            background-color: var(--color-background) !important;
                            border-color: \${isDark ? &#x27;#374151&#x27; : &#x27;#e5e7eb&#x27;} !important;
                        }
                        .codeblock-header {
                            background-color: var(--color-surface) !important;
                            border-bottom-color: \${isDark ? &#x27;#374151&#x27; : &#x27;#e5e7eb&#x27;} !important;
                        }
                        .codeblock-copy-btn {
                            background-color: var(--color-background) !important;
                            color: var(--color-foreground) !important;
                        }
                        .codeblock-copy-btn:hover {
                            background-color: var(--color-surface) !important;
                            color: var(--color-primary) !important;
                        }
                        .codeblock-content {
                            background-color: var(--color-surface) !important;
                            color: var(--color-foreground) !important;
                        }
                    \`;
                    
                    const styleElement = document.createElement(&#x27;style&#x27;);
                    styleElement.id = &#x27;codeblock-theme-styles&#x27;;
                    styleElement.textContent = themeStyles;
                    document.head.appendChild(styleElement);
                }
                
                // Copy functionality initialization
                function initializeCodeBlocks() {
                    const codeBlocks = document.querySelectorAll(&#x27;.enhanced-codeblock&#x27;);
                    
                    codeBlocks.forEach(function(block, blockIndex) {
                        const copyBtn = block.querySelector(&#x27;.codeblock-copy-btn&#x27;);
                        if (!copyBtn || copyBtn.hasAttribute(&#x27;data-initialized&#x27;)) return;
                        
                        copyBtn.setAttribute(&#x27;data-initialized&#x27;, &#x27;true&#x27;);
                        
                        copyBtn.addEventListener(&#x27;click&#x27;, async function(e) {
                            e.preventDefault();
                            
                            try {
                                let code = block.getAttribute(&#x27;data-code&#x27;);
                                if (code) {
                                    code = decodeURIComponent(code);
                                } else {
                                    const codeElement = block.querySelector(&#x27;pre code&#x27;);
                                    if (codeElement) {
                                        code = codeElement.textContent || &#x27;&#x27;;
                                    }
                                }
                                
                                // Copy to clipboard
                                if (navigator.clipboard &amp;&amp; navigator.clipboard.writeText) {
                                    await navigator.clipboard.writeText(code);
                                } else {
                                    // Fallback solution
                                    const textArea = document.createElement(&#x27;textarea&#x27;);
                                    textArea.value = code;
                                    textArea.style.position = &#x27;fixed&#x27;;
                                    textArea.style.left = &#x27;-999999px&#x27;;
                                    document.body.appendChild(textArea);
                                    textArea.select();
                                    document.execCommand(&#x27;copy&#x27;);
                                    textArea.remove();
                                }
                                
                                showToast(&#x27;<span class="hljs-subst inline">${copySuccessText}</span>&#x27;, &#x27;success&#x27;);
                                
                            } catch (err) {
                                showToast(&#x27;<span class="hljs-subst inline">${copyErrorText}</span>&#x27;, &#x27;error&#x27;);
                            }
                        });
                    });
                }
                
                // Toast notification system
                function showToast(message, type = &#x27;success&#x27;) {
                    const existingToasts = document.querySelectorAll(&#x27;.copy-toast&#x27;);
                    existingToasts.forEach(toast =&gt; toast.remove());
                    
                    const toast = document.createElement(&#x27;div&#x27;);
                    toast.className = &#x27;copy-toast fixed top-4 right-4 z-[9999] px-4 py-2 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full opacity-0&#x27;;
                    
                    if (type === &#x27;success&#x27;) {
                        toast.className += &#x27; bg-green-500 text-white&#x27;;
                    } else {
                        toast.className += &#x27; bg-red-500 text-white&#x27;;
                    }
                    
                    toast.textContent = message;
                    document.body.appendChild(toast);
                    
                    setTimeout(() =&gt; {
                        toast.classList.remove(&#x27;translate-x-full&#x27;, &#x27;opacity-0&#x27;);
                    }, 10);
                    
                    setTimeout(() =&gt; {
                        toast.classList.add(&#x27;translate-x-full&#x27;, &#x27;opacity-0&#x27;);
                        setTimeout(() =&gt; toast.remove(), 300);
                    }, 3000);
                }
                
                // Initialization and monitoring
                if (document.readyState === &#x27;loading&#x27;) {
                    document.addEventListener(&#x27;DOMContentLoaded&#x27;, function() {
                        initializeCodeBlocks();
                        injectThemeCSS();
                    });
                } else {
                    initializeCodeBlocks();
                    injectThemeCSS();
                }
                
                // Theme change monitoring
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === &#x27;attributes&#x27; &amp;&amp; 
                            mutation.attributeName === &#x27;class&#x27; &amp;&amp; 
                            mutation.target === document.documentElement) {
                            setTimeout(injectThemeCSS, 10);
                        }
                    });
                });
                
                observer.observe(document.documentElement, {
                    attributes: true,
                    attributeFilter: [&#x27;class&#x27;]
                });
            })();
        &lt;/script&gt;
    `</span>;
}
</code></pre>
<h3 id="style-configuration-file" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#style-configuration-file" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Style Configuration File">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Style Configuration File
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="json" data-code="%2F%2F%20public%2Fstyles%2Fmarkdown.json%0A%7B%0A%22h1%22%3A%20%22text-4xl%20font-bold%20mt-8%20mb-4%20text-foreground%20leading-tight%22%2C%0A%22h2%22%3A%20%22text-3xl%20font-semibold%20mt-6%20mb-3%20text-foreground%20leading-tight%22%2C%0A%22h3%22%3A%20%22text-2xl%20font-semibold%20mt-5%20mb-2%20text-foreground%20leading-snug%22%2C%0A%22h4%22%3A%20%22text-xl%20font-medium%20mt-4%20mb-2%20text-foreground%20leading-snug%22%2C%0A%22p%22%3A%20%22text-base%20leading-7%20mb-4%20text-foreground%22%2C%0A%22code%22%3A%20%22bg-surface%20text-primary%20px-1.5%20py-0.5%20rounded%20text-sm%20font-mono%22%2C%0A%22pre%22%3A%20%22bg-surface%20text-foreground%20p-4%20rounded-lg%20overflow-x-auto%20mb-4%20font-mono%20text-sm%20leading-relaxed%20border%20border-gray-200%22%2C%0A%22ul%22%3A%20%22list-disc%20list-inside%20mb-4%20pl-6%20space-y-2%22%2C%0A%22ol%22%3A%20%22list-decimal%20list-inside%20mb-4%20pl-6%20space-y-2%22%2C%0A%22li%22%3A%20%22text-foreground%20leading-relaxed%22%2C%0A%22strong%22%3A%20%22font-bold%20text-foreground%22%2C%0A%22em%22%3A%20%22italic%20text-foreground%22%2C%0A%22a%22%3A%20%22text-primary%20hover%3Atext-accent%20underline%20transition-colors%20duration-200%22%2C%0A%22img%22%3A%20%22max-w-full%20h-auto%20rounded-lg%20shadow-sm%20my-4%20mx-auto%20block%22%2C%0A%22table%22%3A%20%22w-full%20border-collapse%20mb-4%20shadow-sm%20rounded-lg%20overflow-hidden%22%2C%0A%22th%22%3A%20%22px-4%20py-3%20text-left%20text-xs%20font-medium%20text-foreground%20uppercase%20tracking-wider%20bg-surface%22%2C%0A%22td%22%3A%20%22px-4%20py-3%20text-sm%20text-foreground%22%2C%0A%22blockquote%22%3A%20%22border-l-4%20border-primary%20pl-4%20py-2%20my-4%20bg-surface%20text-foreground%20italic%22%2C%0A%22hr%22%3A%20%22border-0%20h-px%20bg-gray-300%20my-8%22%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">json</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-json"><span class="hljs-comment inline">// public/styles/markdown.json</span>
<span class="hljs-punctuation inline">{</span>
  <span class="hljs-attr inline">&quot;h1&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-4xl font-bold mt-8 mb-4 text-foreground leading-tight&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;h2&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;h3&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;h4&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-xl font-medium mt-4 mb-2 text-foreground leading-snug&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;p&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-base leading-7 mb-4 text-foreground&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;code&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;bg-surface text-primary px-1.5 py-0.5 rounded text-sm font-mono&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;pre&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;bg-surface text-foreground p-4 rounded-lg overflow-x-auto mb-4 font-mono text-sm leading-relaxed border border-gray-200&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;ul&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;list-disc list-inside mb-4 pl-6 space-y-2&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;ol&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;list-decimal list-inside mb-4 pl-6 space-y-2&quot;</span><span class="hljs-punctuation inline">,</span> 
  <span class="hljs-attr inline">&quot;li&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-foreground leading-relaxed&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;strong&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;font-bold text-foreground&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;em&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;italic text-foreground&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;a&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;text-primary hover:text-accent underline transition-colors duration-200&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;img&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;max-w-full h-auto rounded-lg shadow-sm my-4 mx-auto block&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;table&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;w-full border-collapse mb-4 shadow-sm rounded-lg overflow-hidden&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;th&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;td&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;px-4 py-3 text-sm text-foreground&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;blockquote&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;border-l-4 border-primary pl-4 py-2 my-4 bg-surface text-foreground italic&quot;</span><span class="hljs-punctuation inline">,</span>
  <span class="hljs-attr inline">&quot;hr&quot;</span><span class="hljs-punctuation inline">:</span> <span class="hljs-string inline">&quot;border-0 h-px bg-gray-300 my-8&quot;</span>
<span class="hljs-punctuation inline">}</span>
</code></pre>
            </div>
        
<h3 id="server-side-rendering-integration" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#server-side-rendering-integration" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Server-Side Rendering Integration">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Server-Side Rendering Integration
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20src%2Fapp%2Fdocuments%2F%5B...slug%5D%2Fpage.tsx%0Aexport%20default%20async%20function%20DocumentPage(%7Bparams%7D%3A%20PageProps)%20%7B%0Atry%20%7B%0Aconst%20%7Bslug%7D%20%3D%20await%20params%3B%0Aconst%20%5Blang%2C%20category%2C%20fileName%5D%20%3D%20slug%3B%0Aconst%20%7Bcontent%2C%20frontMatter%2C%20readingTime%7D%20%3D%20getArticlesData(fileName%2C%20lang%2C%20false%2C%20category)%3B%0A%2F%2F%20Configure%20Remarkable%20parser%0Aconst%20md%20%3D%20new%20Remarkable(%7B%0Ahtml%3A%20true%2C%0Abreaks%3A%20true%2C%0Atypographer%3A%20true%2C%0Ahighlight%3A%20function%20(str%3A%20string%2C%20lang%3A%20string)%20%7B%0Aif%20(lang%20%26%26%20hljs.getLanguage(lang))%20%7B%0Atry%20%7B%0Areturn%20hljs.highlight(str%2C%20%7Blanguage%3A%20lang%7D).value%3B%0A%7D%20catch%20(err)%20%7B%7D%0A%7D%0Atry%20%7B%0Areturn%20hljs.highlightAuto(str).value%3B%0A%7D%20catch%20(err)%20%7B%7D%0Areturn%20''%3B%0A%7D%0A%7D)%0A.use(linkify)%0A.use(rkatex%2C%20%7Bdelimiter%3A%20'%24'%7D)%3B%0Alet%20htmlContent%20%3D%20md.render(content%2C%20frontMatter)%3B%0A%2F%2F%20Load%20internationalization%20text%0Alet%20translations%20%3D%20null%3B%0Atry%20%7B%0Aconst%20translationsPath%20%3D%20path.join(process.cwd()%2C%20'public'%2C%20'locales'%2C%20lang%2C%20'common.json')%3B%0Aif%20(fs.existsSync(translationsPath))%20%7B%0Atranslations%20%3D%20JSON.parse(fs.readFileSync(translationsPath%2C%20'utf8'))%3B%0A%7D%0A%7D%20catch%20(error)%20%7B%0Aconsole.warn('Failed%20to%20load%20translations%3A'%2C%20error)%3B%0A%7D%0A%2F%2F%20Processing%20pipeline%3A%20Extract%20TOC%20%E2%86%92%20Add%20anchors%20%E2%86%92%20Style%20injection%0Aconst%20tocItems%20%3D%20extractTOC(htmlContent)%3B%0AhtmlContent%20%3D%20addHeadingAnchors(htmlContent)%3B%0AhtmlContent%20%3D%20styleInject(htmlContent%2C%20translations)%3B%0Areturn%20(%0ADocumentPageClient%0AhtmlContent%3D%7BhtmlContent%7D%0AfrontMatter%3D%7BfrontMatter%7D%0AreadingTime%3D%7BreadingTime%7D%0Acategory%3D%7Bcategory%7D%0AtocItems%3D%7BtocItems%7D%0Atranslations%3D%7Btranslations%7D%0Alang%3D%7Blang%7D%0A%2F%3E%0A)%3B%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20rendering%20document%3A'%2C%20error)%3B%0AnotFound()%3B%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// src/app/documents/[...slug]/page.tsx</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">default</span> <span class="hljs-keyword inline">async</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">DocumentPage</span>(<span class="hljs-params inline">{params}: <span class="hljs-title class_ inline">PageProps</span></span>) {
    <span class="hljs-keyword inline">try</span> {
        <span class="hljs-keyword inline">const</span> {slug} = <span class="hljs-keyword inline">await</span> params;
        <span class="hljs-keyword inline">const</span> [lang, category, fileName] = slug;
        <span class="hljs-keyword inline">const</span> {content, frontMatter, readingTime} = <span class="hljs-title function_ inline">getArticlesData</span>(fileName, lang, <span class="hljs-literal inline">false</span>, category);

        <span class="hljs-comment inline">// Configure Remarkable parser</span>
        <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>({
            <span class="hljs-attr inline">html</span>: <span class="hljs-literal inline">true</span>,
            <span class="hljs-attr inline">breaks</span>: <span class="hljs-literal inline">true</span>,
            <span class="hljs-attr inline">typographer</span>: <span class="hljs-literal inline">true</span>,
            <span class="hljs-attr inline">highlight</span>: <span class="hljs-keyword inline">function</span> (<span class="hljs-params inline"><span class="hljs-attr inline">str</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">lang</span>: <span class="hljs-built_in inline">string</span></span>) {
                <span class="hljs-keyword inline">if</span> (lang &amp;&amp; hljs.<span class="hljs-title function_ inline">getLanguage</span>(lang)) {
                    <span class="hljs-keyword inline">try</span> {
                        <span class="hljs-keyword inline">return</span> hljs.<span class="hljs-title function_ inline">highlight</span>(str, {<span class="hljs-attr inline">language</span>: lang}).<span class="hljs-property inline">value</span>;
                    } <span class="hljs-keyword inline">catch</span> (err) {}
                }
                <span class="hljs-keyword inline">try</span> {
                    <span class="hljs-keyword inline">return</span> hljs.<span class="hljs-title function_ inline">highlightAuto</span>(str).<span class="hljs-property inline">value</span>;
                } <span class="hljs-keyword inline">catch</span> (err) {}
                <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;&#x27;</span>;
            }
        })
        .<span class="hljs-title function_ inline">use</span>(linkify)
        .<span class="hljs-title function_ inline">use</span>(rkatex, {<span class="hljs-attr inline">delimiter</span>: <span class="hljs-string inline">&#x27;$&#x27;</span>});

        <span class="hljs-keyword inline">let</span> htmlContent = md.<span class="hljs-title function_ inline">render</span>(content, frontMatter);

        <span class="hljs-comment inline">// Load internationalization text</span>
        <span class="hljs-keyword inline">let</span> translations = <span class="hljs-literal inline">null</span>;
        <span class="hljs-keyword inline">try</span> {
            <span class="hljs-keyword inline">const</span> translationsPath = path.<span class="hljs-title function_ inline">join</span>(process.<span class="hljs-title function_ inline">cwd</span>(), <span class="hljs-string inline">&#x27;public&#x27;</span>, <span class="hljs-string inline">&#x27;locales&#x27;</span>, lang, <span class="hljs-string inline">&#x27;common.json&#x27;</span>);
            <span class="hljs-keyword inline">if</span> (fs.<span class="hljs-title function_ inline">existsSync</span>(translationsPath)) {
                translations = <span class="hljs-title class_ inline">JSON</span>.<span class="hljs-title function_ inline">parse</span>(fs.<span class="hljs-title function_ inline">readFileSync</span>(translationsPath, <span class="hljs-string inline">&#x27;utf8&#x27;</span>));
            }
        } <span class="hljs-keyword inline">catch</span> (error) {
            <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;Failed to load translations:&#x27;</span>, error);
        }

        <span class="hljs-comment inline">// Processing pipeline: Extract TOC → Add anchors → Style injection</span>
        <span class="hljs-keyword inline">const</span> tocItems = <span class="hljs-title function_ inline">extractTOC</span>(htmlContent);
        htmlContent = <span class="hljs-title function_ inline">addHeadingAnchors</span>(htmlContent);
        htmlContent = <span class="hljs-title function_ inline">styleInject</span>(htmlContent, translations);

        <span class="hljs-keyword inline">return</span> (
            <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">DocumentPageClient</span>
                <span class="hljs-attr inline">htmlContent</span>=<span class="hljs-string inline">{htmlContent}</span>
                <span class="hljs-attr inline">frontMatter</span>=<span class="hljs-string inline">{frontMatter}</span>
                <span class="hljs-attr inline">readingTime</span>=<span class="hljs-string inline">{readingTime}</span>
                <span class="hljs-attr inline">category</span>=<span class="hljs-string inline">{category}</span>
                <span class="hljs-attr inline">tocItems</span>=<span class="hljs-string inline">{tocItems}</span>
                <span class="hljs-attr inline">translations</span>=<span class="hljs-string inline">{translations}</span>
                <span class="hljs-attr inline">lang</span>=<span class="hljs-string inline">{lang}</span>
            /&gt;</span></span>
        );
    } <span class="hljs-keyword inline">catch</span> (error) {
        <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error rendering document:&#x27;</span>, error);
        <span class="hljs-title function_ inline">notFound</span>();
    }
}
</code></pre>
            </div>
        
<h3 id="client-component-integration" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#client-component-integration" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Client Component Integration">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Client Component Integration
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20src%2Fapp%2Fdocuments%2F%5B...slug%5D%2FDocumentPageClient.tsx%0Aexport%20function%20DocumentPageClient(%7B%0AhtmlContent%2C%0AfrontMatter%2C%0AreadingTime%2C%0Acategory%2C%0AtocItems%2C%0Atranslations%2C%0Alang%0A%7D%3A%20DocumentPageClientProps)%20%7B%0Aconst%20%7Bt%7D%20%3D%20useTranslation()%3B%0Aconst%20%5BformattedDate%2C%20setFormattedDate%5D%20%3D%20useStatestring%3E('')%3B%0A%2F%2F%20Inject%20client-side%20interaction%20scripts%0AuseEffect(()%20%3D%3E%20%7B%0Aconst%20codeBlockScript%20%3D%20getCodeBlockScript(translations)%3B%0Aconst%20tempDiv%20%3D%20document.createElement('div')%3B%0AtempDiv.innerHTML%20%3D%20codeBlockScript%3B%0Aconst%20scriptElement%20%3D%20tempDiv.querySelector('script')%3B%0Aif%20(scriptElement)%20%7B%0Aconst%20newScript%20%3D%20document.createElement('script')%3B%0AnewScript.textContent%20%3D%20scriptElement.textContent%3B%0Adocument.head.appendChild(newScript)%3B%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(document.head.contains(newScript))%20%7B%0Adocument.head.removeChild(newScript)%3B%0A%7D%0A%7D%3B%0A%7D%0A%7D%2C%20%5Btranslations%5D)%3B%0Areturn%20(%0Adiv%20className%3D%22relative%20z-30%20min-h-screen%20bg-background%22%3E%0Adiv%20className%3D%22container%20mx-auto%20px-4%20py-8%20max-w-4xl%22%3E%0Aarticle%20className%3D%22prose%20max-w-none%22%3E%0Adiv%0AclassName%3D%22prose-pre%3Ap-4%20prose-pre%3Abg-surface%20w-full%22%0AdangerouslySetInnerHTML%3D%7B%7B__html%3A%20htmlContent%7D%7D%0A%2F%3E%0Aarticle%3E%0Adiv%3E%0Adiv%3E%0ATableOfContents%20tocItems%3D%7BtocItems%7D%2F%3E%0A)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// src/app/documents/[...slug]/DocumentPageClient.tsx</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">DocumentPageClient</span>(<span class="hljs-params inline">{
    htmlContent,
    frontMatter,
    readingTime,
    category,
    tocItems,
    translations,
    lang
}: <span class="hljs-title class_ inline">DocumentPageClientProps</span></span>) {
    <span class="hljs-keyword inline">const</span> {t} = <span class="hljs-title function_ inline">useTranslation</span>();
    <span class="hljs-keyword inline">const</span> [formattedDate, setFormattedDate] = useState&lt;<span class="hljs-built_in inline">string</span>&gt;(<span class="hljs-string inline">&#x27;&#x27;</span>);

    <span class="hljs-comment inline">// Inject client-side interaction scripts</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">const</span> codeBlockScript = <span class="hljs-title function_ inline">getCodeBlockScript</span>(translations);
        <span class="hljs-keyword inline">const</span> tempDiv = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">createElement</span>(<span class="hljs-string inline">&#x27;div&#x27;</span>);
        tempDiv.<span class="hljs-property inline">innerHTML</span> = codeBlockScript;
        <span class="hljs-keyword inline">const</span> scriptElement = tempDiv.<span class="hljs-title function_ inline">querySelector</span>(<span class="hljs-string inline">&#x27;script&#x27;</span>);
        
        <span class="hljs-keyword inline">if</span> (scriptElement) {
            <span class="hljs-keyword inline">const</span> newScript = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">createElement</span>(<span class="hljs-string inline">&#x27;script&#x27;</span>);
            newScript.<span class="hljs-property inline">textContent</span> = scriptElement.<span class="hljs-property inline">textContent</span>;
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">head</span>.<span class="hljs-title function_ inline">appendChild</span>(newScript);
            
            <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
                <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">head</span>.<span class="hljs-title function_ inline">contains</span>(newScript)) {
                    <span class="hljs-variable language_ inline">document</span>.<span class="hljs-property inline">head</span>.<span class="hljs-title function_ inline">removeChild</span>(newScript);
                }
            };
        }
    }, [translations]);

    <span class="hljs-keyword inline">return</span> (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;relative z-30 min-h-screen bg-background&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;container mx-auto px-4 py-8 max-w-4xl&quot;</span>&gt;</span>
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">article</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;prose max-w-none&quot;</span>&gt;</span>
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> 
                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;prose-pre:p-4 prose-pre:bg-surface w-full&quot;</span>
                            <span class="hljs-attr inline">dangerouslySetInnerHTML</span>=<span class="hljs-string inline">{{__html:</span> <span class="hljs-attr inline">htmlContent</span>}}
                        /&gt;</span>
                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">article</span>&gt;</span>
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">TableOfContents</span> <span class="hljs-attr inline">tocItems</span>=<span class="hljs-string inline">{tocItems}/</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/&gt;</span></span>
    );
}
</code></pre>
            </div>
        
<h3 id="core-algorithm-flow-chart" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#core-algorithm-flow-chart" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Core Algorithm Flow Chart">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Core Algorithm Flow Chart
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="MDX%20Input%20%E2%86%92%20Remarkable%20Parsing%20%E2%86%92%20Style%20Injection%20System%20%E2%86%92%20Enhanced%20HTML%20Output%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AOriginal%20%20%20%20%20%20HTML%20String%20%20%20%20%20%20%20Style%20Class%20Injection%20%20%20Complete%20Rendering%0ASyntax%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E2%86%93%20%20%20%20%20%20%20%20Code%20Block%20%20%20%20%20%20%20%20%20Theme%20Adaptation%20%20%20%20%20%20%20Interactive%20Features%0ASyntax%20%20%20%20%20%20%20%20Recognition%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AHighlighting%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20Client%20Scripts%20%20%20%20%20%20%20%20User%20Experience%0A%E2%86%93%20%20%20%20%20%20%20%20Anchor%20Generation%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0ATOC%20Extraction%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20Copy%20Functionality%20%20%20%20Accessibility">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-variable inline">MDX</span> <span class="hljs-built_in inline">Input</span> → <span class="hljs-variable inline">Remarkable</span> <span class="hljs-variable inline">Parsing</span> → <span class="hljs-built_in inline">Style</span> <span class="hljs-variable inline">Injection</span> <span class="hljs-variable inline">System</span> → <span class="hljs-variable inline">Enhanced</span> <span class="hljs-variable inline">HTML</span> <span class="hljs-variable inline">Output</span>
    ↓           ↓                    ↓                      ↓
<span class="hljs-variable inline">Original</span>      <span class="hljs-variable inline">HTML</span> <span class="hljs-built_in inline">String</span>       <span class="hljs-built_in inline">Style</span> <span class="hljs-variable inline">Class</span> <span class="hljs-variable inline">Injection</span>   <span class="hljs-variable inline">Complete</span> <span class="hljs-variable inline">Rendering</span>
<span class="hljs-built_in inline">Syntax</span>            ↓                    ↓                      ↓
    ↓        <span class="hljs-variable inline">Code</span> <span class="hljs-built_in inline">Block</span>         <span class="hljs-variable inline">Theme</span> <span class="hljs-variable inline">Adaptation</span>       <span class="hljs-built_in inline">Interactive</span> <span class="hljs-variable inline">Features</span>
<span class="hljs-built_in inline">Syntax</span>        <span class="hljs-variable inline">Recognition</span>            ↓                      ↓
<span class="hljs-variable inline">Highlighting</span>      ↓             <span class="hljs-variable inline">Client</span> <span class="hljs-variable inline">Scripts</span>        <span class="hljs-variable inline">User</span> <span class="hljs-variable inline">Experience</span>
    ↓        <span class="hljs-variable inline">Anchor</span> <span class="hljs-variable inline">Generation</span>       ↓                      ↓
<span class="hljs-variable inline">TOC</span> <span class="hljs-variable inline">Extraction</span>    ↓             <span class="hljs-variable inline">Copy</span> <span class="hljs-variable inline">Functionality</span>    <span class="hljs-variable inline">Accessibility</span>
</code></pre>
            </div>
        
<h3 id="key-implementation-principles-summary" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#key-implementation-principles-summary" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Key Implementation Principles Summary">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Key Implementation Principles Summary
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">1. Regex-Driven Style Injection</strong></p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Precisely match HTML tag opening parts</li>
<li class="text-foreground leading-relaxed">Intelligently handle existing class attribute merging</li>
<li class="text-foreground leading-relaxed">Support special handling of self-closing tags</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">2. Three-Layer Architecture for Code Block Enhancement</strong></p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">HTML Structure Layer: Semantic enhanced code blocks</li>
<li class="text-foreground leading-relaxed">Style Layer: Dynamic theme-adaptive CSS</li>
<li class="text-foreground leading-relaxed">Interaction Layer: Copy functionality and user feedback</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">3. Text Processing Algorithm for TOC Generation</strong></p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Accurate extraction of multi-line content</li>
<li class="text-foreground leading-relaxed">Complete HTML entity decoding</li>
<li class="text-foreground leading-relaxed">URL-safe ID generation strategy</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">4. Memory Management in Client Scripts</strong></p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Global state tracking to prevent duplicate listeners</li>
<li class="text-foreground leading-relaxed">Automatic cleanup mechanism to avoid memory leaks</li>
<li class="text-foreground leading-relaxed">Debounce optimization to reduce unnecessary re-initialization</li>
</ul>
<h2 id="conclusion" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#conclusion" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Conclusion">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Conclusion
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">The overall implementation of the style injection solution is not actually complex, and the approach is relatively simple. But as the saying goes: <em class="italic text-foreground">“Simplicity is the ultimate sophistication.”</em> Behind the complex technical implementation, the style injection system presents users with a simple, beautiful, and easy-to-use document experience.</p>
<p class="text-base leading-7 mb-4 text-foreground"><em class="italic text-foreground">May your documents shine like works of art, radiating brilliant light in the digital age with the power of style injection.</em> ✨</p>
d:["$","$L1d",null,{"htmlContent":"$1e","frontMatter":{"title":"Style Injection: Phoenix Rising from TailwindCSS Preflight's Destruction","description":"Deep analysis of style loss issues in MDX to HTML conversion and complete implementation of style injection solutions","date":"2025-01-22","author":"MilkWind","tags":["MDX Rendering"],"references":{}},"readingTime":"24 min read","category":"personal-website","tocItems":[{"id":"style-injection-phoenix-rising-from-tailwindcss-preflight’s-destruction","text":"Style Injection: Phoenix Rising from TailwindCSS Preflight’s Destruction","level":1},{"id":"root-cause-analysis-the-double-edged-sword-effect-of-preflight","text":"Root Cause Analysis: The Double-Edged Sword Effect of Preflight","level":2},{"id":"tailwindcss-preflight-mechanism-analysis","text":"TailwindCSS Preflight Mechanism Analysis","level":3},{"id":"mdx-to-html-rendering-pipeline","text":"MDX to HTML Rendering Pipeline","level":3},{"id":"style-mapping-configuration-design","text":"Style Mapping Configuration Design","level":2},{"id":"json-configuration-file","text":"JSON Configuration File","level":3},{"id":"core-injection-algorithm-regex-driven-capture-and-replace","text":"Core Injection Algorithm: Regex-Driven Capture and Replace","level":2},{"id":"tag-matching-regex-magic","text":"Tag Matching Regex Magic","level":3},{"id":"class-name-injection-algorithm","text":"Class Name Injection Algorithm","level":3},{"id":"anti-duplicate-injection-protection-mechanism","text":"Anti-Duplicate Injection Protection Mechanism","level":3},{"id":"code-block-enhancement-this-little-box-is-code’s-forever-home","text":"Code Block Enhancement: This Little Box is Code’s Forever Home","level":2},{"id":"code-block-recognition-and-deconstruction","text":"Code Block Recognition and Deconstruction","level":3},{"id":"language-identifier-extraction-algorithm","text":"Language Identifier Extraction Algorithm","level":3},{"id":"html-entity-restoration-processing","text":"HTML Entity Restoration Processing","level":3},{"id":"enhanced-code-block-html-structure-design","text":"Enhanced Code Block HTML Structure Design","level":3},{"id":"dynamic-theme-switching-implementation-mechanism","text":"Dynamic Theme Switching Implementation Mechanism","level":3},{"id":"client-side-interaction-scripts-monitoring-and-notifications","text":"Client-Side Interaction Scripts: Monitoring and Notifications","level":2},{"id":"gracefully-degradable-copy-functionality","text":"Gracefully Degradable Copy Functionality","level":3},{"id":"dynamic-content-listening-mutationobserver","text":"Dynamic Content Listening: MutationObserver","level":3},{"id":"toast-notification-system-implementation","text":"Toast Notification System Implementation","level":3},{"id":"table-of-contents-generation-document-navigation-construction","text":"Table of Contents Generation: Document Navigation Construction","level":2},{"id":"title-extraction-regex","text":"Title Extraction Regex","level":3},{"id":"precise-text-content-extraction","text":"Precise Text Content Extraction","level":3},{"id":"id-generation-algorithm-design","text":"ID Generation Algorithm Design","level":3},{"id":"anchor-generation-navigable-document-implementation","text":"Anchor Generation: Navigable Document Implementation","level":2},{"id":"anchor-html-structure-design","text":"Anchor HTML Structure Design","level":3},{"id":"comprehensive-accessibility-considerations","text":"Comprehensive Accessibility Considerations","level":3},{"id":"complete-source-code-analysis","text":"Complete Source Code Analysis","level":2},{"id":"style-injection-core-module","text":"Style Injection Core Module","level":3},{"id":"style-configuration-file","text":"Style Configuration File","level":3},{"id":"server-side-rendering-integration","text":"Server-Side Rendering Integration","level":3},{"id":"client-component-integration","text":"Client Component Integration","level":3},{"id":"core-algorithm-flow-chart","text":"Core Algorithm Flow Chart","level":3},{"id":"key-implementation-principles-summary","text":"Key Implementation Principles Summary","level":3},{"id":"conclusion","text":"Conclusion","level":2}],"translations":{"common":{"welcome":"Welcome","loading":"Loading...","error":"Something went wrong","retry":"Try again","theme":"Theme","language":"Language","light":"Light","dark":"Dark"},"navigation":{"home":"Home","personal":"Personal","works":"Works","contributions":"Contributions","documents":"Documents","about":"About","contact":"Contact"},"personal":{"technicalSkills":"Technical Skills","email":"Email","github":"GitHub","resume":"Resume","codeRepository":"Code Repository","loadingPersonalInfo":"Loading personal information...","loadingResume":"Loading resume...","closeResume":"Close Resume","emailCopied":"Email copied to clipboard!","galaxyDefaultDescription":"Expert in full-stack development, cross-platform architecture, AI technology integration, and high-performance system optimization","skillGalaxy":"Skill Galaxy","stirGalaxy":"Stir Galaxy","stirring":"Stirring...","fullStackEngineer":"MilkWind - Full Stack Engineer","professionalProfile":"About Me"},"documents":{"technicalDocuments":"Technical Documents","description":"Basic principles, code splitting, and some random thoughts.","articles":"Articles","categories":"Categories","allCategories":"All Categories","noArticlesFound":"No articles found","noArticlesAvailable":"No articles available in English.","noArticlesInCategory":"No articles found in the category.","readMore":"Read more","loadingDocuments":"Loading documents...","backToDocuments":"← Back to Documents","documentNotFound":"Document Not Found","documentNotFoundDescription":"The requested document could not be found.","technicalInsights":"Insights","untitledDocument":"Untitled Document","byAuthor":"By","search":"Search articles...","searchByTags":"Filter by tags","searching":"Searching...","noSearchResults":"No articles match your search criteria","clearSearch":"Clear search","selectedTags":"Selected tags","allTags":"All tags","searchInTitle":"Search in titles, descriptions, and content","enterImmersiveMode":"Immersive Reading","exitImmersiveMode":"Exit Immersive Mode","immersiveReading":"Immersive Reading Mode","exploreContent":"Explore content by category","browseBy":"Browse by","exploreAll":"All content in one place","categoryDescription":"Articles in this category","totalArticles":"Articles","totalCategories":"Categories","foundArticles":"Found articles","categoriesWithResults":"Categories with results"},"works":{"workCases":"Work Cases","projects":"Portfolio","loadingProjects":"Loading projects...","grid":"Grid","stack":"Stack","of":"of","workCasesPageTitle":"Work Cases Page","pageWorkingCorrectly":"This page is working! The routing is correct.","try3DVersion":"Try 3D Version","dragToScroll":"Drag to scroll","dragToChange":"Drag to change","swipeCards":"Swipe cards","keyboardNav":"Keyboard navigation"},"contributions":{"contributionCases":"Open Source","contributions":"Contributions","loadingContributions":"Loading contributions...","grid":"Grid","stack":"Stack","of":"of","contributionCasesPageTitle":"Contribution Cases Page","pageWorkingCorrectly":"This page is working! The routing is correct.","try3DVersion":"Try 3D Version","dragToScroll":"Drag to scroll","dragToChange":"Drag to change","swipeCards":"Swipe cards","keyboardNav":"Keyboard navigation"},"contribution":{"contributionPreview":"Contribution Preview","accessible":"Accessible","code":"Code","maintenance":"Maintenance","enhancement":"Enhancement","documentation":"Documentation","community":"Community","moreItems":"more","technicalDetails":"Technical Details","technologies":"Technologies:","contributionDetail":"Contribution Detail","description":"Description:","seeDetails":"See Details","github":"GitHub","viewContribution":"View Contribution","viewCode":"View Code"},"project":{"projectPreview":"Project Preview","accessible":"Accessible","tool":"Tool","plugin":"Plugin","toy":"Toy","moreItems":"more","technicalDetails":"Technical Details","technologies":"Technologies:","description":"Description:","seeDetails":"See Details","github":"GitHub","gitee":"Gitee","viewLiveDemo":"View Live Demo","viewCode":"View Code","access":"Access","videos":"Videos","watchVideo":"Watch Video","hasVideo":"Has Video"},"codeblock":{"copy":"Copy","copySuccess":"Code copied to clipboard!","copyError":"Failed to copy code","copyTooltip":"Copy code"},"toc":{"contents":"Contents","autoScroll":"Auto-scroll to section","collapse":"Collapse","expand":"Expand"},"loading":{"loading":"LOADING","preparingExperience":"Preparing experience"}},"lang":"en","theme":"light"}]
12:null
18:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
11:null
1c:{"metadata":[["$","title","0",{"children":"Style Injection: Phoenix Rising from TailwindCSS Preflight's Destruction | Interactive Portfolio"}],["$","meta","1",{"name":"description","content":"Deep analysis of style loss issues in MDX to HTML conversion and complete implementation of style injection solutions"}],["$","meta","2",{"name":"author","content":"Developer"}],["$","meta","3",{"name":"keywords","content":"portfolio,3D,interactive,web development,Three.js,Next.js"}],["$","meta","4",{"property":"og:title","content":"Style Injection: Phoenix Rising from TailwindCSS Preflight's Destruction | Interactive Portfolio"}],["$","meta","5",{"property":"og:description","content":"Deep analysis of style loss issues in MDX to HTML conversion and complete implementation of style injection solutions"}],["$","meta","6",{"property":"og:type","content":"article"}],["$","meta","7",{"property":"article:published_time","content":"2025-01-22"}],["$","meta","8",{"property":"article:tag","content":"MDX Rendering"}],["$","meta","9",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","10",{"name":"twitter:title","content":"Style Injection: Phoenix Rising from TailwindCSS Preflight's Destruction | Interactive Portfolio"}],["$","meta","11",{"name":"twitter:description","content":"Deep analysis of style loss issues in MDX to HTML conversion and complete implementation of style injection solutions"}],["$","link","12",{"rel":"icon","href":"/MilkWind-Website/favicon.ico","type":"image/x-icon","sizes":"32x32"}]],"error":null,"digest":"$undefined"}
14:{"metadata":"$1c:metadata","error":null,"digest":"$undefined"}
