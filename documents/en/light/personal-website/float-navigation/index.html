<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/f034c804622acb16.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b226d7ef8e491b72.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5eacd01f773eed7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-18c0f30037e967de.js"/><script src="/_next/static/chunks/4bd1b696-5119e10e90c1bd1b.js" async=""></script><script src="/_next/static/chunks/1684-be5e4efdb509cc75.js" async=""></script><script src="/_next/static/chunks/main-app-c5f95d71e93250dc.js" async=""></script><script src="/_next/static/chunks/46-72724587da45cdb8.js" async=""></script><script src="/_next/static/chunks/app/layout-af4a6e723c0ff668.js" async=""></script><script src="/_next/static/chunks/app/error-dda32be1d095a86c.js" async=""></script><script src="/_next/static/chunks/6874-fbe9a08eb79b991c.js" async=""></script><script src="/_next/static/chunks/app/not-found-9ff98b2ccf24cac7.js" async=""></script><script src="/_next/static/chunks/206-4f4cbf4d7156f437.js" async=""></script><script src="/_next/static/chunks/app/documents/layout-28408791defde09e.js" async=""></script><script src="/_next/static/chunks/2415-689c103fb3d2c28d.js" async=""></script><script src="/_next/static/chunks/8610-7bd3f91f3cf2a4d6.js" async=""></script><script src="/_next/static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js" async=""></script><script src="/_next/static/chunks/app/loading-68f227fb49b3ac8c.js" async=""></script><script src="/_next/static/chunks/b498d07c-095637f0f10883c6.js" async=""></script><script src="/_next/static/chunks/9554-b714f9de28e85d30.js" async=""></script><script src="/_next/static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js" async=""></script><title>Floating Navigation Ball: From Mathematical Principles to Interactive Implementation | Interactive Portfolio</title><meta name="description" content="Detailed analysis of a draggable, snappable, expandable circular menu system"/><meta name="author" content="Developer"/><meta name="keywords" content="portfolio,3D,interactive,web development,Three.js,Next.js"/><meta property="og:title" content="Floating Navigation Ball: From Mathematical Principles to Interactive Implementation | Interactive Portfolio"/><meta property="og:description" content="Detailed analysis of a draggable, snappable, expandable circular menu system"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-06-22"/><meta property="article:tag" content="Navigation"/><meta property="article:tag" content="Interactive Design"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Floating Navigation Ball: From Mathematical Principles to Interactive Implementation | Interactive Portfolio"/><meta name="twitter:description" content="Detailed analysis of a draggable, snappable, expandable circular menu system"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_d4c88d __variable_7b4e2b __variable_c3272d font-sans antialiased min-h-screen bg-background text-foreground"><div class="fixed inset-0 w-full h-full overflow-hidden pointer-events-none z-0" style="background:linear-gradient(135deg, hsl(210, 80%, 60%), hsl(180, 40%, 50%))"></div><div class="fixed top-20 right-5 z-50"><div class="w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40"></div></div><!--$--><style>
:root {
  --bprogress-color: #0066cc;
  --bprogress-height: 4px;
  --bprogress-spinner-size: 18px;
  --bprogress-spinner-animation-duration: 400ms;
  --bprogress-spinner-border-size: 2px;
  --bprogress-box-shadow: 0 0 10px #0066cc, 0 0 5px #0066cc;
  --bprogress-z-index: 99999;
  --bprogress-spinner-top: 15px;
  --bprogress-spinner-bottom: auto;
  --bprogress-spinner-right: 15px;
  --bprogress-spinner-left: auto;
}

.bprogress {
  width: 0;
  height: 0;
  pointer-events: none;
  z-index: var(--bprogress-z-index);
}

.bprogress .bar {
  background: var(--bprogress-color);
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
}

/* Fancy blur effect */
.bprogress .peg {
  display: block;
  position: absolute;
  right: 0;
  width: 100px;
  height: 100%;
  box-shadow: var(--bprogress-box-shadow);
  opacity: 1.0;
  transform: rotate(3deg) translate(0px, -4px);
}

/* Remove these to get rid of the spinner */
.bprogress .spinner {
  display: block;
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: var(--bprogress-spinner-top);
  bottom: var(--bprogress-spinner-bottom);
  right: var(--bprogress-spinner-right);
  left: var(--bprogress-spinner-left);
}

.bprogress .spinner-icon {
  width: var(--bprogress-spinner-size);
  height: var(--bprogress-spinner-size);
  box-sizing: border-box;
  border: solid var(--bprogress-spinner-border-size) transparent;
  border-top-color: var(--bprogress-color);
  border-left-color: var(--bprogress-color);
  border-radius: 50%;
  -webkit-animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
  animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
}

.bprogress-custom-parent {
  overflow: hidden;
  position: relative;
}

.bprogress-custom-parent .bprogress .spinner,
.bprogress-custom-parent .bprogress .bar {
  position: absolute;
}

.bprogress .indeterminate {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
  overflow: hidden;
}

.bprogress .indeterminate .inc,
.bprogress .indeterminate .dec {
  position: absolute;
  top: 0;
  height: 100%;
  background-color: var(--bprogress-color);
}

.bprogress .indeterminate .inc {
  animation: bprogress-indeterminate-increase 2s infinite;
}

.bprogress .indeterminate .dec {
  animation: bprogress-indeterminate-decrease 2s 0.5s infinite;
}

@-webkit-keyframes bprogress-spinner {
  0%   { -webkit-transform: rotate(0deg); transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }
}

@keyframes bprogress-spinner {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes bprogress-indeterminate-increase {
  from { left: -5%; width: 5%; }
  to { left: 130%; width: 100%; }
}

@keyframes bprogress-indeterminate-decrease {
  from { left: -80%; width: 80%; }
  to { left: 110%; width: 10%; }
}
</style><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><!--$--><div class="relative z-30 min-h-screen bg-background "><div class="container mx-auto px-4 py-8 max-w-4xl"><div class="mb-8"><a class="inline-flex items-center text-primary hover:text-primary/80 transition-colors" href="/documents/">documents.backToDocuments</a></div><header class="mb-12"><div class="flex items-center gap-4 mb-4 text-sm text-foreground/60"><span class="px-3 py-1 bg-primary/20 text-primary rounded-full capitalize">personal website</span><span>30 min read</span></div><h1 class="font-bold mb-4 bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent text-4xl md:text-5xl">Floating Navigation Ball: From Mathematical Principles to Interactive Implementation</h1><p class="text-xl text-foreground/80 max-w-3xl">Detailed analysis of a draggable, snappable, expandable circular menu system</p><div class="flex flex-wrap gap-2 mt-6"><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">Navigation</span><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">Interactive Design</span></div></header><article class="prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-foreground prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg max-w-none "><div class="prose-pre:p-4 prose-pre:bg-surface w-full"><h1 id="floating-navigation-ball-from-mathematical-principles-to-interactive-implementation" class="group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight">
            <a href="#floating-navigation-ball-from-mathematical-principles-to-interactive-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Floating Navigation Ball: From Mathematical Principles to Interactive Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Floating Navigation Ball: From Mathematical Principles to Interactive Implementation
        </h1>
<p class="text-base leading-7 mb-4 text-foreground">When writing the navigation bar menu, I was thinking, how can I express modernity and tech-savviness while breaking through traditional layout? How about creating a floating ball type navigation bar? …So I did just that.</p>
<p class="text-base leading-7 mb-4 text-foreground">Imagine if your website navigation could be like an intelligent assistant, quietly staying in the corner when not needed, gracefully sliding to the center of the screen to unfold all functions when required, and obediently returning to its original position after use… Yeah, that sounds pretty nice.</p>
<p class="text-base leading-7 mb-4 text-foreground">This floating navigation ball integrates complex interaction logic: draggable, snappable to screen edges, expandable into a circular menu, plus smooth animation transitions. In this article, I’ll start from the most basic coordinate calculations and gradually dive deep into every implementation detail, comprehensively analyzing this seemingly simple yet complex interactive system.</p>
<h2 id="state-management" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#state-management" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to State Management">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            State Management
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Any complex interactive system requires carefully designed state management, and our floating navigation ball is no exception. Let’s first quickly review the overall state members:</p>
<h3 id="state-definition" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#state-definition" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to State Definition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            State Definition
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Why do we need so many state variables? Because each state carries specific responsibilities, and together they constitute a complete interactive ecosystem.</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> [mounted, setMounted] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [isExpanded, setIsExpanded] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [position, setPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});
<span class="hljs-keyword inline">const</span> [originalPosition, setOriginalPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});
<span class="hljs-keyword inline">const</span> [isDragging, setIsDragging] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [dragOffset, setDragOffset] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});
<span class="hljs-keyword inline">const</span> [dragStartPosition, setDragStartPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});
<span class="hljs-keyword inline">const</span> [showRipple, setShowRipple] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
</code></pre>
            </div>
        
<h3 id="core-state-breakdown" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#core-state-breakdown" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Core State Breakdown">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Core State Breakdown
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Let me explain the purpose of each state one by one:</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">mounted</strong>: This is a “fuse” state. In the world of server-side rendering, <code>window.innerWidth</code> is undefined during initial rendering, so we need to wait until the component is actually mounted in the browser before performing position calculations.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">isExpanded</strong>: The “switch” state of the navigation ball. <code>false</code> means it’s a small ball, <code>true</code> means it expands into a circular menu. This state controls the entire UI morphology change.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">position</strong>: Current real-time position coordinates. This is the core of the entire drag system, all position changes are reflected here.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">originalPosition</strong>: “The remembered home.” When the navigation ball expands, it moves to the screen center, but we need to remember its original position so it can return there when collapsed.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">isDragging</strong>: A flag for drag state. <code>true</code> when the user presses the mouse to start dragging, <code>false</code> when releasing the mouse. This state affects mouse event listening and visual feedback.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">dragOffset</strong>: This is the most easily overlooked yet most important state. It records the offset of the mouse click position relative to the top-left corner of the navigation ball, ensuring the ball doesn’t “jump” to the mouse position during dragging.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">dragStartPosition</strong>: The recorder of the drag starting point. We need it to calculate drag distance and distinguish between “click” and “actual drag.”</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">showRipple</strong>: The switch for visual feedback. Shows ripple effects during dragging, letting users know “I’m moving this thing.”</p>
<h3 id="state-machine-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#state-machine-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to State Machine Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            State Machine Design
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The relationships between these states form a complex state machine:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Normal%20State%20%E2%86%90%E2%86%92%20Drag%20State%20%E2%86%92%20Snap%20State%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%91%0AExpanded%20State%20%E2%86%90-----------------%E2%94%98">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>Normal State ←→ Drag State → Snap State
    ↓                            ↑
Expanded State ←<span class="hljs-comment inline">-----------------┘</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Key state transition logic:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Normal→Drag</strong>: <code>mouseDown</code> event triggers, simultaneously setting <code>isDragging=true</code> and recording initial offset</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Drag→Snap</strong>: <code>mouseUp</code> event triggers, executing edge snapping algorithm</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Normal→Expanded</strong>: Click event triggers (non-drag), moves to screen center</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Expanded→Normal</strong>: Click again or click background, returns to original position</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">The elegance of this state machine lies in its ability to correctly handle edge cases, such as users quickly clicking during drag, or starting to drag in expanded state, etc.</p>
<h2 id="coordinate-system-and-position-recording" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#coordinate-system-and-position-recording" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Coordinate System and Position Recording">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Coordinate System and Position Recording
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">In the browser world, there are many coordinate systems to choose from, and our choice determines the complexity and performance of the entire system.</p>
<h3 id="coordinate-system-choice" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#coordinate-system-choice" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Coordinate System Choice">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Coordinate System Choice
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">I chose the absolute positioning (<code>position: fixed</code>) + <code>left/top</code> properties approach, rather than the more modern <code>transform</code> approach. Why?</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20The%20approach%20we%20use%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0A%7D%7D%0A%2F%2F%20Instead%20of%20this%0Astyle%3D%7B%7B%0Atransform%3A%20%60translate(%24%7Bposition.x%7Dpx%2C%20%24%7Bposition.y%7Dpx)%60%0A%7D%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// The approach we use</span>
style={{
    <span class="hljs-attr inline">left</span>: <span class="hljs-string inline">`<span class="hljs-subst inline">${position.x}</span>px`</span>,
    <span class="hljs-attr inline">top</span>: <span class="hljs-string inline">`<span class="hljs-subst inline">${position.y}</span>px`</span>,
}}

<span class="hljs-comment inline">// Instead of this</span>
style={{
    <span class="hljs-attr inline">transform</span>: <span class="hljs-string inline">`translate(<span class="hljs-subst inline">${position.x}</span>px, <span class="hljs-subst inline">${position.y}</span>px)`</span>
}}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><del class="line-through opacity-60">(Mainly because I’m lazy)</del> The reason is simple: <strong class="font-bold text-foreground">computational simplicity</strong>. When using <code>left/top</code>, coordinate values directly correspond to screen positions, and we can directly use <code>getBoundingClientRect()</code> to get element positions for calculations. When using <code>transform</code>, the actual rendered position and the position recorded in CSS might be inconsistent, adding computational complexity.</p>
<p class="text-base leading-7 mb-4 text-foreground">Although <code>transform</code> performs better in some cases (GPU acceleration), for a single navigation ball, this performance difference is negligible. Sometimes, simplicity is beauty.</p>
<h3 id="position-initialization-strategy" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#position-initialization-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Position Initialization Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Position Initialization Strategy
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20initialX%20%3D%20window.innerWidth%20-%2080%3B%0Aconst%20initialY%20%3D%20100%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> initialX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> - <span class="hljs-number inline">80</span>;
<span class="hljs-keyword inline">const</span> initialY = <span class="hljs-number inline">100</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>window.innerWidth - 80</code> ensures the ball is completely within the screen, 80px is the ball size plus some margin, ensuring the floating navigation ball has high initial visibility on various devices.</p>
<h3 id="mathematical-principles-of-dragoffset" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mathematical-principles-of-dragoffset" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mathematical Principles of dragOffset">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mathematical Principles of dragOffset
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">This is the most error-prone part of the entire drag system. Let me illustrate with an example:</p>
<p class="text-base leading-7 mb-4 text-foreground">Suppose the navigation ball’s top-left corner position is <code>(100, 50)</code>, and the user clicks at the center of the ball <code>(132, 82)</code> to start dragging (the ball size is 64x64px).</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20132%20-%20100%20%3D%2032%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%2082%20-%2050%20%3D%2032%0A%7D)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">React</span>.<span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt; {
    <span class="hljs-keyword inline">const</span> rect = ballRef.<span class="hljs-property inline">current</span>?.<span class="hljs-title function_ inline">getBoundingClientRect</span>();
    <span class="hljs-keyword inline">if</span> (rect) {
        <span class="hljs-title function_ inline">setDragOffset</span>({
            <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - rect.<span class="hljs-property inline">left</span>,  <span class="hljs-comment inline">// 132 - 100 = 32</span>
            <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - rect.<span class="hljs-property inline">top</span>    <span class="hljs-comment inline">// 82 - 50 = 32</span>
        });
    }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Now, when the mouse moves to <code>(200, 150)</code>, the new ball position should be:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%20%20%2F%2F%20200%20-%2032%20%3D%20168%0Ay%3A%20e.clientY%20-%20dragOffset.y%20%20%20%2F%2F%20150%20-%2032%20%3D%20118%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> newPos = {
    <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,  <span class="hljs-comment inline">// 200 - 32 = 168</span>
    <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>   <span class="hljs-comment inline">// 150 - 32 = 118</span>
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">This way, the ball’s center will follow the mouse without producing a “jump” effect. If we didn’t have the final correction of -32 pixels, when dragging actually occurs, the cursor would point to the ball’s top-left corner instead of the ball center, causing drag offset errors.</p>
<h2 id="drag-system-implementation" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#drag-system-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Drag System Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Drag System Implementation
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">The drag system is the core functionality of the entire navigation ball, requiring handling of complex event sequences and state changes.</p>
<h3 id="drag-lifecycle" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#drag-lifecycle" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Drag Lifecycle">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Drag Lifecycle
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">A complete drag operation includes three phases:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">mouseDown</strong>: Initialize drag state</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">mouseMove</strong>: Continuously update position</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">mouseUp</strong>: End drag and execute subsequent logic</li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground">Each phase has its specific responsibilities and processing logic.</p>
<h3 id="debounced-animation-implementation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#debounced-animation-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Debounced Animation Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Debounced Animation Implementation
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Traditional drag implementations immediately update position on every <code>mouseMove</code>, but this causes performance issues and visual jitter. I adopted a debouncing strategy:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20Calculate%20new%20position%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20Store%20pending%20position%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20Immediately%20show%20ripple%20effect%0AsetShowRipple(true)%3B%0A%2F%2F%20Clear%20existing%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20Set%20new%20debounce%20timer%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%7D%2C%20%5BisDragging%2C%20dragOffset%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> handleMouseMove = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-comment inline">// Calculate new position</span>
    <span class="hljs-keyword inline">const</span> newPos = {
        <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,
        <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>
    };

    <span class="hljs-comment inline">// Store pending position</span>
    pendingPositionRef.<span class="hljs-property inline">current</span> = newPos;

    <span class="hljs-comment inline">// Immediately show ripple effect</span>
    <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">true</span>);

    <span class="hljs-comment inline">// Clear existing debounce timer</span>
    <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
    }

    <span class="hljs-comment inline">// Set new debounce timer</span>
    debounceTimerRef.<span class="hljs-property inline">current</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-title function_ inline">setPosition</span>(newPos);
        <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);
    }, <span class="hljs-number inline">500</span>);
}, [isDragging, dragOffset]);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Note:</strong> I used <code>ref</code> instead of <code>state</code> to store the pending position, because <code>useState</code> updates are asynchronous. When I use asynchronous state updates, there are read value hazards, i.e., when I read the “updated” value, the asynchronous update hasn’t completed yet, so I’m actually reading the pre-update value, causing abnormal results. <code>ref</code> updates are synchronous and don’t have thread safety issues, meaning the value I read “after update” is indeed the post-update value.</p>
<h3 id="drag-distance-determination" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#drag-distance-determination" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Drag Distance Determination">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Drag Distance Determination
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">How to distinguish between “click” and &quot;drag&quot;? This is a classic UI interaction problem. My solution is based on Euclidean distance:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Record%20drag%20start%20position%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20Calculate%20distance%20in%20mouseMove%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Record drag start position</span>
<span class="hljs-title function_ inline">setDragStartPosition</span>({<span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span>, <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span>});

<span class="hljs-comment inline">// Calculate distance in mouseMove</span>
<span class="hljs-keyword inline">const</span> dragDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sqrt</span>(
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientX</span> - dragStartPosition.<span class="hljs-property inline">x</span>, <span class="hljs-number inline">2</span>) +
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientY</span> - dragStartPosition.<span class="hljs-property inline">y</span>, <span class="hljs-number inline">2</span>)
);

<span class="hljs-keyword inline">if</span> (dragDistance &gt; <span class="hljs-number inline">3</span>) {
    hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">true</span>;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Only when the floating navigation ball moves more than 3 pixels is it considered “dragging,” otherwise it’s considered a “click.” Generally, natural hand tremor is usually within 1-2 pixels, so 3 pixels can effectively filter out these unintentional micro-movements while not hindering genuine drag intentions.</p>
<h3 id="intelligent-handling-of-drag-end" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#intelligent-handling-of-drag-end" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Intelligent Handling of Drag End">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Intelligent Handling of Drag End
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20Clear%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0A%2F%2F%20Significant%20drag%20-%20execute%20snapping%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%0A%7D%0A%2F%2F%20Reset%20drag%20flag%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> handleMouseUp = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">false</span>);
    <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);

    <span class="hljs-comment inline">// Clear debounce timer</span>
    <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
    }

    <span class="hljs-keyword inline">if</span> (hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-comment inline">// Significant drag - execute snapping</span>
        <span class="hljs-keyword inline">const</span> snappedPos = <span class="hljs-title function_ inline">snapToEdge</span>(pendingPositionRef.<span class="hljs-property inline">current</span>);
        <span class="hljs-title function_ inline">setPosition</span>(snappedPos);
        <span class="hljs-title function_ inline">setOriginalPosition</span>(snappedPos);
    }

    <span class="hljs-comment inline">// Reset drag flag</span>
    <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">false</span>;
    }, <span class="hljs-number inline">100</span>);
}, [isDragging]);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">There’s a detail here: why delay resetting the drag flag by 100ms? Because <code>mouseUp</code> and <code>click</code> events have timing differences. If reset immediately, the click event might be incorrectly processed as a post-drag click. The 100ms delay ensures correct event processing order.</p>
<h2 id="edge-snapping-algorithm" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#edge-snapping-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Edge Snapping Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Edge Snapping Algorithm
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">The snapping effect is a user-friendly design that ensures when you “let go” of the navigation ball, it automatically stops at a fixed distance from the screen edge, solving the core pain point of visually obsessive users. <del class="line-through opacity-60">(Like me)</del></p>
<h3 id="core-logic-of-snapping-algorithm" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#core-logic-of-snapping-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Core Logic of Snapping Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Core Logic of Snapping Algorithm
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The mathematical principle of snapping is actually simple: calculate the distance from the current position to four boundaries, then move to the nearest boundary:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%2F%2F%20Ball%20size%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%2F%2F%20Distance%20from%20edge%0A%2F%2F%20Calculate%20distances%20to%20four%20boundaries%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20Find%20minimum%20distance%0Aconst%20minDistance%20%3D%20Math.min(%0AdistanceToLeft%2C%0AdistanceToRight%2C%0AdistanceToTop%2C%0AdistanceToBottom%0A)%3B%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20Decide%20snap%20direction%20based%20on%20minimum%20distance%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%0A%7D%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> snapToEdge = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">currentPos</span>: <span class="hljs-title class_ inline">Position</span></span>) =&gt;</span> {
    <span class="hljs-keyword inline">const</span> windowWidth = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span>;
    <span class="hljs-keyword inline">const</span> windowHeight = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span>;
    <span class="hljs-keyword inline">const</span> ballSize = <span class="hljs-number inline">70</span>;  <span class="hljs-comment inline">// Ball size</span>
    <span class="hljs-keyword inline">const</span> margin = <span class="hljs-number inline">20</span>;    <span class="hljs-comment inline">// Distance from edge</span>
    
    <span class="hljs-comment inline">// Calculate distances to four boundaries</span>
    <span class="hljs-keyword inline">const</span> distanceToLeft = currentPos.<span class="hljs-property inline">x</span>;
    <span class="hljs-keyword inline">const</span> distanceToRight = windowWidth - currentPos.<span class="hljs-property inline">x</span>;
    <span class="hljs-keyword inline">const</span> distanceToTop = currentPos.<span class="hljs-property inline">y</span>;
    <span class="hljs-keyword inline">const</span> distanceToBottom = windowHeight - currentPos.<span class="hljs-property inline">y</span>;
    
    <span class="hljs-comment inline">// Find minimum distance</span>
    <span class="hljs-keyword inline">const</span> minDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(
        distanceToLeft, 
        distanceToRight, 
        distanceToTop, 
        distanceToBottom
    );
    
    <span class="hljs-keyword inline">let</span> newPos = {...currentPos};
    
    <span class="hljs-comment inline">// Decide snap direction based on minimum distance</span>
    <span class="hljs-keyword inline">if</span> (minDistance === distanceToLeft) {
        newPos.<span class="hljs-property inline">x</span> = margin;
    } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToRight) {
        newPos.<span class="hljs-property inline">x</span> = windowWidth - ballSize - margin;
    } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToTop) {
        newPos.<span class="hljs-property inline">y</span> = margin;
    } <span class="hljs-keyword inline">else</span> {
        newPos.<span class="hljs-property inline">y</span> = windowHeight - ballSize - margin;
    }
    
    <span class="hljs-keyword inline">return</span> newPos;
}, []);
</code></pre>
            </div>
        
<h3 id="mathematical-principles-of-boundary-calculation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mathematical-principles-of-boundary-calculation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mathematical Principles of Boundary Calculation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mathematical Principles of Boundary Calculation
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Distance calculation explanation:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToLeft</strong>: Directly equals <code>currentPos.x</code>, because the left boundary is x=0</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToRight</strong>: <code>windowWidth - currentPos.x</code>, because the right boundary is window width</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToTop</strong>: Directly equals <code>currentPos.y</code>, because the top boundary is y=0</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToBottom</strong>: <code>windowHeight - currentPos.y</code>, because the bottom boundary is window height</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><code>Math.min()</code> finds the smallest of these four values, corresponding to the nearest boundary.</p>
<h3 id="boundary-constraint-implementation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#boundary-constraint-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Boundary Constraint Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Boundary Constraint Implementation
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">This is a protective logic to prevent boundary overflow:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="newPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript">newPos.<span class="hljs-property inline">x</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowWidth - ballSize - margin, newPos.<span class="hljs-property inline">x</span>));
newPos.<span class="hljs-property inline">y</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowHeight - ballSize - margin, newPos.<span class="hljs-property inline">y</span>));
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">“Double clamping” strategy:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>Math.min()</code> ensures position doesn’t exceed right and bottom boundaries</li>
<li class="text-foreground leading-relaxed"><code>Math.max()</code> ensures position doesn’t go below left and top boundaries</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">This way, regardless of what position the algorithm calculates, the final coordinates will be strictly limited within the safe range.</p>
<p class="text-base leading-7 mb-4 text-foreground">Why do we need <code>ballSize</code>? Because CSS’s <code>left</code> and <code>top</code> properties position the element’s top-left corner, not the center point. If we don’t consider the ball’s size, part of the ball might run off-screen.</p>
<h2 id="expandcollapse-animation-system" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#expandcollapse-animation-system" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Expand/Collapse Animation System">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Expand/Collapse Animation System
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">The expansion and collapse of the navigation ball is an animated process with transition effects, involving position movement, state switching, and timing control.</p>
<h3 id="center-positioning-algorithm" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#center-positioning-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Center Positioning Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Center Positioning Algorithm
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">When the user clicks the navigation ball, it needs to move to the screen center for expansion:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
<span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
<span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: centerX, <span class="hljs-attr inline">y</span>: centerY});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why subtract 35</strong>? Because the navigation ball is 70px in size. If we want the ball’s <strong class="font-bold text-foreground">center</strong> to align with the screen center, we need to offset left and up by half the ball’s size (70/2 = 35px).</p>
<p class="text-base leading-7 mb-4 text-foreground">This is the difference between visual center and geometric center:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Geometric center</strong>: The center point of the element’s bounding box</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Visual center</strong>: The element center point perceived by the human eye</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">For circular elements, these two are consistent, so we can use geometric calculations.</p>
<h3 id="timing-control-for-state-switching" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#timing-control-for-state-switching" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Timing Control for State Switching">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Timing Control for State Switching
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Expand and collapse animations require precise timing control:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20Expand%3A%20first%20save%20current%20position%2C%20then%20move%20to%20center%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20Collapse%3A%20first%20set%20state%2C%20delay%20150ms%20before%20moving%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleBallClick</span> = (<span class="hljs-params inline"></span>) =&gt; {
    <span class="hljs-keyword inline">if</span> (!hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-keyword inline">if</span> (!isExpanded) {
            <span class="hljs-comment inline">// Expand: first save current position, then move to center</span>
            <span class="hljs-title function_ inline">setOriginalPosition</span>(position);
            <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
            <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
            <span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: centerX, <span class="hljs-attr inline">y</span>: centerY});
            <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">true</span>);
        } <span class="hljs-keyword inline">else</span> {
            <span class="hljs-comment inline">// Collapse: first set state, delay 150ms before moving</span>
            <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
            <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
                <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
            }, <span class="hljs-number inline">150</span>);
        }
    }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">There’s a key design decision here: why delay 150ms when collapsing?</p>
<p class="text-base leading-7 mb-4 text-foreground">Because menu item disappearing animations need time. If we immediately move the ball position while setting <code>isExpanded=false</code>, users would see the ball start moving while menu items are still disappearing, creating a jarring visual effect.</p>
<p class="text-base leading-7 mb-4 text-foreground">The 150ms delay allows the menu item disappearing animation to complete before the ball starts moving back to its original position. This timing arrangement makes the entire animation feel more coherent and natural.</p>
<h3 id="saving-mechanism-for-originalposition" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#saving-mechanism-for-originalposition" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Saving Mechanism for originalPosition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Saving Mechanism for originalPosition
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The timing of saving <code>originalPosition</code> is crucial:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Save%20before%20expanding%0AsetOriginalPosition(position)%3B%0A%2F%2F%20Update%20after%20drag%20ends%0AsetOriginalPosition(snappedPos)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Save before expanding</span>
<span class="hljs-title function_ inline">setOriginalPosition</span>(position);

<span class="hljs-comment inline">// Update after drag ends</span>
<span class="hljs-title function_ inline">setOriginalPosition</span>(snappedPos);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">This ensures that regardless of whether the user dragged the ball before expanding, it returns to the correct position when collapsed. If the user drags the ball to a new position then expands, it should return to the post-drag position when collapsed, not the initial position.</p>
<h2 id="circular-menu-layout-algorithm" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#circular-menu-layout-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Circular Menu Layout Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Circular Menu Layout Algorithm
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">When the navigation ball expands, menu items need to be evenly distributed around a circle. This is a typical polar coordinate layout problem.</p>
<h3 id="mathematical-foundation-of-polar-coordinate-layout" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mathematical-foundation-of-polar-coordinate-layout" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mathematical Foundation of Polar Coordinate Layout">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mathematical Foundation of Polar Coordinate Layout
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The core of circular layout is the conversion from polar coordinates to Cartesian coordinates:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%0A%7D%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCircularPosition</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">index</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">total</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">radius</span>: <span class="hljs-built_in inline">number</span> = <span class="hljs-number inline">120</span></span>) =&gt; {
    <span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">x</span>: centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius - <span class="hljs-number inline">60</span>,
        <span class="hljs-attr inline">y</span>: centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius - <span class="hljs-number inline">30</span>,
    };
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Let me explain this algorithm line by line:</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Angle calculation</strong>: <code>(2 * Math.PI * index) / total</code> divides the circumference (2π radians) equally into <code>total</code> parts, with each menu item occupying one part.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Starting angle adjustment</strong>: <code>- Math.PI / 2</code> adjusts the starting angle from 3 o’clock direction (0 radians) to 12 o’clock direction (-π/2 radians). This way the first menu item appears at the top, conforming to visual habits.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Coordinate conversion</strong>: <code>Math.cos(angle) * radius</code> and <code>Math.sin(angle) * radius</code> convert polar coordinates to Cartesian coordinates relative to the circle center.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Position offset</strong>: <code>- 60</code> and <code>- 30</code> adjust the menu item positioning point. These values are calculated based on the actual size of menu items, ensuring the menu item center points are located on the circumference.</p>
<h3 id="angle-distribution-strategy" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#angle-distribution-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Angle Distribution Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Angle Distribution Strategy
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Assuming we have 6 menu items, their angle distribution is like this:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Item%200%3A%20(2%CF%80%20%C3%97%200)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F2%20%20%20(12%20o'clock%20direction)%0AItem%201%3A%20(2%CF%80%20%C3%97%201)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F6%20%20%20(2%20o'clock%20direction)%0AItem%202%3A%20(2%CF%80%20%C3%97%202)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F6%20%20%20%20(4%20o'clock%20direction)%0AItem%203%3A%20(2%CF%80%20%C3%97%203)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F2%20%20%20%20(6%20o'clock%20direction)%0AItem%204%3A%20(2%CF%80%20%C3%97%204)%20%2F%206%20-%20%CF%80%2F2%20%3D%205%CF%80%2F6%20%20%20(8%20o'clock%20direction)%0AItem%205%3A%20(2%CF%80%20%C3%97%205)%20%2F%206%20-%20%CF%80%2F2%20%3D%207%CF%80%2F6%20%20%20(10%20o'clock%20direction)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-attribute inline">Item</span> <span class="hljs-number inline">0</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">0</span>) / <span class="hljs-number inline">6</span> - π/<span class="hljs-number inline">2</span> = -π/<span class="hljs-number inline">2</span>   (<span class="hljs-number inline">12</span> o&#x27;clock direction)
<span class="hljs-attribute inline">Item</span> <span class="hljs-number inline">1</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">1</span>) / <span class="hljs-number inline">6</span> - π/<span class="hljs-number inline">2</span> = -π/<span class="hljs-number inline">6</span>   (<span class="hljs-number inline">2</span> o&#x27;clock direction)
<span class="hljs-attribute inline">Item</span> <span class="hljs-number inline">2</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">2</span>) / <span class="hljs-number inline">6</span> - π/<span class="hljs-number inline">2</span> = π/<span class="hljs-number inline">6</span>    (<span class="hljs-number inline">4</span> o&#x27;clock direction)
<span class="hljs-attribute inline">Item</span> <span class="hljs-number inline">3</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">3</span>) / <span class="hljs-number inline">6</span> - π/<span class="hljs-number inline">2</span> = π/<span class="hljs-number inline">2</span>    (<span class="hljs-number inline">6</span> o&#x27;clock direction)
<span class="hljs-attribute inline">Item</span> <span class="hljs-number inline">4</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">4</span>) / <span class="hljs-number inline">6</span> - π/<span class="hljs-number inline">2</span> = <span class="hljs-number inline">5</span>π/<span class="hljs-number inline">6</span>   (<span class="hljs-number inline">8</span> o&#x27;clock direction)
<span class="hljs-attribute inline">Item</span> <span class="hljs-number inline">5</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">5</span>) / <span class="hljs-number inline">6</span> - π/<span class="hljs-number inline">2</span> = <span class="hljs-number inline">7</span>π/<span class="hljs-number inline">6</span>   (<span class="hljs-number inline">10</span> o&#x27;clock direction)
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">This distribution ensures visual uniformity and symmetry of menu items.</p>
<h2 id="keyframe-animation-system" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#keyframe-animation-system" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Keyframe Animation System">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Keyframe Animation System
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">The appearance and disappearance animations of menu items are key to ensuring smoothness.</p>
<h3 id="css-in-js-animation-implementation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#css-in-js-animation-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to CSS-in-JS Animation Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            CSS-in-JS Animation Implementation
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">I use CSS-in-JS animation definition to maintain component encapsulation:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="jsx" data-code="%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">jsx</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-jsx">&lt;style jsx&gt;{<span class="hljs-string inline">`
    @keyframes menuItemAppear {
        0% {
            opacity: 0;
            transform: scale(0) translate(-50%, -50%);
        }
        50% {
            opacity: 0.7;
            transform: scale(0.8) translate(-25%, -25%);
        }
        100% {
            opacity: 1;
            transform: scale(1) translate(0%, 0%);
        }
    }
    
    .menu-item {
        animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
`</span>}&lt;/style&gt;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">This animation contains three keyframes:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">0%</strong>: Completely transparent, zero scale, large offset</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">50%</strong>: Semi-transparent, 80% scale, small offset</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">100%</strong>: Completely opaque, normal scale, no offset</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why include translate offset</strong>? Pure scale animations would make menu items “burst” from the center point. Adding translate offset creates a “flying in from afar” dynamic effect.</p>
<h3 id="layered-animation-delays" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#layered-animation-delays" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Layered Animation Delays">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Layered Animation Delays
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="style%3D%7B%7B%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript">style={{
    <span class="hljs-attr inline">animationDelay</span>: <span class="hljs-string inline">`<span class="hljs-subst inline">${index * <span class="hljs-number inline">120</span>}</span>ms`</span>
}}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Each menu item’s animation delays by 120ms, creating a “wave-like” appearance effect. Menu items don’t appear simultaneously but appear sequentially in order, like dominoes.</p>
<h3 id="easing-function-choice" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#easing-function-choice" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Easing Function Choice">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Easing Function Choice
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><code>cubic-bezier(0.4, 0, 0.2, 1)</code> is the “standard” easing function from Material Design, with characteristics:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Slow start</strong>: Acceleration is slower at the beginning, conforming to physical intuition</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Fast end</strong>: Quickly reaches target state at the end, avoiding sluggishness</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Smooth transition</strong>: No abrupt speed changes throughout the process</li>
</ul>
<h2 id="event-handling-and-performance-optimization" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#event-handling-and-performance-optimization" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Event Handling and Performance Optimization">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Event Handling and Performance Optimization
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">When handling complex interactions, proper event management and performance optimization are essential.</p>
<h3 id="event-listener-lifecycle-management" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#event-listener-lifecycle-management" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Event Listener Lifecycle Management">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Event Listener Lifecycle Management
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Drag functionality requires listening to mouse events at the document level, but these listeners must be properly managed to avoid memory leaks:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="useEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20Ensure%20listeners%20are%20removed%20in%20non-drag%20state%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20handleMouseMove%2C%20handleMouseUp%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (isDragging) {
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
        <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
        };
    } <span class="hljs-keyword inline">else</span> {
        <span class="hljs-comment inline">// Ensure listeners are removed in non-drag state</span>
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
    }
}, [isDragging, handleMouseMove, handleMouseUp]);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Design features:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Conditional listening</strong>: Only add listeners during drag state, reducing unnecessary event processing</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Automatic cleanup</strong>: useEffect’s return function ensures cleanup when component unmounts</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">State synchronization</strong>: When drag state changes, listeners update accordingly</li>
</ol>
<h3 id="performance-optimization-with-usecallback" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#performance-optimization-with-usecallback" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Performance Optimization with useCallback">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Performance Optimization with useCallback
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0A%2F%2F%20Processing%20logic...%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0A%2F%2F%20Snapping%20logic...%0A%7D%2C%20%5B%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> handleMouseMove = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt;</span> {
    <span class="hljs-comment inline">// Processing logic...</span>
}, [isDragging, dragOffset, dragStartPosition]);

<span class="hljs-keyword inline">const</span> snapToEdge = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">currentPos</span>: <span class="hljs-title class_ inline">Position</span></span>) =&gt;</span> {
    <span class="hljs-comment inline">// Snapping logic...</span>
}, []);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>useCallback</code> ensures these function references remain stable when dependencies don’t change, avoiding unnecessary re-renders and frequent addition/removal of event listeners.</p>
<h3 id="event-bubbling-prevention-strategy" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#event-bubbling-prevention-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Event Bubbling Prevention Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Event Bubbling Prevention Strategy
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20Prevent%20default%20behaviors%20like%20text%20selection%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20Disable%20drag%20in%20expanded%20state%0AsetIsDragging(true)%3B%0A%2F%2F%20...%20other%20logic%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">React</span>.<span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt; {
    e.<span class="hljs-title function_ inline">preventDefault</span>();  <span class="hljs-comment inline">// Prevent default behaviors like text selection</span>
    <span class="hljs-keyword inline">if</span> (isExpanded) <span class="hljs-keyword inline">return</span>;  <span class="hljs-comment inline">// Disable drag in expanded state</span>
    
    <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">true</span>);
    <span class="hljs-comment inline">// ... other logic</span>
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>e.preventDefault()</code> prevents some default browser behaviors that might interfere with dragging, such as text selection, image dragging, etc.</p>
<h2 id="reusable-design-pattern-summary" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#reusable-design-pattern-summary" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Reusable Design Pattern Summary">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Reusable Design Pattern Summary
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">Through this in-depth analysis, we can extract several general design patterns that can be applied to other similar interactive systems.</p>
<h3 id="core-design-pattern-extraction" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#core-design-pattern-extraction" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Core Design Pattern Extraction">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Core Design Pattern Extraction
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Drag System Pattern</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%201.%20State%20initialization%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0A%2F%2F%202.%20Event%20handling%0Aconst%20handleMouseDown%20%3D%20(e)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20elementRef.current%3F.getBoundingClientRect()%3B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%0Ay%3A%20e.clientY%20-%20rect.top%0A%7D)%3B%0AsetIsDragging(true)%3B%0A%7D%3B%0A%2F%2F%203.%20Position%20update%0Aconst%20handleMouseMove%20%3D%20(e)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetPosition(%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D)%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 1. State initialization</span>
<span class="hljs-keyword inline">const</span> [isDragging, setIsDragging] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [dragOffset, setDragOffset] = <span class="hljs-title function_ inline">useState</span>({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});
<span class="hljs-keyword inline">const</span> [position, setPosition] = <span class="hljs-title function_ inline">useState</span>({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});

<span class="hljs-comment inline">// 2. Event handling</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline">e</span>) =&gt; {
    <span class="hljs-keyword inline">const</span> rect = elementRef.<span class="hljs-property inline">current</span>?.<span class="hljs-title function_ inline">getBoundingClientRect</span>();
    <span class="hljs-title function_ inline">setDragOffset</span>({
        <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - rect.<span class="hljs-property inline">left</span>,
        <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - rect.<span class="hljs-property inline">top</span>
    });
    <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">true</span>);
};

<span class="hljs-comment inline">// 3. Position update</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseMove</span> = (<span class="hljs-params inline">e</span>) =&gt; {
    <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;
    <span class="hljs-title function_ inline">setPosition</span>({
        <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,
        <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>
    });
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Circular Layout Pattern</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20getCircularPosition%20%3D%20(index%2C%20total%2C%20radius%2C%20centerX%2C%20centerY)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%0A%7D%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCircularPosition</span> = (<span class="hljs-params inline">index, total, radius, centerX, centerY</span>) =&gt; {
    <span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">x</span>: centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius,
        <span class="hljs-attr inline">y</span>: centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius
    };
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">State Machine Pattern</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Clear%20state%20definition%0Aconst%20states%20%3D%20%7B%0AIDLE%3A%20'idle'%2C%0ADRAGGING%3A%20'dragging'%2C%0AEXPANDED%3A%20'expanded'%0A%7D%3B%0A%2F%2F%20State%20transition%20logic%0Aconst%20handleStateTransition%20%3D%20(currentState%2C%20action)%20%3D%3E%20%7B%0Aswitch%20(currentState)%20%7B%0Acase%20states.IDLE%3A%0Areturn%20action%20%3D%3D%3D%20'drag'%20%3F%20states.DRAGGING%20%3A%0Aaction%20%3D%3D%3D%20'click'%20%3F%20states.EXPANDED%20%3A%20currentState%3B%0A%2F%2F%20...%20other%20state%20transitions%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Clear state definition</span>
<span class="hljs-keyword inline">const</span> states = {
    <span class="hljs-attr inline">IDLE</span>: <span class="hljs-string inline">&#x27;idle&#x27;</span>,
    <span class="hljs-attr inline">DRAGGING</span>: <span class="hljs-string inline">&#x27;dragging&#x27;</span>,
    <span class="hljs-attr inline">EXPANDED</span>: <span class="hljs-string inline">&#x27;expanded&#x27;</span>
};

<span class="hljs-comment inline">// State transition logic</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleStateTransition</span> = (<span class="hljs-params inline">currentState, action</span>) =&gt; {
    <span class="hljs-keyword inline">switch</span> (currentState) {
        <span class="hljs-keyword inline">case</span> states.<span class="hljs-property inline">IDLE</span>:
            <span class="hljs-keyword inline">return</span> action === <span class="hljs-string inline">&#x27;drag&#x27;</span> ? states.<span class="hljs-property inline">DRAGGING</span> : 
                   action === <span class="hljs-string inline">&#x27;click&#x27;</span> ? states.<span class="hljs-property inline">EXPANDED</span> : currentState;
        <span class="hljs-comment inline">// ... other state transitions</span>
    }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Debounced Animation Pattern</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20%5BpendingValue%2C%20setPendingValue%5D%20%3D%20useState(null)%3B%0Aconst%20timerRef%20%3D%20useRef(null)%3B%0Aconst%20debouncedUpdate%20%3D%20(newValue)%20%3D%3E%20%7B%0AsetPendingValue(newValue)%3B%0Aif%20(timerRef.current)%20clearTimeout(timerRef.current)%3B%0AtimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetActualValue(newValue)%3B%0A%7D%2C%20delay)%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> [pendingValue, setPendingValue] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">null</span>);
<span class="hljs-keyword inline">const</span> timerRef = <span class="hljs-title function_ inline">useRef</span>(<span class="hljs-literal inline">null</span>);

<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">debouncedUpdate</span> = (<span class="hljs-params inline">newValue</span>) =&gt; {
    <span class="hljs-title function_ inline">setPendingValue</span>(newValue);
    
    <span class="hljs-keyword inline">if</span> (timerRef.<span class="hljs-property inline">current</span>) <span class="hljs-built_in inline">clearTimeout</span>(timerRef.<span class="hljs-property inline">current</span>);
    
    timerRef.<span class="hljs-property inline">current</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-title function_ inline">setActualValue</span>(newValue);
    }, delay);
};
</code></pre>
            </div>
        
<h3 id="best-practice-distillation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#best-practice-distillation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Best Practice Distillation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Best Practice Distillation
        </h3>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Event listener cleanup</strong>: Always clean up event listeners in useEffect’s return function</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Coordinate calculation boundary protection</strong>: Use Math.min/max to ensure coordinates are within safe ranges</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">State synchronization</strong>: Related state updates must stay synchronized, avoiding intermediate states</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Animation timing</strong>: Complex animations must consider timing relationships between parts</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">User feedback</strong>: Even with delayed updates, provide immediate visual feedback</li>
</ol>
<h2 id="complete-source-code-analysis" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#complete-source-code-analysis" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete Source Code Analysis">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete Source Code Analysis
        </h2>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="'use%20client'%3B%0Aimport%20React%2C%20%7BuseCallback%2C%20useEffect%2C%20useRef%2C%20useState%7D%20from%20'react'%3B%0Aimport%20%7BusePathname%2C%20useRouter%7D%20from%20'next%2Fnavigation'%3B%0Aimport%20%7BuseTheme%7D%20from%20'.%2FThemeProvider'%3B%0Aimport%20%7BuseLocaleStore%7D%20from%20'%40%2Flib%2Fstores%2FlocaleStore'%3B%0Aimport%20%7BLOCALES%7D%20from%20'%40%2Flib%2Futils%2Flocales'%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Type%20Definitions%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0Ainterface%20Position%20%7B%0Ax%3A%20number%3B%20%20%2F%2F%20X%20coordinate%0Ay%3A%20number%3B%20%20%2F%2F%20Y%20coordinate%0A%7D%0Aexport%20function%20Navigation()%20%7B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20State%20Management%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F%2F%20Basic%20states%0Aconst%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Component%20mount%20state%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Menu%20expansion%20state%0A%2F%2F%20Position-related%20states%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Current%20position%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%2F%2F%20Original%20position%20record%0A%2F%2F%20Drag-related%20states%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Drag%20state%20flag%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%20%20%20%20%20%20%20%20%2F%2F%20Drag%20offset%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%2F%2F%20Drag%20start%20position%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Show%20ripple%20effect%0A%2F%2F%20References%20and%20timers%0Aconst%20debounceTimerRef%20%3D%20useRefNodeJS.Timeout%20%7C%20null%3E(null)%3B%20%20%20%20%20%2F%2F%20Debounce%20timer%0Aconst%20hasDraggedSignificantlyRef%20%3D%20useRef(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Has%20significant%20drag%20occurred%0Aconst%20pendingPositionRef%20%3D%20useRefPosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%2F%2F%20Pending%20position%20update%0Aconst%20ballRef%20%3D%20useRefHTMLDivElement%3E(null)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Navigation%20ball%20reference%0A%2F%2F%20Next.js%20and%20theme%20hooks%0Aconst%20router%20%3D%20useRouter()%3B%0Aconst%20pathname%20%3D%20usePathname()%3B%0Aconst%20%7Btheme%2C%20toggleTheme%7D%20%3D%20useTheme()%3B%0Aconst%20%7Blocale%2C%20toggleLocale%7D%20%3D%20useLocaleStore()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Initialization%20Effect%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Initialize%20position%20when%20component%20mounts%0A*%20Calculate%20initial%20position%20during%20client-side%20rendering%2C%20avoiding%20window%20undefined%20issue%20during%20SSR%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0AsetMounted(true)%3B%0Aconst%20initialX%20%3D%20window.innerWidth%20-%2080%3B%20%20%20%2F%2F%2080px%20from%20right%20edge%0Aconst%20initialY%20%3D%20100%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20100px%20from%20top%0AsetPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0AsetOriginalPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0ApendingPositionRef.current%20%3D%20%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F**%0A*%20Clean%20up%20debounce%20timer%20to%20prevent%20memory%20leaks%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Navigation%20Configuration%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Navigation%20menu%20configuration%0A*%20Define%20all%20navigable%20pages%20and%20their%20identifiers%0A*%2F%0Aconst%20sections%20%3D%20%5B%0A%7B%0Aid%3A%20'personal'%20as%20const%2C%0Alabel%3A%20'Personal'%2C%0Adescription%3A%20'About%20Me'%2C%0Ahref%3A%20'%2Fpersonal'%0A%7D%2C%0A%7B%0Aid%3A%20'works'%20as%20const%2C%0Alabel%3A%20'Works'%2C%0Adescription%3A%20'Portfolio'%2C%0Ahref%3A%20'%2Fworks'%0A%7D%2C%0A%7B%0Aid%3A%20'contributions'%20as%20const%2C%0Alabel%3A%20'Contributions'%2C%0Adescription%3A%20'Open%20Source'%2C%0Ahref%3A%20'%2Fcontributions'%0A%7D%2C%0A%7B%0Aid%3A%20'documents'%20as%20const%2C%0Alabel%3A%20'Documents'%2C%0Adescription%3A%20'Insights'%2C%0Ahref%3A%20'%2Fdocuments'%0A%7D%2C%0A%5D%3B%0A%2F**%0A*%20Get%20active%20navigation%20item%20based%20on%20current%20path%0A*%20%40returns%20Currently%20active%20navigation%20item%20ID%20or%20null%0A*%2F%0Aconst%20getActiveSection%20%3D%20()%20%3D%3E%20%7B%0Aif%20(pathname%20%3D%3D%3D%20'%2F')%20return%20'personal'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fworks')%20return%20'works'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fcontributions')%20return%20'contributions'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fdocuments')%20return%20'documents'%3B%0Areturn%20null%3B%0A%7D%3B%0Aconst%20activeSection%20%3D%20getActiveSection()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Core%20Algorithm%3A%20Edge%20Snapping%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Edge%20snapping%20algorithm%0A*%20Calculate%20distance%20to%20four%20boundaries%20and%20move%20to%20nearest%20boundary%0A*%20%40param%20currentPos%20Current%20position%0A*%20%40returns%20Position%20after%20snapping%0A*%2F%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%20%20%2F%2F%20Navigation%20ball%20size%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%20%20%2F%2F%20Distance%20from%20edge%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20Calculate%20distances%20to%20four%20boundaries%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20Find%20minimum%20distance%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20Determine%20snap%20direction%20based%20on%20minimum%20distance%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20Snap%20to%20left%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20Snap%20to%20right%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%20%20%2F%2F%20Snap%20to%20top%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20Snap%20to%20bottom%0A%7D%0A%2F%2F%20Boundary%20constraints%3A%20ensure%20position%20is%20within%20safe%20range%0AnewPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Drag%20Event%20Handling%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Mouse%20down%20event%20handler%0A*%20Initialize%20drag%20state%2C%20record%20start%20position%20and%20offset%0A*%2F%0Aconst%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20Prevent%20default%20behaviors%20(like%20text%20selection)%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20Disable%20drag%20in%20expanded%20state%0AsetIsDragging(true)%3B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20Calculate%20mouse%20click%20position%20relative%20to%20navigation%20ball%20offset%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20Mouse%20X%20-%20ball%20left%20%3D%20X%20offset%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%20Mouse%20Y%20-%20ball%20top%20%3D%20Y%20offset%0A%7D)%3B%0A%7D%0A%7D%3B%0A%2F**%0A*%20Mouse%20move%20event%20handler%20(with%20debounce%20strategy)%0A*%20Update%20position%20in%20real-time%2C%20but%20use%20debouncing%20to%20avoid%20frequent%20rendering%0A*%2F%0Aconst%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20Calculate%20new%20position%20based%20on%20mouse%20position%20and%20initial%20offset%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20Store%20pending%20position%20(for%20debounced%20update)%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20Immediately%20show%20ripple%20effect%20for%20instant%20feedback%0AsetShowRipple(true)%3B%0A%2F%2F%20Clear%20existing%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20Set%20new%20debounce%20timer%20(500ms%20delay)%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%2F%2F%20Calculate%20drag%20distance%20to%20determine%20if%20it's%20significant%20drag%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0A%2F%2F%20Over%203%20pixels%20is%20considered%20significant%20drag%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0A%2F**%0A*%20Mouse%20up%20event%20handler%0A*%20End%20drag%20and%20execute%20snapping%20logic%0A*%2F%0Aconst%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20Clear%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0AdebounceTimerRef.current%20%3D%20null%3B%0A%7D%0A%2F%2F%20If%20significant%20drag%20occurred%2C%20execute%20edge%20snapping%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%20%20%2F%2F%20Update%20original%20position%20record%0A%7D%0A%2F%2F%20Delay%20reset%20of%20drag%20flag%20to%20avoid%20conflict%20with%20click%20events%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Global%20Event%20Listeners%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Manage%20global%20mouse%20event%20listeners%0A*%20Only%20add%20listeners%20during%20drag%20state%20for%20performance%20optimization%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20Ensure%20listeners%20are%20removed%20in%20non-drag%20state%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Interaction%20Event%20Handling%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Navigation%20ball%20click%20event%20handler%0A*%20Toggle%20expand%2Fcollapse%20state%2C%20handle%20position%20movement%0A*%2F%0Aconst%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0A%2F%2F%20Only%20handle%20click%20when%20no%20significant%20drag%20occurred%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20Expand%3A%20save%20current%20position%2C%20move%20to%20screen%20center%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%20%20%20%2F%2F%20Center%20X%20-%20ball%20radius%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%20%20%2F%2F%20Center%20Y%20-%20ball%20radius%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20Collapse%3A%20delay%20150ms%20before%20returning%20to%20original%20position%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B%0A%2F**%0A*%20Menu%20item%20click%20event%20handler%0A*%20Execute%20action%20then%20collapse%20menu%0A*%2F%0Aconst%20handleMenuItemClick%20%3D%20(action%3A%20()%20%3D%3E%20void)%20%3D%3E%20%7B%0Aaction()%3B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F**%0A*%20Page%20navigation%20handler%0A*%2F%0Aconst%20navigateToPage%20%3D%20(href%3A%20string)%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20router.push(href))%3B%0A%7D%3B%0A%2F**%0A*%20Theme%20toggle%20handler%0A*%2F%0Aconst%20handleThemeToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20toggleTheme())%3B%0A%7D%3B%0A%2F**%0A*%20Locale%20toggle%20handler%0A*%20Support%20language%20switching%20redirect%20for%20document%20pages%0A*%2F%0Aconst%20handleLocaleToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20%7B%0AtoggleLocale((newLocale)%20%3D%3E%20%7B%0A%2F%2F%20Check%20if%20on%20document%20page%2C%20redirect%20to%20same%20article%20in%20new%20language%0Aif%20(pathname.startsWith('%2Fdocuments%2F'))%20%7B%0Aconst%20pathSegments%20%3D%20pathname.split('%2F').filter(Boolean)%3B%0Aif%20(pathSegments.length%20%3E%3D%204)%20%7B%0Aconst%20%5B%2C%20currentLang%2C%20category%2C%20fileName%5D%20%3D%20pathSegments%3B%0Aconst%20newPath%20%3D%20%60%2Fdocuments%2F%24%7BnewLocale%7D%2F%24%7Bcategory%7D%2F%24%7BfileName%7D%60%3B%0Arouter.push(newPath)%3B%0A%7D%0A%7D%0A%7D)%3B%0A%7D)%3B%0A%7D%3B%0A%2F**%0A*%20Backdrop%20click%20event%20handler%0A*%20Click%20background%20to%20collapse%20menu%0A*%2F%0Aconst%20handleBackdropClick%20%3D%20()%20%3D%3E%20%7B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Core%20Algorithm%3A%20Circular%20Layout%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Circular%20menu%20layout%20algorithm%0A*%20Use%20polar%20coordinates%20to%20calculate%20menu%20item%20positions%0A*%20%40param%20index%20Menu%20item%20index%0A*%20%40param%20total%20Total%20number%20of%20menu%20items%0A*%20%40param%20radius%20Circle%20radius%0A*%20%40returns%20Screen%20coordinates%20of%20menu%20item%0A*%2F%0Aconst%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0A%2F%2F%20Calculate%20angle%3A%20divide%20circumference%20equally%2C%20starting%20angle%20at%20-%CF%80%2F2%20(12%20o'clock)%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0A%2F%2F%20Screen%20center%20coordinates%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0A%2F%2F%20Polar%20to%20Cartesian%20coordinate%20conversion%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%20%20%2F%2F%20-60%20for%20menu%20item%20width%20adjustment%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%20%20%2F%2F%20-30%20for%20menu%20item%20height%20adjustment%0A%7D%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Style%20Utility%20Functions%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Get%20uniform%20button%20styles%0A*%2F%0Aconst%20getUniformButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20border%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3B%0A%7D%3B%0A%2F**%0A*%20Get%20theme%20button%20styles%0A*%2F%0Aconst%20getThemeButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20w-16%20h-12%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20bg-transparent%20hover%3Abg-surface%2F20%22%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20UI%20Components%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Active%20state%20indicator%20component%0A*%2F%0Aconst%20ActiveIndicator%20%3D%20(%7BisActive%7D%3A%20%7B%20isActive%3A%20boolean%20%7D)%20%3D%3E%20%7B%0Aif%20(!isActive)%20return%20null%3B%0Areturn%20(%0Adiv%20className%3D%22absolute%20-top-1%20-right-1%20w-3%20h-3%20rounded-full%20shadow-lg%22%3E%0Adiv%20className%3D%22w-full%20h-full%20rounded-full%20bg-primary%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%3B%0A%2F%2F%20Theme%20icon%20components%0Aconst%20SunIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20fillRule%3D%22evenodd%22%0Ad%3D%22M10%202a1%201%200%20011%201v1a1%201%200%2011-2%200V3a1%201%200%20011-1zm4%208a4%204%200%2011-8%200%204%204%200%20018%200zm-.464%204.95l.707.707a1%201%200%20001.414-1.414l-.707-.707a1%201%200%2000-1.414%201.414zm2.12-10.607a1%201%200%20010%201.414l-.706.707a1%201%200%2011-1.414-1.414l.707-.707a1%201%200%20011.414%200zM17%2011a1%201%200%20100-2h-1a1%201%200%20100%202h1zm-7%204a1%201%200%20011%201v1a1%201%200%2011-2%200v-1a1%201%200%20011-1zM5.05%206.464A1%201%200%20106.465%205.05l-.708-.707a1%201%200%2000-1.414%201.414l.707.707zm1.414%208.486l-.707.707a1%201%200%2001-1.414-1.414l.707-.707a1%201%200%20011.414%201.414zM4%2011a1%201%200%20100-2H3a1%201%200%20000%202h1z%22%0AclipRule%3D%22evenodd%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0Aconst%20MoonIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20d%3D%22M17.293%2013.293A8%208%200%20016.707%202.707a8.001%208.001%200%201010.586%2010.586z%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20Language%20toggle%20icon%20component%0Aconst%20LocaleIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%20flex%20items-center%20justify-center%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%22%3E%0A%7BLOCALES%5Blocale%5D.flag%7D%0Aspan%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Render%20Logic%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Loading%20state%20render%0A*%2F%0Aif%20(!mounted)%20%7B%0Areturn%20(%0Adiv%20className%3D%22fixed%20top-20%20right-5%20z-50%22%3E%0Adiv%0AclassName%3D%22w-16%20h-16%20rounded-full%20backdrop-blur-md%20border%20animate-pulse%20bg-surface%2F60%20border-surface%2F40%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%0A%2F**%0A*%20Build%20complete%20menu%20items%20array%0A*%2F%0Aconst%20allMenuItems%20%3D%20%5B%0A...sections.map(section%20%3D%3E%20(%7B%0Atype%3A%20'section'%20as%20const%2C%0Asection%2C%0Aaction%3A%20()%20%3D%3E%20navigateToPage(section.id%20%3D%3D%3D%20'personal'%20%3F%20'%2F'%20%3A%20section.href)%2C%0AisActive%3A%20activeSection%20%3D%3D%3D%20section.id%0A%7D))%2C%0A%7B%0Atype%3A%20'theme'%20as%20const%2C%0Aaction%3A%20handleThemeToggle%2C%0AisActive%3A%20false%0A%7D%2C%0A%7B%0Atype%3A%20'locale'%20as%20const%2C%0Aaction%3A%20handleLocaleToggle%2C%0AisActive%3A%20false%0A%7D%0A%5D%3B%0Areturn%20(%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Main%20Navigation%20Ball%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0Adiv%0Aref%3D%7BballRef%7D%0AclassName%3D%7B%60%0Afixed%20z-50%20transition-all%20duration-500%20cursor-pointer%20select-none%0A%24%7BisDragging%20%3F%20'cursor-grabbing%20scale-110%20duration-0'%20%3A%20'cursor-grab%20hover%3Ascale-105'%7D%0A%24%7BisExpanded%20%3F%20'hover%3Ascale-120'%20%3A%20''%7D%0A%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0Atransform%3A%20%60%24%7BisDragging%20%3F%20'rotate(5deg)'%20%3A%20isExpanded%20%3F%20'rotate(0deg)%20scale(1.1)'%20%3A%20'rotate(0deg)'%7D%60%0A%7D%7D%0AonMouseDown%3D%7BhandleMouseDown%7D%0AonClick%3D%7BhandleBallClick%7D%0A%3E%0A%7B%2F*%20Modern%20navigation%20ball%20*%2F%7D%0Adiv%20className%3D%7B%60%0Arelative%20w-16%20h-16%20rounded-full%20transition-all%20duration-500%0A%24%7BisExpanded%20%3F%20'animate-pulse%20shadow-lg'%20%3A%20''%7D%0A%60%7D%3E%0A%7B%2F*%20Ball%20shadow%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20rounded-full%20bg-black%2F20%20blur-lg%20translate-y-2%22%3Ediv%3E%0A%7B%2F*%20Ripple%20effect%20-%20shown%20during%20drag%20*%2F%7D%0A%7BshowRipple%20%26%26%20(%0Adiv%0AclassName%3D%22absolute%20rounded-full%20border-2%20animate-ping%20pointer-events-none%22%0Astyle%3D%7B%7B%0AborderColor%3A%20theme%20%3D%3D%3D%20'dark'%20%3F%20'rgba(78%2C%20205%2C%20196%2C%200.6)'%20%3A%20'rgba(0%2C%20102%2C%20204%2C%200.6)'%2C%0Awidth%3A%20'80px'%2C%0Aheight%3A%20'80px'%2C%0Atop%3A%20'-8px'%2C%0Aleft%3A%20'-8px'%2C%0AanimationDuration%3A%20'1s'%0A%7D%7D%0A%3Ediv%3E%0A)%7D%0A%7B%2F*%20Main%20ball%20body%20*%2F%7D%0Adiv%0AclassName%3D%22relative%20w-full%20h-full%20rounded-full%20shadow-xl%20transform-gpu%20backdrop-blur-md%20border%20transition-all%20duration-300%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3E%0A%7B%2F*%20Highlight%20effect%20*%2F%7D%0Adiv%20className%3D%22absolute%20top-2%20left-2%20w-4%20h-4%20rounded-full%20bg-white%2F30%20blur-sm%22%3Ediv%3E%0A%7B%2F*%20Menu%20symbol%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20flex%20items-center%20justify-center%22%3E%0Adiv%20className%3D%7B%60%0Aw-6%20h-6%20rounded-full%20border%20transition-all%20duration-300%20flex%20items-center%20justify-center%20border-foreground%2F40%0A%24%7BisExpanded%20%3F%20'rotate-90%20scale-110'%20%3A%20'rotate-0'%7D%0A%60%7D%3E%0A%7B%0AisExpanded%20%3F%20(%0Adiv%0AclassName%3D%22relative%20transition-all%20duration-300%20w-2%20h-2%20opacity-50%20text-center%20flex%20items-center%20justify-center%20text-foreground%22%0Astyle%3D%7B%7Btransform%3A%20'translateY(-1px)'%7D%7D%0A%3E%C3%97div%3E%0A)%20%3A%20(%0Adiv%0AclassName%3D%22transition-all%20duration-300%20w-1%20h-1%20opacity-50%20rounded-full%20bg-foreground%22%3Ediv%3E%0A)%0A%7D%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Circular%20Menu%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7BisExpanded%20%26%26%20(%0A%7B%2F*%20Background%20overlay%20*%2F%7D%0Adiv%0AclassName%3D%22fixed%20inset-0%20z-40%20backdrop-blur-md%20transition-all%20duration-300%20bg-background%2F20%22%0AonClick%3D%7BhandleBackdropClick%7D%0A%3Ediv%3E%0A%7B%2F*%20Circular%20layout%20menu%20items%20*%2F%7D%0A%7BallMenuItems.map((item%2C%20index)%20%3D%3E%20%7B%0Aconst%20circularPos%20%3D%20getCircularPosition(index%2C%20allMenuItems.length)%3B%0Aif%20(item.type%20%3D%3D%3D%20'section')%20%7B%0Aconst%20section%20%3D%20item.section!%3B%0Areturn%20(%0Abutton%0Akey%3D%7Bsection.id%7D%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7B%60%24%7BgetUniformButtonStyles()%7D%20w-28%20h-14%20%24%7Bitem.isActive%20%3F%20'ring-2%20ring-blue-400%2F60%20scale-105'%20%3A%20''%7D%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20Section%20content%20*%2F%7D%0Adiv%0AclassName%3D%22absolute%20inset-0%20flex%20flex-col%20items-center%20justify-center%20text-foreground%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%20leading-tight%20text-center%22%3E%0A%7Bsection.label%7D%0Aspan%3E%0Aspan%20className%3D%22text-xs%20opacity-70%20mt-0.5%20font-medium%22%3E%0A%7Bsection.description%7D%0Aspan%3E%0Adiv%3E%0AActiveIndicator%20isActive%3D%7Bitem.isActive%7D%2F%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20if%20(item.type%20%3D%3D%3D%20'theme')%20%7B%0Areturn%20(%0Abutton%0Akey%3D%22theme%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20Theme%20toggle%20icon%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0A%7Btheme%20%3D%3D%3D%20'dark'%20%3F%20SunIcon%2F%3E%20%3A%20MoonIcon%2F%3E%7D%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20%7B%20%2F%2F%20locale%20toggle%0Areturn%20(%0Abutton%0Akey%3D%22locale%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20Language%20toggle%20icon%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0ALocaleIcon%2F%3E%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%0A%7D)%7D%0A)%7D%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20CSS%20Animation%20Definitions%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A%40keyframes%20menuItemDisappear%20%7B%0A0%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.3%3B%0Atransform%3A%20scale(0.6)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D%0A)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-string inline">&#x27;use client&#x27;</span>;
<span class="hljs-keyword inline">import</span> <span class="hljs-title class_ inline">React</span>, {useCallback, useEffect, useRef, useState} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;react&#x27;</span>;
<span class="hljs-keyword inline">import</span> {usePathname, useRouter} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;next/navigation&#x27;</span>;
<span class="hljs-keyword inline">import</span> {useTheme} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;./ThemeProvider&#x27;</span>;
<span class="hljs-keyword inline">import</span> {useLocaleStore} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;@/lib/stores/localeStore&#x27;</span>;
<span class="hljs-keyword inline">import</span> {<span class="hljs-variable constant_ inline">LOCALES</span>} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;@/lib/utils/locales&#x27;</span>;

<span class="hljs-comment inline">// ==================== Type Definitions ====================</span>
<span class="hljs-keyword inline">interface</span> <span class="hljs-title class_ inline">Position</span> {
    <span class="hljs-attr inline">x</span>: <span class="hljs-built_in inline">number</span>;  <span class="hljs-comment inline">// X coordinate</span>
    <span class="hljs-attr inline">y</span>: <span class="hljs-built_in inline">number</span>;  <span class="hljs-comment inline">// Y coordinate</span>
}

<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">Navigation</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-comment inline">// ==================== State Management ====================</span>
    <span class="hljs-comment inline">// Basic states</span>
    <span class="hljs-keyword inline">const</span> [mounted, setMounted] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);                    <span class="hljs-comment inline">// Component mount state</span>
    <span class="hljs-keyword inline">const</span> [isExpanded, setIsExpanded] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);              <span class="hljs-comment inline">// Menu expansion state</span>
    
    <span class="hljs-comment inline">// Position-related states</span>
    <span class="hljs-keyword inline">const</span> [position, setPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});           <span class="hljs-comment inline">// Current position</span>
    <span class="hljs-keyword inline">const</span> [originalPosition, setOriginalPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>}); <span class="hljs-comment inline">// Original position record</span>
    
    <span class="hljs-comment inline">// Drag-related states</span>
    <span class="hljs-keyword inline">const</span> [isDragging, setIsDragging] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);              <span class="hljs-comment inline">// Drag state flag</span>
    <span class="hljs-keyword inline">const</span> [dragOffset, setDragOffset] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});         <span class="hljs-comment inline">// Drag offset</span>
    <span class="hljs-keyword inline">const</span> [dragStartPosition, setDragStartPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>}); <span class="hljs-comment inline">// Drag start position</span>
    <span class="hljs-keyword inline">const</span> [showRipple, setShowRipple] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);              <span class="hljs-comment inline">// Show ripple effect</span>
    
    <span class="hljs-comment inline">// References and timers</span>
    <span class="hljs-keyword inline">const</span> debounceTimerRef = useRef&lt;<span class="hljs-title class_ inline">NodeJS</span>.<span class="hljs-property inline">Timeout</span> | <span class="hljs-literal inline">null</span>&gt;(<span class="hljs-literal inline">null</span>);     <span class="hljs-comment inline">// Debounce timer</span>
    <span class="hljs-keyword inline">const</span> hasDraggedSignificantlyRef = <span class="hljs-title function_ inline">useRef</span>(<span class="hljs-literal inline">false</span>);                 <span class="hljs-comment inline">// Has significant drag occurred</span>
    <span class="hljs-keyword inline">const</span> pendingPositionRef = useRef&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});      <span class="hljs-comment inline">// Pending position update</span>
    <span class="hljs-keyword inline">const</span> ballRef = useRef&lt;<span class="hljs-title class_ inline">HTMLDivElement</span>&gt;(<span class="hljs-literal inline">null</span>);                     <span class="hljs-comment inline">// Navigation ball reference</span>
    
    <span class="hljs-comment inline">// Next.js and theme hooks</span>
    <span class="hljs-keyword inline">const</span> router = <span class="hljs-title function_ inline">useRouter</span>();
    <span class="hljs-keyword inline">const</span> pathname = <span class="hljs-title function_ inline">usePathname</span>();
    <span class="hljs-keyword inline">const</span> {theme, toggleTheme} = <span class="hljs-title function_ inline">useTheme</span>();
    <span class="hljs-keyword inline">const</span> {locale, toggleLocale} = <span class="hljs-title function_ inline">useLocaleStore</span>();

    <span class="hljs-comment inline">// ==================== Initialization Effect ====================</span>
    <span class="hljs-comment inline">/**
     * Initialize position when component mounts
     * Calculate initial position during client-side rendering, avoiding window undefined issue during SSR
     */</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-title function_ inline">setMounted</span>(<span class="hljs-literal inline">true</span>);
        <span class="hljs-keyword inline">const</span> initialX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> - <span class="hljs-number inline">80</span>;   <span class="hljs-comment inline">// 80px from right edge</span>
        <span class="hljs-keyword inline">const</span> initialY = <span class="hljs-number inline">100</span>;                      <span class="hljs-comment inline">// 100px from top</span>
        <span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: initialX, <span class="hljs-attr inline">y</span>: initialY});
        <span class="hljs-title function_ inline">setOriginalPosition</span>({<span class="hljs-attr inline">x</span>: initialX, <span class="hljs-attr inline">y</span>: initialY});
        pendingPositionRef.<span class="hljs-property inline">current</span> = {<span class="hljs-attr inline">x</span>: initialX, <span class="hljs-attr inline">y</span>: initialY};
    }, []);

    <span class="hljs-comment inline">/**
     * Clean up debounce timer to prevent memory leaks
     */</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
                <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
            }
        };
    }, []);

    <span class="hljs-comment inline">// ==================== Navigation Configuration ====================</span>
    <span class="hljs-comment inline">/**
     * Navigation menu configuration
     * Define all navigable pages and their identifiers
     */</span>
    <span class="hljs-keyword inline">const</span> sections = [
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;personal&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Personal&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;About Me&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/personal&#x27;</span>
        },
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;works&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Works&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;Portfolio&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/works&#x27;</span>
        },
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;contributions&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Contributions&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;Open Source&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/contributions&#x27;</span>
        },
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;documents&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Documents&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;Insights&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/documents&#x27;</span>
        },
    ];

    <span class="hljs-comment inline">/**
     * Get active navigation item based on current path
     * <span class="hljs-doctag inline">@returns</span> Currently active navigation item ID or null
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getActiveSection</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;personal&#x27;</span>;
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/works&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;works&#x27;</span>;
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/contributions&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;contributions&#x27;</span>;
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/documents&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;documents&#x27;</span>;
        <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
    };

    <span class="hljs-keyword inline">const</span> activeSection = <span class="hljs-title function_ inline">getActiveSection</span>();

    <span class="hljs-comment inline">// ==================== Core Algorithm: Edge Snapping ====================</span>
    <span class="hljs-comment inline">/**
     * Edge snapping algorithm
     * Calculate distance to four boundaries and move to nearest boundary
     * <span class="hljs-doctag inline">@param</span> currentPos Current position
     * <span class="hljs-doctag inline">@returns</span> Position after snapping
     */</span>
    <span class="hljs-keyword inline">const</span> snapToEdge = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">currentPos</span>: <span class="hljs-title class_ inline">Position</span></span>) =&gt;</span> {
        <span class="hljs-keyword inline">const</span> windowWidth = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span>;
        <span class="hljs-keyword inline">const</span> windowHeight = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span>;
        <span class="hljs-keyword inline">const</span> ballSize = <span class="hljs-number inline">70</span>;    <span class="hljs-comment inline">// Navigation ball size</span>
        <span class="hljs-keyword inline">const</span> margin = <span class="hljs-number inline">20</span>;      <span class="hljs-comment inline">// Distance from edge</span>
        <span class="hljs-keyword inline">let</span> newPos = {...currentPos};

        <span class="hljs-comment inline">// Calculate distances to four boundaries</span>
        <span class="hljs-keyword inline">const</span> distanceToLeft = currentPos.<span class="hljs-property inline">x</span>;
        <span class="hljs-keyword inline">const</span> distanceToRight = windowWidth - currentPos.<span class="hljs-property inline">x</span>;
        <span class="hljs-keyword inline">const</span> distanceToTop = currentPos.<span class="hljs-property inline">y</span>;
        <span class="hljs-keyword inline">const</span> distanceToBottom = windowHeight - currentPos.<span class="hljs-property inline">y</span>;
        
        <span class="hljs-comment inline">// Find minimum distance</span>
        <span class="hljs-keyword inline">const</span> minDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);

        <span class="hljs-comment inline">// Determine snap direction based on minimum distance</span>
        <span class="hljs-keyword inline">if</span> (minDistance === distanceToLeft) {
            newPos.<span class="hljs-property inline">x</span> = margin;  <span class="hljs-comment inline">// Snap to left</span>
        } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToRight) {
            newPos.<span class="hljs-property inline">x</span> = windowWidth - ballSize - margin;  <span class="hljs-comment inline">// Snap to right</span>
        } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToTop) {
            newPos.<span class="hljs-property inline">y</span> = margin;  <span class="hljs-comment inline">// Snap to top</span>
        } <span class="hljs-keyword inline">else</span> {
            newPos.<span class="hljs-property inline">y</span> = windowHeight - ballSize - margin;  <span class="hljs-comment inline">// Snap to bottom</span>
        }

        <span class="hljs-comment inline">// Boundary constraints: ensure position is within safe range</span>
        newPos.<span class="hljs-property inline">x</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowWidth - ballSize - margin, newPos.<span class="hljs-property inline">x</span>));
        newPos.<span class="hljs-property inline">y</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowHeight - ballSize - margin, newPos.<span class="hljs-property inline">y</span>));
        
        <span class="hljs-keyword inline">return</span> newPos;
    }, []);

    <span class="hljs-comment inline">// ==================== Drag Event Handling ====================</span>
    <span class="hljs-comment inline">/**
     * Mouse down event handler
     * Initialize drag state, record start position and offset
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">React</span>.<span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt; {
        e.<span class="hljs-title function_ inline">preventDefault</span>();  <span class="hljs-comment inline">// Prevent default behaviors (like text selection)</span>
        <span class="hljs-keyword inline">if</span> (isExpanded) <span class="hljs-keyword inline">return</span>;  <span class="hljs-comment inline">// Disable drag in expanded state</span>

        <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">true</span>);
        hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">false</span>;
        <span class="hljs-title function_ inline">setDragStartPosition</span>({<span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span>, <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span>});
        
        <span class="hljs-comment inline">// Calculate mouse click position relative to navigation ball offset</span>
        <span class="hljs-keyword inline">const</span> rect = ballRef.<span class="hljs-property inline">current</span>?.<span class="hljs-title function_ inline">getBoundingClientRect</span>();
        <span class="hljs-keyword inline">if</span> (rect) {
            <span class="hljs-title function_ inline">setDragOffset</span>({
                <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - rect.<span class="hljs-property inline">left</span>,  <span class="hljs-comment inline">// Mouse X - ball left = X offset</span>
                <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - rect.<span class="hljs-property inline">top</span>    <span class="hljs-comment inline">// Mouse Y - ball top = Y offset</span>
            });
        }
    };

    <span class="hljs-comment inline">/**
     * Mouse move event handler (with debounce strategy)
     * Update position in real-time, but use debouncing to avoid frequent rendering
     */</span>
    <span class="hljs-keyword inline">const</span> handleMouseMove = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

        <span class="hljs-comment inline">// Calculate new position based on mouse position and initial offset</span>
        <span class="hljs-keyword inline">const</span> newPos = {
            <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,
            <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>
        };

        <span class="hljs-comment inline">// Store pending position (for debounced update)</span>
        pendingPositionRef.<span class="hljs-property inline">current</span> = newPos;

        <span class="hljs-comment inline">// Immediately show ripple effect for instant feedback</span>
        <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">true</span>);

        <span class="hljs-comment inline">// Clear existing debounce timer</span>
        <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
        }

        <span class="hljs-comment inline">// Set new debounce timer (500ms delay)</span>
        debounceTimerRef.<span class="hljs-property inline">current</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">setPosition</span>(newPos);
            <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);
        }, <span class="hljs-number inline">500</span>);

        <span class="hljs-comment inline">// Calculate drag distance to determine if it&#x27;s significant drag</span>
        <span class="hljs-keyword inline">const</span> dragDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sqrt</span>(
            <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientX</span> - dragStartPosition.<span class="hljs-property inline">x</span>, <span class="hljs-number inline">2</span>) +
            <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientY</span> - dragStartPosition.<span class="hljs-property inline">y</span>, <span class="hljs-number inline">2</span>)
        );

        <span class="hljs-comment inline">// Over 3 pixels is considered significant drag</span>
        <span class="hljs-keyword inline">if</span> (dragDistance &gt; <span class="hljs-number inline">3</span>) {
            hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">true</span>;
        }
    }, [isDragging, dragOffset, dragStartPosition]);

    <span class="hljs-comment inline">/**
     * Mouse up event handler
     * End drag and execute snapping logic
     */</span>
    <span class="hljs-keyword inline">const</span> handleMouseUp = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

        <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">false</span>);
        <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);

        <span class="hljs-comment inline">// Clear debounce timer</span>
        <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
            debounceTimerRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">null</span>;
        }

        <span class="hljs-comment inline">// If significant drag occurred, execute edge snapping</span>
        <span class="hljs-keyword inline">if</span> (hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-keyword inline">const</span> snappedPos = <span class="hljs-title function_ inline">snapToEdge</span>(pendingPositionRef.<span class="hljs-property inline">current</span>);
            <span class="hljs-title function_ inline">setPosition</span>(snappedPos);
            <span class="hljs-title function_ inline">setOriginalPosition</span>(snappedPos);  <span class="hljs-comment inline">// Update original position record</span>
        }

        <span class="hljs-comment inline">// Delay reset of drag flag to avoid conflict with click events</span>
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">false</span>;
        }, <span class="hljs-number inline">100</span>);
    }, [isDragging]);

    <span class="hljs-comment inline">// ==================== Global Event Listeners ====================</span>
    <span class="hljs-comment inline">/**
     * Manage global mouse event listeners
     * Only add listeners during drag state for performance optimization
     */</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (isDragging) {
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
            <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
                <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
                <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
            };
        } <span class="hljs-keyword inline">else</span> {
            <span class="hljs-comment inline">// Ensure listeners are removed in non-drag state</span>
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
        }
    }, [isDragging]);

    <span class="hljs-comment inline">// ==================== Interaction Event Handling ====================</span>
    <span class="hljs-comment inline">/**
     * Navigation ball click event handler
     * Toggle expand/collapse state, handle position movement
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleBallClick</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-comment inline">// Only handle click when no significant drag occurred</span>
        <span class="hljs-keyword inline">if</span> (!hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-keyword inline">if</span> (!isExpanded) {
                <span class="hljs-comment inline">// Expand: save current position, move to screen center</span>
                <span class="hljs-title function_ inline">setOriginalPosition</span>(position);
                <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;   <span class="hljs-comment inline">// Center X - ball radius</span>
                <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;  <span class="hljs-comment inline">// Center Y - ball radius</span>
                <span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: centerX, <span class="hljs-attr inline">y</span>: centerY});
                <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">true</span>);
            } <span class="hljs-keyword inline">else</span> {
                <span class="hljs-comment inline">// Collapse: delay 150ms before returning to original position</span>
                <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
                <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
                    <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
                }, <span class="hljs-number inline">150</span>);
            }
        }
    };

    <span class="hljs-comment inline">/**
     * Menu item click event handler
     * Execute action then collapse menu
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMenuItemClick</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">action</span>: () =&gt; <span class="hljs-built_in inline">void</span></span>) =&gt; {
        <span class="hljs-title function_ inline">action</span>();
        <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
        }, <span class="hljs-number inline">150</span>);
    };

    <span class="hljs-comment inline">/**
     * Page navigation handler
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">navigateToPage</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">href</span>: <span class="hljs-built_in inline">string</span></span>) =&gt; {
        <span class="hljs-title function_ inline">handleMenuItemClick</span>(<span class="hljs-function inline">() =&gt;</span> router.<span class="hljs-title function_ inline">push</span>(href));
    };

    <span class="hljs-comment inline">/**
     * Theme toggle handler
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleThemeToggle</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-title function_ inline">handleMenuItemClick</span>(<span class="hljs-function inline">() =&gt;</span> <span class="hljs-title function_ inline">toggleTheme</span>());
    };

    <span class="hljs-comment inline">/**
     * Locale toggle handler
     * Support language switching redirect for document pages
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleLocaleToggle</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-title function_ inline">handleMenuItemClick</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">toggleLocale</span>(<span class="hljs-function inline">(<span class="hljs-params inline">newLocale</span>) =&gt;</span> {
                <span class="hljs-comment inline">// Check if on document page, redirect to same article in new language</span>
                <span class="hljs-keyword inline">if</span> (pathname.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;/documents/&#x27;</span>)) {
                    <span class="hljs-keyword inline">const</span> pathSegments = pathname.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27;/&#x27;</span>).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-title class_ inline">Boolean</span>);
                    <span class="hljs-keyword inline">if</span> (pathSegments.<span class="hljs-property inline">length</span> &gt;= <span class="hljs-number inline">4</span>) {
                        <span class="hljs-keyword inline">const</span> [, currentLang, category, fileName] = pathSegments;
                        <span class="hljs-keyword inline">const</span> newPath = <span class="hljs-string inline">`/documents/<span class="hljs-subst inline">${newLocale}</span>/<span class="hljs-subst inline">${category}</span>/<span class="hljs-subst inline">${fileName}</span>`</span>;
                        router.<span class="hljs-title function_ inline">push</span>(newPath);
                    }
                }
            });
        });
    };

    <span class="hljs-comment inline">/**
     * Backdrop click event handler
     * Click background to collapse menu
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleBackdropClick</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
        }, <span class="hljs-number inline">150</span>);
    };

    <span class="hljs-comment inline">// ==================== Core Algorithm: Circular Layout ====================</span>
    <span class="hljs-comment inline">/**
     * Circular menu layout algorithm
     * Use polar coordinates to calculate menu item positions
     * <span class="hljs-doctag inline">@param</span> index Menu item index
     * <span class="hljs-doctag inline">@param</span> total Total number of menu items
     * <span class="hljs-doctag inline">@param</span> radius Circle radius
     * <span class="hljs-doctag inline">@returns</span> Screen coordinates of menu item
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCircularPosition</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">index</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">total</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">radius</span>: <span class="hljs-built_in inline">number</span> = <span class="hljs-number inline">120</span></span>) =&gt; {
        <span class="hljs-comment inline">// Calculate angle: divide circumference equally, starting angle at -π/2 (12 o&#x27;clock)</span>
        <span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;
        
        <span class="hljs-comment inline">// Screen center coordinates</span>
        <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span>;
        <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span>;
        
        <span class="hljs-comment inline">// Polar to Cartesian coordinate conversion</span>
        <span class="hljs-keyword inline">return</span> {
            <span class="hljs-attr inline">x</span>: centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius - <span class="hljs-number inline">60</span>,  <span class="hljs-comment inline">// -60 for menu item width adjustment</span>
            <span class="hljs-attr inline">y</span>: centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius - <span class="hljs-number inline">30</span>,  <span class="hljs-comment inline">// -30 for menu item height adjustment</span>
        };
    };

    <span class="hljs-comment inline">// ==================== Style Utility Functions ====================</span>
    <span class="hljs-comment inline">/**
     * Get uniform button styles
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getUniformButtonStyles</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&quot;fixed z-50 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md border bg-surface/60 border-surface/40 hover:bg-surface/80&quot;</span>;
    };

    <span class="hljs-comment inline">/**
     * Get theme button styles
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getThemeButtonStyles</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&quot;fixed z-50 w-16 h-12 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md bg-transparent hover:bg-surface/20&quot;</span>;
    };

    <span class="hljs-comment inline">// ==================== UI Components ====================</span>
    <span class="hljs-comment inline">/**
     * Active state indicator component
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">ActiveIndicator</span> = (<span class="hljs-params inline">{isActive}: { isActive: <span class="hljs-built_in inline">boolean</span> }</span>) =&gt; {
        <span class="hljs-keyword inline">if</span> (!isActive) <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;

        <span class="hljs-keyword inline">return</span> (
            <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute -top-1 -right-1 w-3 h-3 rounded-full shadow-lg&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-full h-full rounded-full bg-primary&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
        );
    };

    <span class="hljs-comment inline">// Theme icon components</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">SunIcon</span> = (<span class="hljs-params inline"></span>) =&gt; (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-accent transition-all duration-300&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">svg</span> <span class="hljs-attr inline">fill</span>=<span class="hljs-string inline">&quot;currentColor&quot;</span> <span class="hljs-attr inline">viewBox</span>=<span class="hljs-string inline">&quot;0 0 20 20&quot;</span> <span class="hljs-attr inline">xmlns</span>=<span class="hljs-string inline">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">path</span> <span class="hljs-attr inline">fillRule</span>=<span class="hljs-string inline">&quot;evenodd&quot;</span>
                      <span class="hljs-attr inline">d</span>=<span class="hljs-string inline">&quot;M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z&quot;</span>
                      <span class="hljs-attr inline">clipRule</span>=<span class="hljs-string inline">&quot;evenodd&quot;</span>/&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">svg</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
    );

    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">MoonIcon</span> = (<span class="hljs-params inline"></span>) =&gt; (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-accent transition-all duration-300&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">svg</span> <span class="hljs-attr inline">fill</span>=<span class="hljs-string inline">&quot;currentColor&quot;</span> <span class="hljs-attr inline">viewBox</span>=<span class="hljs-string inline">&quot;0 0 20 20&quot;</span> <span class="hljs-attr inline">xmlns</span>=<span class="hljs-string inline">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">path</span> <span class="hljs-attr inline">d</span>=<span class="hljs-string inline">&quot;M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z&quot;</span>/&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">svg</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
    );

    <span class="hljs-comment inline">// Language toggle icon component</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">LocaleIcon</span> = (<span class="hljs-params inline"></span>) =&gt; (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-accent transition-all duration-300 flex items-center justify-center&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;text-sm font-bold&quot;</span>&gt;</span>
                {LOCALES[locale].flag}
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
    );

    <span class="hljs-comment inline">// ==================== Render Logic ====================</span>
    <span class="hljs-comment inline">/**
     * Loading state render
     */</span>
    <span class="hljs-keyword inline">if</span> (!mounted) {
        <span class="hljs-keyword inline">return</span> (
            <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;fixed top-20 right-5 z-50&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
        );
    }

    <span class="hljs-comment inline">/**
     * Build complete menu items array
     */</span>
    <span class="hljs-keyword inline">const</span> allMenuItems = [
        ...sections.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">section</span> =&gt;</span> ({
            <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;section&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            section,
            <span class="hljs-attr inline">action</span>: <span class="hljs-function inline">() =&gt;</span> <span class="hljs-title function_ inline">navigateToPage</span>(section.<span class="hljs-property inline">id</span> === <span class="hljs-string inline">&#x27;personal&#x27;</span> ? <span class="hljs-string inline">&#x27;/&#x27;</span> : section.<span class="hljs-property inline">href</span>),
            <span class="hljs-attr inline">isActive</span>: activeSection === section.<span class="hljs-property inline">id</span>
        })),
        {
            <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;theme&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">action</span>: handleThemeToggle,
            <span class="hljs-attr inline">isActive</span>: <span class="hljs-literal inline">false</span>
        },
        {
            <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;locale&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">action</span>: handleLocaleToggle,
            <span class="hljs-attr inline">isActive</span>: <span class="hljs-literal inline">false</span>
        }
    ];

    <span class="hljs-keyword inline">return</span> (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;&gt;</span>
            {/* ==================== Main Navigation Ball ==================== */}
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                <span class="hljs-attr inline">ref</span>=<span class="hljs-string inline">{ballRef}</span>
                <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`
          <span class="hljs-attr inline">fixed</span> <span class="hljs-attr inline">z-50</span> <span class="hljs-attr inline">transition-all</span> <span class="hljs-attr inline">duration-500</span> <span class="hljs-attr inline">cursor-pointer</span> <span class="hljs-attr inline">select-none</span>
          ${<span class="hljs-attr inline">isDragging</span> ? &#x27;<span class="hljs-attr inline">cursor-grabbing</span> <span class="hljs-attr inline">scale-110</span> <span class="hljs-attr inline">duration-0</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">cursor-grab</span> <span class="hljs-attr inline">hover:scale-105</span>&#x27;}
          ${<span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">hover:scale-120</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;&#x27;}
        `}
                <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                    <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">position.x</span>}<span class="hljs-attr inline">px</span>`,
                    <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">position.y</span>}<span class="hljs-attr inline">px</span>`,
                    <span class="hljs-attr inline">transform:</span> `${<span class="hljs-attr inline">isDragging</span> ? &#x27;<span class="hljs-attr inline">rotate</span>(<span class="hljs-attr inline">5deg</span>)&#x27; <span class="hljs-attr inline">:</span> <span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">rotate</span>(<span class="hljs-attr inline">0deg</span>) <span class="hljs-attr inline">scale</span>(<span class="hljs-attr inline">1.1</span>)&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">rotate</span>(<span class="hljs-attr inline">0deg</span>)&#x27;}`
                }}
                <span class="hljs-attr inline">onMouseDown</span>=<span class="hljs-string inline">{handleMouseDown}</span>
                <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{handleBallClick}</span>
            &gt;</span>
                {/* Modern navigation ball */}
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`
          <span class="hljs-attr inline">relative</span> <span class="hljs-attr inline">w-16</span> <span class="hljs-attr inline">h-16</span> <span class="hljs-attr inline">rounded-full</span> <span class="hljs-attr inline">transition-all</span> <span class="hljs-attr inline">duration-500</span>
          ${<span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">animate-pulse</span> <span class="hljs-attr inline">shadow-lg</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;&#x27;}
        `}&gt;</span>
                    {/* Ball shadow */}
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute inset-0 rounded-full bg-black/20 blur-lg translate-y-2&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                    
                    {/* Ripple effect - shown during drag */}
                    {showRipple &amp;&amp; (
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute rounded-full border-2 animate-ping pointer-events-none&quot;</span>
                            <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                <span class="hljs-attr inline">borderColor:</span> <span class="hljs-attr inline">theme</span> === <span class="hljs-string inline">&#x27;dark&#x27;</span> ? &#x27;<span class="hljs-attr inline">rgba</span>(<span class="hljs-attr inline">78</span>, <span class="hljs-attr inline">205</span>, <span class="hljs-attr inline">196</span>, <span class="hljs-attr inline">0.6</span>)&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">rgba</span>(<span class="hljs-attr inline">0</span>, <span class="hljs-attr inline">102</span>, <span class="hljs-attr inline">204</span>, <span class="hljs-attr inline">0.6</span>)&#x27;,
                                <span class="hljs-attr inline">width:</span> &#x27;<span class="hljs-attr inline">80px</span>&#x27;,
                                <span class="hljs-attr inline">height:</span> &#x27;<span class="hljs-attr inline">80px</span>&#x27;,
                                <span class="hljs-attr inline">top:</span> &#x27;<span class="hljs-attr inline">-8px</span>&#x27;,
                                <span class="hljs-attr inline">left:</span> &#x27;<span class="hljs-attr inline">-8px</span>&#x27;,
                                <span class="hljs-attr inline">animationDuration:</span> &#x27;<span class="hljs-attr inline">1s</span>&#x27;
                            }}
                        &gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                    )}

                    {/* Main ball body */}
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                        <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;relative w-full h-full rounded-full shadow-xl transform-gpu backdrop-blur-md border transition-all duration-300 bg-surface/60 border-surface/40 hover:bg-surface/80&quot;</span>&gt;</span>
                        {/* Highlight effect */}
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute top-2 left-2 w-4 h-4 rounded-full bg-white/30 blur-sm&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                        
                        {/* Menu symbol */}
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute inset-0 flex items-center justify-center&quot;</span>&gt;</span>
                            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`
                <span class="hljs-attr inline">w-6</span> <span class="hljs-attr inline">h-6</span> <span class="hljs-attr inline">rounded-full</span> <span class="hljs-attr inline">border</span> <span class="hljs-attr inline">transition-all</span> <span class="hljs-attr inline">duration-300</span> <span class="hljs-attr inline">flex</span> <span class="hljs-attr inline">items-center</span> <span class="hljs-attr inline">justify-center</span> <span class="hljs-attr inline">border-foreground</span>/<span class="hljs-attr inline">40</span>
                ${<span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">rotate-90</span> <span class="hljs-attr inline">scale-110</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">rotate-0</span>&#x27;}
              `}&gt;</span>
                                {
                                    isExpanded ? (
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;relative transition-all duration-300 w-2 h-2 opacity-50 text-center flex items-center justify-center text-foreground&quot;</span>
                                            <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{transform:</span> &#x27;<span class="hljs-attr inline">translateY</span>(<span class="hljs-attr inline">-1px</span>)&#x27;}}
                                        &gt;</span>×<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                    ) : (
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;transition-all duration-300 w-1 h-1 opacity-50 rounded-full bg-foreground&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                    )
                                }

                            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

            {/* ==================== Circular Menu ==================== */}
            {isExpanded &amp;&amp; (
                <span class="hljs-tag inline">&lt;&gt;</span>
                    {/* Background overlay */}
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                        <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;fixed inset-0 z-40 backdrop-blur-md transition-all duration-300 bg-background/20&quot;</span>
                        <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{handleBackdropClick}</span>
                    &gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

                    {/* Circular layout menu items */}
                    {allMenuItems.map((item, index) =&gt; {
                        const circularPos = getCircularPosition(index, allMenuItems.length);

                        if (item.type === &#x27;section&#x27;) {
                            const section = item.section!;

                            return (
                                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                                    <span class="hljs-attr inline">key</span>=<span class="hljs-string inline">{section.id}</span>
                                    <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{item.action}</span>
                                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`${<span class="hljs-attr inline">getUniformButtonStyles</span>()} <span class="hljs-attr inline">w-28</span> <span class="hljs-attr inline">h-14</span> ${<span class="hljs-attr inline">item.isActive</span> ? &#x27;<span class="hljs-attr inline">ring-2</span> <span class="hljs-attr inline">ring-blue-400</span>/<span class="hljs-attr inline">60</span> <span class="hljs-attr inline">scale-105</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;&#x27;}`}
                                    <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                        <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">circularPos.x</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">circularPos.y</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">animationDelay:</span> `${<span class="hljs-attr inline">index</span> * <span class="hljs-attr inline">120</span>}<span class="hljs-attr inline">ms</span>`
                                    }}
                                &gt;</span>
                                    {/* Section content */}
                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                                        <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute inset-0 flex flex-col items-center justify-center text-foreground&quot;</span>&gt;</span>
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;text-sm font-bold leading-tight text-center&quot;</span>&gt;</span>
                                            {section.label}
                                        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;text-xs opacity-70 mt-0.5 font-medium&quot;</span>&gt;</span>
                                            {section.description}
                                        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
                                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">ActiveIndicator</span> <span class="hljs-attr inline">isActive</span>=<span class="hljs-string inline">{item.isActive}/</span>&gt;</span>
                                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                            );
                        } else if (item.type === &#x27;theme&#x27;) {
                            return (
                                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                                    <span class="hljs-attr inline">key</span>=<span class="hljs-string inline">&quot;theme&quot;</span>
                                    <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{item.action}</span>
                                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{getThemeButtonStyles()}</span>
                                    <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                        <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">circularPos.x</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">circularPos.y</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">animationDelay:</span> `${<span class="hljs-attr inline">index</span> * <span class="hljs-attr inline">120</span>}<span class="hljs-attr inline">ms</span>`
                                    }}
                                &gt;</span>
                                    {/* Theme toggle icon */}
                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;flex items-center justify-center h-full&quot;</span>&gt;</span>
                                        {theme === &#x27;dark&#x27; ? <span class="hljs-tag inline">&lt;<span class="hljs-name inline">SunIcon</span>/&gt;</span> : <span class="hljs-tag inline">&lt;<span class="hljs-name inline">MoonIcon</span>/&gt;</span>}
                                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                            );
                        } else { // locale toggle
                            return (
                                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                                    <span class="hljs-attr inline">key</span>=<span class="hljs-string inline">&quot;locale&quot;</span>
                                    <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{item.action}</span>
                                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{getThemeButtonStyles()}</span>
                                    <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                        <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">circularPos.x</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">circularPos.y</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">animationDelay:</span> `${<span class="hljs-attr inline">index</span> * <span class="hljs-attr inline">120</span>}<span class="hljs-attr inline">ms</span>`
                                    }}
                                &gt;</span>
                                    {/* Language toggle icon */}
                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;flex items-center justify-center h-full&quot;</span>&gt;</span>
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">LocaleIcon</span>/&gt;</span>
                                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                            );
                        }
                    })}
                <span class="hljs-tag inline">&lt;/&gt;</span></span>
            )}

            {<span class="hljs-comment inline">/* ==================== CSS Animation Definitions ==================== */</span>}
            &lt;style jsx&gt;{<span class="hljs-string inline">`
                @keyframes menuItemAppear {
                    0% {
                        opacity: 0;
                        transform: scale(0) translate(-50%, -50%);
                    }
                    50% {
                        opacity: 0.7;
                        transform: scale(0.8) translate(-25%, -25%);
                    }
                    100% {
                        opacity: 1;
                        transform: scale(1) translate(0%, 0%);
                    }
                }

                @keyframes menuItemDisappear {
                    0% {
                        opacity: 1;
                        transform: scale(1) translate(0%, 0%);
                    }
                    50% {
                        opacity: 0.3;
                        transform: scale(0.6) translate(-25%, -25%);
                    }
                    100% {
                        opacity: 0;
                        transform: scale(0) translate(-50%, -50%);
                    }
                }

                .menu-item {
                    animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
                }
            `</span>}&lt;/style&gt;
        &lt;/&gt;
    );
}
</code></pre>
            </div>
        
<h3 id="core-algorithm-flow-diagram" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#core-algorithm-flow-diagram" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Core Algorithm Flow Diagram">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Core Algorithm Flow Diagram
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="User%20Interaction%20%E2%86%92%20Event%20Judgment%20%E2%86%92%20State%20Update%20%E2%86%92%20Position%20Calculation%20%E2%86%92%20Visual%20Feedback%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AMouse%20Down%20%20%20%20%20%20Drag%2FClick%20%20%20%20%20%20isDragging%20%20%20%20%20dragOffset%20%20%20%20%20%20%20%20%20Ripple%20Effect%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AMouse%20Move%20%20%20%20%20%20Distance%20Calc%20%20%20position%20Update%20%20Debounced%20Update%20%20Real-time%20Feedback%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AMouse%20Up%20%20%20%20%20%20%20%20Snapping%20Algo%20%20%20Boundary%20Constraint%20Menu%20Expand%20%20%20%20Animation%20Transition">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-variable inline">User</span> <span class="hljs-variable inline">Interaction</span> → <span class="hljs-variable inline">Event</span> <span class="hljs-variable inline">Judgment</span> → <span class="hljs-variable inline">State</span> <span class="hljs-built_in inline">Update</span> → <span class="hljs-built_in inline">Position</span> <span class="hljs-variable inline">Calculation</span> → <span class="hljs-variable inline">Visual</span> <span class="hljs-variable inline">Feedback</span>
    ↓                ↓               ↓              ↓                  ↓
<span class="hljs-variable inline">Mouse</span> <span class="hljs-built_in inline">Down</span>      <span class="hljs-variable inline">Drag</span><span class="hljs-operator inline">/</span><span class="hljs-variable inline">Click</span>      <span class="hljs-variable inline">isDragging</span>     <span class="hljs-variable inline">dragOffset</span>         <span class="hljs-variable inline">Ripple</span> <span class="hljs-variable inline">Effect</span>
    ↓                ↓               ↓              ↓                  ↓
<span class="hljs-variable inline">Mouse</span> <span class="hljs-variable inline">Move</span>      <span class="hljs-variable inline">Distance</span> <span class="hljs-variable inline">Calc</span>   <span class="hljs-variable inline">position</span> <span class="hljs-built_in inline">Update</span>  <span class="hljs-variable inline">Debounced</span> <span class="hljs-built_in inline">Update</span>  <span class="hljs-built_in inline">Real</span><span class="hljs-operator inline">-</span><span class="hljs-variable inline">time</span> <span class="hljs-variable inline">Feedback</span>
    ↓                ↓               ↓              ↓                  ↓
<span class="hljs-variable inline">Mouse</span> <span class="hljs-built_in inline">Up</span>        <span class="hljs-variable inline">Snapping</span> <span class="hljs-variable inline">Algo</span>   <span class="hljs-variable inline">Boundary</span> <span class="hljs-variable inline">Constraint</span> <span class="hljs-built_in inline">Menu</span> <span class="hljs-built_in inline">Expand</span>    <span class="hljs-variable inline">Animation</span> <span class="hljs-variable inline">Transition</span>
</code></pre>
            </div>
        
<h3 id="key-algorithm-analysis" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#key-algorithm-analysis" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Key Algorithm Analysis">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Key Algorithm Analysis
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">1. Edge Snapping Core Algorithm</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Key%3A%20Calculate%20distance%20to%20four%20edges%2C%20move%20to%20nearest%20boundary%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20Determine%20snap%20direction%20based%20on%20minimum%20distance%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20Snap%20to%20left%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Key: Calculate distance to four edges, move to nearest boundary</span>
<span class="hljs-keyword inline">const</span> distanceToLeft = currentPos.<span class="hljs-property inline">x</span>;
<span class="hljs-keyword inline">const</span> distanceToRight = windowWidth - currentPos.<span class="hljs-property inline">x</span>;
<span class="hljs-keyword inline">const</span> distanceToTop = currentPos.<span class="hljs-property inline">y</span>;
<span class="hljs-keyword inline">const</span> distanceToBottom = windowHeight - currentPos.<span class="hljs-property inline">y</span>;
<span class="hljs-keyword inline">const</span> minDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);

<span class="hljs-comment inline">// Determine snap direction based on minimum distance</span>
<span class="hljs-keyword inline">if</span> (minDistance === distanceToLeft) {
    newPos.<span class="hljs-property inline">x</span> = margin;  <span class="hljs-comment inline">// Snap to left</span>
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">2. Circular Layout Mathematical Calculation</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Key%3A%20Polar%20coordinate%20conversion%20%2B%20angle%20division%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%20%20%2F%2F%20Angle%20calculation%0Aconst%20x%20%3D%20centerX%20%2B%20Math.cos(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20X%20coordinate%20conversion%0Aconst%20y%20%3D%20centerY%20%2B%20Math.sin(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Y%20coordinate%20conversion">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Key: Polar coordinate conversion + angle division</span>
<span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;  <span class="hljs-comment inline">// Angle calculation</span>
<span class="hljs-keyword inline">const</span> x = centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius;               <span class="hljs-comment inline">// X coordinate conversion</span>
<span class="hljs-keyword inline">const</span> y = centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius;               <span class="hljs-comment inline">// Y coordinate conversion</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">3. Debounced Drag Optimization</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Key%3A%20Immediate%20feedback%20%2B%20delayed%20update%0ApendingPositionRef.current%20%3D%20newPos%3B%20%20%20%20%20%2F%2F%20Store%20pending%20position%0AsetShowRipple(true)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Show%20immediate%20feedback%0AsetTimeout(()%20%3D%3E%20%7B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Debounced%20update%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Key: Immediate feedback + delayed update</span>
pendingPositionRef.<span class="hljs-property inline">current</span> = newPos;     <span class="hljs-comment inline">// Store pending position</span>
<span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">true</span>);                     <span class="hljs-comment inline">// Show immediate feedback</span>
<span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {                       <span class="hljs-comment inline">// Debounced update</span>
    <span class="hljs-title function_ inline">setPosition</span>(newPos);
    <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);
}, <span class="hljs-number inline">500</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">4. Drag Distance Determination</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Key%3A%20Euclidean%20distance%20calculation%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%20%20%2F%2F%203%20pixel%20threshold%20filters%20hand%20tremor%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Key: Euclidean distance calculation</span>
<span class="hljs-keyword inline">const</span> dragDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sqrt</span>(
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientX</span> - dragStartPosition.<span class="hljs-property inline">x</span>, <span class="hljs-number inline">2</span>) +
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientY</span> - dragStartPosition.<span class="hljs-property inline">y</span>, <span class="hljs-number inline">2</span>)
);
<span class="hljs-keyword inline">if</span> (dragDistance &gt; <span class="hljs-number inline">3</span>) {  <span class="hljs-comment inline">// 3 pixel threshold filters hand tremor</span>
    hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">true</span>;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><em class="italic text-foreground">May your navigation be as stable as the North Star, as dynamic as a meteor.</em> ✨</p>
</div></article><footer class="mt-16 pt-8 border-t border-foreground/20"><div class="flex items-center justify-between"><a class="inline-flex items-center px-4 py-2 bg-primary text-foreground rounded-lg hover:bg-primary/90 transition-colors" href="/documents/">documents.backToDocuments</a><div class="text-sm text-foreground/60"><span>documents.byAuthor<!-- --> <!-- -->MilkWind</span></div></div></footer></div></div><!--$--><!--/$--><!--$--><!--/$--><!--/$--><!--/$--><script src="/_next/static/chunks/webpack-18c0f30037e967de.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[38735,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n3:I[19945,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n4:I[65337,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n5:I[96190,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"ClientProviders\"]\n6:I[87555,[],\"\"]\n7:I[51901,[\"8039\",\"static/chunks/app/error-dda32be1d095a86c.js\"],\"default\"]\n8:I[31295,[],\"\"]\n9:I[6874,[\"6874\",\"static/chunks/6874-fbe9a08eb79b991c.js\",\"4345\",\"static/chunks/app/not-found-9ff98b2ccf24cac7.js\"],\"\"]\na:I[94970,[],\"ClientSegmentRoot\"]\nb:I[44065,[\"206\",\"static/chunks/206-4f4cbf4d7156f437.js\",\"3092\",\"static/chunks/app/documents/layout-28408791defde09e.js\"],\"default\"]\ne:I[59665,[],\"MetadataBoundary\"]\n10:I[59665,[],\"OutletBoundary\"]\n13:I[74911,[],\"AsyncMetadataOutlet\"]\n15:I[39460,[\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"8610\",\"static/chunks/8610-7bd3f91f3cf2a4d6.js\",\"5650\",\"static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js\"],\"default\"]\n16:I[88610,[\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"8610\",\"static/chunks/8610-7bd3f91f3cf2a4d6.js\",\"4209\",\"static/chunks/app/loading-68f227fb49b3ac8c.js\"],\"default\"]\n17:I[59665,[],\"ViewportBoundary\"]\n19:I[26614,[],\"\"]\n:HL[\"/_next/static/css/f034c804622acb16.css\",\"style\"]\n:HL[\"/_next/static/css/b226d7ef8e491b72.css\",\"style\"]\n:HL[\"/_next/static/css/5eacd01f773eed7f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"VBTZvHNp6tlBlJCFUsE6O\",\"p\":\"\",\"c\":[\"\",\"documents\",\"en\",\"light\",\"personal-website\",\"float-navigation\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"documents\",{\"children\":[[\"slug\",\"en/light/personal-website/float-navigation\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f034c804622acb16.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b226d7ef8e491b72.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_d4c88d __variable_7b4e2b __variable_c3272d font-sans antialiased min-h-screen bg-background text-foreground\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$7\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"z-10 relative min-h-screen flex items-center justify-center bg-background p-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"text-center max-w-md\",\"children\":[[\"$\",\"div\",null,{\"className\":\"text-8xl font-bold text-primary mb-4\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold text-foreground mb-4\",\"children\":\"Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"text-foreground/70 mb-8\",\"children\":\"The page you're looking for doesn't exist or has been moved to a different location.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col sm:flex-row gap-4 justify-center\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"className\":\"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors\",\"children\":\"Go Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/works\",\"className\":\"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors\",\"children\":\"View Works\"}]]}],[\"$\",\"div\",null,{\"className\":\"absolute inset-0 overflow-hidden pointer-events-none -z-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float\"}],[\"$\",\"div\",null,{\"className\":\"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float\",\"style\":{\"animationDelay\":\"1s\"}}],[\"$\",\"div\",null,{\"className\":\"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float\",\"style\":{\"animationDelay\":\"2s\"}}]]}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]}]]}],{\"children\":[\"documents\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$La\",null,{\"Component\":\"$b\",\"slots\":{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"params\":{},\"promise\":\"$@c\"}]]}],{\"children\":[[\"slug\",\"en/light/personal-website/float-navigation\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$Ld\",[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5eacd01f773eed7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L10\",null,{\"children\":[\"$L11\",\"$L12\",[\"$\",\"$L13\",null,{\"promise\":\"$@14\"}]]}]]}],{},null,false]},null,false]},[[\"$\",\"$L15\",\"l\",{}],[],[]],false]},[[\"$\",\"$L16\",\"l\",{}],[],[]],false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"aiL6BJyVuNZShceGDtg6k\",{\"children\":[[\"$\",\"$L17\",null,{\"children\":\"$L18\"}],null]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$19\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"1a:\"$Sreact.suspense\"\n1b:I[74911,[],\"AsyncMetadata\"]\nc:{}\nf:[\"$\",\"$1a\",null,{\"fallback\":null,\"children\":[\"$\",\"$L1b\",null,{\"promise\":\"$@1c\"}]}]\n"])</script><script>self.__next_f.push([1,"1d:I[57340,[\"5584\",\"static/chunks/b498d07c-095637f0f10883c6.js\",\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"6874\",\"static/chunks/6874-fbe9a08eb79b991c.js\",\"9554\",\"static/chunks/9554-b714f9de28e85d30.js\",\"1873\",\"static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js\"],\"DocumentPageClient\"]\n1e:T40eda,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"floating-navigation-ball-from-mathematical-principles-to-interactive-implementation\" class=\"group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#floating-navigation-ball-from-mathematical-principles-to-interactive-implementation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Floating Navigation Ball: From Mathematical Principles to Interactive Implementation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Floating Navigation Ball: From Mathematical Principles to Interactive Implementation\n        \u003c/h1\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eWhen writing the navigation bar menu, I was thinking, how can I express modernity and tech-savviness while breaking through traditional layout? How about creating a floating ball type navigation bar? …So I did just that.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eImagine if your website navigation could be like an intelligent assistant, quietly staying in the corner when not needed, gracefully sliding to the center of the screen to unfold all functions when required, and obediently returning to its original position after use… Yeah, that sounds pretty nice.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis floating navigation ball integrates complex interaction logic: draggable, snappable to screen edges, expandable into a circular menu, plus smooth animation transitions. In this article, I’ll start from the most basic coordinate calculations and gradually dive deep into every implementation detail, comprehensively analyzing this seemingly simple yet complex interactive system.\u003c/p\u003e\n\u003ch2 id=\"state-management\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#state-management\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to State Management\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            State Management\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eAny complex interactive system requires carefully designed state management, and our floating navigation ball is no exception. Let’s first quickly review the overall state members:\u003c/p\u003e\n\u003ch3 id=\"state-definition\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#state-definition\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to State Definition\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            State Definition\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eWhy do we need so many state variables? Because each state carries specific responsibilities, and together they constitute a complete interactive ecosystem.\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [mounted, setMounted] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isExpanded, setIsExpanded] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [originalPosition, setOriginalPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isDragging, setIsDragging] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragOffset, setDragOffset] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragStartPosition, setDragStartPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [showRipple, setShowRipple] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"core-state-breakdown\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#core-state-breakdown\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Core State Breakdown\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Core State Breakdown\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eLet me explain the purpose of each state one by one:\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emounted\u003c/strong\u003e: This is a “fuse” state. In the world of server-side rendering, \u003ccode\u003ewindow.innerWidth\u003c/code\u003e is undefined during initial rendering, so we need to wait until the component is actually mounted in the browser before performing position calculations.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eisExpanded\u003c/strong\u003e: The “switch” state of the navigation ball. \u003ccode\u003efalse\u003c/code\u003e means it’s a small ball, \u003ccode\u003etrue\u003c/code\u003e means it expands into a circular menu. This state controls the entire UI morphology change.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eposition\u003c/strong\u003e: Current real-time position coordinates. This is the core of the entire drag system, all position changes are reflected here.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eoriginalPosition\u003c/strong\u003e: “The remembered home.” When the navigation ball expands, it moves to the screen center, but we need to remember its original position so it can return there when collapsed.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eisDragging\u003c/strong\u003e: A flag for drag state. \u003ccode\u003etrue\u003c/code\u003e when the user presses the mouse to start dragging, \u003ccode\u003efalse\u003c/code\u003e when releasing the mouse. This state affects mouse event listening and visual feedback.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edragOffset\u003c/strong\u003e: This is the most easily overlooked yet most important state. It records the offset of the mouse click position relative to the top-left corner of the navigation ball, ensuring the ball doesn’t “jump” to the mouse position during dragging.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edragStartPosition\u003c/strong\u003e: The recorder of the drag starting point. We need it to calculate drag distance and distinguish between “click” and “actual drag.”\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eshowRipple\u003c/strong\u003e: The switch for visual feedback. Shows ripple effects during dragging, letting users know “I’m moving this thing.”\u003c/p\u003e\n\u003ch3 id=\"state-machine-design\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#state-machine-design\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to State Machine Design\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            State Machine Design\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe relationships between these states form a complex state machine:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"\" data-code=\"Normal%20State%20%E2%86%90%E2%86%92%20Drag%20State%20%E2%86%92%20Snap%20State%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%91%0AExpanded%20State%20%E2%86%90-----------------%E2%94%98\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ecode\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode\u003eNormal State ←→ Drag State → Snap State\n    ↓                            ↑\nExpanded State ←\u003cspan class=\"hljs-comment inline\"\u003e-----------------┘\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eKey state transition logic:\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eNormal→Drag\u003c/strong\u003e: \u003ccode\u003emouseDown\u003c/code\u003e event triggers, simultaneously setting \u003ccode\u003eisDragging=true\u003c/code\u003e and recording initial offset\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eDrag→Snap\u003c/strong\u003e: \u003ccode\u003emouseUp\u003c/code\u003e event triggers, executing edge snapping algorithm\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eNormal→Expanded\u003c/strong\u003e: Click event triggers (non-drag), moves to screen center\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eExpanded→Normal\u003c/strong\u003e: Click again or click background, returns to original position\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe elegance of this state machine lies in its ability to correctly handle edge cases, such as users quickly clicking during drag, or starting to drag in expanded state, etc.\u003c/p\u003e\n\u003ch2 id=\"coordinate-system-and-position-recording\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#coordinate-system-and-position-recording\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Coordinate System and Position Recording\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Coordinate System and Position Recording\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eIn the browser world, there are many coordinate systems to choose from, and our choice determines the complexity and performance of the entire system.\u003c/p\u003e\n\u003ch3 id=\"coordinate-system-choice\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#coordinate-system-choice\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Coordinate System Choice\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Coordinate System Choice\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eI chose the absolute positioning (\u003ccode\u003eposition: fixed\u003c/code\u003e) + \u003ccode\u003eleft/top\u003c/code\u003e properties approach, rather than the more modern \u003ccode\u003etransform\u003c/code\u003e approach. Why?\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20The%20approach%20we%20use%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0A%7D%7D%0A%2F%2F%20Instead%20of%20this%0Astyle%3D%7B%7B%0Atransform%3A%20%60translate(%24%7Bposition.x%7Dpx%2C%20%24%7Bposition.y%7Dpx)%60%0A%7D%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// The approach we use\u003c/span\u003e\nstyle={{\n    \u003cspan class=\"hljs-attr inline\"\u003eleft\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`\u003cspan class=\"hljs-subst inline\"\u003e${position.x}\u003c/span\u003epx`\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr inline\"\u003etop\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`\u003cspan class=\"hljs-subst inline\"\u003e${position.y}\u003c/span\u003epx`\u003c/span\u003e,\n}}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// Instead of this\u003c/span\u003e\nstyle={{\n    \u003cspan class=\"hljs-attr inline\"\u003etransform\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`translate(\u003cspan class=\"hljs-subst inline\"\u003e${position.x}\u003c/span\u003epx, \u003cspan class=\"hljs-subst inline\"\u003e${position.y}\u003c/span\u003epx)`\u003c/span\u003e\n}}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cdel class=\"line-through opacity-60\"\u003e(Mainly because I’m lazy)\u003c/del\u003e The reason is simple: \u003cstrong class=\"font-bold text-foreground\"\u003ecomputational simplicity\u003c/strong\u003e. When using \u003ccode\u003eleft/top\u003c/code\u003e, coordinate values directly correspond to screen positions, and we can directly use \u003ccode\u003egetBoundingClientRect()\u003c/code\u003e to get element positions for calculations. When using \u003ccode\u003etransform\u003c/code\u003e, the actual rendered position and the position recorded in CSS might be inconsistent, adding computational complexity.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eAlthough \u003ccode\u003etransform\u003c/code\u003e performs better in some cases (GPU acceleration), for a single navigation ball, this performance difference is negligible. Sometimes, simplicity is beauty.\u003c/p\u003e\n\u003ch3 id=\"position-initialization-strategy\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#position-initialization-strategy\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Position Initialization Strategy\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Position Initialization Strategy\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20initialX%20%3D%20window.innerWidth%20-%2080%3B%0Aconst%20initialY%20%3D%20100%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e80\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialY = \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003ewindow.innerWidth - 80\u003c/code\u003e ensures the ball is completely within the screen, 80px is the ball size plus some margin, ensuring the floating navigation ball has high initial visibility on various devices.\u003c/p\u003e\n\u003ch3 id=\"mathematical-principles-of-dragoffset\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#mathematical-principles-of-dragoffset\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Mathematical Principles of dragOffset\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Mathematical Principles of dragOffset\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis is the most error-prone part of the entire drag system. Let me illustrate with an example:\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eSuppose the navigation ball’s top-left corner position is \u003ccode\u003e(100, 50)\u003c/code\u003e, and the user clicks at the center of the ball \u003ccode\u003e(132, 82)\u003c/code\u003e to start dragging (the ball size is 64x64px).\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20132%20-%20100%20%3D%2032%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%2082%20-%2050%20%3D%2032%0A%7D)%3B%0A%7D%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e rect = ballRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e?.\u003cspan class=\"hljs-title function_ inline\"\u003egetBoundingClientRect\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (rect) {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetDragOffset\u003c/span\u003e({\n            \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// 132 - 100 = 32\u003c/span\u003e\n            \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003etop\u003c/span\u003e    \u003cspan class=\"hljs-comment inline\"\u003e// 82 - 50 = 32\u003c/span\u003e\n        });\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eNow, when the mouse moves to \u003ccode\u003e(200, 150)\u003c/code\u003e, the new ball position should be:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%20%20%2F%2F%20200%20-%2032%20%3D%20168%0Ay%3A%20e.clientY%20-%20dragOffset.y%20%20%20%2F%2F%20150%20-%2032%20%3D%20118%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPos = {\n    \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// 200 - 32 = 168\u003c/span\u003e\n    \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e   \u003cspan class=\"hljs-comment inline\"\u003e// 150 - 32 = 118\u003c/span\u003e\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis way, the ball’s center will follow the mouse without producing a “jump” effect. If we didn’t have the final correction of -32 pixels, when dragging actually occurs, the cursor would point to the ball’s top-left corner instead of the ball center, causing drag offset errors.\u003c/p\u003e\n\u003ch2 id=\"drag-system-implementation\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#drag-system-implementation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Drag System Implementation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Drag System Implementation\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe drag system is the core functionality of the entire navigation ball, requiring handling of complex event sequences and state changes.\u003c/p\u003e\n\u003ch3 id=\"drag-lifecycle\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#drag-lifecycle\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Drag Lifecycle\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Drag Lifecycle\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eA complete drag operation includes three phases:\u003c/p\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emouseDown\u003c/strong\u003e: Initialize drag state\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emouseMove\u003c/strong\u003e: Continuously update position\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emouseUp\u003c/strong\u003e: End drag and execute subsequent logic\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eEach phase has its specific responsibilities and processing logic.\u003c/p\u003e\n\u003ch3 id=\"debounced-animation-implementation\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#debounced-animation-implementation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Debounced Animation Implementation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Debounced Animation Implementation\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eTraditional drag implementations immediately update position on every \u003ccode\u003emouseMove\u003c/code\u003e, but this causes performance issues and visual jitter. I adopted a debouncing strategy:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20Calculate%20new%20position%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20Store%20pending%20position%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20Immediately%20show%20ripple%20effect%0AsetShowRipple(true)%3B%0A%2F%2F%20Clear%20existing%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20Set%20new%20debounce%20timer%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%7D%2C%20%5BisDragging%2C%20dragOffset%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseMove = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Calculate new position\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPos = {\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Store pending position\u003c/span\u003e\n    pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = newPos;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Immediately show ripple effect\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Clear existing debounce timer\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Set new debounce timer\u003c/span\u003e\n    debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(newPos);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n    }, \u003cspan class=\"hljs-number inline\"\u003e500\u003c/span\u003e);\n}, [isDragging, dragOffset]);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eNote:\u003c/strong\u003e I used \u003ccode\u003eref\u003c/code\u003e instead of \u003ccode\u003estate\u003c/code\u003e to store the pending position, because \u003ccode\u003euseState\u003c/code\u003e updates are asynchronous. When I use asynchronous state updates, there are read value hazards, i.e., when I read the “updated” value, the asynchronous update hasn’t completed yet, so I’m actually reading the pre-update value, causing abnormal results. \u003ccode\u003eref\u003c/code\u003e updates are synchronous and don’t have thread safety issues, meaning the value I read “after update” is indeed the post-update value.\u003c/p\u003e\n\u003ch3 id=\"drag-distance-determination\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#drag-distance-determination\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Drag Distance Determination\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Drag Distance Determination\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eHow to distinguish between “click” and \u0026quot;drag\u0026quot;? This is a classic UI interaction problem. My solution is based on Euclidean distance:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Record%20drag%20start%20position%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20Calculate%20distance%20in%20mouseMove%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Record drag start position\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetDragStartPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e});\n\n\u003cspan class=\"hljs-comment inline\"\u003e// Calculate distance in mouseMove\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e dragDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esqrt\u003c/span\u003e(\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) +\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e)\n);\n\n\u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (dragDistance \u0026gt; \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) {\n    hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eOnly when the floating navigation ball moves more than 3 pixels is it considered “dragging,” otherwise it’s considered a “click.” Generally, natural hand tremor is usually within 1-2 pixels, so 3 pixels can effectively filter out these unintentional micro-movements while not hindering genuine drag intentions.\u003c/p\u003e\n\u003ch3 id=\"intelligent-handling-of-drag-end\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#intelligent-handling-of-drag-end\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Intelligent Handling of Drag End\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Intelligent Handling of Drag End\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20Clear%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0A%2F%2F%20Significant%20drag%20-%20execute%20snapping%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%0A%7D%0A%2F%2F%20Reset%20drag%20flag%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseUp = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Clear debounce timer\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    }\n\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment inline\"\u003e// Significant drag - execute snapping\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snappedPos = \u003cspan class=\"hljs-title function_ inline\"\u003esnapToEdge\u003c/span\u003e(pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(snappedPos);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(snappedPos);\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Reset drag flag\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n    }, \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e);\n}, [isDragging]);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThere’s a detail here: why delay resetting the drag flag by 100ms? Because \u003ccode\u003emouseUp\u003c/code\u003e and \u003ccode\u003eclick\u003c/code\u003e events have timing differences. If reset immediately, the click event might be incorrectly processed as a post-drag click. The 100ms delay ensures correct event processing order.\u003c/p\u003e\n\u003ch2 id=\"edge-snapping-algorithm\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#edge-snapping-algorithm\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Edge Snapping Algorithm\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Edge Snapping Algorithm\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe snapping effect is a user-friendly design that ensures when you “let go” of the navigation ball, it automatically stops at a fixed distance from the screen edge, solving the core pain point of visually obsessive users. \u003cdel class=\"line-through opacity-60\"\u003e(Like me)\u003c/del\u003e\u003c/p\u003e\n\u003ch3 id=\"core-logic-of-snapping-algorithm\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#core-logic-of-snapping-algorithm\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Core Logic of Snapping Algorithm\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Core Logic of Snapping Algorithm\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe mathematical principle of snapping is actually simple: calculate the distance from the current position to four boundaries, then move to the nearest boundary:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%2F%2F%20Ball%20size%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%2F%2F%20Distance%20from%20edge%0A%2F%2F%20Calculate%20distances%20to%20four%20boundaries%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20Find%20minimum%20distance%0Aconst%20minDistance%20%3D%20Math.min(%0AdistanceToLeft%2C%0AdistanceToRight%2C%0AdistanceToTop%2C%0AdistanceToBottom%0A)%3B%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20Decide%20snap%20direction%20based%20on%20minimum%20distance%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%0A%7D%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snapToEdge = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ecurrentPos\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowWidth = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowHeight = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e ballSize = \u003cspan class=\"hljs-number inline\"\u003e70\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Ball size\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e margin = \u003cspan class=\"hljs-number inline\"\u003e20\u003c/span\u003e;    \u003cspan class=\"hljs-comment inline\"\u003e// Distance from edge\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Calculate distances to four boundaries\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToLeft = currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToRight = windowWidth - currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToTop = currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToBottom = windowHeight - currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Find minimum distance\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e minDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(\n        distanceToLeft, \n        distanceToRight, \n        distanceToTop, \n        distanceToBottom\n    );\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003elet\u003c/span\u003e newPos = {...currentPos};\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Decide snap direction based on minimum distance\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToLeft) {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = margin;\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToRight) {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = windowWidth - ballSize - margin;\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToTop) {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = margin;\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = windowHeight - ballSize - margin;\n    }\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e newPos;\n}, []);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"mathematical-principles-of-boundary-calculation\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#mathematical-principles-of-boundary-calculation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Mathematical Principles of Boundary Calculation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Mathematical Principles of Boundary Calculation\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eDistance calculation explanation:\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToLeft\u003c/strong\u003e: Directly equals \u003ccode\u003ecurrentPos.x\u003c/code\u003e, because the left boundary is x=0\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToRight\u003c/strong\u003e: \u003ccode\u003ewindowWidth - currentPos.x\u003c/code\u003e, because the right boundary is window width\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToTop\u003c/strong\u003e: Directly equals \u003ccode\u003ecurrentPos.y\u003c/code\u003e, because the top boundary is y=0\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToBottom\u003c/strong\u003e: \u003ccode\u003ewindowHeight - currentPos.y\u003c/code\u003e, because the bottom boundary is window height\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003eMath.min()\u003c/code\u003e finds the smallest of these four values, corresponding to the nearest boundary.\u003c/p\u003e\n\u003ch3 id=\"boundary-constraint-implementation\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#boundary-constraint-implementation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Boundary Constraint Implementation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Boundary Constraint Implementation\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis is a protective logic to prevent boundary overflow:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"newPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003enewPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowWidth - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e));\nnewPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowHeight - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e));\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e“Double clamping” strategy:\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003ccode\u003eMath.min()\u003c/code\u003e ensures position doesn’t exceed right and bottom boundaries\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003ccode\u003eMath.max()\u003c/code\u003e ensures position doesn’t go below left and top boundaries\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis way, regardless of what position the algorithm calculates, the final coordinates will be strictly limited within the safe range.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eWhy do we need \u003ccode\u003eballSize\u003c/code\u003e? Because CSS’s \u003ccode\u003eleft\u003c/code\u003e and \u003ccode\u003etop\u003c/code\u003e properties position the element’s top-left corner, not the center point. If we don’t consider the ball’s size, part of the ball might run off-screen.\u003c/p\u003e\n\u003ch2 id=\"expandcollapse-animation-system\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#expandcollapse-animation-system\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Expand/Collapse Animation System\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Expand/Collapse Animation System\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe expansion and collapse of the navigation ball is an animated process with transition effects, involving position movement, state switching, and timing control.\u003c/p\u003e\n\u003ch3 id=\"center-positioning-algorithm\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#center-positioning-algorithm\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Center Positioning Algorithm\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Center Positioning Algorithm\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eWhen the user clicks the navigation ball, it needs to move to the screen center for expansion:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n\u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY});\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eWhy subtract 35\u003c/strong\u003e? Because the navigation ball is 70px in size. If we want the ball’s \u003cstrong class=\"font-bold text-foreground\"\u003ecenter\u003c/strong\u003e to align with the screen center, we need to offset left and up by half the ball’s size (70/2 = 35px).\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis is the difference between visual center and geometric center:\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eGeometric center\u003c/strong\u003e: The center point of the element’s bounding box\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eVisual center\u003c/strong\u003e: The element center point perceived by the human eye\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eFor circular elements, these two are consistent, so we can use geometric calculations.\u003c/p\u003e\n\u003ch3 id=\"timing-control-for-state-switching\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#timing-control-for-state-switching\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Timing Control for State Switching\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Timing Control for State Switching\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eExpand and collapse animations require precise timing control:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20Expand%3A%20first%20save%20current%20position%2C%20then%20move%20to%20center%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20Collapse%3A%20first%20set%20state%2C%20delay%20150ms%20before%20moving%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleBallClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isExpanded) {\n            \u003cspan class=\"hljs-comment inline\"\u003e// Expand: first save current position, then move to center\u003c/span\u003e\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(position);\n            \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n            \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY});\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n            \u003cspan class=\"hljs-comment inline\"\u003e// Collapse: first set state, delay 150ms before moving\u003c/span\u003e\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n            \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n            }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n        }\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThere’s a key design decision here: why delay 150ms when collapsing?\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eBecause menu item disappearing animations need time. If we immediately move the ball position while setting \u003ccode\u003eisExpanded=false\u003c/code\u003e, users would see the ball start moving while menu items are still disappearing, creating a jarring visual effect.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe 150ms delay allows the menu item disappearing animation to complete before the ball starts moving back to its original position. This timing arrangement makes the entire animation feel more coherent and natural.\u003c/p\u003e\n\u003ch3 id=\"saving-mechanism-for-originalposition\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#saving-mechanism-for-originalposition\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Saving Mechanism for originalPosition\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Saving Mechanism for originalPosition\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe timing of saving \u003ccode\u003eoriginalPosition\u003c/code\u003e is crucial:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Save%20before%20expanding%0AsetOriginalPosition(position)%3B%0A%2F%2F%20Update%20after%20drag%20ends%0AsetOriginalPosition(snappedPos)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Save before expanding\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(position);\n\n\u003cspan class=\"hljs-comment inline\"\u003e// Update after drag ends\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(snappedPos);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis ensures that regardless of whether the user dragged the ball before expanding, it returns to the correct position when collapsed. If the user drags the ball to a new position then expands, it should return to the post-drag position when collapsed, not the initial position.\u003c/p\u003e\n\u003ch2 id=\"circular-menu-layout-algorithm\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#circular-menu-layout-algorithm\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Circular Menu Layout Algorithm\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Circular Menu Layout Algorithm\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eWhen the navigation ball expands, menu items need to be evenly distributed around a circle. This is a typical polar coordinate layout problem.\u003c/p\u003e\n\u003ch3 id=\"mathematical-foundation-of-polar-coordinate-layout\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#mathematical-foundation-of-polar-coordinate-layout\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Mathematical Foundation of Polar Coordinate Layout\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Mathematical Foundation of Polar Coordinate Layout\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe core of circular layout is the conversion from polar coordinates to Cartesian coordinates:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%0A%7D%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetCircularPosition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003etotal\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003eradius\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e = \u003cspan class=\"hljs-number inline\"\u003e120\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e {\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e60\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e30\u003c/span\u003e,\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eLet me explain this algorithm line by line:\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eAngle calculation\u003c/strong\u003e: \u003ccode\u003e(2 * Math.PI * index) / total\u003c/code\u003e divides the circumference (2π radians) equally into \u003ccode\u003etotal\u003c/code\u003e parts, with each menu item occupying one part.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eStarting angle adjustment\u003c/strong\u003e: \u003ccode\u003e- Math.PI / 2\u003c/code\u003e adjusts the starting angle from 3 o’clock direction (0 radians) to 12 o’clock direction (-π/2 radians). This way the first menu item appears at the top, conforming to visual habits.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eCoordinate conversion\u003c/strong\u003e: \u003ccode\u003eMath.cos(angle) * radius\u003c/code\u003e and \u003ccode\u003eMath.sin(angle) * radius\u003c/code\u003e convert polar coordinates to Cartesian coordinates relative to the circle center.\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003ePosition offset\u003c/strong\u003e: \u003ccode\u003e- 60\u003c/code\u003e and \u003ccode\u003e- 30\u003c/code\u003e adjust the menu item positioning point. These values are calculated based on the actual size of menu items, ensuring the menu item center points are located on the circumference.\u003c/p\u003e\n\u003ch3 id=\"angle-distribution-strategy\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#angle-distribution-strategy\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Angle Distribution Strategy\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Angle Distribution Strategy\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eAssuming we have 6 menu items, their angle distribution is like this:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"\" data-code=\"Item%200%3A%20(2%CF%80%20%C3%97%200)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F2%20%20%20(12%20o'clock%20direction)%0AItem%201%3A%20(2%CF%80%20%C3%97%201)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F6%20%20%20(2%20o'clock%20direction)%0AItem%202%3A%20(2%CF%80%20%C3%97%202)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F6%20%20%20%20(4%20o'clock%20direction)%0AItem%203%3A%20(2%CF%80%20%C3%97%203)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F2%20%20%20%20(6%20o'clock%20direction)%0AItem%204%3A%20(2%CF%80%20%C3%97%204)%20%2F%206%20-%20%CF%80%2F2%20%3D%205%CF%80%2F6%20%20%20(8%20o'clock%20direction)%0AItem%205%3A%20(2%CF%80%20%C3%97%205)%20%2F%206%20-%20%CF%80%2F2%20%3D%207%CF%80%2F6%20%20%20(10%20o'clock%20direction)\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ecode\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode\u003e\u003cspan class=\"hljs-attribute inline\"\u003eItem\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e) / \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e - π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e = -π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e12\u003c/span\u003e o\u0026#x27;clock direction)\n\u003cspan class=\"hljs-attribute inline\"\u003eItem\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e) / \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e - π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e = -π/\u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e o\u0026#x27;clock direction)\n\u003cspan class=\"hljs-attribute inline\"\u003eItem\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) / \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e - π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e = π/\u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e    (\u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e o\u0026#x27;clock direction)\n\u003cspan class=\"hljs-attribute inline\"\u003eItem\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) / \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e - π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e = π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e    (\u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e o\u0026#x27;clock direction)\n\u003cspan class=\"hljs-attribute inline\"\u003eItem\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e) / \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e - π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e = \u003cspan class=\"hljs-number inline\"\u003e5\u003c/span\u003eπ/\u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e8\u003c/span\u003e o\u0026#x27;clock direction)\n\u003cspan class=\"hljs-attribute inline\"\u003eItem\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e5\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e5\u003c/span\u003e) / \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e - π/\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e = \u003cspan class=\"hljs-number inline\"\u003e7\u003c/span\u003eπ/\u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e10\u003c/span\u003e o\u0026#x27;clock direction)\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis distribution ensures visual uniformity and symmetry of menu items.\u003c/p\u003e\n\u003ch2 id=\"keyframe-animation-system\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#keyframe-animation-system\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Keyframe Animation System\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Keyframe Animation System\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThe appearance and disappearance animations of menu items are key to ensuring smoothness.\u003c/p\u003e\n\u003ch3 id=\"css-in-js-animation-implementation\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#css-in-js-animation-implementation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to CSS-in-JS Animation Implementation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            CSS-in-JS Animation Implementation\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eI use CSS-in-JS animation definition to maintain component encapsulation:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"jsx\" data-code=\"%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejsx\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-jsx\"\u003e\u0026lt;style jsx\u0026gt;{\u003cspan class=\"hljs-string inline\"\u003e`\n    @keyframes menuItemAppear {\n        0% {\n            opacity: 0;\n            transform: scale(0) translate(-50%, -50%);\n        }\n        50% {\n            opacity: 0.7;\n            transform: scale(0.8) translate(-25%, -25%);\n        }\n        100% {\n            opacity: 1;\n            transform: scale(1) translate(0%, 0%);\n        }\n    }\n    \n    .menu-item {\n        animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n    }\n`\u003c/span\u003e}\u0026lt;/style\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThis animation contains three keyframes:\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e0%\u003c/strong\u003e: Completely transparent, zero scale, large offset\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e50%\u003c/strong\u003e: Semi-transparent, 80% scale, small offset\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e100%\u003c/strong\u003e: Completely opaque, normal scale, no offset\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eWhy include translate offset\u003c/strong\u003e? Pure scale animations would make menu items “burst” from the center point. Adding translate offset creates a “flying in from afar” dynamic effect.\u003c/p\u003e\n\u003ch3 id=\"layered-animation-delays\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#layered-animation-delays\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Layered Animation Delays\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Layered Animation Delays\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"style%3D%7B%7B%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003estyle={{\n    \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`\u003cspan class=\"hljs-subst inline\"\u003e${index * \u003cspan class=\"hljs-number inline\"\u003e120\u003c/span\u003e}\u003c/span\u003ems`\u003c/span\u003e\n}}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eEach menu item’s animation delays by 120ms, creating a “wave-like” appearance effect. Menu items don’t appear simultaneously but appear sequentially in order, like dominoes.\u003c/p\u003e\n\u003ch3 id=\"easing-function-choice\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#easing-function-choice\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Easing Function Choice\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Easing Function Choice\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003ecubic-bezier(0.4, 0, 0.2, 1)\u003c/code\u003e is the “standard” easing function from Material Design, with characteristics:\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eSlow start\u003c/strong\u003e: Acceleration is slower at the beginning, conforming to physical intuition\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eFast end\u003c/strong\u003e: Quickly reaches target state at the end, avoiding sluggishness\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eSmooth transition\u003c/strong\u003e: No abrupt speed changes throughout the process\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"event-handling-and-performance-optimization\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#event-handling-and-performance-optimization\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Event Handling and Performance Optimization\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Event Handling and Performance Optimization\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eWhen handling complex interactions, proper event management and performance optimization are essential.\u003c/p\u003e\n\u003ch3 id=\"event-listener-lifecycle-management\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#event-listener-lifecycle-management\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Event Listener Lifecycle Management\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Event Listener Lifecycle Management\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eDrag functionality requires listening to mouse events at the document level, but these listeners must be properly managed to avoid memory leaks:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"useEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20Ensure%20listeners%20are%20removed%20in%20non-drag%20state%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20handleMouseMove%2C%20handleMouseUp%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isDragging) {\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n        };\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment inline\"\u003e// Ensure listeners are removed in non-drag state\u003c/span\u003e\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n    }\n}, [isDragging, handleMouseMove, handleMouseUp]);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eDesign features:\u003c/p\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eConditional listening\u003c/strong\u003e: Only add listeners during drag state, reducing unnecessary event processing\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eAutomatic cleanup\u003c/strong\u003e: useEffect’s return function ensures cleanup when component unmounts\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eState synchronization\u003c/strong\u003e: When drag state changes, listeners update accordingly\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"performance-optimization-with-usecallback\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#performance-optimization-with-usecallback\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Performance Optimization with useCallback\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Performance Optimization with useCallback\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0A%2F%2F%20Processing%20logic...%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0A%2F%2F%20Snapping%20logic...%0A%7D%2C%20%5B%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseMove = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment inline\"\u003e// Processing logic...\u003c/span\u003e\n}, [isDragging, dragOffset, dragStartPosition]);\n\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snapToEdge = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ecurrentPos\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment inline\"\u003e// Snapping logic...\u003c/span\u003e\n}, []);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003euseCallback\u003c/code\u003e ensures these function references remain stable when dependencies don’t change, avoiding unnecessary re-renders and frequent addition/removal of event listeners.\u003c/p\u003e\n\u003ch3 id=\"event-bubbling-prevention-strategy\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#event-bubbling-prevention-strategy\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Event Bubbling Prevention Strategy\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Event Bubbling Prevention Strategy\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20Prevent%20default%20behaviors%20like%20text%20selection%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20Disable%20drag%20in%20expanded%20state%0AsetIsDragging(true)%3B%0A%2F%2F%20...%20other%20logic%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n    e.\u003cspan class=\"hljs-title function_ inline\"\u003epreventDefault\u003c/span\u003e();  \u003cspan class=\"hljs-comment inline\"\u003e// Prevent default behaviors like text selection\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isExpanded) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Disable drag in expanded state\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n    \u003cspan class=\"hljs-comment inline\"\u003e// ... other logic\u003c/span\u003e\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003ee.preventDefault()\u003c/code\u003e prevents some default browser behaviors that might interfere with dragging, such as text selection, image dragging, etc.\u003c/p\u003e\n\u003ch2 id=\"reusable-design-pattern-summary\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#reusable-design-pattern-summary\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Reusable Design Pattern Summary\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Reusable Design Pattern Summary\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003eThrough this in-depth analysis, we can extract several general design patterns that can be applied to other similar interactive systems.\u003c/p\u003e\n\u003ch3 id=\"core-design-pattern-extraction\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#core-design-pattern-extraction\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Core Design Pattern Extraction\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Core Design Pattern Extraction\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eDrag System Pattern\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%201.%20State%20initialization%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0A%2F%2F%202.%20Event%20handling%0Aconst%20handleMouseDown%20%3D%20(e)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20elementRef.current%3F.getBoundingClientRect()%3B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%0Ay%3A%20e.clientY%20-%20rect.top%0A%7D)%3B%0AsetIsDragging(true)%3B%0A%7D%3B%0A%2F%2F%203.%20Position%20update%0Aconst%20handleMouseMove%20%3D%20(e)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetPosition(%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D)%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 1. State initialization\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isDragging, setIsDragging] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragOffset, setDragOffset] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 2. Event handling\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003ee\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e rect = elementRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e?.\u003cspan class=\"hljs-title function_ inline\"\u003egetBoundingClientRect\u003c/span\u003e();\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetDragOffset\u003c/span\u003e({\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003etop\u003c/span\u003e\n    });\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n};\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 3. Position update\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseMove\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003ee\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e\n    });\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eCircular Layout Pattern\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20getCircularPosition%20%3D%20(index%2C%20total%2C%20radius%2C%20centerX%2C%20centerY)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%0A%7D%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetCircularPosition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003eindex, total, radius, centerX, centerY\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e {\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eState Machine Pattern\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Clear%20state%20definition%0Aconst%20states%20%3D%20%7B%0AIDLE%3A%20'idle'%2C%0ADRAGGING%3A%20'dragging'%2C%0AEXPANDED%3A%20'expanded'%0A%7D%3B%0A%2F%2F%20State%20transition%20logic%0Aconst%20handleStateTransition%20%3D%20(currentState%2C%20action)%20%3D%3E%20%7B%0Aswitch%20(currentState)%20%7B%0Acase%20states.IDLE%3A%0Areturn%20action%20%3D%3D%3D%20'drag'%20%3F%20states.DRAGGING%20%3A%0Aaction%20%3D%3D%3D%20'click'%20%3F%20states.EXPANDED%20%3A%20currentState%3B%0A%2F%2F%20...%20other%20state%20transitions%0A%7D%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Clear state definition\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e states = {\n    \u003cspan class=\"hljs-attr inline\"\u003eIDLE\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;idle\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr inline\"\u003eDRAGGING\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;dragging\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr inline\"\u003eEXPANDED\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;expanded\u0026#x27;\u003c/span\u003e\n};\n\n\u003cspan class=\"hljs-comment inline\"\u003e// State transition logic\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleStateTransition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003ecurrentState, action\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eswitch\u003c/span\u003e (currentState) {\n        \u003cspan class=\"hljs-keyword inline\"\u003ecase\u003c/span\u003e states.\u003cspan class=\"hljs-property inline\"\u003eIDLE\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e action === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;drag\u0026#x27;\u003c/span\u003e ? states.\u003cspan class=\"hljs-property inline\"\u003eDRAGGING\u003c/span\u003e : \n                   action === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;click\u0026#x27;\u003c/span\u003e ? states.\u003cspan class=\"hljs-property inline\"\u003eEXPANDED\u003c/span\u003e : currentState;\n        \u003cspan class=\"hljs-comment inline\"\u003e// ... other state transitions\u003c/span\u003e\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eDebounced Animation Pattern\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20%5BpendingValue%2C%20setPendingValue%5D%20%3D%20useState(null)%3B%0Aconst%20timerRef%20%3D%20useRef(null)%3B%0Aconst%20debouncedUpdate%20%3D%20(newValue)%20%3D%3E%20%7B%0AsetPendingValue(newValue)%3B%0Aif%20(timerRef.current)%20clearTimeout(timerRef.current)%3B%0AtimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetActualValue(newValue)%3B%0A%7D%2C%20delay)%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [pendingValue, setPendingValue] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e timerRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003edebouncedUpdate\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003enewValue\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPendingValue\u003c/span\u003e(newValue);\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (timerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(timerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    \n    timerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetActualValue\u003c/span\u003e(newValue);\n    }, delay);\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"best-practice-distillation\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#best-practice-distillation\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Best Practice Distillation\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Best Practice Distillation\n        \u003c/h3\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eEvent listener cleanup\u003c/strong\u003e: Always clean up event listeners in useEffect’s return function\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eCoordinate calculation boundary protection\u003c/strong\u003e: Use Math.min/max to ensure coordinates are within safe ranges\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eState synchronization\u003c/strong\u003e: Related state updates must stay synchronized, avoiding intermediate states\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eAnimation timing\u003c/strong\u003e: Complex animations must consider timing relationships between parts\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eUser feedback\u003c/strong\u003e: Even with delayed updates, provide immediate visual feedback\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"complete-source-code-analysis\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#complete-source-code-analysis\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Complete Source Code Analysis\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Complete Source Code Analysis\n        \u003c/h2\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"'use%20client'%3B%0Aimport%20React%2C%20%7BuseCallback%2C%20useEffect%2C%20useRef%2C%20useState%7D%20from%20'react'%3B%0Aimport%20%7BusePathname%2C%20useRouter%7D%20from%20'next%2Fnavigation'%3B%0Aimport%20%7BuseTheme%7D%20from%20'.%2FThemeProvider'%3B%0Aimport%20%7BuseLocaleStore%7D%20from%20'%40%2Flib%2Fstores%2FlocaleStore'%3B%0Aimport%20%7BLOCALES%7D%20from%20'%40%2Flib%2Futils%2Flocales'%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Type%20Definitions%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0Ainterface%20Position%20%7B%0Ax%3A%20number%3B%20%20%2F%2F%20X%20coordinate%0Ay%3A%20number%3B%20%20%2F%2F%20Y%20coordinate%0A%7D%0Aexport%20function%20Navigation()%20%7B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20State%20Management%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F%2F%20Basic%20states%0Aconst%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Component%20mount%20state%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Menu%20expansion%20state%0A%2F%2F%20Position-related%20states%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Current%20position%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%2F%2F%20Original%20position%20record%0A%2F%2F%20Drag-related%20states%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Drag%20state%20flag%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%20%20%20%20%20%20%20%20%2F%2F%20Drag%20offset%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%2F%2F%20Drag%20start%20position%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Show%20ripple%20effect%0A%2F%2F%20References%20and%20timers%0Aconst%20debounceTimerRef%20%3D%20useRefNodeJS.Timeout%20%7C%20null%3E(null)%3B%20%20%20%20%20%2F%2F%20Debounce%20timer%0Aconst%20hasDraggedSignificantlyRef%20%3D%20useRef(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Has%20significant%20drag%20occurred%0Aconst%20pendingPositionRef%20%3D%20useRefPosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%2F%2F%20Pending%20position%20update%0Aconst%20ballRef%20%3D%20useRefHTMLDivElement%3E(null)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Navigation%20ball%20reference%0A%2F%2F%20Next.js%20and%20theme%20hooks%0Aconst%20router%20%3D%20useRouter()%3B%0Aconst%20pathname%20%3D%20usePathname()%3B%0Aconst%20%7Btheme%2C%20toggleTheme%7D%20%3D%20useTheme()%3B%0Aconst%20%7Blocale%2C%20toggleLocale%7D%20%3D%20useLocaleStore()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Initialization%20Effect%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Initialize%20position%20when%20component%20mounts%0A*%20Calculate%20initial%20position%20during%20client-side%20rendering%2C%20avoiding%20window%20undefined%20issue%20during%20SSR%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0AsetMounted(true)%3B%0Aconst%20initialX%20%3D%20window.innerWidth%20-%2080%3B%20%20%20%2F%2F%2080px%20from%20right%20edge%0Aconst%20initialY%20%3D%20100%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20100px%20from%20top%0AsetPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0AsetOriginalPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0ApendingPositionRef.current%20%3D%20%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F**%0A*%20Clean%20up%20debounce%20timer%20to%20prevent%20memory%20leaks%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Navigation%20Configuration%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Navigation%20menu%20configuration%0A*%20Define%20all%20navigable%20pages%20and%20their%20identifiers%0A*%2F%0Aconst%20sections%20%3D%20%5B%0A%7B%0Aid%3A%20'personal'%20as%20const%2C%0Alabel%3A%20'Personal'%2C%0Adescription%3A%20'About%20Me'%2C%0Ahref%3A%20'%2Fpersonal'%0A%7D%2C%0A%7B%0Aid%3A%20'works'%20as%20const%2C%0Alabel%3A%20'Works'%2C%0Adescription%3A%20'Portfolio'%2C%0Ahref%3A%20'%2Fworks'%0A%7D%2C%0A%7B%0Aid%3A%20'contributions'%20as%20const%2C%0Alabel%3A%20'Contributions'%2C%0Adescription%3A%20'Open%20Source'%2C%0Ahref%3A%20'%2Fcontributions'%0A%7D%2C%0A%7B%0Aid%3A%20'documents'%20as%20const%2C%0Alabel%3A%20'Documents'%2C%0Adescription%3A%20'Insights'%2C%0Ahref%3A%20'%2Fdocuments'%0A%7D%2C%0A%5D%3B%0A%2F**%0A*%20Get%20active%20navigation%20item%20based%20on%20current%20path%0A*%20%40returns%20Currently%20active%20navigation%20item%20ID%20or%20null%0A*%2F%0Aconst%20getActiveSection%20%3D%20()%20%3D%3E%20%7B%0Aif%20(pathname%20%3D%3D%3D%20'%2F')%20return%20'personal'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fworks')%20return%20'works'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fcontributions')%20return%20'contributions'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fdocuments')%20return%20'documents'%3B%0Areturn%20null%3B%0A%7D%3B%0Aconst%20activeSection%20%3D%20getActiveSection()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Core%20Algorithm%3A%20Edge%20Snapping%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Edge%20snapping%20algorithm%0A*%20Calculate%20distance%20to%20four%20boundaries%20and%20move%20to%20nearest%20boundary%0A*%20%40param%20currentPos%20Current%20position%0A*%20%40returns%20Position%20after%20snapping%0A*%2F%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%20%20%2F%2F%20Navigation%20ball%20size%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%20%20%2F%2F%20Distance%20from%20edge%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20Calculate%20distances%20to%20four%20boundaries%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20Find%20minimum%20distance%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20Determine%20snap%20direction%20based%20on%20minimum%20distance%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20Snap%20to%20left%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20Snap%20to%20right%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%20%20%2F%2F%20Snap%20to%20top%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20Snap%20to%20bottom%0A%7D%0A%2F%2F%20Boundary%20constraints%3A%20ensure%20position%20is%20within%20safe%20range%0AnewPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Drag%20Event%20Handling%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Mouse%20down%20event%20handler%0A*%20Initialize%20drag%20state%2C%20record%20start%20position%20and%20offset%0A*%2F%0Aconst%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20Prevent%20default%20behaviors%20(like%20text%20selection)%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20Disable%20drag%20in%20expanded%20state%0AsetIsDragging(true)%3B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20Calculate%20mouse%20click%20position%20relative%20to%20navigation%20ball%20offset%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20Mouse%20X%20-%20ball%20left%20%3D%20X%20offset%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%20Mouse%20Y%20-%20ball%20top%20%3D%20Y%20offset%0A%7D)%3B%0A%7D%0A%7D%3B%0A%2F**%0A*%20Mouse%20move%20event%20handler%20(with%20debounce%20strategy)%0A*%20Update%20position%20in%20real-time%2C%20but%20use%20debouncing%20to%20avoid%20frequent%20rendering%0A*%2F%0Aconst%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20Calculate%20new%20position%20based%20on%20mouse%20position%20and%20initial%20offset%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20Store%20pending%20position%20(for%20debounced%20update)%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20Immediately%20show%20ripple%20effect%20for%20instant%20feedback%0AsetShowRipple(true)%3B%0A%2F%2F%20Clear%20existing%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20Set%20new%20debounce%20timer%20(500ms%20delay)%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%2F%2F%20Calculate%20drag%20distance%20to%20determine%20if%20it's%20significant%20drag%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0A%2F%2F%20Over%203%20pixels%20is%20considered%20significant%20drag%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0A%2F**%0A*%20Mouse%20up%20event%20handler%0A*%20End%20drag%20and%20execute%20snapping%20logic%0A*%2F%0Aconst%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20Clear%20debounce%20timer%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0AdebounceTimerRef.current%20%3D%20null%3B%0A%7D%0A%2F%2F%20If%20significant%20drag%20occurred%2C%20execute%20edge%20snapping%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%20%20%2F%2F%20Update%20original%20position%20record%0A%7D%0A%2F%2F%20Delay%20reset%20of%20drag%20flag%20to%20avoid%20conflict%20with%20click%20events%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Global%20Event%20Listeners%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Manage%20global%20mouse%20event%20listeners%0A*%20Only%20add%20listeners%20during%20drag%20state%20for%20performance%20optimization%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20Ensure%20listeners%20are%20removed%20in%20non-drag%20state%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Interaction%20Event%20Handling%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Navigation%20ball%20click%20event%20handler%0A*%20Toggle%20expand%2Fcollapse%20state%2C%20handle%20position%20movement%0A*%2F%0Aconst%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0A%2F%2F%20Only%20handle%20click%20when%20no%20significant%20drag%20occurred%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20Expand%3A%20save%20current%20position%2C%20move%20to%20screen%20center%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%20%20%20%2F%2F%20Center%20X%20-%20ball%20radius%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%20%20%2F%2F%20Center%20Y%20-%20ball%20radius%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20Collapse%3A%20delay%20150ms%20before%20returning%20to%20original%20position%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B%0A%2F**%0A*%20Menu%20item%20click%20event%20handler%0A*%20Execute%20action%20then%20collapse%20menu%0A*%2F%0Aconst%20handleMenuItemClick%20%3D%20(action%3A%20()%20%3D%3E%20void)%20%3D%3E%20%7B%0Aaction()%3B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F**%0A*%20Page%20navigation%20handler%0A*%2F%0Aconst%20navigateToPage%20%3D%20(href%3A%20string)%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20router.push(href))%3B%0A%7D%3B%0A%2F**%0A*%20Theme%20toggle%20handler%0A*%2F%0Aconst%20handleThemeToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20toggleTheme())%3B%0A%7D%3B%0A%2F**%0A*%20Locale%20toggle%20handler%0A*%20Support%20language%20switching%20redirect%20for%20document%20pages%0A*%2F%0Aconst%20handleLocaleToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20%7B%0AtoggleLocale((newLocale)%20%3D%3E%20%7B%0A%2F%2F%20Check%20if%20on%20document%20page%2C%20redirect%20to%20same%20article%20in%20new%20language%0Aif%20(pathname.startsWith('%2Fdocuments%2F'))%20%7B%0Aconst%20pathSegments%20%3D%20pathname.split('%2F').filter(Boolean)%3B%0Aif%20(pathSegments.length%20%3E%3D%204)%20%7B%0Aconst%20%5B%2C%20currentLang%2C%20category%2C%20fileName%5D%20%3D%20pathSegments%3B%0Aconst%20newPath%20%3D%20%60%2Fdocuments%2F%24%7BnewLocale%7D%2F%24%7Bcategory%7D%2F%24%7BfileName%7D%60%3B%0Arouter.push(newPath)%3B%0A%7D%0A%7D%0A%7D)%3B%0A%7D)%3B%0A%7D%3B%0A%2F**%0A*%20Backdrop%20click%20event%20handler%0A*%20Click%20background%20to%20collapse%20menu%0A*%2F%0Aconst%20handleBackdropClick%20%3D%20()%20%3D%3E%20%7B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Core%20Algorithm%3A%20Circular%20Layout%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Circular%20menu%20layout%20algorithm%0A*%20Use%20polar%20coordinates%20to%20calculate%20menu%20item%20positions%0A*%20%40param%20index%20Menu%20item%20index%0A*%20%40param%20total%20Total%20number%20of%20menu%20items%0A*%20%40param%20radius%20Circle%20radius%0A*%20%40returns%20Screen%20coordinates%20of%20menu%20item%0A*%2F%0Aconst%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0A%2F%2F%20Calculate%20angle%3A%20divide%20circumference%20equally%2C%20starting%20angle%20at%20-%CF%80%2F2%20(12%20o'clock)%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0A%2F%2F%20Screen%20center%20coordinates%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0A%2F%2F%20Polar%20to%20Cartesian%20coordinate%20conversion%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%20%20%2F%2F%20-60%20for%20menu%20item%20width%20adjustment%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%20%20%2F%2F%20-30%20for%20menu%20item%20height%20adjustment%0A%7D%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Style%20Utility%20Functions%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Get%20uniform%20button%20styles%0A*%2F%0Aconst%20getUniformButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20border%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3B%0A%7D%3B%0A%2F**%0A*%20Get%20theme%20button%20styles%0A*%2F%0Aconst%20getThemeButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20w-16%20h-12%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20bg-transparent%20hover%3Abg-surface%2F20%22%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20UI%20Components%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Active%20state%20indicator%20component%0A*%2F%0Aconst%20ActiveIndicator%20%3D%20(%7BisActive%7D%3A%20%7B%20isActive%3A%20boolean%20%7D)%20%3D%3E%20%7B%0Aif%20(!isActive)%20return%20null%3B%0Areturn%20(%0Adiv%20className%3D%22absolute%20-top-1%20-right-1%20w-3%20h-3%20rounded-full%20shadow-lg%22%3E%0Adiv%20className%3D%22w-full%20h-full%20rounded-full%20bg-primary%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%3B%0A%2F%2F%20Theme%20icon%20components%0Aconst%20SunIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20fillRule%3D%22evenodd%22%0Ad%3D%22M10%202a1%201%200%20011%201v1a1%201%200%2011-2%200V3a1%201%200%20011-1zm4%208a4%204%200%2011-8%200%204%204%200%20018%200zm-.464%204.95l.707.707a1%201%200%20001.414-1.414l-.707-.707a1%201%200%2000-1.414%201.414zm2.12-10.607a1%201%200%20010%201.414l-.706.707a1%201%200%2011-1.414-1.414l.707-.707a1%201%200%20011.414%200zM17%2011a1%201%200%20100-2h-1a1%201%200%20100%202h1zm-7%204a1%201%200%20011%201v1a1%201%200%2011-2%200v-1a1%201%200%20011-1zM5.05%206.464A1%201%200%20106.465%205.05l-.708-.707a1%201%200%2000-1.414%201.414l.707.707zm1.414%208.486l-.707.707a1%201%200%2001-1.414-1.414l.707-.707a1%201%200%20011.414%201.414zM4%2011a1%201%200%20100-2H3a1%201%200%20000%202h1z%22%0AclipRule%3D%22evenodd%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0Aconst%20MoonIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20d%3D%22M17.293%2013.293A8%208%200%20016.707%202.707a8.001%208.001%200%201010.586%2010.586z%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20Language%20toggle%20icon%20component%0Aconst%20LocaleIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%20flex%20items-center%20justify-center%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%22%3E%0A%7BLOCALES%5Blocale%5D.flag%7D%0Aspan%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Render%20Logic%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20Loading%20state%20render%0A*%2F%0Aif%20(!mounted)%20%7B%0Areturn%20(%0Adiv%20className%3D%22fixed%20top-20%20right-5%20z-50%22%3E%0Adiv%0AclassName%3D%22w-16%20h-16%20rounded-full%20backdrop-blur-md%20border%20animate-pulse%20bg-surface%2F60%20border-surface%2F40%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%0A%2F**%0A*%20Build%20complete%20menu%20items%20array%0A*%2F%0Aconst%20allMenuItems%20%3D%20%5B%0A...sections.map(section%20%3D%3E%20(%7B%0Atype%3A%20'section'%20as%20const%2C%0Asection%2C%0Aaction%3A%20()%20%3D%3E%20navigateToPage(section.id%20%3D%3D%3D%20'personal'%20%3F%20'%2F'%20%3A%20section.href)%2C%0AisActive%3A%20activeSection%20%3D%3D%3D%20section.id%0A%7D))%2C%0A%7B%0Atype%3A%20'theme'%20as%20const%2C%0Aaction%3A%20handleThemeToggle%2C%0AisActive%3A%20false%0A%7D%2C%0A%7B%0Atype%3A%20'locale'%20as%20const%2C%0Aaction%3A%20handleLocaleToggle%2C%0AisActive%3A%20false%0A%7D%0A%5D%3B%0Areturn%20(%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Main%20Navigation%20Ball%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0Adiv%0Aref%3D%7BballRef%7D%0AclassName%3D%7B%60%0Afixed%20z-50%20transition-all%20duration-500%20cursor-pointer%20select-none%0A%24%7BisDragging%20%3F%20'cursor-grabbing%20scale-110%20duration-0'%20%3A%20'cursor-grab%20hover%3Ascale-105'%7D%0A%24%7BisExpanded%20%3F%20'hover%3Ascale-120'%20%3A%20''%7D%0A%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0Atransform%3A%20%60%24%7BisDragging%20%3F%20'rotate(5deg)'%20%3A%20isExpanded%20%3F%20'rotate(0deg)%20scale(1.1)'%20%3A%20'rotate(0deg)'%7D%60%0A%7D%7D%0AonMouseDown%3D%7BhandleMouseDown%7D%0AonClick%3D%7BhandleBallClick%7D%0A%3E%0A%7B%2F*%20Modern%20navigation%20ball%20*%2F%7D%0Adiv%20className%3D%7B%60%0Arelative%20w-16%20h-16%20rounded-full%20transition-all%20duration-500%0A%24%7BisExpanded%20%3F%20'animate-pulse%20shadow-lg'%20%3A%20''%7D%0A%60%7D%3E%0A%7B%2F*%20Ball%20shadow%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20rounded-full%20bg-black%2F20%20blur-lg%20translate-y-2%22%3Ediv%3E%0A%7B%2F*%20Ripple%20effect%20-%20shown%20during%20drag%20*%2F%7D%0A%7BshowRipple%20%26%26%20(%0Adiv%0AclassName%3D%22absolute%20rounded-full%20border-2%20animate-ping%20pointer-events-none%22%0Astyle%3D%7B%7B%0AborderColor%3A%20theme%20%3D%3D%3D%20'dark'%20%3F%20'rgba(78%2C%20205%2C%20196%2C%200.6)'%20%3A%20'rgba(0%2C%20102%2C%20204%2C%200.6)'%2C%0Awidth%3A%20'80px'%2C%0Aheight%3A%20'80px'%2C%0Atop%3A%20'-8px'%2C%0Aleft%3A%20'-8px'%2C%0AanimationDuration%3A%20'1s'%0A%7D%7D%0A%3Ediv%3E%0A)%7D%0A%7B%2F*%20Main%20ball%20body%20*%2F%7D%0Adiv%0AclassName%3D%22relative%20w-full%20h-full%20rounded-full%20shadow-xl%20transform-gpu%20backdrop-blur-md%20border%20transition-all%20duration-300%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3E%0A%7B%2F*%20Highlight%20effect%20*%2F%7D%0Adiv%20className%3D%22absolute%20top-2%20left-2%20w-4%20h-4%20rounded-full%20bg-white%2F30%20blur-sm%22%3Ediv%3E%0A%7B%2F*%20Menu%20symbol%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20flex%20items-center%20justify-center%22%3E%0Adiv%20className%3D%7B%60%0Aw-6%20h-6%20rounded-full%20border%20transition-all%20duration-300%20flex%20items-center%20justify-center%20border-foreground%2F40%0A%24%7BisExpanded%20%3F%20'rotate-90%20scale-110'%20%3A%20'rotate-0'%7D%0A%60%7D%3E%0A%7B%0AisExpanded%20%3F%20(%0Adiv%0AclassName%3D%22relative%20transition-all%20duration-300%20w-2%20h-2%20opacity-50%20text-center%20flex%20items-center%20justify-center%20text-foreground%22%0Astyle%3D%7B%7Btransform%3A%20'translateY(-1px)'%7D%7D%0A%3E%C3%97div%3E%0A)%20%3A%20(%0Adiv%0AclassName%3D%22transition-all%20duration-300%20w-1%20h-1%20opacity-50%20rounded-full%20bg-foreground%22%3Ediv%3E%0A)%0A%7D%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20Circular%20Menu%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7BisExpanded%20%26%26%20(%0A%7B%2F*%20Background%20overlay%20*%2F%7D%0Adiv%0AclassName%3D%22fixed%20inset-0%20z-40%20backdrop-blur-md%20transition-all%20duration-300%20bg-background%2F20%22%0AonClick%3D%7BhandleBackdropClick%7D%0A%3Ediv%3E%0A%7B%2F*%20Circular%20layout%20menu%20items%20*%2F%7D%0A%7BallMenuItems.map((item%2C%20index)%20%3D%3E%20%7B%0Aconst%20circularPos%20%3D%20getCircularPosition(index%2C%20allMenuItems.length)%3B%0Aif%20(item.type%20%3D%3D%3D%20'section')%20%7B%0Aconst%20section%20%3D%20item.section!%3B%0Areturn%20(%0Abutton%0Akey%3D%7Bsection.id%7D%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7B%60%24%7BgetUniformButtonStyles()%7D%20w-28%20h-14%20%24%7Bitem.isActive%20%3F%20'ring-2%20ring-blue-400%2F60%20scale-105'%20%3A%20''%7D%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20Section%20content%20*%2F%7D%0Adiv%0AclassName%3D%22absolute%20inset-0%20flex%20flex-col%20items-center%20justify-center%20text-foreground%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%20leading-tight%20text-center%22%3E%0A%7Bsection.label%7D%0Aspan%3E%0Aspan%20className%3D%22text-xs%20opacity-70%20mt-0.5%20font-medium%22%3E%0A%7Bsection.description%7D%0Aspan%3E%0Adiv%3E%0AActiveIndicator%20isActive%3D%7Bitem.isActive%7D%2F%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20if%20(item.type%20%3D%3D%3D%20'theme')%20%7B%0Areturn%20(%0Abutton%0Akey%3D%22theme%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20Theme%20toggle%20icon%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0A%7Btheme%20%3D%3D%3D%20'dark'%20%3F%20SunIcon%2F%3E%20%3A%20MoonIcon%2F%3E%7D%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20%7B%20%2F%2F%20locale%20toggle%0Areturn%20(%0Abutton%0Akey%3D%22locale%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20Language%20toggle%20icon%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0ALocaleIcon%2F%3E%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%0A%7D)%7D%0A)%7D%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20CSS%20Animation%20Definitions%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A%40keyframes%20menuItemDisappear%20%7B%0A0%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.3%3B%0Atransform%3A%20scale(0.6)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D%0A)%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;use client\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e, {useCallback, useEffect, useRef, useState} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {usePathname, useRouter} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;next/navigation\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {useTheme} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;./ThemeProvider\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {useLocaleStore} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;@/lib/stores/localeStore\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {\u003cspan class=\"hljs-variable constant_ inline\"\u003eLOCALES\u003c/span\u003e} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;@/lib/utils/locales\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment inline\"\u003e// ==================== Type Definitions ====================\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003einterface\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// X coordinate\u003c/span\u003e\n    \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Y coordinate\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword inline\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eNavigation\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== State Management ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e// Basic states\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [mounted, setMounted] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);                    \u003cspan class=\"hljs-comment inline\"\u003e// Component mount state\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isExpanded, setIsExpanded] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);              \u003cspan class=\"hljs-comment inline\"\u003e// Menu expansion state\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Position-related states\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});           \u003cspan class=\"hljs-comment inline\"\u003e// Current position\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [originalPosition, setOriginalPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e}); \u003cspan class=\"hljs-comment inline\"\u003e// Original position record\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Drag-related states\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isDragging, setIsDragging] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);              \u003cspan class=\"hljs-comment inline\"\u003e// Drag state flag\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragOffset, setDragOffset] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});         \u003cspan class=\"hljs-comment inline\"\u003e// Drag offset\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragStartPosition, setDragStartPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e}); \u003cspan class=\"hljs-comment inline\"\u003e// Drag start position\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [showRipple, setShowRipple] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);              \u003cspan class=\"hljs-comment inline\"\u003e// Show ripple effect\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// References and timers\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e debounceTimerRef = useRef\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003eNodeJS\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eTimeout\u003c/span\u003e | \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);     \u003cspan class=\"hljs-comment inline\"\u003e// Debounce timer\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e hasDraggedSignificantlyRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);                 \u003cspan class=\"hljs-comment inline\"\u003e// Has significant drag occurred\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e pendingPositionRef = useRef\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});      \u003cspan class=\"hljs-comment inline\"\u003e// Pending position update\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e ballRef = useRef\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003eHTMLDivElement\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);                     \u003cspan class=\"hljs-comment inline\"\u003e// Navigation ball reference\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Next.js and theme hooks\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e router = \u003cspan class=\"hljs-title function_ inline\"\u003euseRouter\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e pathname = \u003cspan class=\"hljs-title function_ inline\"\u003eusePathname\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e {theme, toggleTheme} = \u003cspan class=\"hljs-title function_ inline\"\u003euseTheme\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e {locale, toggleLocale} = \u003cspan class=\"hljs-title function_ inline\"\u003euseLocaleStore\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Initialization Effect ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Initialize position when component mounts\n     * Calculate initial position during client-side rendering, avoiding window undefined issue during SSR\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetMounted\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e80\u003c/span\u003e;   \u003cspan class=\"hljs-comment inline\"\u003e// 80px from right edge\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialY = \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e;                      \u003cspan class=\"hljs-comment inline\"\u003e// 100px from top\u003c/span\u003e\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: initialX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: initialY});\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: initialX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: initialY});\n        pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = {\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: initialX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: initialY};\n    }, []);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Clean up debounce timer to prevent memory leaks\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n                \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n            }\n        };\n    }, []);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Navigation Configuration ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Navigation menu configuration\n     * Define all navigable pages and their identifiers\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e sections = [\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;personal\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Personal\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;About Me\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/personal\u0026#x27;\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;works\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Works\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Portfolio\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/works\u0026#x27;\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;contributions\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Contributions\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Open Source\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/contributions\u0026#x27;\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;documents\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Documents\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Insights\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/documents\u0026#x27;\u003c/span\u003e\n        },\n    ];\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Get active navigation item based on current path\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@returns\u003c/span\u003e Currently active navigation item ID or null\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetActiveSection\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;personal\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/works\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;works\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/contributions\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;contributions\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/documents\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;documents\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n    };\n\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e activeSection = \u003cspan class=\"hljs-title function_ inline\"\u003egetActiveSection\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Core Algorithm: Edge Snapping ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Edge snapping algorithm\n     * Calculate distance to four boundaries and move to nearest boundary\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e currentPos Current position\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@returns\u003c/span\u003e Position after snapping\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snapToEdge = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ecurrentPos\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowWidth = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowHeight = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e ballSize = \u003cspan class=\"hljs-number inline\"\u003e70\u003c/span\u003e;    \u003cspan class=\"hljs-comment inline\"\u003e// Navigation ball size\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e margin = \u003cspan class=\"hljs-number inline\"\u003e20\u003c/span\u003e;      \u003cspan class=\"hljs-comment inline\"\u003e// Distance from edge\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003elet\u003c/span\u003e newPos = {...currentPos};\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Calculate distances to four boundaries\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToLeft = currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToRight = windowWidth - currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToTop = currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToBottom = windowHeight - currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// Find minimum distance\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e minDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Determine snap direction based on minimum distance\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToLeft) {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = margin;  \u003cspan class=\"hljs-comment inline\"\u003e// Snap to left\u003c/span\u003e\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToRight) {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = windowWidth - ballSize - margin;  \u003cspan class=\"hljs-comment inline\"\u003e// Snap to right\u003c/span\u003e\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToTop) {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = margin;  \u003cspan class=\"hljs-comment inline\"\u003e// Snap to top\u003c/span\u003e\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = windowHeight - ballSize - margin;  \u003cspan class=\"hljs-comment inline\"\u003e// Snap to bottom\u003c/span\u003e\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Boundary constraints: ensure position is within safe range\u003c/span\u003e\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowWidth - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e));\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowHeight - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e));\n        \n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e newPos;\n    }, []);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Drag Event Handling ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Mouse down event handler\n     * Initialize drag state, record start position and offset\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        e.\u003cspan class=\"hljs-title function_ inline\"\u003epreventDefault\u003c/span\u003e();  \u003cspan class=\"hljs-comment inline\"\u003e// Prevent default behaviors (like text selection)\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isExpanded) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Disable drag in expanded state\u003c/span\u003e\n\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n        hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetDragStartPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e});\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// Calculate mouse click position relative to navigation ball offset\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e rect = ballRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e?.\u003cspan class=\"hljs-title function_ inline\"\u003egetBoundingClientRect\u003c/span\u003e();\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (rect) {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetDragOffset\u003c/span\u003e({\n                \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// Mouse X - ball left = X offset\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003etop\u003c/span\u003e    \u003cspan class=\"hljs-comment inline\"\u003e// Mouse Y - ball top = Y offset\u003c/span\u003e\n            });\n        }\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Mouse move event handler (with debounce strategy)\n     * Update position in real-time, but use debouncing to avoid frequent rendering\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseMove = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Calculate new position based on mouse position and initial offset\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPos = {\n            \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e\n        };\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Store pending position (for debounced update)\u003c/span\u003e\n        pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = newPos;\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Immediately show ripple effect for instant feedback\u003c/span\u003e\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Clear existing debounce timer\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Set new debounce timer (500ms delay)\u003c/span\u003e\n        debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(newPos);\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        }, \u003cspan class=\"hljs-number inline\"\u003e500\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Calculate drag distance to determine if it\u0026#x27;s significant drag\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e dragDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esqrt\u003c/span\u003e(\n            \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) +\n            \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e)\n        );\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Over 3 pixels is considered significant drag\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (dragDistance \u0026gt; \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) {\n            hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n        }\n    }, [isDragging, dragOffset, dragStartPosition]);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Mouse up event handler\n     * End drag and execute snapping logic\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseUp = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Clear debounce timer\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n            debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// If significant drag occurred, execute edge snapping\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snappedPos = \u003cspan class=\"hljs-title function_ inline\"\u003esnapToEdge\u003c/span\u003e(pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(snappedPos);\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(snappedPos);  \u003cspan class=\"hljs-comment inline\"\u003e// Update original position record\u003c/span\u003e\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// Delay reset of drag flag to avoid conflict with click events\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n        }, \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e);\n    }, [isDragging]);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Global Event Listeners ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Manage global mouse event listeners\n     * Only add listeners during drag state for performance optimization\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isDragging) {\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n            \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n                \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n                \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n            };\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n            \u003cspan class=\"hljs-comment inline\"\u003e// Ensure listeners are removed in non-drag state\u003c/span\u003e\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n        }\n    }, [isDragging]);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Interaction Event Handling ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Navigation ball click event handler\n     * Toggle expand/collapse state, handle position movement\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleBallClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-comment inline\"\u003e// Only handle click when no significant drag occurred\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isExpanded) {\n                \u003cspan class=\"hljs-comment inline\"\u003e// Expand: save current position, move to screen center\u003c/span\u003e\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(position);\n                \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;   \u003cspan class=\"hljs-comment inline\"\u003e// Center X - ball radius\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Center Y - ball radius\u003c/span\u003e\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY});\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n            } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n                \u003cspan class=\"hljs-comment inline\"\u003e// Collapse: delay 150ms before returning to original position\u003c/span\u003e\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n                \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n                    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n                }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n            }\n        }\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Menu item click event handler\n     * Execute action then collapse menu\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: () =\u0026gt; \u003cspan class=\"hljs-built_in inline\"\u003evoid\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003eaction\u003c/span\u003e();\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n        }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Page navigation handler\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003enavigateToPage\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e router.\u003cspan class=\"hljs-title function_ inline\"\u003epush\u003c/span\u003e(href));\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Theme toggle handler\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleThemeToggle\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003etoggleTheme\u003c/span\u003e());\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Locale toggle handler\n     * Support language switching redirect for document pages\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleLocaleToggle\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003etoggleLocale\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003enewLocale\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n                \u003cspan class=\"hljs-comment inline\"\u003e// Check if on document page, redirect to same article in new language\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname.\u003cspan class=\"hljs-title function_ inline\"\u003estartsWith\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/documents/\u0026#x27;\u003c/span\u003e)) {\n                    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e pathSegments = pathname.\u003cspan class=\"hljs-title function_ inline\"\u003esplit\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/\u0026#x27;\u003c/span\u003e).\u003cspan class=\"hljs-title function_ inline\"\u003efilter\u003c/span\u003e(\u003cspan class=\"hljs-title class_ inline\"\u003eBoolean\u003c/span\u003e);\n                    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathSegments.\u003cspan class=\"hljs-property inline\"\u003elength\u003c/span\u003e \u0026gt;= \u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e) {\n                        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [, currentLang, category, fileName] = pathSegments;\n                        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPath = \u003cspan class=\"hljs-string inline\"\u003e`/documents/\u003cspan class=\"hljs-subst inline\"\u003e${newLocale}\u003c/span\u003e/\u003cspan class=\"hljs-subst inline\"\u003e${category}\u003c/span\u003e/\u003cspan class=\"hljs-subst inline\"\u003e${fileName}\u003c/span\u003e`\u003c/span\u003e;\n                        router.\u003cspan class=\"hljs-title function_ inline\"\u003epush\u003c/span\u003e(newPath);\n                    }\n                }\n            });\n        });\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Backdrop click event handler\n     * Click background to collapse menu\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleBackdropClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n        }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Core Algorithm: Circular Layout ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Circular menu layout algorithm\n     * Use polar coordinates to calculate menu item positions\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e index Menu item index\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e total Total number of menu items\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e radius Circle radius\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@returns\u003c/span\u003e Screen coordinates of menu item\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetCircularPosition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003etotal\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003eradius\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e = \u003cspan class=\"hljs-number inline\"\u003e120\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-comment inline\"\u003e// Calculate angle: divide circumference equally, starting angle at -π/2 (12 o\u0026#x27;clock)\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// Screen center coordinates\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// Polar to Cartesian coordinate conversion\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e {\n            \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e60\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// -60 for menu item width adjustment\u003c/span\u003e\n            \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e30\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// -30 for menu item height adjustment\u003c/span\u003e\n        };\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Style Utility Functions ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Get uniform button styles\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetUniformButtonStyles\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed z-50 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md border bg-surface/60 border-surface/40 hover:bg-surface/80\u0026quot;\u003c/span\u003e;\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Get theme button styles\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetThemeButtonStyles\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed z-50 w-16 h-12 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md bg-transparent hover:bg-surface/20\u0026quot;\u003c/span\u003e;\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== UI Components ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Active state indicator component\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eActiveIndicator\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e{isActive}: { isActive: \u003cspan class=\"hljs-built_in inline\"\u003eboolean\u003c/span\u003e }\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isActive) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute -top-1 -right-1 w-3 h-3 rounded-full shadow-lg\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-full h-full rounded-full bg-primary\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        );\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Theme icon components\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eSunIcon\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-5 h-5 text-accent transition-all duration-300\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003efill\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;currentColor\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eviewBox\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;0 0 20 20\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003epath\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003efillRule\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;evenodd\u0026quot;\u003c/span\u003e\n                      \u003cspan class=\"hljs-attr inline\"\u003ed\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z\u0026quot;\u003c/span\u003e\n                      \u003cspan class=\"hljs-attr inline\"\u003eclipRule\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;evenodd\u0026quot;\u003c/span\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eMoonIcon\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-5 h-5 text-accent transition-all duration-300\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003efill\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;currentColor\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eviewBox\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;0 0 20 20\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003epath\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ed\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z\u0026quot;\u003c/span\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// Language toggle icon component\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eLocaleIcon\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-5 h-5 text-accent transition-all duration-300 flex items-center justify-center\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;text-sm font-bold\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                {LOCALES[locale].flag}\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== Render Logic ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Loading state render\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!mounted) {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed top-20 right-5 z-50\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        );\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * Build complete menu items array\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e allMenuItems = [\n        ...sections.\u003cspan class=\"hljs-title function_ inline\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e\u003cspan class=\"hljs-params inline\"\u003esection\u003c/span\u003e =\u0026gt;\u003c/span\u003e ({\n            \u003cspan class=\"hljs-attr inline\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;section\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            section,\n            \u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003enavigateToPage\u003c/span\u003e(section.\u003cspan class=\"hljs-property inline\"\u003eid\u003c/span\u003e === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;personal\u0026#x27;\u003c/span\u003e ? \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/\u0026#x27;\u003c/span\u003e : section.\u003cspan class=\"hljs-property inline\"\u003ehref\u003c/span\u003e),\n            \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e: activeSection === section.\u003cspan class=\"hljs-property inline\"\u003eid\u003c/span\u003e\n        })),\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;theme\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: handleThemeToggle,\n            \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e: \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;locale\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: handleLocaleToggle,\n            \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e: \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e\n        }\n    ];\n\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\n            {/* ==================== Main Navigation Ball ==================== */}\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003eref\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{ballRef}\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`\n          \u003cspan class=\"hljs-attr inline\"\u003efixed\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ez-50\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransition-all\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-500\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ecursor-pointer\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eselect-none\u003c/span\u003e\n          ${\u003cspan class=\"hljs-attr inline\"\u003eisDragging\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ecursor-grabbing\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003escale-110\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-0\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ecursor-grab\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ehover:scale-105\u003c/span\u003e\u0026#x27;}\n          ${\u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ehover:scale-120\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u0026#x27;}\n        `}\n                \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eposition.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                    \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eposition.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                    \u003cspan class=\"hljs-attr inline\"\u003etransform:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eisDragging\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e5deg\u003c/span\u003e)\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e0deg\u003c/span\u003e) \u003cspan class=\"hljs-attr inline\"\u003escale\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e1.1\u003c/span\u003e)\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e0deg\u003c/span\u003e)\u0026#x27;}`\n                }}\n                \u003cspan class=\"hljs-attr inline\"\u003eonMouseDown\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{handleMouseDown}\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{handleBallClick}\u003c/span\u003e\n            \u0026gt;\u003c/span\u003e\n                {/* Modern navigation ball */}\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`\n          \u003cspan class=\"hljs-attr inline\"\u003erelative\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ew-16\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eh-16\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003erounded-full\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransition-all\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-500\u003c/span\u003e\n          ${\u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003eanimate-pulse\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eshadow-lg\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u0026#x27;}\n        `}\u0026gt;\u003c/span\u003e\n                    {/* Ball shadow */}\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute inset-0 rounded-full bg-black/20 blur-lg translate-y-2\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    \n                    {/* Ripple effect - shown during drag */}\n                    {showRipple \u0026amp;\u0026amp; (\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                            \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute rounded-full border-2 animate-ping pointer-events-none\u0026quot;\u003c/span\u003e\n                            \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                \u003cspan class=\"hljs-attr inline\"\u003eborderColor:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etheme\u003c/span\u003e === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;dark\u0026#x27;\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ergba\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e78\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e205\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e196\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e0.6\u003c/span\u003e)\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ergba\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e102\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e204\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e0.6\u003c/span\u003e)\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003ewidth:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e80px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003eheight:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e80px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e-8px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e-8px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003eanimationDuration:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e1s\u003c/span\u003e\u0026#x27;\n                            }}\n                        \u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    )}\n\n                    {/* Main ball body */}\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;relative w-full h-full rounded-full shadow-xl transform-gpu backdrop-blur-md border transition-all duration-300 bg-surface/60 border-surface/40 hover:bg-surface/80\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                        {/* Highlight effect */}\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute top-2 left-2 w-4 h-4 rounded-full bg-white/30 blur-sm\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                        \n                        {/* Menu symbol */}\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute inset-0 flex items-center justify-center\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`\n                \u003cspan class=\"hljs-attr inline\"\u003ew-6\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eh-6\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003erounded-full\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eborder\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransition-all\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-300\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eflex\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eitems-center\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ejustify-center\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eborder-foreground\u003c/span\u003e/\u003cspan class=\"hljs-attr inline\"\u003e40\u003c/span\u003e\n                ${\u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate-90\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003escale-110\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate-0\u003c/span\u003e\u0026#x27;}\n              `}\u0026gt;\u003c/span\u003e\n                                {\n                                    isExpanded ? (\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                                            \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;relative transition-all duration-300 w-2 h-2 opacity-50 text-center flex items-center justify-center text-foreground\u0026quot;\u003c/span\u003e\n                                            \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{transform:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003etranslateY\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e-1px\u003c/span\u003e)\u0026#x27;}}\n                                        \u0026gt;\u003c/span\u003e×\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                    ) : (\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                                            \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;transition-all duration-300 w-1 h-1 opacity-50 rounded-full bg-foreground\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                    )\n                                }\n\n                            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n            {/* ==================== Circular Menu ==================== */}\n            {isExpanded \u0026amp;\u0026amp; (\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\n                    {/* Background overlay */}\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed inset-0 z-40 backdrop-blur-md transition-all duration-300 bg-background/20\u0026quot;\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{handleBackdropClick}\u003c/span\u003e\n                    \u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n                    {/* Circular layout menu items */}\n                    {allMenuItems.map((item, index) =\u0026gt; {\n                        const circularPos = getCircularPosition(index, allMenuItems.length);\n\n                        if (item.type === \u0026#x27;section\u0026#x27;) {\n                            const section = item.section!;\n\n                            return (\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{section.id}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.action}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`${\u003cspan class=\"hljs-attr inline\"\u003egetUniformButtonStyles\u003c/span\u003e()} \u003cspan class=\"hljs-attr inline\"\u003ew-28\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eh-14\u003c/span\u003e ${\u003cspan class=\"hljs-attr inline\"\u003eitem.isActive\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ering-2\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ering-blue-400\u003c/span\u003e/\u003cspan class=\"hljs-attr inline\"\u003e60\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003escale-105\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u0026#x27;}`}\n                                    \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e * \u003cspan class=\"hljs-attr inline\"\u003e120\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003ems\u003c/span\u003e`\n                                    }}\n                                \u0026gt;\u003c/span\u003e\n                                    {/* Section content */}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute inset-0 flex flex-col items-center justify-center text-foreground\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;text-sm font-bold leading-tight text-center\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                            {section.label}\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;text-xs opacity-70 mt-0.5 font-medium\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                            {section.description}\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eActiveIndicator\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.isActive}/\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            );\n                        } else if (item.type === \u0026#x27;theme\u0026#x27;) {\n                            return (\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;theme\u0026quot;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.action}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{getThemeButtonStyles()}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e * \u003cspan class=\"hljs-attr inline\"\u003e120\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003ems\u003c/span\u003e`\n                                    }}\n                                \u0026gt;\u003c/span\u003e\n                                    {/* Theme toggle icon */}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;flex items-center justify-center h-full\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        {theme === \u0026#x27;dark\u0026#x27; ? \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eSunIcon\u003c/span\u003e/\u0026gt;\u003c/span\u003e : \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eMoonIcon\u003c/span\u003e/\u0026gt;\u003c/span\u003e}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            );\n                        } else { // locale toggle\n                            return (\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;locale\u0026quot;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.action}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{getThemeButtonStyles()}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e * \u003cspan class=\"hljs-attr inline\"\u003e120\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003ems\u003c/span\u003e`\n                                    }}\n                                \u0026gt;\u003c/span\u003e\n                                    {/* Language toggle icon */}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;flex items-center justify-center h-full\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eLocaleIcon\u003c/span\u003e/\u0026gt;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            );\n                        }\n                    })}\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            )}\n\n            {\u003cspan class=\"hljs-comment inline\"\u003e/* ==================== CSS Animation Definitions ==================== */\u003c/span\u003e}\n            \u0026lt;style jsx\u0026gt;{\u003cspan class=\"hljs-string inline\"\u003e`\n                @keyframes menuItemAppear {\n                    0% {\n                        opacity: 0;\n                        transform: scale(0) translate(-50%, -50%);\n                    }\n                    50% {\n                        opacity: 0.7;\n                        transform: scale(0.8) translate(-25%, -25%);\n                    }\n                    100% {\n                        opacity: 1;\n                        transform: scale(1) translate(0%, 0%);\n                    }\n                }\n\n                @keyframes menuItemDisappear {\n                    0% {\n                        opacity: 1;\n                        transform: scale(1) translate(0%, 0%);\n                    }\n                    50% {\n                        opacity: 0.3;\n                        transform: scale(0.6) translate(-25%, -25%);\n                    }\n                    100% {\n                        opacity: 0;\n                        transform: scale(0) translate(-50%, -50%);\n                    }\n                }\n\n                .menu-item {\n                    animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n                }\n            `\u003c/span\u003e}\u0026lt;/style\u0026gt;\n        \u0026lt;/\u0026gt;\n    );\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"core-algorithm-flow-diagram\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#core-algorithm-flow-diagram\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Core Algorithm Flow Diagram\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Core Algorithm Flow Diagram\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"\" data-code=\"User%20Interaction%20%E2%86%92%20Event%20Judgment%20%E2%86%92%20State%20Update%20%E2%86%92%20Position%20Calculation%20%E2%86%92%20Visual%20Feedback%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AMouse%20Down%20%20%20%20%20%20Drag%2FClick%20%20%20%20%20%20isDragging%20%20%20%20%20dragOffset%20%20%20%20%20%20%20%20%20Ripple%20Effect%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AMouse%20Move%20%20%20%20%20%20Distance%20Calc%20%20%20position%20Update%20%20Debounced%20Update%20%20Real-time%20Feedback%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%93%0AMouse%20Up%20%20%20%20%20%20%20%20Snapping%20Algo%20%20%20Boundary%20Constraint%20Menu%20Expand%20%20%20%20Animation%20Transition\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ecode\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode\u003e\u003cspan class=\"hljs-variable inline\"\u003eUser\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eInteraction\u003c/span\u003e → \u003cspan class=\"hljs-variable inline\"\u003eEvent\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eJudgment\u003c/span\u003e → \u003cspan class=\"hljs-variable inline\"\u003eState\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eUpdate\u003c/span\u003e → \u003cspan class=\"hljs-built_in inline\"\u003ePosition\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eCalculation\u003c/span\u003e → \u003cspan class=\"hljs-variable inline\"\u003eVisual\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eFeedback\u003c/span\u003e\n    ↓                ↓               ↓              ↓                  ↓\n\u003cspan class=\"hljs-variable inline\"\u003eMouse\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eDown\u003c/span\u003e      \u003cspan class=\"hljs-variable inline\"\u003eDrag\u003c/span\u003e\u003cspan class=\"hljs-operator inline\"\u003e/\u003c/span\u003e\u003cspan class=\"hljs-variable inline\"\u003eClick\u003c/span\u003e      \u003cspan class=\"hljs-variable inline\"\u003eisDragging\u003c/span\u003e     \u003cspan class=\"hljs-variable inline\"\u003edragOffset\u003c/span\u003e         \u003cspan class=\"hljs-variable inline\"\u003eRipple\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eEffect\u003c/span\u003e\n    ↓                ↓               ↓              ↓                  ↓\n\u003cspan class=\"hljs-variable inline\"\u003eMouse\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eMove\u003c/span\u003e      \u003cspan class=\"hljs-variable inline\"\u003eDistance\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eCalc\u003c/span\u003e   \u003cspan class=\"hljs-variable inline\"\u003eposition\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eUpdate\u003c/span\u003e  \u003cspan class=\"hljs-variable inline\"\u003eDebounced\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eUpdate\u003c/span\u003e  \u003cspan class=\"hljs-built_in inline\"\u003eReal\u003c/span\u003e\u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-variable inline\"\u003etime\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eFeedback\u003c/span\u003e\n    ↓                ↓               ↓              ↓                  ↓\n\u003cspan class=\"hljs-variable inline\"\u003eMouse\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eUp\u003c/span\u003e        \u003cspan class=\"hljs-variable inline\"\u003eSnapping\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eAlgo\u003c/span\u003e   \u003cspan class=\"hljs-variable inline\"\u003eBoundary\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eConstraint\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eMenu\u003c/span\u003e \u003cspan class=\"hljs-built_in inline\"\u003eExpand\u003c/span\u003e    \u003cspan class=\"hljs-variable inline\"\u003eAnimation\u003c/span\u003e \u003cspan class=\"hljs-variable inline\"\u003eTransition\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"key-algorithm-analysis\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#key-algorithm-analysis\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to Key Algorithm Analysis\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            Key Algorithm Analysis\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e1. Edge Snapping Core Algorithm\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Key%3A%20Calculate%20distance%20to%20four%20edges%2C%20move%20to%20nearest%20boundary%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20Determine%20snap%20direction%20based%20on%20minimum%20distance%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20Snap%20to%20left%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Key: Calculate distance to four edges, move to nearest boundary\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToLeft = currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToRight = windowWidth - currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToTop = currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToBottom = windowHeight - currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e minDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);\n\n\u003cspan class=\"hljs-comment inline\"\u003e// Determine snap direction based on minimum distance\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToLeft) {\n    newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = margin;  \u003cspan class=\"hljs-comment inline\"\u003e// Snap to left\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e2. Circular Layout Mathematical Calculation\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Key%3A%20Polar%20coordinate%20conversion%20%2B%20angle%20division%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%20%20%2F%2F%20Angle%20calculation%0Aconst%20x%20%3D%20centerX%20%2B%20Math.cos(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20X%20coordinate%20conversion%0Aconst%20y%20%3D%20centerY%20%2B%20Math.sin(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Y%20coordinate%20conversion\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Key: Polar coordinate conversion + angle division\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Angle calculation\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e x = centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius;               \u003cspan class=\"hljs-comment inline\"\u003e// X coordinate conversion\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e y = centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius;               \u003cspan class=\"hljs-comment inline\"\u003e// Y coordinate conversion\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e3. Debounced Drag Optimization\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Key%3A%20Immediate%20feedback%20%2B%20delayed%20update%0ApendingPositionRef.current%20%3D%20newPos%3B%20%20%20%20%20%2F%2F%20Store%20pending%20position%0AsetShowRipple(true)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Show%20immediate%20feedback%0AsetTimeout(()%20%3D%3E%20%7B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Debounced%20update%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Key: Immediate feedback + delayed update\u003c/span\u003e\npendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = newPos;     \u003cspan class=\"hljs-comment inline\"\u003e// Store pending position\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);                     \u003cspan class=\"hljs-comment inline\"\u003e// Show immediate feedback\u003c/span\u003e\n\u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {                       \u003cspan class=\"hljs-comment inline\"\u003e// Debounced update\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(newPos);\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n}, \u003cspan class=\"hljs-number inline\"\u003e500\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e4. Drag Distance Determination\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20Key%3A%20Euclidean%20distance%20calculation%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%20%20%2F%2F%203%20pixel%20threshold%20filters%20hand%20tremor%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"Copy code\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003eCopy\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// Key: Euclidean distance calculation\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e dragDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esqrt\u003c/span\u003e(\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) +\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e)\n);\n\u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (dragDistance \u0026gt; \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) {  \u003cspan class=\"hljs-comment inline\"\u003e// 3 pixel threshold filters hand tremor\u003c/span\u003e\n    hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cem class=\"italic text-foreground\"\u003eMay your navigation be as stable as the North Star, as dynamic as a meteor.\u003c/em\u003e ✨\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"$L1d\",null,{\"htmlContent\":\"$1e\",\"frontMatter\":{\"title\":\"Floating Navigation Ball: From Mathematical Principles to Interactive Implementation\",\"description\":\"Detailed analysis of a draggable, snappable, expandable circular menu system\",\"date\":\"2025-06-22\",\"author\":\"MilkWind\",\"tags\":[\"Navigation\",\"Interactive Design\"],\"references\":{}},\"readingTime\":\"30 min read\",\"category\":\"personal-website\",\"tocItems\":[{\"id\":\"floating-navigation-ball-from-mathematical-principles-to-interactive-implementation\",\"text\":\"Floating Navigation Ball: From Mathematical Principles to Interactive Implementation\",\"level\":1},{\"id\":\"state-management\",\"text\":\"State Management\",\"level\":2},{\"id\":\"state-definition\",\"text\":\"State Definition\",\"level\":3},{\"id\":\"core-state-breakdown\",\"text\":\"Core State Breakdown\",\"level\":3},{\"id\":\"state-machine-design\",\"text\":\"State Machine Design\",\"level\":3},{\"id\":\"coordinate-system-and-position-recording\",\"text\":\"Coordinate System and Position Recording\",\"level\":2},{\"id\":\"coordinate-system-choice\",\"text\":\"Coordinate System Choice\",\"level\":3},{\"id\":\"position-initialization-strategy\",\"text\":\"Position Initialization Strategy\",\"level\":3},{\"id\":\"mathematical-principles-of-dragoffset\",\"text\":\"Mathematical Principles of dragOffset\",\"level\":3},{\"id\":\"drag-system-implementation\",\"text\":\"Drag System Implementation\",\"level\":2},{\"id\":\"drag-lifecycle\",\"text\":\"Drag Lifecycle\",\"level\":3},{\"id\":\"debounced-animation-implementation\",\"text\":\"Debounced Animation Implementation\",\"level\":3},{\"id\":\"drag-distance-determination\",\"text\":\"Drag Distance Determination\",\"level\":3},{\"id\":\"intelligent-handling-of-drag-end\",\"text\":\"Intelligent Handling of Drag End\",\"level\":3},{\"id\":\"edge-snapping-algorithm\",\"text\":\"Edge Snapping Algorithm\",\"level\":2},{\"id\":\"core-logic-of-snapping-algorithm\",\"text\":\"Core Logic of Snapping Algorithm\",\"level\":3},{\"id\":\"mathematical-principles-of-boundary-calculation\",\"text\":\"Mathematical Principles of Boundary Calculation\",\"level\":3},{\"id\":\"boundary-constraint-implementation\",\"text\":\"Boundary Constraint Implementation\",\"level\":3},{\"id\":\"expandcollapse-animation-system\",\"text\":\"Expand/Collapse Animation System\",\"level\":2},{\"id\":\"center-positioning-algorithm\",\"text\":\"Center Positioning Algorithm\",\"level\":3},{\"id\":\"timing-control-for-state-switching\",\"text\":\"Timing Control for State Switching\",\"level\":3},{\"id\":\"saving-mechanism-for-originalposition\",\"text\":\"Saving Mechanism for originalPosition\",\"level\":3},{\"id\":\"circular-menu-layout-algorithm\",\"text\":\"Circular Menu Layout Algorithm\",\"level\":2},{\"id\":\"mathematical-foundation-of-polar-coordinate-layout\",\"text\":\"Mathematical Foundation of Polar Coordinate Layout\",\"level\":3},{\"id\":\"angle-distribution-strategy\",\"text\":\"Angle Distribution Strategy\",\"level\":3},{\"id\":\"keyframe-animation-system\",\"text\":\"Keyframe Animation System\",\"level\":2},{\"id\":\"css-in-js-animation-implementation\",\"text\":\"CSS-in-JS Animation Implementation\",\"level\":3},{\"id\":\"layered-animation-delays\",\"text\":\"Layered Animation Delays\",\"level\":3},{\"id\":\"easing-function-choice\",\"text\":\"Easing Function Choice\",\"level\":3},{\"id\":\"event-handling-and-performance-optimization\",\"text\":\"Event Handling and Performance Optimization\",\"level\":2},{\"id\":\"event-listener-lifecycle-management\",\"text\":\"Event Listener Lifecycle Management\",\"level\":3},{\"id\":\"performance-optimization-with-usecallback\",\"text\":\"Performance Optimization with useCallback\",\"level\":3},{\"id\":\"event-bubbling-prevention-strategy\",\"text\":\"Event Bubbling Prevention Strategy\",\"level\":3},{\"id\":\"reusable-design-pattern-summary\",\"text\":\"Reusable Design Pattern Summary\",\"level\":2},{\"id\":\"core-design-pattern-extraction\",\"text\":\"Core Design Pattern Extraction\",\"level\":3},{\"id\":\"best-practice-distillation\",\"text\":\"Best Practice Distillation\",\"level\":3},{\"id\":\"complete-source-code-analysis\",\"text\":\"Complete Source Code Analysis\",\"level\":2},{\"id\":\"core-algorithm-flow-diagram\",\"text\":\"Core Algorithm Flow Diagram\",\"level\":3},{\"id\":\"key-algorithm-analysis\",\"text\":\"Key Algorithm Analysis\",\"level\":3}],\"translations\":{\"common\":{\"welcome\":\"Welcome\",\"loading\":\"Loading...\",\"error\":\"Something went wrong\",\"retry\":\"Try again\",\"theme\":\"Theme\",\"language\":\"Language\",\"light\":\"Light\",\"dark\":\"Dark\"},\"navigation\":{\"home\":\"Home\",\"personal\":\"Personal\",\"works\":\"Works\",\"contributions\":\"Contributions\",\"documents\":\"Documents\",\"about\":\"About\",\"contact\":\"Contact\"},\"personal\":{\"technicalSkills\":\"Technical Skills\",\"email\":\"Email\",\"github\":\"GitHub\",\"resume\":\"Resume\",\"codeRepository\":\"Code Repository\",\"loadingPersonalInfo\":\"Loading personal information...\",\"loadingResume\":\"Loading resume...\",\"closeResume\":\"Close Resume\",\"emailCopied\":\"Email copied to clipboard!\",\"galaxyDefaultDescription\":\"Expert in full-stack development, cross-platform architecture, AI technology integration, and high-performance system optimization\",\"skillGalaxy\":\"Skill Galaxy\",\"stirGalaxy\":\"Stir Galaxy\",\"stirring\":\"Stirring...\",\"fullStackEngineer\":\"MilkWind - Full Stack Engineer\",\"professionalProfile\":\"About Me\"},\"documents\":{\"technicalDocuments\":\"Technical Documents\",\"description\":\"Basic principles, code splitting, and some random thoughts.\",\"articles\":\"Articles\",\"categories\":\"Categories\",\"allCategories\":\"All Categories\",\"noArticlesFound\":\"No articles found\",\"noArticlesAvailable\":\"No articles available in English.\",\"noArticlesInCategory\":\"No articles found in the category.\",\"readMore\":\"Read more\",\"loadingDocuments\":\"Loading documents...\",\"backToDocuments\":\"← Back to Documents\",\"documentNotFound\":\"Document Not Found\",\"documentNotFoundDescription\":\"The requested document could not be found.\",\"technicalInsights\":\"Insights\",\"untitledDocument\":\"Untitled Document\",\"byAuthor\":\"By\",\"search\":\"Search articles...\",\"searchByTags\":\"Filter by tags\",\"searching\":\"Searching...\",\"noSearchResults\":\"No articles match your search criteria\",\"clearSearch\":\"Clear search\",\"selectedTags\":\"Selected tags\",\"allTags\":\"All tags\",\"searchInTitle\":\"Search in titles, descriptions, and content\",\"enterImmersiveMode\":\"Immersive Reading\",\"exitImmersiveMode\":\"Exit Immersive Mode\",\"immersiveReading\":\"Immersive Reading Mode\",\"exploreContent\":\"Explore content by category\",\"browseBy\":\"Browse by\",\"exploreAll\":\"All content in one place\",\"categoryDescription\":\"Articles in this category\",\"totalArticles\":\"Articles\",\"totalCategories\":\"Categories\",\"foundArticles\":\"Found articles\",\"categoriesWithResults\":\"Categories with results\"},\"works\":{\"workCases\":\"Work Cases\",\"projects\":\"Portfolio\",\"loadingProjects\":\"Loading projects...\",\"grid\":\"Grid\",\"stack\":\"Stack\",\"of\":\"of\",\"workCasesPageTitle\":\"Work Cases Page\",\"pageWorkingCorrectly\":\"This page is working! The routing is correct.\",\"try3DVersion\":\"Try 3D Version\",\"dragToScroll\":\"Drag to scroll\",\"dragToChange\":\"Drag to change\",\"swipeCards\":\"Swipe cards\",\"keyboardNav\":\"Keyboard navigation\"},\"contributions\":{\"contributionCases\":\"Open Source\",\"contributions\":\"Contributions\",\"loadingContributions\":\"Loading contributions...\",\"grid\":\"Grid\",\"stack\":\"Stack\",\"of\":\"of\",\"contributionCasesPageTitle\":\"Contribution Cases Page\",\"pageWorkingCorrectly\":\"This page is working! The routing is correct.\",\"try3DVersion\":\"Try 3D Version\",\"dragToScroll\":\"Drag to scroll\",\"dragToChange\":\"Drag to change\",\"swipeCards\":\"Swipe cards\",\"keyboardNav\":\"Keyboard navigation\"},\"contribution\":{\"contributionPreview\":\"Contribution Preview\",\"accessible\":\"Accessible\",\"code\":\"Code\",\"maintenance\":\"Maintenance\",\"enhancement\":\"Enhancement\",\"documentation\":\"Documentation\",\"community\":\"Community\",\"moreItems\":\"more\",\"technicalDetails\":\"Technical Details\",\"technologies\":\"Technologies:\",\"contributionDetail\":\"Contribution Detail\",\"description\":\"Description:\",\"seeDetails\":\"See Details\",\"github\":\"GitHub\",\"viewContribution\":\"View Contribution\",\"viewCode\":\"View Code\"},\"project\":{\"projectPreview\":\"Project Preview\",\"accessible\":\"Accessible\",\"tool\":\"Tool\",\"plugin\":\"Plugin\",\"toy\":\"Toy\",\"moreItems\":\"more\",\"technicalDetails\":\"Technical Details\",\"technologies\":\"Technologies:\",\"description\":\"Description:\",\"seeDetails\":\"See Details\",\"github\":\"GitHub\",\"gitee\":\"Gitee\",\"viewLiveDemo\":\"View Live Demo\",\"viewCode\":\"View Code\",\"access\":\"Access\",\"videos\":\"Videos\",\"watchVideo\":\"Watch Video\",\"hasVideo\":\"Has Video\"},\"codeblock\":{\"copy\":\"Copy\",\"copySuccess\":\"Code copied to clipboard!\",\"copyError\":\"Failed to copy code\",\"copyTooltip\":\"Copy code\"},\"toc\":{\"contents\":\"Contents\",\"autoScroll\":\"Auto-scroll to section\",\"collapse\":\"Collapse\",\"expand\":\"Expand\"},\"loading\":{\"loading\":\"LOADING\",\"preparingExperience\":\"Preparing experience\"}},\"lang\":\"en\",\"theme\":\"light\"}]\n"])</script><script>self.__next_f.push([1,"12:null\n"])</script><script>self.__next_f.push([1,"18:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n11:null\n"])</script><script>self.__next_f.push([1,"1c:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Floating Navigation Ball: From Mathematical Principles to Interactive Implementation | Interactive Portfolio\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Detailed analysis of a draggable, snappable, expandable circular menu system\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Developer\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"portfolio,3D,interactive,web development,Three.js,Next.js\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Floating Navigation Ball: From Mathematical Principles to Interactive Implementation | Interactive Portfolio\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"Detailed analysis of a draggable, snappable, expandable circular menu system\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"7\",{\"property\":\"article:published_time\",\"content\":\"2025-06-22\"}],[\"$\",\"meta\",\"8\",{\"property\":\"article:tag\",\"content\":\"Navigation\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:tag\",\"content\":\"Interactive Design\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"Floating Navigation Ball: From Mathematical Principles to Interactive Implementation | Interactive Portfolio\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"Detailed analysis of a draggable, snappable, expandable circular menu system\"}],[\"$\",\"link\",\"13\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}]],\"error\":null,\"digest\":\"$undefined\"}\n14:{\"metadata\":\"$1c:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>