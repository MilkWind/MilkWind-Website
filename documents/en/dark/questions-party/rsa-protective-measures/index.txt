1:"$Sreact.fragment"
2:I[38735,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"default"]
3:I[19945,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"default"]
4:I[65337,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"default"]
5:I[96190,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"ClientProviders"]
6:I[87555,[],""]
7:I[51901,["8039","static/chunks/app/error-dda32be1d095a86c.js"],"default"]
8:I[31295,[],""]
9:I[6874,["6874","static/chunks/6874-fbe9a08eb79b991c.js","4345","static/chunks/app/not-found-9ff98b2ccf24cac7.js"],""]
a:I[94970,[],"ClientSegmentRoot"]
b:I[44065,["206","static/chunks/206-4f4cbf4d7156f437.js","3092","static/chunks/app/documents/layout-28408791defde09e.js"],"default"]
e:I[59665,[],"MetadataBoundary"]
10:I[59665,[],"OutletBoundary"]
13:I[74911,[],"AsyncMetadataOutlet"]
15:I[39460,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","5650","static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js"],"default"]
16:I[88610,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","4209","static/chunks/app/loading-68f227fb49b3ac8c.js"],"default"]
17:I[59665,[],"ViewportBoundary"]
19:I[26614,[],""]
:HL["/MilkWind-Website/_next/static/css/f034c804622acb16.css","style"]
:HL["/MilkWind-Website/_next/static/css/276b387d8ca46690.css","style"]
:HL["/MilkWind-Website/_next/static/css/5eacd01f773eed7f.css","style"]
0:{"P":null,"b":"BJpk_sL_vr43bGNqBw4uH","p":"/MilkWind-Website","c":["","documents","en","dark","questions-party","rsa-protective-measures",""],"i":false,"f":[[["",{"children":["documents",{"children":[["slug","en/dark/questions-party/rsa-protective-measures","c"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/f034c804622acb16.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/276b387d8ca46690.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_9b7fb1 __variable_ca2a15 __variable_591dcc font-sans antialiased min-h-screen bg-background text-foreground","suppressHydrationWarning":true,"children":[["$","$L2",null,{}],["$","$L3",null,{}],["$","$L4",null,{}],["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$7","errorStyles":[],"errorScripts":[],"template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"z-10 relative min-h-screen flex items-center justify-center bg-background p-8","children":["$","div",null,{"className":"text-center max-w-md","children":[["$","div",null,{"className":"text-8xl font-bold text-primary mb-4","children":"404"}],["$","h2",null,{"className":"text-2xl font-bold text-foreground mb-4","children":"Page Not Found"}],["$","p",null,{"className":"text-foreground/70 mb-8","children":"The page you're looking for doesn't exist or has been moved to a different location."}],["$","div",null,{"className":"flex flex-col sm:flex-row gap-4 justify-center","children":[["$","$L9",null,{"href":"/","className":"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors","children":"Go Home"}],["$","$L9",null,{"href":"/works","className":"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors","children":"View Works"}]]}],["$","div",null,{"className":"absolute inset-0 overflow-hidden pointer-events-none -z-10","children":[["$","div",null,{"className":"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float"}],["$","div",null,{"className":"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float","style":{"animationDelay":"1s"}}],["$","div",null,{"className":"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float","style":{"animationDelay":"2s"}}]]}]]}]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]}]]}],{"children":["documents",["$","$1","c",{"children":[null,["$","$La",null,{"Component":"$b","slots":{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@c"}]]}],{"children":[["slug","en/dark/questions-party/rsa-protective-measures","c"],["$","$1","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$Ld",["$","$Le",null,{"children":"$Lf"}],[["$","link","0",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/5eacd01f773eed7f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L10",null,{"children":["$L11","$L12",["$","$L13",null,{"promise":"$@14"}]]}]]}],{},null,false]},null,false]},[["$","$L15","l",{}],[],[]],false]},[["$","$L16","l",{}],[],[]],false],["$","$1","h",{"children":[null,["$","$1","n-kq_q1LetVP7D3J_4C8C",{"children":[["$","$L17",null,{"children":"$L18"}],null]}],null]}],false]],"m":"$undefined","G":["$19","$undefined"],"s":false,"S":true}
1a:"$Sreact.suspense"
1b:I[74911,[],"AsyncMetadata"]
c:{}
f:["$","$1a",null,{"fallback":null,"children":["$","$L1b",null,{"promise":"$@1c"}]}]
1d:I[57340,["5584","static/chunks/b498d07c-095637f0f10883c6.js","2415","static/chunks/2415-689c103fb3d2c28d.js","6874","static/chunks/6874-fbe9a08eb79b991c.js","9554","static/chunks/9554-b714f9de28e85d30.js","1873","static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js"],"DocumentPageClient"]
1e:T64403,<h1 id="the-double-edged-sword-of-keys-rsa-encryption’s-security-protection-path-in-modern-web-applications" class="group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight">
            <a href="#the-double-edged-sword-of-keys-rsa-encryption’s-security-protection-path-in-modern-web-applications" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to The Double-Edged Sword of Keys: RSA Encryption’s Security Protection Path in Modern Web Applications">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            The Double-Edged Sword of Keys: RSA Encryption’s Security Protection Path in Modern Web Applications
        </h1>
<p class="text-base leading-7 mb-4 text-foreground">In the long river of cryptography, if symmetric encryption is a precise lock, then asymmetric encryption is a magical double-edged sword—one edge can encrypt, the other can decrypt, yet it never harms the wielder.</p>
<p class="text-base leading-7 mb-4 text-foreground">Looking back to the early days of information security, developers were still struggling with how to securely transmit API keys. Plaintext transmission? That’s running naked. Symmetric encryption? Key distribution became the new challenge. It wasn’t until the emergence of the RSA algorithm that this seemingly unsolvable key distribution problem was truly resolved.</p>
<p class="text-base leading-7 mb-4 text-foreground">This article will deeply analyze the complete RSA encryption implementation in the Questions Party project, from mathematical principles to engineering practice, from key generation to data transmission, taking you through the true power of this “double-edged sword of keys.”</p>
<h2 id="mathematical-foundation-of-the-rsa-algorithm" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#mathematical-foundation-of-the-rsa-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mathematical Foundation of the RSA Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mathematical Foundation of the RSA Algorithm
        </h2>
<h3 id="the-mathematical-challenge-of-large-number-factorization" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#the-mathematical-challenge-of-large-number-factorization" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to The Mathematical Challenge of Large Number Factorization">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            The Mathematical Challenge of Large Number Factorization
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The security of the RSA algorithm is built on a seemingly simple yet extremely difficult mathematical problem: <strong class="font-bold text-foreground">prime factorization of large integers</strong>.</p>
<p class="text-base leading-7 mb-4 text-foreground">It’s easy to multiply two large prime numbers:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>=</mo><mn>61</mn><mo separator="true">,</mo><mi>q</mi><mo>=</mo><mn>53</mn></mrow><annotation encoding="application/x-tex">p = 61, q = 53</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline">p</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord inline">61</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">53</span></span></span></span></span><br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi><mo>=</mo><mn>61</mn><mo>×</mo><mn>53</mn><mo>=</mo><mn>3233</mn></mrow><annotation encoding="application/x-tex">n = p \times q = 61 \times 53 = 3233</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline">p</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">61</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">53</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">3233</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">But if I now tell you <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>3233</mn></mrow><annotation encoding="application/x-tex">n = 3233</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">3233</span></span></span></span> and ask you to find <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline">p</span></span></span></span> and <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span></span></span></span>, you might need to try many times to find the answer.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Now imagine if <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline">p</span></span></span></span> and <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span></span></span></span> were both 1024-bit prime numbers…</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">This is the core idea of RSA: <strong class="font-bold text-foreground">forward computation is simple, reverse computation is difficult</strong>.</p>
<h3 id="euler’s-totient-function-and-modular-arithmetic" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#euler’s-totient-function-and-modular-arithmetic" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Euler’s Totient Function and Modular Arithmetic">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Euler’s Totient Function and Modular Arithmetic
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The key to the RSA algorithm lies in Euler’s totient function <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>p</mi><mo>×</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n) = \phi(p \times q) = (p-1)(q-1)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">p</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord mathnormal inline">p</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">−</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord inline">1</span><span class="mclose inline">)</span><span class="mopen inline">(</span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">−</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord inline">1</span><span class="mclose inline">)</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">Continuing with our example:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mn>3233</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>61</mn><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>53</mn><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>60</mn><mo>×</mo><mn>52</mn><mo>=</mo><mn>3120</mn></mrow><annotation encoding="application/x-tex">\phi(3233) = (61-1)(53-1) = 60 \times 52 = 3120</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord inline">3233</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline">61</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">−</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord inline">1</span><span class="mclose inline">)</span><span class="mopen inline">(</span><span class="mord inline">53</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">−</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord inline">1</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">60</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">52</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">3120</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why calculate Euler’s totient function?</strong> Because it tells us how many numbers are coprime with <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span> under modulo <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span>.</p>
<h3 id="mathematical-process-of-public-private-key-generation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mathematical-process-of-public-private-key-generation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mathematical Process of Public-Private Key Generation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mathematical Process of Public-Private Key Generation
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Step 1: Choose the public key exponent <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span></span></span></span></strong></p>
<p class="text-base leading-7 mb-4 text-foreground">Here’s a small example, choosing <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>17</mn></mrow><annotation encoding="application/x-tex">e = 17</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">17</span></span></span></span>, which satisfies RSA conditions:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">1 &lt; e &lt; φ(n), i.e., 1 &lt; 17 &lt; 3120 ✓</li>
<li class="text-foreground leading-relaxed">gcd(17, 3120) = 1, i.e., 17 is coprime with 3120 ✓</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Note</strong>: In practical applications, <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>65537</mn></mrow><annotation encoding="application/x-tex">e = 65537</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">65537</span></span></span></span> is usually chosen, but that requires larger prime numbers so that <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span> is much greater than 65537.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Step 2: Calculate the private key exponent <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span></span></span></span></strong></p>
<p class="text-base leading-7 mb-4 text-foreground">Must satisfy:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>×</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e \times d \equiv 1 \pmod{\phi(n)}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">))</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">Using our example:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>17</mn><mo>×</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mn>3120</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">17 \times d \equiv 1 \pmod{3120}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">17</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord inline">3120</span><span class="mclose inline">)</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">Through the extended Euclidean algorithm, we can calculate <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>2753</mn></mrow><annotation encoding="application/x-tex">d = 2753</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">2753</span></span></span></span>.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Verification</strong>: <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>17</mn><mo>×</mo><mn>2753</mn><mo>=</mo><mn>46801</mn></mrow><annotation encoding="application/x-tex">17 \times 2753 = 46801</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">17</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">2753</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">46801</span></span></span></span>, <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>46801</mn><mo>=</mo><mn>15</mn><mo>×</mo><mn>3120</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>46800</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">46801 = 15 \times 3120 + 1 = 46800 + 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">46801</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">15</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">3120</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">46800</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span>, so <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>17</mn><mo>×</mo><mn>2753</mn><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mn>3120</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">17 \times 2753 \equiv 1 \pmod{3120}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">17</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">2753</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:0.4444em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord inline">3120</span><span class="mclose inline">)</span></span></span></span> ✓</p>
<h3 id="detailed-explanation-of-the-extended-euclidean-algorithm" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#detailed-explanation-of-the-extended-euclidean-algorithm" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Detailed Explanation of the Extended Euclidean Algorithm">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Detailed Explanation of the Extended Euclidean Algorithm
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">The extended Euclidean algorithm is a classic algorithm for solving linear Diophantine equations <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>gcd</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax + by = \gcd(a,b)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal inline">a</span><span class="mord mathnormal inline">x</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline">b</span><span class="mord mathnormal inline" style="margin-right:0.03588em;">y</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mop inline"><span style="margin-right:0.01389em;" class="inline">g</span>cd</span><span class="mopen inline">(</span><span class="mord mathnormal inline">a</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord mathnormal inline">b</span><span class="mclose inline">)</span></span></span></span>. In RSA, we need to solve:</p>
<p class="text-base leading-7 mb-4 text-foreground"><span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi><mo>+</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e \cdot d + \phi(n) \cdot k = 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">That is, find <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span></span></span></span> and <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span></span></span></span> such that <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e \cdot d \equiv 1 \pmod{\phi(n)}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:0.4444em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">))</span></span></span></span>.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Algorithm Steps</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Using our example, solving <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>17</mn><mo>⋅</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mn>3120</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">17 \cdot d \equiv 1 \pmod{3120}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">17</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:0.4444em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord inline">3120</span><span class="mclose inline">)</span></span></span></span>:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Initialization</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>0</mn></msub><mo>=</mo><mn>3120</mn><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo>=</mo><mn>17</mn></mrow><annotation encoding="application/x-tex">r_0 = 3120, r_1 = 17</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.02778em;">r</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">0</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord inline">3120</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.02778em;">r</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">1</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">17</span></span></span></span></li>
<li class="text-foreground leading-relaxed"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s_0 = 1, s_1 = 0</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord inline"><span class="mord mathnormal inline">s</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">0</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord inline">1</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord inline"><span class="mord mathnormal inline">s</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">1</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">0</span></span></span></span></li>
<li class="text-foreground leading-relaxed"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_0 = 0, t_1 = 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord inline"><span class="mord mathnormal inline">t</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">0</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord inline">0</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord inline"><span class="mord mathnormal inline">t</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">1</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span></li>
</ul></li>
<li class="text-foreground leading-relaxed"><p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Iteration Process</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Step%201%3A%20q%E2%82%81%20%3D%20%E2%8C%8A3120%2F17%E2%8C%8B%20%3D%20183%0Ar%E2%82%82%20%3D%203120%20-%20183%C3%9717%20%3D%203120%20-%203111%20%3D%209%0As%E2%82%82%20%3D%201%20-%20183%C3%970%20%3D%201%0At%E2%82%82%20%3D%200%20-%20183%C3%971%20%3D%20-183%0AStep%202%3A%20q%E2%82%82%20%3D%20%E2%8C%8A17%2F9%E2%8C%8B%20%3D%201%0Ar%E2%82%83%20%3D%2017%20-%201%C3%979%20%3D%208%0As%E2%82%83%20%3D%200%20-%201%C3%971%20%3D%20-1%0At%E2%82%83%20%3D%201%20-%201%C3%97(-183)%20%3D%20184%0AStep%203%3A%20q%E2%82%83%20%3D%20%E2%8C%8A9%2F8%E2%8C%8B%20%3D%201%0Ar%E2%82%84%20%3D%209%20-%201%C3%978%20%3D%201%0As%E2%82%84%20%3D%201%20-%201%C3%97(-1)%20%3D%202%0At%E2%82%84%20%3D%20-183%20-%201%C3%97184%20%3D%20-367%0AStep%204%3A%20r%E2%82%84%20%3D%201%2C%20algorithm%20ends">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-attribute inline">Step</span> <span class="hljs-number inline">1</span>: q₁ = ⌊<span class="hljs-number inline">3120</span>/<span class="hljs-number inline">17</span>⌋ = <span class="hljs-number inline">183</span>
<span class="hljs-attribute inline">r</span>₂ = <span class="hljs-number inline">3120</span> - <span class="hljs-number inline">183</span>×<span class="hljs-number inline">17</span> = <span class="hljs-number inline">3120</span> - <span class="hljs-number inline">3111</span> = <span class="hljs-number inline">9</span>
<span class="hljs-attribute inline">s</span>₂ = <span class="hljs-number inline">1</span> - <span class="hljs-number inline">183</span>×<span class="hljs-number inline">0</span> = <span class="hljs-number inline">1</span>
<span class="hljs-attribute inline">t</span>₂ = <span class="hljs-number inline">0</span> - <span class="hljs-number inline">183</span>×<span class="hljs-number inline">1</span> = -<span class="hljs-number inline">183</span>

<span class="hljs-attribute inline">Step</span> <span class="hljs-number inline">2</span>: q₂ = ⌊<span class="hljs-number inline">17</span>/<span class="hljs-number inline">9</span>⌋ = <span class="hljs-number inline">1</span>
<span class="hljs-attribute inline">r</span>₃ = <span class="hljs-number inline">17</span> - <span class="hljs-number inline">1</span>×<span class="hljs-number inline">9</span> = <span class="hljs-number inline">8</span>
<span class="hljs-attribute inline">s</span>₃ = <span class="hljs-number inline">0</span> - <span class="hljs-number inline">1</span>×<span class="hljs-number inline">1</span> = -<span class="hljs-number inline">1</span>
<span class="hljs-attribute inline">t</span>₃ = <span class="hljs-number inline">1</span> - <span class="hljs-number inline">1</span>×(-<span class="hljs-number inline">183</span>) = <span class="hljs-number inline">184</span>

<span class="hljs-attribute inline">Step</span> <span class="hljs-number inline">3</span>: q₃ = ⌊<span class="hljs-number inline">9</span>/<span class="hljs-number inline">8</span>⌋ = <span class="hljs-number inline">1</span>
<span class="hljs-attribute inline">r</span>₄ = <span class="hljs-number inline">9</span> - <span class="hljs-number inline">1</span>×<span class="hljs-number inline">8</span> = <span class="hljs-number inline">1</span>
<span class="hljs-attribute inline">s</span>₄ = <span class="hljs-number inline">1</span> - <span class="hljs-number inline">1</span>×(-<span class="hljs-number inline">1</span>) = <span class="hljs-number inline">2</span>
<span class="hljs-attribute inline">t</span>₄ = -<span class="hljs-number inline">183</span> - <span class="hljs-number inline">1</span>×<span class="hljs-number inline">184</span> = -<span class="hljs-number inline">367</span>

<span class="hljs-attribute inline">Step</span> <span class="hljs-number inline">4</span>: r₄ = <span class="hljs-number inline">1</span>, algorithm ends
</code></pre>
            </div>
        </li>
<li class="text-foreground leading-relaxed"><p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Final Result</strong>:<br class="block">
When <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>4</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_4 = 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.02778em;">r</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">4</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span>, the corresponding <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>4</mn></msub><mo>=</mo><mo>−</mo><mn>367</mn></mrow><annotation encoding="application/x-tex">t_4 = -367</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord inline"><span class="mord mathnormal inline">t</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">4</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">−</span><span class="mord inline">367</span></span></span></span>.</p>
<p class="text-base leading-7 mb-4 text-foreground">Since we need a positive number, <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mo>−</mo><mn>367</mn><mo>+</mo><mn>3120</mn><mo>=</mo><mn>2753</mn></mrow><annotation encoding="application/x-tex">d = -367 + 3120 = 2753</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">−</span><span class="mord inline">367</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">3120</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">2753</span></span></span></span>.</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Verification</strong>: <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>17</mn><mo>×</mo><mn>2753</mn><mo>=</mo><mn>46801</mn><mo>=</mo><mn>15</mn><mo>×</mo><mn>3120</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">17 \times 2753 = 46801 = 15 \times 3120 + 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">17</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">2753</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">46801</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">15</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">3120</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span>, indeed <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>17</mn><mo>×</mo><mn>2753</mn><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mn>3120</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">17 \times 2753 \equiv 1 \pmod{3120}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">17</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">2753</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:0.4444em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord inline">3120</span><span class="mclose inline">)</span></span></span></span> ✓</p></li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Mathematical Principle of the Algorithm</strong>:<br class="block">
The extended Euclidean algorithm is based on the fact that if <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gcd(e, \phi(n)) = 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mop inline"><span style="margin-right:0.01389em;" class="inline">g</span>cd</span><span class="mopen inline">(</span><span class="mord mathnormal inline">e</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">))</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span>, then there must exist integers <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span></span></span></span> and <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span></span></span></span> such that:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi><mo>+</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e \cdot d + \phi(n) \cdot k = 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">This is equivalent to:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e \cdot d \equiv 1 \pmod{\phi(n)}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">))</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">That is, <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span></span></span></span> is the <strong class="font-bold text-foreground">modular multiplicative inverse</strong> of <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span></span></span></span> under modulo <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span>.</p>
<h3 id="mathematical-principles-of-encryption-and-decryption" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mathematical-principles-of-encryption-and-decryption" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mathematical Principles of Encryption and Decryption">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mathematical Principles of Encryption and Decryption
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Symbol Explanation</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground">Let’s first clarify the meaning of each mathematical symbol:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span></span></span></span></strong> (message): <strong class="font-bold text-foreground">Plaintext message</strong>, the original data to be encrypted, must satisfy <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>m</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">0 \leq m &lt; n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord inline">0</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≤</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal inline">m</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">&lt;</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">c</span></span></span></span></strong> (ciphertext): <strong class="font-bold text-foreground">Ciphertext</strong>, the encrypted data</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span></span></span></span></strong> (encryption exponent): <strong class="font-bold text-foreground">Public key exponent</strong>, 17 in our example, usually 65537 in practical applications</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span></span></span></span></strong> (decryption exponent): <strong class="font-bold text-foreground">Private key exponent</strong>, the modular multiplicative inverse of e under modulo φ(n), 2753 in our example</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span></strong>: <strong class="font-bold text-foreground">Modulus</strong>, equal to the product of two large prime numbers, i.e., <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">n = p \times q</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline">p</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">×</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span></span></span></span></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span></strong>: <strong class="font-bold text-foreground">Euler’s totient function value</strong>, equal to <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p-1)(q-1)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord mathnormal inline">p</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">−</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord inline">1</span><span class="mclose inline">)</span><span class="mopen inline">(</span><span class="mord mathnormal inline" style="margin-right:0.03588em;">q</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">−</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord inline">1</span><span class="mclose inline">)</span></span></span></span>, representing the number of positive integers less than n and coprime with n</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span></span></span></span></strong>: <strong class="font-bold text-foreground">Arbitrary integer</strong>, auxiliary variable appearing in mathematical proofs</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Encryption Process</strong>:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c = m^e \bmod n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">c</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7144em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">e</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Decryption Process</strong>:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">m = c^d \bmod n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8991em;"></span><span class="mord inline"><span class="mord mathnormal inline">c</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">d</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Mathematical Proof of RSA Correctness</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Step 1: Apply Euler’s Theorem</strong><br class="block">
According to Euler’s theorem, for coprime <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span></span></span></span> and <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">n</span></span></span></span> (i.e., <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>gcd</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gcd(m,n) = 1</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mop inline"><span style="margin-right:0.01389em;" class="inline">g</span>cd</span><span class="mopen inline">(</span><span class="mord mathnormal inline">m</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span></span></span></span>):<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^{\phi(n)} \equiv 1 \pmod{n}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.938em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">ϕ</span><span class="mopen mtight inline">(</span><span class="mord mathnormal mtight inline">n</span><span class="mclose mtight inline">)</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Step 2: Utilize the Definition of the Private Key</strong><br class="block">
Since <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span></span></span></span> is the modular multiplicative inverse of <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span></span></span></span>, we have:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e \cdot d \equiv 1 \pmod{\phi(n)}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">))</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">This means there exists some integer <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span></span></span></span> such that:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo>⋅</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e \cdot d = 1 + k \cdot \phi(n)</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline">d</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord inline">1</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6944em;"></span><span class="mord mathnormal inline" style="margin-right:0.03148em;">k</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">ϕ</span><span class="mopen inline">(</span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Step 3: Verify the Decryption Process</strong><br class="block">
Now we prove that decryption can indeed recover the original message:</p>
<p class="text-base leading-7 mb-4 text-foreground"><span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>c</mi><mi>d</mi></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>m</mi><mi>e</mi></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>=</mo><msup><mi>m</mi><mrow><mn>1</mn><mo>+</mo><mi>k</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>m</mi><mn>1</mn></msup><mo>⋅</mo><msup><mi>m</mi><mrow><mi>k</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>m</mi><mo>⋅</mo><mo stretchy="false">(</mo><msup><mi>m</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">c^d = (m^e)^d = m^{ed} = m^{1 + k\phi(n)} = m^1 \cdot m^{k\phi(n)} = m \cdot (m^{\phi(n)})^k</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.8991em;"></span><span class="mord inline"><span class="mord mathnormal inline">c</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">d</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">e</span></span></span></span></span></span></span></span><span class="mclose inline"><span class="mclose inline">)</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">d</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8991em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">e</span><span class="mord mathnormal mtight inline">d</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.938em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mtight inline">1</span><span class="mbin mtight inline">+</span><span class="mord mathnormal mtight inline" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight inline">ϕ</span><span class="mopen mtight inline">(</span><span class="mord mathnormal mtight inline">n</span><span class="mclose mtight inline">)</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8641em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline">1</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.938em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight inline">ϕ</span><span class="mopen mtight inline">(</span><span class="mord mathnormal mtight inline">n</span><span class="mclose mtight inline">)</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">m</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">ϕ</span><span class="mopen mtight inline">(</span><span class="mord mathnormal mtight inline">n</span><span class="mclose mtight inline">)</span></span></span></span></span></span></span></span></span><span class="mclose inline"><span class="mclose inline">)</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">According to Euler’s theorem, <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^{\phi(n)} \equiv 1 \pmod{n}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.888em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">ϕ</span><span class="mopen mtight inline">(</span><span class="mord mathnormal mtight inline">n</span><span class="mclose mtight inline">)</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">1</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:0.4444em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span>, therefore:</p>
<p class="text-base leading-7 mb-4 text-foreground"><span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>⋅</mo><mo stretchy="false">(</mo><msup><mi>m</mi><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>≡</mo><mi>m</mi><mo>⋅</mo><msup><mn>1</mn><mi>k</mi></msup><mo>≡</mo><mi>m</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m \cdot (m^{\phi(n)})^k \equiv m \cdot 1^k \equiv m \pmod{n}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">m</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">ϕ</span><span class="mopen mtight inline">(</span><span class="mord mathnormal mtight inline">n</span><span class="mclose mtight inline">)</span></span></span></span></span></span></span></span></span><span class="mclose inline"><span class="mclose inline">)</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4445em;"></span><span class="mord mathnormal inline">m</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⋅</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8991em;"></span><span class="mord inline"><span class="mord inline">1</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Conclusion</strong>:<br class="block">
<span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>c</mi><mi>d</mi></msup><mo>≡</mo><mi>m</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c^d \equiv m \pmod{n}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.8991em;"></span><span class="mord inline"><span class="mord mathnormal inline">c</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">d</span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">≡</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span><span class="mspace allowbreak inline"></span><span class="mspace inline" style="margin-right:1em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.3333em;"></span><span class="mord mathnormal inline">n</span><span class="mclose inline">)</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Specific Numerical Verification</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Let plaintext <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>123</mn></mrow><annotation encoding="application/x-tex">m = 123</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">123</span></span></span></span></li>
<li class="text-foreground leading-relaxed">Encryption: <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mn>123</mn><mn>17</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mn>3233</mn></mrow><annotation encoding="application/x-tex">c = 123^{17} \bmod 3233</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">c</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8141em;"></span><span class="mord inline">12</span><span class="mord inline"><span class="mord inline">3</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mtight inline">17</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">3233</span></span></span></span></li>
<li class="text-foreground leading-relaxed">Decryption: <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msup><mi>c</mi><mn>2753</mn></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mn>3233</mn><mo>=</mo><mn>123</mn></mrow><annotation encoding="application/x-tex">m&#x27; = c^{2753} \bmod 3233 = 123</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.7519em;"></span><span class="mord inline"><span class="mord mathnormal inline">m</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mtight inline">′</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.8141em;"></span><span class="mord inline"><span class="mord mathnormal inline">c</span><span class="msupsub inline"><span class="vlist-t inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mtight inline">2753</span></span></span></span></span></span></span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline"><span class="mord inline"><span class="mord mathrm inline">mod</span></span></span><span class="mspace inline" style="margin-right:0.0556em;"></span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">3233</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">123</span></span></span></span></li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Important Note</strong>: This example uses small prime numbers for demonstration purposes only. In practical applications, RSA uses 1024-bit or 2048-bit large prime numbers, where <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>65537</mn></mrow><annotation encoding="application/x-tex">e = 65537</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">e</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:0.6444em;"></span><span class="mord inline">65537</span></span></span></span> is usually chosen because it provides good computational performance while ensuring security.</p>
<h2 id="rsa’s-role-positioning-in-web-security" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#rsa’s-role-positioning-in-web-security" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to RSA’s Role Positioning in Web Security">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            RSA’s Role Positioning in Web Security
        </h2>
<h3 id="selection-strategy-symmetric-vs-asymmetric-encryption" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#selection-strategy-symmetric-vs-asymmetric-encryption" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Selection Strategy: Symmetric vs Asymmetric Encryption">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Selection Strategy: Symmetric vs Asymmetric Encryption
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">In modern web applications, RSA is typically not used for encrypting large amounts of data, but rather plays the role of a &quot;key protector&quot;:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Traditional%20Dilemma%3A%0AUser%20--%5BPlaintext%20API%20Key%5D--%3E%20Server%20%20%E2%9D%8C%20Insecure%0AUser%20--%5BSymmetric%20Encryption%5D--%3E%20Server%20%20%20%20%E2%9D%8C%20Key%20Distribution%20Problem%0ARSA%20Solution%3A%0AUser%20--%5BRSA%20Public%20Key%20Encryption%5D--%3E%20Server%20--%5BRSA%20Private%20Key%20Decryption%5D--%3E%20Secure%20Storage%20%20%E2%9C%85">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>Traditional Dilemma:
<span class="hljs-keyword inline">User</span> <span class="hljs-title inline">--[Plaintext</span> API Key]--&gt; Server  ❌ Insecure
<span class="hljs-keyword inline">User</span> <span class="hljs-title inline">--[Symmetric</span> Encryption]--&gt; Server    ❌ Key Distribution Problem

RSA Solution:
<span class="hljs-keyword inline">User</span> <span class="hljs-title inline">--[RSA</span> Public Key Encryption]--&gt; Server --[RSA Private Key Decryption]--&gt; Secure Storage  ✅
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Performance Comparison</strong>:</p>
<table class="w-full border-collapse mb-4 shadow-sm rounded-lg overflow-hidden">
<thead class="bg-surface">
<tr class="border-b border-gray-200"><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Encryption Method</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Encryption Speed</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Decryption Speed</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Key Distribution</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Applicable Scenarios</th></tr>
</thead>
<tbody class="bg-background divide-y divide-gray-200">
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">AES-256</td><td class="px-4 py-3 text-sm text-foreground">Very Fast</td><td class="px-4 py-3 text-sm text-foreground">Very Fast</td><td class="px-4 py-3 text-sm text-foreground">Difficult</td><td class="px-4 py-3 text-sm text-foreground">Large Data</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">RSA-2048</td><td class="px-4 py-3 text-sm text-foreground">Slow</td><td class="px-4 py-3 text-sm text-foreground">Very Slow</td><td class="px-4 py-3 text-sm text-foreground">Simple</td><td class="px-4 py-3 text-sm text-foreground">Small Data/Key Exchange</td></tr>
</tbody>
</table>
<h3 id="security-of-rsa-oaep-padding-scheme" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#security-of-rsa-oaep-padding-scheme" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Security of RSA-OAEP Padding Scheme">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Security of RSA-OAEP Padding Scheme
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why is padding needed?</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">If using raw RSA directly:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Same plaintext always produces same ciphertext</li>
<li class="text-foreground leading-relaxed">Vulnerable to chosen plaintext attacks</li>
<li class="text-foreground leading-relaxed">Plaintext length information leakage</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">How OAEP Padding Works</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Plaintext%20%E2%86%92%20Add%20Random%20Number%20%E2%86%92%20Mask%20Generation%20%E2%86%92%20Final%20Ciphertext">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>Plaintext → Add <span class="hljs-built_in inline">Random</span> <span class="hljs-built_in inline">Number</span> → Mask Generation → Final Ciphertext
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">OAEP ensures:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Randomness</strong>: Same plaintext produces different encryption results each time</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Integrity</strong>: Any tampering will cause decryption to fail</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Semantic Security</strong>: Attackers cannot infer plaintext information from ciphertext</li>
</ol>
<h3 id="questions-party-security-architecture-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#questions-party-security-architecture-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Questions Party Security Architecture Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Questions Party Security Architecture Design
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Updating API Key:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="User%20Input%20API%20Key%20%E2%86%92%20Frontend%20RSA%20Encryption%20%E2%86%92%20HTTPS%20Transmission%20%E2%86%92%20Database%20Storage%20(stores%20ciphertext)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-keyword inline">User</span> <span class="hljs-keyword inline">Input</span> API Key → Frontend RSA Encryption → HTTPS Transmission → <span class="hljs-keyword inline">Database</span> <span class="hljs-keyword inline">Storage</span> (stores ciphertext)
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Using API Key to Send Requests:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="User%20Input%20Request%20Content%20%E2%86%92%20HTTPS%20Transmission%20%E2%86%92%20Backend%20RSA%20Decryption%20%E2%86%92%20Use%20Decrypted%20Plaintext%20Key%20to%20Call%20Large%20Model%20API%20%E2%86%92%20Parse%20Response%20and%20Return">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-keyword inline">User</span> <span class="hljs-keyword inline">Input</span> Request Content → HTTPS Transmission → Backend RSA Decryption → Use Decrypted Plaintext Key <span class="hljs-keyword inline">to</span> <span class="hljs-keyword inline">Call</span> <span class="hljs-keyword inline">Large</span> Model API → Parse Response <span class="hljs-keyword inline">and</span> <span class="hljs-keyword inline">Return</span>
</code></pre>
            </div>
        
<h2 id="rsa-implementation-architecture-in-the-questions-party-project" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#rsa-implementation-architecture-in-the-questions-party-project" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to RSA Implementation Architecture in the Questions Party Project">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            RSA Implementation Architecture in the Questions Party Project
        </h2>
<h3 id="overall-security-architecture-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#overall-security-architecture-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Overall Security Architecture Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Overall Security Architecture Design
        </h3>
<div class="mermaid block" id="mermaid-1767525093360-llsx37m">graph TB
    subgraph "Frontend Browser"
        A[User Input API Key] --> B[Get RSA Public Key]
        B --> C[Frontend RSA Encryption]
        C --> D[HTTPS Transmission]
    end
    
    subgraph "Backend Server"
        D --> E[Receive Encrypted Data]
        E --> G[Database Storage]
    end
    
    subgraph "Key Management"
        H[Environment Variable File] --> I[RSA Key Pair]
        I --> J[Public Key Distribution]
        I --> K[Private Key Protection]
    end
    
    J --> B
    K --> G</div>
<h3 id="encryption-strategy-in-frontend-backend-separation-architecture" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#encryption-strategy-in-frontend-backend-separation-architecture" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Encryption Strategy in Frontend-Backend Separation Architecture">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Encryption Strategy in Frontend-Backend Separation Architecture
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Frontend Responsibilities</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Get public key</li>
<li class="text-foreground leading-relaxed">Encrypt sensitive data</li>
<li class="text-foreground leading-relaxed">Transmit encrypted data</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Backend Responsibilities</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Key pair management</li>
<li class="text-foreground leading-relaxed">Public key distribution</li>
<li class="text-foreground leading-relaxed">Store encrypted data</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Security Boundaries</strong>:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">Private key never leaves the server</li>
<li class="text-foreground leading-relaxed">Public key can be freely distributed</li>
<li class="text-foreground leading-relaxed">Sensitive data is only decrypted when necessary</li>
</ul>
<h3 id="key-management-and-distribution-mechanism" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#key-management-and-distribution-mechanism" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Key Management and Distribution Mechanism">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Key Management and Distribution Mechanism
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20jsrsasign%20%3D%20require('jsrsasign')%3B%0Aconst%20%7B%20KEYUTIL%20%7D%20%3D%20jsrsasign%3B%0Aconst%20crypto%20%3D%20require('crypto')%3B%0Aclass%20RSACrypto%20%7B%0Aconstructor()%20%7B%0Athis.keySize%20%3D%202048%3B%0Athis.initializeKeys()%3B%0A%7D%0A%2F%2F%20Initialize%20RSA%20key%20pair%20from%20environment%20variables%20or%20generate%20new%20key%20pair%0AinitializeKeys()%20%7B%0Aif%20(process.env.RSA_PUBLIC_KEY%20%26%26%20process.env.RSA_PRIVATE_KEY)%20%7B%0A%2F%2F%20Handle%20escaped%20and%20non-escaped%20newlines%20(compatibility%20consideration)%0Athis.publicKeyPEM%20%3D%20process.env.RSA_PUBLIC_KEY.includes('%5C%5Cn')%0A%3F%20process.env.RSA_PUBLIC_KEY.replace(%2F%5C%5Cn%2Fg%2C%20'%5Cn')%0A%3A%20process.env.RSA_PUBLIC_KEY%3B%0Athis.privateKeyPEM%20%3D%20process.env.RSA_PRIVATE_KEY.includes('%5C%5Cn')%0A%3F%20process.env.RSA_PRIVATE_KEY.replace(%2F%5C%5Cn%2Fg%2C%20'%5Cn')%0A%3A%20process.env.RSA_PRIVATE_KEY%3B%0A%7D%20else%20%7B%0Aconsole.warn('RSA%20keys%20not%20found%20in%20environment.%20Generating%20new%20keys...')%3B%0Aconst%20keyPair%20%3D%20this.generateKeyPair()%3B%0Athis.publicKeyPEM%20%3D%20keyPair.publicKeyPEM%3B%0Athis.privateKeyPEM%20%3D%20keyPair.privateKeyPEM%3B%0Aconsole.log('Generated%20RSA%20Public%20Key%3A'%2C%20this.publicKeyPEM)%3B%0Aconsole.log('Generated%20RSA%20Private%20Key%3A'%2C%20this.privateKeyPEM)%3B%0Aconsole.log('Please%20add%20these%20keys%20to%20your%20.env%20file%3A')%3B%0Aconsole.log('RSA_PUBLIC_KEY%3D%22'%20%2B%20this.publicKeyPEM.replace(%2F%5Cn%2Fg%2C%20'%5C%5Cn')%20%2B%20'%22')%3B%0Aconsole.log('RSA_PRIVATE_KEY%3D%22'%20%2B%20this.privateKeyPEM.replace(%2F%5Cn%2Fg%2C%20'%5C%5Cn')%20%2B%20'%22')%3B%0A%7D%0A%7D%0A%2F%2F%20RSA%20key%20pair%20generation%3A%20use%20jsrsasign%20to%20generate%20standard%20format%20keys%0AgenerateKeyPair(keySize%20%3D%202048)%20%7B%0Atry%20%7B%0Aconst%20keyPair%20%3D%20KEYUTIL.generateKeypair('RSA'%2C%20keySize)%3B%0Aconst%20publicKeyPEM%20%3D%20KEYUTIL.getPEM(keyPair.pubKeyObj)%3B%20%20%20%20%20%20%20%2F%2F%20Public%20key%20PEM%20format%0Aconst%20privateKeyPEM%20%3D%20KEYUTIL.getPEM(keyPair.prvKeyObj%2C%20'PKCS8PRV')%3B%20%20%2F%2F%20Private%20key%20PKCS8%20format%0Areturn%20%7B%20publicKeyPEM%2C%20privateKeyPEM%20%7D%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20key%20generation%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Public%20key%20distribution%20interface%3A%20for%20frontend%20to%20get%20public%20key%0AgetPublicKey()%20%7B%0Areturn%20this.publicKeyPEM%3B%0A%7D%0A%2F%2F%20RSA-OAEP%20encryption%20implementation%3A%20use%20Node.js%20crypto%20module%20to%20ensure%20optimal%20performance%20and%20security%0Aencrypt(plaintext)%20%7B%0Atry%20%7B%0A%2F%2F%20Input%20validation%3A%20ensure%20plaintext%20is%20valid%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0A%2F%2F%20UTF-8%20encoding%20conversion%3A%20ensure%20proper%20handling%20of%20Chinese%20and%20other%20characters%0Aconst%20buffer%20%3D%20Buffer.from(plaintext%2C%20'utf8')%3B%0A%2F%2F%20Core%20encryption%20logic%3A%20RSA%20encryption%20with%20OAEP%20padding%0A%2F%2F%20Choose%20Node.js%20crypto%20over%20jsrsasign%3A%20more%20reliable%20OAEP%20implementation%0Aconst%20encrypted%20%3D%20crypto.publicEncrypt(%0A%7B%0Akey%3A%20this.publicKeyPEM%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20PEM%20format%20public%20key%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%20%20%20%2F%2F%20OAEP%20padding%2C%20prevents%20padding%20attacks%0AoaepHash%3A%20'sha256'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20SHA-256%20hash%20function%0A%7D%2C%0Abuffer%0A)%3B%0A%2F%2F%20Base64%20encoding%3A%20convenient%20for%20network%20transmission%20and%20storage%0Areturn%20encrypted.toString('base64')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20RSA-OAEP%20decryption%20implementation%3A%20core%20of%20temporary%20decryption%20strategy%0Adecrypt(encryptedData)%20%7B%0Atry%20%7B%0A%2F%2F%20Input%20validation%3A%20ensure%20ciphertext%20format%20is%20correct%0Aif%20(!encryptedData%20%7C%7C%20typeof%20encryptedData%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20encrypted%20data%20for%20decryption')%3B%0A%7D%0A%2F%2F%20Base64%20decoding%3A%20restore%20binary%20ciphertext%0Aconst%20encryptedBuffer%20%3D%20Buffer.from(encryptedData%2C%20'base64')%3B%0A%2F%2F%20Core%20decryption%20logic%3A%20decrypt%20using%20private%20key%0Aconst%20decrypted%20%3D%20crypto.privateDecrypt(%0A%7B%0Akey%3A%20this.privateKeyPEM%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20PEM%20format%20private%20key%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%20%20%20%2F%2F%20Consistent%20padding%20with%20encryption%0AoaepHash%3A%20'sha256'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Consistent%20hash%20with%20encryption%0A%7D%2C%0AencryptedBuffer%0A)%3B%0A%2F%2F%20UTF-8%20decoding%3A%20restore%20original%20string%0Areturn%20decrypted.toString('utf8')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20decryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Flexible%20encryption%20interface%3A%20support%20encryption%20with%20arbitrary%20public%20key%20(for%20testing)%0AencryptWithPublicKey(plaintext%2C%20publicKeyPEM)%20%7B%0Atry%20%7B%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0Aconst%20buffer%20%3D%20Buffer.from(plaintext%2C%20'utf8')%3B%0A%2F%2F%20Encrypt%20using%20externally%20provided%20public%20key%0Aconst%20encrypted%20%3D%20crypto.publicEncrypt(%0A%7B%0Akey%3A%20publicKeyPEM%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20External%20public%20key%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%0AoaepHash%3A%20'sha256'%2C%0A%7D%2C%0Abuffer%0A)%3B%0Areturn%20encrypted.toString('base64')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20with%20provided%20key%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Key%20validation%20utility%3A%20ensure%20key%20format%20is%20correct%0AvalidateKey(keyPEM%2C%20isPrivate%20%3D%20false)%20%7B%0Atry%20%7B%0Aconst%20keyObj%20%3D%20KEYUTIL.getKey(keyPEM)%3B%0Areturn%20keyObj%20%26%26%20(isPrivate%20%3F%20keyObj.isPrivate%20%3A%20keyObj.isPublic)%3B%0A%7D%20catch%20(error)%20%7B%0Areturn%20false%3B%20%20%20%2F%2F%20Return%20false%20on%20validation%20failure%20instead%20of%20throwing%20exception%0A%7D%0A%7D%0A%7D%0A%2F%2F%20Singleton%20pattern%20export%3A%20global%20unique%20instance%2C%20saves%20memory%20and%20ensures%20cache%20consistency%0Aconst%20rsaCrypto%20%3D%20new%20RSACrypto()%3B%0A%2F%2F%20Module%20export%3A%20provide%20multiple%20usage%20methods%0Amodule.exports%20%3D%20%7B%0ARSACrypto%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Export%20class%20(for%20extension)%0ArsaCrypto%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Export%20singleton%20instance%0AgenerateKeyPair%3A%20(keySize)%20%3D%3E%20rsaCrypto.generateKeyPair(keySize)%2C%20%20%20%20%20%2F%2F%20Convenience%20function%0Aencrypt%3A%20(plaintext)%20%3D%3E%20rsaCrypto.encrypt(plaintext)%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Convenience%20function%0Adecrypt%3A%20(encryptedData)%20%3D%3E%20rsaCrypto.decrypt(encryptedData)%2C%20%20%20%20%20%20%20%20%20%2F%2F%20Convenience%20function%0AgetPublicKey%3A%20()%20%3D%3E%20rsaCrypto.getPublicKey()%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Convenience%20function%0AencryptWithPublicKey%3A%20(plaintext%2C%20publicKey)%20%3D%3E%20rsaCrypto.encryptWithPublicKey(plaintext%2C%20publicKey)%2C%0AvalidateKey%3A%20(keyPEM%2C%20isPrivate)%20%3D%3E%20rsaCrypto.validateKey(keyPEM%2C%20isPrivate)%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> jsrsasign = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;jsrsasign&#x27;</span>);
<span class="hljs-keyword inline">const</span> { <span class="hljs-variable constant_ inline">KEYUTIL</span> } = jsrsasign;
<span class="hljs-keyword inline">const</span> crypto = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;crypto&#x27;</span>);

<span class="hljs-keyword inline">class</span> <span class="hljs-title class_ inline">RSACrypto</span> {
  <span class="hljs-title function_ inline">constructor</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">keySize</span> = <span class="hljs-number inline">2048</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">initializeKeys</span>();
  }

  <span class="hljs-comment inline">// Initialize RSA key pair from environment variables or generate new key pair</span>
  <span class="hljs-title function_ inline">initializeKeys</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">if</span> (process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span> &amp;&amp; process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>) {
      <span class="hljs-comment inline">// Handle escaped and non-escaped newlines (compatibility consideration)</span>
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span> = process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span>.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27;\\n&#x27;</span>) 
        ? process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\\n/g</span>, <span class="hljs-string inline">&#x27;\n&#x27;</span>)
        : process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span>;
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span> = process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27;\\n&#x27;</span>)
        ? process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\\n/g</span>, <span class="hljs-string inline">&#x27;\n&#x27;</span>)
        : process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>;
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;RSA keys not found in environment. Generating new keys...&#x27;</span>);
      <span class="hljs-keyword inline">const</span> keyPair = <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">generateKeyPair</span>();
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span> = keyPair.<span class="hljs-property inline">publicKeyPEM</span>;
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span> = keyPair.<span class="hljs-property inline">privateKeyPEM</span>;
      
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Generated RSA Public Key:&#x27;</span>, <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Generated RSA Private Key:&#x27;</span>, <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Please add these keys to your .env file:&#x27;</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;RSA_PUBLIC_KEY=&quot;&#x27;</span> + <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\n/g</span>, <span class="hljs-string inline">&#x27;\\n&#x27;</span>) + <span class="hljs-string inline">&#x27;&quot;&#x27;</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;RSA_PRIVATE_KEY=&quot;&#x27;</span> + <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\n/g</span>, <span class="hljs-string inline">&#x27;\\n&#x27;</span>) + <span class="hljs-string inline">&#x27;&quot;&#x27;</span>);
    }
  }

  <span class="hljs-comment inline">// RSA key pair generation: use jsrsasign to generate standard format keys</span>
  <span class="hljs-title function_ inline">generateKeyPair</span>(<span class="hljs-params inline">keySize = <span class="hljs-number inline">2048</span></span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">const</span> keyPair = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">generateKeypair</span>(<span class="hljs-string inline">&#x27;RSA&#x27;</span>, keySize);
      <span class="hljs-keyword inline">const</span> publicKeyPEM = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getPEM</span>(keyPair.<span class="hljs-property inline">pubKeyObj</span>);       <span class="hljs-comment inline">// Public key PEM format</span>
      <span class="hljs-keyword inline">const</span> privateKeyPEM = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getPEM</span>(keyPair.<span class="hljs-property inline">prvKeyObj</span>, <span class="hljs-string inline">&#x27;PKCS8PRV&#x27;</span>);  <span class="hljs-comment inline">// Private key PKCS8 format</span>
      
      <span class="hljs-keyword inline">return</span> { publicKeyPEM, privateKeyPEM };
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA key generation failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// Public key distribution interface: for frontend to get public key</span>
  <span class="hljs-title function_ inline">getPublicKey</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>;
  }

  <span class="hljs-comment inline">// RSA-OAEP encryption implementation: use Node.js crypto module to ensure optimal performance and security</span>
  <span class="hljs-title function_ inline">encrypt</span>(<span class="hljs-params inline">plaintext</span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-comment inline">// Input validation: ensure plaintext is valid</span>
      <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
      }

      <span class="hljs-comment inline">// UTF-8 encoding conversion: ensure proper handling of Chinese and other characters</span>
      <span class="hljs-keyword inline">const</span> buffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(plaintext, <span class="hljs-string inline">&#x27;utf8&#x27;</span>);
      
      <span class="hljs-comment inline">// Core encryption logic: RSA encryption with OAEP padding</span>
      <span class="hljs-comment inline">// Choose Node.js crypto over jsrsasign: more reliable OAEP implementation</span>
      <span class="hljs-keyword inline">const</span> encrypted = crypto.<span class="hljs-title function_ inline">publicEncrypt</span>(
        {
          <span class="hljs-attr inline">key</span>: <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>,                              <span class="hljs-comment inline">// PEM format public key</span>
          <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,   <span class="hljs-comment inline">// OAEP padding, prevents padding attacks</span>
          <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,                                  <span class="hljs-comment inline">// SHA-256 hash function</span>
        },
        buffer
      );

      <span class="hljs-comment inline">// Base64 encoding: convenient for network transmission and storage</span>
      <span class="hljs-keyword inline">return</span> encrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;base64&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// RSA-OAEP decryption implementation: core of temporary decryption strategy</span>
  <span class="hljs-title function_ inline">decrypt</span>(<span class="hljs-params inline">encryptedData</span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-comment inline">// Input validation: ensure ciphertext format is correct</span>
      <span class="hljs-keyword inline">if</span> (!encryptedData || <span class="hljs-keyword inline">typeof</span> encryptedData !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid encrypted data for decryption&#x27;</span>);
      }

      <span class="hljs-comment inline">// Base64 decoding: restore binary ciphertext</span>
      <span class="hljs-keyword inline">const</span> encryptedBuffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(encryptedData, <span class="hljs-string inline">&#x27;base64&#x27;</span>);
      
      <span class="hljs-comment inline">// Core decryption logic: decrypt using private key</span>
      <span class="hljs-keyword inline">const</span> decrypted = crypto.<span class="hljs-title function_ inline">privateDecrypt</span>(
        {
          <span class="hljs-attr inline">key</span>: <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span>,                             <span class="hljs-comment inline">// PEM format private key</span>
          <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,   <span class="hljs-comment inline">// Consistent padding with encryption</span>
          <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,                                  <span class="hljs-comment inline">// Consistent hash with encryption</span>
        },
        encryptedBuffer
      );

      <span class="hljs-comment inline">// UTF-8 decoding: restore original string</span>
      <span class="hljs-keyword inline">return</span> decrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;utf8&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA decryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// Flexible encryption interface: support encryption with arbitrary public key (for testing)</span>
  <span class="hljs-title function_ inline">encryptWithPublicKey</span>(<span class="hljs-params inline">plaintext, publicKeyPEM</span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
      }

      <span class="hljs-keyword inline">const</span> buffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(plaintext, <span class="hljs-string inline">&#x27;utf8&#x27;</span>);
      
      <span class="hljs-comment inline">// Encrypt using externally provided public key</span>
      <span class="hljs-keyword inline">const</span> encrypted = crypto.<span class="hljs-title function_ inline">publicEncrypt</span>(
        {
          <span class="hljs-attr inline">key</span>: publicKeyPEM,                                   <span class="hljs-comment inline">// External public key</span>
          <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,
          <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,
        },
        buffer
      );

      <span class="hljs-keyword inline">return</span> encrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;base64&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption with provided key failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// Key validation utility: ensure key format is correct</span>
  <span class="hljs-title function_ inline">validateKey</span>(<span class="hljs-params inline">keyPEM, isPrivate = <span class="hljs-literal inline">false</span></span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">const</span> keyObj = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getKey</span>(keyPEM);
      <span class="hljs-keyword inline">return</span> keyObj &amp;&amp; (isPrivate ? keyObj.<span class="hljs-property inline">isPrivate</span> : keyObj.<span class="hljs-property inline">isPublic</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>;   <span class="hljs-comment inline">// Return false on validation failure instead of throwing exception</span>
    }
  }
}

<span class="hljs-comment inline">// Singleton pattern export: global unique instance, saves memory and ensures cache consistency</span>
<span class="hljs-keyword inline">const</span> rsaCrypto = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RSACrypto</span>();

<span class="hljs-comment inline">// Module export: provide multiple usage methods</span>
<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = {
  <span class="hljs-title class_ inline">RSACrypto</span>,                                                    <span class="hljs-comment inline">// Export class (for extension)</span>
  rsaCrypto,                                                   <span class="hljs-comment inline">// Export singleton instance</span>
  <span class="hljs-attr inline">generateKeyPair</span>: <span class="hljs-function inline">(<span class="hljs-params inline">keySize</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">generateKeyPair</span>(keySize),     <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">encrypt</span>: <span class="hljs-function inline">(<span class="hljs-params inline">plaintext</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">encrypt</span>(plaintext),                 <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">decrypt</span>: <span class="hljs-function inline">(<span class="hljs-params inline">encryptedData</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">decrypt</span>(encryptedData),         <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">getPublicKey</span>: <span class="hljs-function inline">() =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">getPublicKey</span>(),                         <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">encryptWithPublicKey</span>: <span class="hljs-function inline">(<span class="hljs-params inline">plaintext, publicKey</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">encryptWithPublicKey</span>(plaintext, publicKey),
  <span class="hljs-attr inline">validateKey</span>: <span class="hljs-function inline">(<span class="hljs-params inline">keyPEM, isPrivate</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">validateKey</span>(keyPEM, isPrivate)
};
</code></pre>
            </div>
        
<h3 id="key-initialization-design" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#key-initialization-design" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Key Initialization Design">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Key Initialization Design
        </h3>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Environment Variable Priority</strong>: Production environment uses pre-configured keys</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Auto-generation Fallback</strong>: Development environment auto-generates temporary keys</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Format Compatibility</strong>: Handle escape character compatibility issues</li>
</ol>
<h3 id="encrypted-data-storage-strategy" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#encrypted-data-storage-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Encrypted Data Storage Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Encrypted Data Storage Strategy
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Method%20to%20decrypt%20API%20key%20using%20RSA%0AuserSchema.methods.decryptApiKey%20%3D%20function(encryptedKey%20%3D%20null)%20%7B%0Atry%20%7B%0Aconst%20keyToDecrypt%20%3D%20encryptedKey%20%7C%7C%20this.apiKey%3B%0Aif%20(!keyToDecrypt)%20%7B%0Areturn%20null%3B%0A%7D%0A%2F%2F%20Check%20if%20it's%20RSA%20encrypted%20(base64%20format%20from%20frontend)%0Aif%20(keyToDecrypt.startsWith('rsa%3A'))%20%7B%0Aconst%20encryptedData%20%3D%20keyToDecrypt.substring(4)%3B%0Areturn%20decrypt(encryptedData)%3B%0A%7D%0A%2F%2F%20If%20not%20encrypted%2C%20return%20directly%20(for%20development%2Ftesting)%0Areturn%20keyToDecrypt%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60API%20key%20decryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Method to decrypt API key using RSA</span>
userSchema.<span class="hljs-property inline">methods</span>.<span class="hljs-property inline">decryptApiKey</span> = <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">encryptedKey = <span class="hljs-literal inline">null</span></span>) {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> keyToDecrypt = encryptedKey || <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">apiKey</span>;
    
    <span class="hljs-keyword inline">if</span> (!keyToDecrypt) {
      <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
    }

    <span class="hljs-comment inline">// Check if it&#x27;s RSA encrypted (base64 format from frontend)</span>
    <span class="hljs-keyword inline">if</span> (keyToDecrypt.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;rsa:&#x27;</span>)) {
      <span class="hljs-keyword inline">const</span> encryptedData = keyToDecrypt.<span class="hljs-title function_ inline">substring</span>(<span class="hljs-number inline">4</span>);
      <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">decrypt</span>(encryptedData);
    }
    
    <span class="hljs-comment inline">// If not encrypted, return directly (for development/testing)</span>
    <span class="hljs-keyword inline">return</span> keyToDecrypt;
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`API key decryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
  }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Storage Strategy</strong>:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Prefix Identification</strong>: <code>rsa:</code> prefix identifies encrypted data</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Compatibility Handling</strong>: Support plaintext storage (development environment)</li>
</ol>
<h2 id="backend-rsa-key-management-and-encryption-service" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#backend-rsa-key-management-and-encryption-service" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Backend RSA Key Management and Encryption Service">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Backend RSA Key Management and Encryption Service
        </h2>
<h3 id="singleton-pattern-design-of-rsacrypto-class" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#singleton-pattern-design-of-rsacrypto-class" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Singleton Pattern Design of RSACrypto Class">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Singleton Pattern Design of RSACrypto Class
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Export%20singleton%20instance%0Aconst%20rsaCrypto%20%3D%20new%20RSACrypto()%3B%0Amodule.exports%20%3D%20%7B%0ARSACrypto%2C%0ArsaCrypto%2C%0AgenerateKeyPair%3A%20(keySize)%20%3D%3E%20rsaCrypto.generateKeyPair(keySize)%2C%0Aencrypt%3A%20(plaintext)%20%3D%3E%20rsaCrypto.encrypt(plaintext)%2C%0Adecrypt%3A%20(encryptedData)%20%3D%3E%20rsaCrypto.decrypt(encryptedData)%2C%0AgetPublicKey%3A%20()%20%3D%3E%20rsaCrypto.getPublicKey()%2C%0AencryptWithPublicKey%3A%20(plaintext%2C%20publicKey)%20%3D%3E%20rsaCrypto.encryptWithPublicKey(plaintext%2C%20publicKey)%2C%0AvalidateKey%3A%20(keyPEM%2C%20isPrivate)%20%3D%3E%20rsaCrypto.validateKey(keyPEM%2C%20isPrivate)%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Export singleton instance</span>
<span class="hljs-keyword inline">const</span> rsaCrypto = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RSACrypto</span>();

<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = {
  <span class="hljs-title class_ inline">RSACrypto</span>,
  rsaCrypto,
  <span class="hljs-attr inline">generateKeyPair</span>: <span class="hljs-function inline">(<span class="hljs-params inline">keySize</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">generateKeyPair</span>(keySize),
  <span class="hljs-attr inline">encrypt</span>: <span class="hljs-function inline">(<span class="hljs-params inline">plaintext</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">encrypt</span>(plaintext),
  <span class="hljs-attr inline">decrypt</span>: <span class="hljs-function inline">(<span class="hljs-params inline">encryptedData</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">decrypt</span>(encryptedData),
  <span class="hljs-attr inline">getPublicKey</span>: <span class="hljs-function inline">() =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">getPublicKey</span>(),
  <span class="hljs-attr inline">encryptWithPublicKey</span>: <span class="hljs-function inline">(<span class="hljs-params inline">plaintext, publicKey</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">encryptWithPublicKey</span>(plaintext, publicKey),
  <span class="hljs-attr inline">validateKey</span>: <span class="hljs-function inline">(<span class="hljs-params inline">keyPEM, isPrivate</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">validateKey</span>(keyPEM, isPrivate)
};
</code></pre>
            </div>
        
<h3 id="key-initialization-strategy" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#key-initialization-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Key Initialization Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Key Initialization Strategy
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Generation Strategy</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Production%20environment%3A%20use%20environment%20variables%0Aif%20(process.env.RSA_PUBLIC_KEY%20%26%26%20process.env.RSA_PRIVATE_KEY)%20%7B%0A%2F%2F%20Use%20pre-configured%20key%20pair%0A%7D%20else%20%7B%0A%2F%2F%20Development%20environment%3A%20dynamic%20generation%0Aconst%20keyPair%20%3D%20this.generateKeyPair()%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Production environment: use environment variables</span>
<span class="hljs-keyword inline">if</span> (process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span> &amp;&amp; process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>) {
  <span class="hljs-comment inline">// Use pre-configured key pair</span>
} <span class="hljs-keyword inline">else</span> {
  <span class="hljs-comment inline">// Development environment: dynamic generation</span>
  <span class="hljs-keyword inline">const</span> keyPair = <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">generateKeyPair</span>();
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Mathematical Process of Key Generation</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Generate%20RSA%20key%20pair%0AgenerateKeyPair(keySize%20%3D%202048)%20%7B%0Atry%20%7B%0Aconst%20keyPair%20%3D%20KEYUTIL.generateKeypair('RSA'%2C%20keySize)%3B%0Aconst%20publicKeyPEM%20%3D%20KEYUTIL.getPEM(keyPair.pubKeyObj)%3B%0Aconst%20privateKeyPEM%20%3D%20KEYUTIL.getPEM(keyPair.prvKeyObj%2C%20'PKCS8PRV')%3B%0Areturn%20%7B%20publicKeyPEM%2C%20privateKeyPEM%20%7D%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20key%20generation%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Generate RSA key pair</span>
<span class="hljs-title function_ inline">generateKeyPair</span>(<span class="hljs-params inline">keySize = <span class="hljs-number inline">2048</span></span>) {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> keyPair = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">generateKeypair</span>(<span class="hljs-string inline">&#x27;RSA&#x27;</span>, keySize);
    <span class="hljs-keyword inline">const</span> publicKeyPEM = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getPEM</span>(keyPair.<span class="hljs-property inline">pubKeyObj</span>);
    <span class="hljs-keyword inline">const</span> privateKeyPEM = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getPEM</span>(keyPair.<span class="hljs-property inline">prvKeyObj</span>, <span class="hljs-string inline">&#x27;PKCS8PRV&#x27;</span>);
    
    <span class="hljs-keyword inline">return</span> { publicKeyPEM, privateKeyPEM };
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA key generation failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
  }
}
</code></pre>
            </div>
        
<h3 id="nodejs-crypto-module’s-oaep-implementation" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#nodejs-crypto-module’s-oaep-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Node.js Crypto Module’s OAEP Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Node.js Crypto Module’s OAEP Implementation
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Use%20RSA-OAEP%20and%20public%20key%20to%20encrypt%20data%0Aencrypt(plaintext)%20%7B%0Atry%20%7B%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0A%2F%2F%20Convert%20plaintext%20to%20Buffer%0Aconst%20buffer%20%3D%20Buffer.from(plaintext%2C%20'utf8')%3B%0A%2F%2F%20Use%20Node.js%20crypto%20module%20for%20RSA-OAEP%20encryption%20(more%20reliable%20than%20jsrsasign)%0Aconst%20encrypted%20%3D%20crypto.publicEncrypt(%0A%7B%0Akey%3A%20this.publicKeyPEM%2C%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%0AoaepHash%3A%20'sha256'%2C%0A%7D%2C%0Abuffer%0A)%3B%0Areturn%20encrypted.toString('base64')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Use RSA-OAEP and public key to encrypt data</span>
<span class="hljs-title function_ inline">encrypt</span>(<span class="hljs-params inline">plaintext</span>) {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
    }

    <span class="hljs-comment inline">// Convert plaintext to Buffer</span>
    <span class="hljs-keyword inline">const</span> buffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(plaintext, <span class="hljs-string inline">&#x27;utf8&#x27;</span>);
    
    <span class="hljs-comment inline">// Use Node.js crypto module for RSA-OAEP encryption (more reliable than jsrsasign)</span>
    <span class="hljs-keyword inline">const</span> encrypted = crypto.<span class="hljs-title function_ inline">publicEncrypt</span>(
      {
        <span class="hljs-attr inline">key</span>: <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>,
        <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,
        <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,
      },
      buffer
    );

    <span class="hljs-keyword inline">return</span> encrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;base64&#x27;</span>);
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
  }
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">OAEP Parameter Analysis</strong>:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">padding: RSA_PKCS1_OAEP_PADDING</strong>: Use OAEP padding scheme</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">oaepHash: ‘sha256’</strong>: Use SHA-256 as hash function</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Output Format</strong>: Base64 encoding for easy transmission</li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Why Mix jsrsasign and crypto?</strong></p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">jsrsasign</strong>: Key generation and management</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">crypto</strong>: Encryption and decryption operations (better performance)</li>
</ul>
<h2 id="deep-analysis-of-frontend-rsa-encryption-implementation" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#deep-analysis-of-frontend-rsa-encryption-implementation" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Deep Analysis of Frontend RSA Encryption Implementation">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Deep Analysis of Frontend RSA Encryption Implementation
        </h2>
<h3 id="usage-of-web-crypto-api" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#usage-of-web-crypto-api" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Usage of Web Crypto API">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Usage of Web Crypto API
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Use%20RSA-OAEP%20for%20encryption%20(compatible%20with%20backend)%0Aasync%20encrypt(plaintext%3A%20string)%3A%20Promisestring%3E%20%7B%0Aif%20(!this.publicKey)%20%7B%0Athrow%20new%20Error('Public%20key%20not%20set.%20Call%20setPublicKey()%20first.')%3B%0A%7D%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0Atry%20%7B%0A%2F%2F%20Use%20Web%20Crypto%20API%20for%20RSA-OAEP%20encryption%0A%2F%2F%20First%2C%20import%20the%20public%20key%0Aconst%20publicKeyBuffer%20%3D%20this.pemToArrayBuffer(this.publicKey)%3B%0Aconst%20cryptoKey%20%3D%20await%20window.crypto.subtle.importKey(%0A'spki'%2C%0ApublicKeyBuffer%2C%0A%7B%0Aname%3A%20'RSA-OAEP'%2C%0Ahash%3A%20'SHA-256'%2C%0A%7D%2C%0Afalse%2C%0A%5B'encrypt'%5D%0A)%3B%0A%2F%2F%20Encrypt%20plaintext%0Aconst%20plaintextBuffer%20%3D%20new%20TextEncoder().encode(plaintext)%3B%0Aconst%20encryptedBuffer%20%3D%20await%20window.crypto.subtle.encrypt(%0A%7B%0Aname%3A%20'RSA-OAEP'%2C%0A%7D%2C%0AcryptoKey%2C%0AplaintextBuffer%0A)%3B%0A%2F%2F%20Convert%20to%20base64%20to%20match%20backend%20format%0Areturn%20this.arrayBufferToBase64(encryptedBuffer)%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20failed%3A%20%24%7Berror%20instanceof%20Error%20%3F%20error.message%20%3A%20'Unknown%20error'%7D%60)%3B%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Use RSA-OAEP for encryption (compatible with backend)</span>
<span class="hljs-keyword inline">async</span> <span class="hljs-title function_ inline">encrypt</span>(<span class="hljs-attr inline">plaintext</span>: <span class="hljs-built_in inline">string</span>): <span class="hljs-title class_ inline">Promise</span>&lt;<span class="hljs-built_in inline">string</span>&gt; {
  <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKey</span>) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Public key not set. Call setPublicKey() first.&#x27;</span>);
  }

  <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
  }

  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-comment inline">// Use Web Crypto API for RSA-OAEP encryption</span>
    <span class="hljs-comment inline">// First, import the public key</span>
    <span class="hljs-keyword inline">const</span> publicKeyBuffer = <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">pemToArrayBuffer</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKey</span>);

    <span class="hljs-keyword inline">const</span> cryptoKey = <span class="hljs-keyword inline">await</span> <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">crypto</span>.<span class="hljs-property inline">subtle</span>.<span class="hljs-title function_ inline">importKey</span>(
      <span class="hljs-string inline">&#x27;spki&#x27;</span>,
      publicKeyBuffer,
      {
        <span class="hljs-attr inline">name</span>: <span class="hljs-string inline">&#x27;RSA-OAEP&#x27;</span>,
        <span class="hljs-attr inline">hash</span>: <span class="hljs-string inline">&#x27;SHA-256&#x27;</span>,
      },
      <span class="hljs-literal inline">false</span>,
      [<span class="hljs-string inline">&#x27;encrypt&#x27;</span>]
    );

    <span class="hljs-comment inline">// Encrypt plaintext</span>
    <span class="hljs-keyword inline">const</span> plaintextBuffer = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">TextEncoder</span>().<span class="hljs-title function_ inline">encode</span>(plaintext);
    <span class="hljs-keyword inline">const</span> encryptedBuffer = <span class="hljs-keyword inline">await</span> <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">crypto</span>.<span class="hljs-property inline">subtle</span>.<span class="hljs-title function_ inline">encrypt</span>(
      {
        <span class="hljs-attr inline">name</span>: <span class="hljs-string inline">&#x27;RSA-OAEP&#x27;</span>,
      },
      cryptoKey,
      plaintextBuffer
    );

    <span class="hljs-comment inline">// Convert to base64 to match backend format</span>
    <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">arrayBufferToBase64</span>(encryptedBuffer);
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption failed: <span class="hljs-subst inline">${error <span class="hljs-keyword inline">instanceof</span> <span class="hljs-built_in inline">Error</span> ? error.message : <span class="hljs-string inline">&#x27;Unknown error&#x27;</span>}</span>`</span>);
  }
}
</code></pre>
            </div>
        
<h3 id="processing-of-pem-format-keys" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#processing-of-pem-format-keys" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Processing of PEM Format Keys">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Processing of PEM Format Keys
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Helper%20method%3A%20convert%20PEM%20format%20to%20ArrayBuffer%0Aprivate%20pemToArrayBuffer(pem%3A%20string)%3A%20ArrayBuffer%20%7B%0A%2F%2F%20Remove%20header%20and%20footer%0Aconst%20pemHeader%20%3D%20'-----BEGIN%20PUBLIC%20KEY-----'%3B%0Aconst%20pemFooter%20%3D%20'-----END%20PUBLIC%20KEY-----'%3B%0Aconst%20pemContents%20%3D%20pem.replace(pemHeader%2C%20'').replace(pemFooter%2C%20'').replace(%2F%5Cs%2Fg%2C%20'')%3B%0A%2F%2F%20Base64%20decode%20to%20binary%20string%0Aconst%20binaryString%20%3D%20atob(pemContents)%3B%0A%2F%2F%20Binary%20string%20to%20ArrayBuffer%0Aconst%20bytes%20%3D%20new%20Uint8Array(binaryString.length)%3B%0Afor%20(let%20i%20%3D%200%3B%20i%20length%3B%20i%2B%2B)%20%7B%0Abytes%5Bi%5D%20%3D%20binaryString.charCodeAt(i)%3B%0A%7D%0Areturn%20bytes.buffer%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Helper method: convert PEM format to ArrayBuffer</span>
<span class="hljs-keyword inline">private</span> <span class="hljs-title function_ inline">pemToArrayBuffer</span>(<span class="hljs-attr inline">pem</span>: <span class="hljs-built_in inline">string</span>): <span class="hljs-title class_ inline">ArrayBuffer</span> {
  <span class="hljs-comment inline">// Remove header and footer</span>
  <span class="hljs-keyword inline">const</span> pemHeader = <span class="hljs-string inline">&#x27;-----BEGIN PUBLIC KEY-----&#x27;</span>;
  <span class="hljs-keyword inline">const</span> pemFooter = <span class="hljs-string inline">&#x27;-----END PUBLIC KEY-----&#x27;</span>;
  <span class="hljs-keyword inline">const</span> pemContents = pem.<span class="hljs-title function_ inline">replace</span>(pemHeader, <span class="hljs-string inline">&#x27;&#x27;</span>).<span class="hljs-title function_ inline">replace</span>(pemFooter, <span class="hljs-string inline">&#x27;&#x27;</span>).<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>);

  <span class="hljs-comment inline">// Base64 decode to binary string</span>
  <span class="hljs-keyword inline">const</span> binaryString = <span class="hljs-title function_ inline">atob</span>(pemContents);

  <span class="hljs-comment inline">// Binary string to ArrayBuffer</span>
  <span class="hljs-keyword inline">const</span> bytes = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Uint8Array</span>(binaryString.<span class="hljs-property inline">length</span>);
  <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> i = <span class="hljs-number inline">0</span>; i &lt; binaryString.<span class="hljs-property inline">length</span>; i++) {
    bytes[i] = binaryString.<span class="hljs-title function_ inline">charCodeAt</span>(i);
  }

  <span class="hljs-keyword inline">return</span> bytes.<span class="hljs-property inline">buffer</span>;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">PEM Format Parsing</strong>:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Header/Footer Removal</strong>: Remove PEM format identifiers</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Whitespace Cleanup</strong>: Remove all whitespace characters</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Base64 Decoding</strong>: Convert Base64 string to binary</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">ArrayBuffer Conversion</strong>: Convert to Web Crypto API required format</li>
</ol>
<h3 id="arraybuffer-and-base64-conversion" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#arraybuffer-and-base64-conversion" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to ArrayBuffer and Base64 Conversion">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            ArrayBuffer and Base64 Conversion
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Helper%20method%3A%20convert%20ArrayBuffer%20to%20base64%0Aprivate%20arrayBufferToBase64(buffer%3A%20ArrayBuffer)%3A%20string%20%7B%0Aconst%20bytes%20%3D%20new%20Uint8Array(buffer)%3B%0Alet%20binary%20%3D%20''%3B%0Afor%20(let%20i%20%3D%200%3B%20i%20byteLength%3B%20i%2B%2B)%20%7B%0Abinary%20%2B%3D%20String.fromCharCode(bytes%5Bi%5D)%3B%0A%7D%0Areturn%20btoa(binary)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Helper method: convert ArrayBuffer to base64</span>
<span class="hljs-keyword inline">private</span> <span class="hljs-title function_ inline">arrayBufferToBase64</span>(<span class="hljs-attr inline">buffer</span>: <span class="hljs-title class_ inline">ArrayBuffer</span>): <span class="hljs-built_in inline">string</span> {
  <span class="hljs-keyword inline">const</span> bytes = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Uint8Array</span>(buffer);
  <span class="hljs-keyword inline">let</span> binary = <span class="hljs-string inline">&#x27;&#x27;</span>;
  <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> i = <span class="hljs-number inline">0</span>; i &lt; bytes.<span class="hljs-property inline">byteLength</span>; i++) {
    binary += <span class="hljs-title class_ inline">String</span>.<span class="hljs-title function_ inline">fromCharCode</span>(bytes[i]);
  }
  <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">btoa</span>(binary);
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Data Conversion</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="User%20Input(String)%20%E2%86%92%20TextEncoder%20%E2%86%92%20ArrayBuffer%20%E2%86%92%20Web%20Crypto%20API%20%E2%86%92%20ArrayBuffer%20%E2%86%92%20Base64%20%E2%86%92%20Network%20Transmission">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-keyword inline">User</span> <span class="hljs-title inline">Input</span>(<span class="hljs-keyword inline">String</span>) → TextEncoder → ArrayBuffer → Web Crypto API → ArrayBuffer → Base64 → Network Transmission
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">Conversion step explanation:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">TextEncoder</strong>: Convert string to UTF-8 bytes</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">ArrayBuffer</strong>: Standard format for Web Crypto API</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Base64</strong>: Safe encoding for network transmission</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Fallback Strategy</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Check%20Web%20Crypto%20API%20support%0Aif%20(!window.crypto%20%7C%7C%20!window.crypto.subtle)%20%7B%0A%2F%2F%20Fallback%20to%20jsrsasign%20implementation%0Areturn%20this.jsrsasignEncrypt(plaintext)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Check Web Crypto API support</span>
<span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">crypto</span> || !<span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">crypto</span>.<span class="hljs-property inline">subtle</span>) {
  <span class="hljs-comment inline">// Fallback to jsrsasign implementation</span>
  <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">jsrsasignEncrypt</span>(plaintext);
}
</code></pre>
            </div>
        
<h2 id="complete-implementation-of-api-key-update-process" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#complete-implementation-of-api-key-update-process" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete Implementation of API Key Update Process">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete Implementation of API Key Update Process
        </h2>
<h3 id="design-philosophy-of-updateapikey-interface" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#design-philosophy-of-updateapikey-interface" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Design Philosophy of updateApiKey Interface">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Design Philosophy of updateApiKey Interface
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%40desc%20%20%20%20Update%20user%20API%20key%0A%2F%2F%20%40route%20%20%20PUT%20%2Fapi%2Fauth%2Fapi-key%0A%2F%2F%20%40access%20%20Private%0Aexports.updateApiKey%20%3D%20async%20(req%2C%20res)%20%3D%3E%20%7B%0Atry%20%7B%0Aconst%20%7B%20apiKey%2C%20useCustomApiKey%20%7D%20%3D%20req.body%3B%0A%2F%2F%20Validate%20input%2C%20only%20require%20apiKey%20when%20useCustomApiKey%20is%20true%20and%20apiKey%20has%20value%0A%2F%2F%20Allow%20useCustomApiKey%20to%20be%20true%20but%20apiKey%20to%20be%20empty%20(user%20intends%20to%20customize%20but%20hasn't%20entered%20yet)%0Aif%20(useCustomApiKey%20%26%26%20apiKey%20%26%26%20apiKey.trim().length%20%3D%3D%3D%200)%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('auth.apiKeyRequired')%0A%7D)%3B%0A%7D%0Aconst%20user%20%3D%20await%20User.findById(req.user.id)%3B%0Aif%20(!user)%20%7B%0Areturn%20res.status(404).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('auth.userNotFound')%0A%7D)%3B%0A%7D%0A%2F%2F%20Update%20user%20API%20key%20settings%0Aif%20(useCustomApiKey)%20%7B%0A%2F%2F%20If%20apiKey%20has%20value%20and%20is%20not%20empty%2C%20directly%20store%20the%20frontend%20encrypted%20API%20key%0A%2F%2F%20Frontend%20sends%20RSA%20encrypted%20API%20key%20with%20'rsa%3A'%20prefix%E2%80%94no%20decryption%20here%0Aif%20(apiKey%20%26%26%20apiKey.trim().length%20%3E%200)%20%7B%0Auser.apiKey%20%3D%20apiKey.trim()%3B%20%2F%2F%20Directly%20store%20encrypted%20data%0A%7D%20else%20%7B%0Auser.apiKey%20%3D%20undefined%3B%0A%7D%0Auser.useCustomApiKey%20%3D%20true%3B%0A%7D%20else%20%7B%0Auser.apiKey%20%3D%20undefined%3B%0Auser.useCustomApiKey%20%3D%20false%3B%0A%7D%0Aawait%20user.save()%3B%0Ares.status(200).json(%7B%0Asuccess%3A%20true%2C%0Amessage%3A%20req.t('auth.apiKeyUpdatedSuccessfully')%2C%0AuseCustomApiKey%3A%20user.useCustomApiKey%0A%7D)%3B%0A%7D%20catch%20(error)%20%7B%0Ares.status(500).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('auth.serverError')%0A%7D)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// @desc    Update user API key</span>
<span class="hljs-comment inline">// @route   PUT /api/auth/api-key</span>
<span class="hljs-comment inline">// @access  Private</span>
<span class="hljs-built_in inline">exports</span>.<span class="hljs-property inline">updateApiKey</span> = <span class="hljs-title function_ inline">async</span> (req, res) =&gt; {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> { apiKey, useCustomApiKey } = req.<span class="hljs-property inline">body</span>;

    <span class="hljs-comment inline">// Validate input, only require apiKey when useCustomApiKey is true and apiKey has value</span>
    <span class="hljs-comment inline">// Allow useCustomApiKey to be true but apiKey to be empty (user intends to customize but hasn&#x27;t entered yet)</span>
    <span class="hljs-keyword inline">if</span> (useCustomApiKey &amp;&amp; apiKey &amp;&amp; apiKey.<span class="hljs-title function_ inline">trim</span>().<span class="hljs-property inline">length</span> === <span class="hljs-number inline">0</span>) {
      <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
        <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.apiKeyRequired&#x27;</span>)
      });
    }

    <span class="hljs-keyword inline">const</span> user = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">User</span>.<span class="hljs-title function_ inline">findById</span>(req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>);
    <span class="hljs-keyword inline">if</span> (!user) {
      <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">404</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
        <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.userNotFound&#x27;</span>)
      });
    }

    <span class="hljs-comment inline">// Update user API key settings</span>
    <span class="hljs-keyword inline">if</span> (useCustomApiKey) {
      <span class="hljs-comment inline">// If apiKey has value and is not empty, directly store the frontend encrypted API key</span>
      <span class="hljs-comment inline">// Frontend sends RSA encrypted API key with &#x27;rsa:&#x27; prefix—no decryption here</span>
      <span class="hljs-keyword inline">if</span> (apiKey &amp;&amp; apiKey.<span class="hljs-title function_ inline">trim</span>().<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>) {
        user.<span class="hljs-property inline">apiKey</span> = apiKey.<span class="hljs-title function_ inline">trim</span>(); <span class="hljs-comment inline">// Directly store encrypted data</span>
      } <span class="hljs-keyword inline">else</span> {
        user.<span class="hljs-property inline">apiKey</span> = <span class="hljs-literal inline">undefined</span>;
      }
      user.<span class="hljs-property inline">useCustomApiKey</span> = <span class="hljs-literal inline">true</span>;
    } <span class="hljs-keyword inline">else</span> {
      user.<span class="hljs-property inline">apiKey</span> = <span class="hljs-literal inline">undefined</span>;
      user.<span class="hljs-property inline">useCustomApiKey</span> = <span class="hljs-literal inline">false</span>;
    }

    <span class="hljs-keyword inline">await</span> user.<span class="hljs-title function_ inline">save</span>();

    res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">200</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.apiKeyUpdatedSuccessfully&#x27;</span>),
      <span class="hljs-attr inline">useCustomApiKey</span>: user.<span class="hljs-property inline">useCustomApiKey</span>
    });
  } <span class="hljs-keyword inline">catch</span> (error) {
    res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">500</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.serverError&#x27;</span>)
    });
  }
};
</code></pre>
            </div>
        
<h3 id="complete-flow-frontend-encryption-→-transmission-→-backend-decryption" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#complete-flow-frontend-encryption-→-transmission-→-backend-decryption" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete Flow: Frontend Encryption → Transmission → Backend Decryption">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete Flow: Frontend Encryption → Transmission → Backend Decryption
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20updateApiKey%20%3D%20async%20(apiKey%3A%20string%2C%20shouldUseCustomKey%3A%20boolean)%20%3D%3E%20%7B%0Aloading.value%20%3D%20true%0Atry%20%7B%0A%2F%2F%20Get%20latest%20public%20key%20before%20encryption%0Aif%20(shouldUseCustomKey%20%26%26%20apiKey)%20%7B%0Aconst%20keyResult%20%3D%20await%20fetchPublicKey()%0Aif%20(!keyResult.success)%20%7B%0Atoast.error(t('apiKey.publicKeyFetchFailed'))%0Areturn%20%7Bsuccess%3A%20false%2C%20message%3A%20t('apiKey.publicKeyFetchError')%7D%0A%7D%0A%7D%0A%2F%2F%20Encrypt%20if%20there's%20custom%20key%20and%20apiKey%0Alet%20encryptedApiKey%20%3D%20''%0Aif%20(shouldUseCustomKey%20%26%26%20apiKey%20%26%26%20publicKey.value)%20%7B%0Atry%20%7B%0Aconst%20encrypted%20%3D%20await%20rsaCrypto.encrypt(apiKey)%0AencryptedApiKey%20%3D%20'rsa%3A'%20%2B%20encrypted%0A%7D%20catch%20(encryptError)%20%7B%0Atoast.error(t('apiKey.encryptionFailed'))%0Aconsole.error(encryptedApiKey)%0Areturn%20%7Bsuccess%3A%20false%2C%20message%3A%20t('apiKey.encryptionError')%7D%0A%7D%0A%7D%0Aconst%20response%20%3D%20await%20aiConfigAPI.updateApiKey(%7B%0AapiKey%3A%20shouldUseCustomKey%20%3F%20encryptedApiKey%20%3A%20''%2C%0AuseCustomApiKey%3A%20shouldUseCustomKey%0A%7D)%0Aif%20(response.data.success)%20%7B%0AuseCustomApiKey.value%20%3D%20response.data.useCustomApiKey%0AhasCustomApiKey.value%20%3D%20shouldUseCustomKey%20%26%26%20!!apiKey%0AcustomApiKey.value%20%3D%20apiKey%0Atoast.success(t('apiKey.updateSuccess'))%0Areturn%20%7Bsuccess%3A%20true%7D%0A%7D%20else%20%7B%0Aconst%20message%20%3D%20response.data.message%20%7C%7C%20t('common.error')%0Atoast.error(message)%0Areturn%20%7Bsuccess%3A%20false%2C%20message%7D%0A%7D%0A%7D%20catch%20(error%3A%20any)%20%7B%0Aconst%20message%20%3D%20error.response%3F.data%3F.message%20%7C%7C%20t('common.error')%0Atoast.error(message)%0Areturn%20%7Bsuccess%3A%20false%2C%20message%7D%0A%7D%20finally%20%7B%0Aloading.value%20%3D%20false%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">updateApiKey</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"><span class="hljs-attr inline">apiKey</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">shouldUseCustomKey</span>: <span class="hljs-built_in inline">boolean</span></span>) =&gt; {
  loading.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">true</span>
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-comment inline">// Get latest public key before encryption</span>
    <span class="hljs-keyword inline">if</span> (shouldUseCustomKey &amp;&amp; apiKey) {
      <span class="hljs-keyword inline">const</span> keyResult = <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">fetchPublicKey</span>()
      <span class="hljs-keyword inline">if</span> (!keyResult.<span class="hljs-property inline">success</span>) {
        toast.<span class="hljs-title function_ inline">error</span>(<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.publicKeyFetchFailed&#x27;</span>))
        <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, <span class="hljs-attr inline">message</span>: <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.publicKeyFetchError&#x27;</span>)}
      }
    }

    <span class="hljs-comment inline">// Encrypt if there&#x27;s custom key and apiKey</span>
    <span class="hljs-keyword inline">let</span> encryptedApiKey = <span class="hljs-string inline">&#x27;&#x27;</span>
    <span class="hljs-keyword inline">if</span> (shouldUseCustomKey &amp;&amp; apiKey &amp;&amp; publicKey.<span class="hljs-property inline">value</span>) {
      <span class="hljs-keyword inline">try</span> {
        <span class="hljs-keyword inline">const</span> encrypted = <span class="hljs-keyword inline">await</span> rsaCrypto.<span class="hljs-title function_ inline">encrypt</span>(apiKey)
        encryptedApiKey = <span class="hljs-string inline">&#x27;rsa:&#x27;</span> + encrypted
      } <span class="hljs-keyword inline">catch</span> (encryptError) {
        toast.<span class="hljs-title function_ inline">error</span>(<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.encryptionFailed&#x27;</span>))
        <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(encryptedApiKey)
        <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, <span class="hljs-attr inline">message</span>: <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.encryptionError&#x27;</span>)}
      }
    }

    <span class="hljs-keyword inline">const</span> response = <span class="hljs-keyword inline">await</span> aiConfigAPI.<span class="hljs-title function_ inline">updateApiKey</span>({
      <span class="hljs-attr inline">apiKey</span>: shouldUseCustomKey ? encryptedApiKey : <span class="hljs-string inline">&#x27;&#x27;</span>,
      <span class="hljs-attr inline">useCustomApiKey</span>: shouldUseCustomKey
    })

    <span class="hljs-keyword inline">if</span> (response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">success</span>) {
      useCustomApiKey.<span class="hljs-property inline">value</span> = response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">useCustomApiKey</span>
      hasCustomApiKey.<span class="hljs-property inline">value</span> = shouldUseCustomKey &amp;&amp; !!apiKey
      customApiKey.<span class="hljs-property inline">value</span> = apiKey
      toast.<span class="hljs-title function_ inline">success</span>(<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.updateSuccess&#x27;</span>))
      <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>}
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-keyword inline">const</span> message = response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;common.error&#x27;</span>)
      toast.<span class="hljs-title function_ inline">error</span>(message)
      <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, message}
    }
  } <span class="hljs-keyword inline">catch</span> (<span class="hljs-attr inline">error</span>: <span class="hljs-built_in inline">any</span>) {
    <span class="hljs-keyword inline">const</span> message = error.<span class="hljs-property inline">response</span>?.<span class="hljs-property inline">data</span>?.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;common.error&#x27;</span>)
    toast.<span class="hljs-title function_ inline">error</span>(message)
    <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, message}
  } <span class="hljs-keyword inline">finally</span> {
    loading.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  }
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Complete Flow Data Changes</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">When Updating API Key</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="User%20Input%3A%20%22sk-1234567890abcdef%22%0A%E2%86%93%0AFrontend%20Encryption%3A%20%22rsa%3ABase64EncryptedData...%22%0A%E2%86%93%0AHTTPS%20Transmission%3A%20%5BTLS%20Encrypted%20RSA%20Encrypted%20Data%5D%0A%E2%86%93%0ABackend%20Reception%3A%20%22rsa%3ABase64EncryptedData...%22%0A%E2%86%93%0ADatabase%20Storage%3A%20%22rsa%3ABase64EncryptedData...%22%20(directly%20store%20ciphertext)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-keyword inline">User</span> <span class="hljs-keyword inline">Input</span>: &quot;sk-1234567890abcdef&quot;
  ↓
Frontend Encryption: &quot;rsa:Base64EncryptedData...&quot;
  ↓
HTTPS Transmission: [TLS <span class="hljs-keyword inline">Encrypted</span> RSA <span class="hljs-keyword inline">Encrypted</span> Data]
  ↓
Backend Reception: &quot;rsa:Base64EncryptedData...&quot;
  ↓
<span class="hljs-keyword inline">Database</span> <span class="hljs-keyword inline">Storage</span>: &quot;rsa:Base64EncryptedData...&quot; (directly store ciphertext)
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">When Using API Key to Call Model</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Database%20Read%3A%20%22rsa%3ABase64EncryptedData...%22%0A%E2%86%93%0ATemporary%20Decryption%3A%20%22sk-1234567890abcdef%22%0A%E2%86%93%0ACall%20Large%20Model%20API%3A%20use%20plaintext%20key%0A%E2%86%93%0AImmediate%20Cleanup%3A%20plaintext%20key%20destroyed%20from%20memory">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code><span class="hljs-keyword inline">Database</span> <span class="hljs-keyword inline">Read</span>: &quot;rsa:Base64EncryptedData...&quot;
  ↓
<span class="hljs-keyword inline">Temporary</span> Decryption: &quot;sk-1234567890abcdef&quot;
  ↓
<span class="hljs-keyword inline">Call</span> <span class="hljs-keyword inline">Large</span> Model API: use plaintext key
  ↓
<span class="hljs-keyword inline">Immediate</span> Cleanup: plaintext key destroyed <span class="hljs-keyword inline">from</span> memory
</code></pre>
            </div>
        
<h3 id="error-handling-and-user-experience-optimization" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#error-handling-and-user-experience-optimization" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Error Handling and User Experience Optimization">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Error Handling and User Experience Optimization
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Multi-layer Error Handling</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20Layer%201%3A%20Encryption%20failure%0Atry%20%7B%0Aconst%20encrypted%20%3D%20await%20rsaCrypto.encrypt(apiKey)%0AencryptedApiKey%20%3D%20'rsa%3A'%20%2B%20encrypted%0A%7D%20catch%20(encryptError)%20%7B%0Atoast.error(t('apiKey.encryptionFailed'))%0Areturn%20%7Bsuccess%3A%20false%2C%20message%3A%20t('apiKey.encryptionError')%7D%0A%7D%0A%2F%2F%20Layer%202%3A%20Network%20request%20failure%0Atry%20%7B%0Aconst%20response%20%3D%20await%20aiConfigAPI.updateApiKey(%7B...%7D)%0A%7D%20catch%20(error%3A%20any)%20%7B%0Aconst%20message%20%3D%20error.response%3F.data%3F.message%20%7C%7C%20t('common.error')%0Atoast.error(message)%0Areturn%20%7Bsuccess%3A%20false%2C%20message%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// Layer 1: Encryption failure</span>
<span class="hljs-keyword inline">try</span> {
  <span class="hljs-keyword inline">const</span> encrypted = <span class="hljs-keyword inline">await</span> rsaCrypto.<span class="hljs-title function_ inline">encrypt</span>(apiKey)
  encryptedApiKey = <span class="hljs-string inline">&#x27;rsa:&#x27;</span> + encrypted
} <span class="hljs-keyword inline">catch</span> (encryptError) {
  toast.<span class="hljs-title function_ inline">error</span>(<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.encryptionFailed&#x27;</span>))
  <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, <span class="hljs-attr inline">message</span>: <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;apiKey.encryptionError&#x27;</span>)}
}

<span class="hljs-comment inline">// Layer 2: Network request failure</span>
<span class="hljs-keyword inline">try</span> {
  <span class="hljs-keyword inline">const</span> response = <span class="hljs-keyword inline">await</span> aiConfigAPI.<span class="hljs-title function_ inline">updateApiKey</span>({...})
} <span class="hljs-keyword inline">catch</span> (<span class="hljs-attr inline">error</span>: <span class="hljs-built_in inline">any</span>) {
  <span class="hljs-keyword inline">const</span> message = error.<span class="hljs-property inline">response</span>?.<span class="hljs-property inline">data</span>?.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;common.error&#x27;</span>)
  toast.<span class="hljs-title function_ inline">error</span>(message)
  <span class="hljs-keyword inline">return</span> {<span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, message}
}
</code></pre>
            </div>
        
<h2 id="data-storage-and-decryption-strategy" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#data-storage-and-decryption-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Data Storage and Decryption Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Data Storage and Decryption Strategy
        </h2>
<h3 id="database-storage-format-for-encrypted-data" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#database-storage-format-for-encrypted-data" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Database Storage Format for Encrypted Data">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Database Storage Format for Encrypted Data
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Custom%20API%20key%20(optional%2C%20uses%20platform%20default%20when%20not%20set)%0A%2F%2F%20Stored%20in%20database%20as%20encrypted%20form%0AapiKey%3A%20%7B%0Atype%3A%20String%2C%0Arequired%3A%20false%2C%0Atrim%3A%20true%0A%7D%2C%0A%2F%2F%20Whether%20to%20use%20custom%20API%20key%0AuseCustomApiKey%3A%20%7B%0Atype%3A%20Boolean%2C%0Adefault%3A%20false%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Custom API key (optional, uses platform default when not set)</span>
<span class="hljs-comment inline">// Stored in database as encrypted form</span>
<span class="hljs-attr inline">apiKey</span>: {
  <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">String</span>,
  <span class="hljs-attr inline">required</span>: <span class="hljs-literal inline">false</span>,
  <span class="hljs-attr inline">trim</span>: <span class="hljs-literal inline">true</span>
},
<span class="hljs-comment inline">// Whether to use custom API key</span>
<span class="hljs-attr inline">useCustomApiKey</span>: {
  <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">Boolean</span>,
  <span class="hljs-attr inline">default</span>: <span class="hljs-literal inline">false</span>
},
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Database Storage Data Format</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20User%20document%20example%0A%7B%0A_id%3A%20ObjectId(%22...%22)%2C%0Ausername%3A%20%22testuser%22%2C%0Aemail%3A%20%22test%40example.com%22%2C%0AapiKey%3A%20%22rsa%3ABase64EncodedEncryptedData...%22%2C%20%20%2F%2F%20Encrypted%20storage%0AuseCustomApiKey%3A%20true%2C%0A%2F%2F%20...%20other%20fields%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// User document example</span>
{
  <span class="hljs-attr inline">_id</span>: <span class="hljs-title class_ inline">ObjectId</span>(<span class="hljs-string inline">&quot;...&quot;</span>),
  <span class="hljs-attr inline">username</span>: <span class="hljs-string inline">&quot;testuser&quot;</span>,
  <span class="hljs-attr inline">email</span>: <span class="hljs-string inline">&quot;test@example.com&quot;</span>,
  <span class="hljs-attr inline">apiKey</span>: <span class="hljs-string inline">&quot;rsa:Base64EncodedEncryptedData...&quot;</span>,  <span class="hljs-comment inline">// Encrypted storage</span>
  <span class="hljs-attr inline">useCustomApiKey</span>: <span class="hljs-literal inline">true</span>,
  <span class="hljs-comment inline">// ... other fields</span>
}
</code></pre>
            </div>
        
<h3 id="rsa-prefix-identification-mechanism" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#rsa-prefix-identification-mechanism" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to rsa: Prefix Identification Mechanism">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            rsa: Prefix Identification Mechanism
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Method%20to%20decrypt%20API%20key%20using%20RSA%0AuserSchema.methods.decryptApiKey%20%3D%20function(encryptedKey%20%3D%20null)%20%7B%0Atry%20%7B%0Aconst%20keyToDecrypt%20%3D%20encryptedKey%20%7C%7C%20this.apiKey%3B%0Aif%20(!keyToDecrypt)%20%7B%0Areturn%20null%3B%0A%7D%0A%2F%2F%20Check%20if%20it's%20RSA%20encrypted%20(base64%20format%20from%20frontend)%0Aif%20(keyToDecrypt.startsWith('rsa%3A'))%20%7B%0Aconst%20encryptedData%20%3D%20keyToDecrypt.substring(4)%3B%0Areturn%20decrypt(encryptedData)%3B%0A%7D%0A%2F%2F%20If%20not%20encrypted%2C%20return%20directly%20(for%20development%2Ftesting)%0Areturn%20keyToDecrypt%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60API%20key%20decryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Method to decrypt API key using RSA</span>
userSchema.<span class="hljs-property inline">methods</span>.<span class="hljs-property inline">decryptApiKey</span> = <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">encryptedKey = <span class="hljs-literal inline">null</span></span>) {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> keyToDecrypt = encryptedKey || <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">apiKey</span>;
    
    <span class="hljs-keyword inline">if</span> (!keyToDecrypt) {
      <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
    }

    <span class="hljs-comment inline">// Check if it&#x27;s RSA encrypted (base64 format from frontend)</span>
    <span class="hljs-keyword inline">if</span> (keyToDecrypt.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;rsa:&#x27;</span>)) {
      <span class="hljs-keyword inline">const</span> encryptedData = keyToDecrypt.<span class="hljs-title function_ inline">substring</span>(<span class="hljs-number inline">4</span>);
      <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">decrypt</span>(encryptedData);
    }
    
    <span class="hljs-comment inline">// If not encrypted, return directly (for development/testing)</span>
    <span class="hljs-keyword inline">return</span> keyToDecrypt;
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`API key decryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
  }
};
</code></pre>
            </div>
        
<h3 id="decryption-timing-selection-strategy" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#decryption-timing-selection-strategy" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Decryption Timing Selection Strategy">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Decryption Timing Selection Strategy
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Method%20to%20get%20decrypted%20API%20key%20for%20AI%20service%0AuserSchema.methods.getDecryptedApiKey%20%3D%20function()%20%7B%0Aif%20(!this.apiKey%20%7C%7C%20!this.useCustomApiKey)%20%7B%0Areturn%20null%3B%0A%7D%0Areturn%20this.decryptApiKey()%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Method to get decrypted API key for AI service</span>
userSchema.<span class="hljs-property inline">methods</span>.<span class="hljs-property inline">getDecryptedApiKey</span> = <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline"></span>) {
  <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">apiKey</span> || !<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">useCustomApiKey</span>) {
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
  }
  <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">decryptApiKey</span>();
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Questions Party’s Choice</strong>: <strong class="font-bold text-foreground">On-demand Temporary Decryption</strong></p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">When storing: Directly store encrypted data, no decryption</li>
<li class="text-foreground leading-relaxed">When using: Only temporarily decrypt when calling large model API</li>
<li class="text-foreground leading-relaxed">After decryption: Immediately clean plaintext data from memory</li>
<li class="text-foreground leading-relaxed">Advantage: Maximize security, minimize plaintext exposure time</li>
</ul>
<h3 id="lifecycle-management-of-plaintext-data-in-memory" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#lifecycle-management-of-plaintext-data-in-memory" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Lifecycle Management of Plaintext Data in Memory">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Lifecycle Management of Plaintext Data in Memory
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Helper%20function%20to%20get%20decrypted%20platform%20API%20key%0Afunction%20getPlatformApiKey()%20%7B%0A%2F%2F%20First%20try%20to%20get%20encrypted%20API%20key%0Aif%20(process.env.ENCRYPTED_PLATFORM_API_KEY)%20%7B%0Atry%20%7B%0Aconst%20%7Bdecrypt%7D%20%3D%20require('..%2Futils%2FrsaCrypto')%3B%0Aif%20(process.env.ENCRYPTED_PLATFORM_API_KEY.startsWith('rsa%3A'))%20%7B%0Aconst%20encryptedData%20%3D%20process.env.ENCRYPTED_PLATFORM_API_KEY.substring(4)%3B%0Areturn%20decrypt(encryptedData)%3B%0A%7D%0A%7D%20catch%20(error)%20%7B%0Aconsole.warn('Failed%20to%20decrypt%20platform%20API%20key%3A'%2C%20error.message)%3B%0A%7D%0A%7D%0A%2F%2F%20Return%20decrypted%20key%20if%20available%2C%20otherwise%20return%20null%0Areturn%20null%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Helper function to get decrypted platform API key</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">getPlatformApiKey</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-comment inline">// First try to get encrypted API key</span>
    <span class="hljs-keyword inline">if</span> (process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">ENCRYPTED_PLATFORM_API_KEY</span>) {
        <span class="hljs-keyword inline">try</span> {
            <span class="hljs-keyword inline">const</span> {decrypt} = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../utils/rsaCrypto&#x27;</span>);

            <span class="hljs-keyword inline">if</span> (process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">ENCRYPTED_PLATFORM_API_KEY</span>.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;rsa:&#x27;</span>)) {
                <span class="hljs-keyword inline">const</span> encryptedData = process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">ENCRYPTED_PLATFORM_API_KEY</span>.<span class="hljs-title function_ inline">substring</span>(<span class="hljs-number inline">4</span>);
                <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">decrypt</span>(encryptedData);
            }
        } <span class="hljs-keyword inline">catch</span> (error) {
            <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;Failed to decrypt platform API key:&#x27;</span>, error.<span class="hljs-property inline">message</span>);
        }
    }

    <span class="hljs-comment inline">// Return decrypted key if available, otherwise return null</span>
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
}
</code></pre>
            </div>
        
<h2 id="security-analysis-and-attack-prevention" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#security-analysis-and-attack-prevention" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Security Analysis and Attack Prevention">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Security Analysis and Attack Prevention
        </h2>
<h3 id="common-rsa-attack-methods-and-protection-measures" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#common-rsa-attack-methods-and-protection-measures" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Common RSA Attack Methods and Protection Measures">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Common RSA Attack Methods and Protection Measures
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">1. Small Public Exponent Attack</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E2%9D%8C%20Dangerous%20choice%0Ae%20%3D%203%20%20%2F%2F%20Too%20small%2C%20vulnerable%20to%20attacks%0A%2F%2F%20%E2%9C%85%20Safe%20choice%0Ae%20%3D%2065537%20%20%2F%2F%20Large%20enough%2C%20good%20computational%20efficiency">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// ❌ Dangerous choice</span>
e = <span class="hljs-number inline">3</span>  <span class="hljs-comment inline">// Too small, vulnerable to attacks</span>

<span class="hljs-comment inline">// ✅ Safe choice</span>
e = <span class="hljs-number inline">65537</span>  <span class="hljs-comment inline">// Large enough, good computational efficiency</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">2. Timing Attack</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E2%9D%8C%20Vulnerable%20to%20timing%20attacks%0Afunction%20unsafeDecrypt(ciphertext)%20%7B%0A%2F%2F%20Decryption%20time%20related%20to%20private%20key%0Areturn%20privateKey.decrypt(ciphertext)%3B%0A%7D%0A%2F%2F%20%E2%9C%85%20Use%20constant-time%20algorithm%0Afunction%20safeDecrypt(ciphertext)%20%7B%0A%2F%2F%20Node.js%20crypto%20module%20already%20implements%20timing%20attack%20protection%0Areturn%20crypto.privateDecrypt(%7B%0Akey%3A%20privateKey%2C%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%0A%7D%2C%20ciphertext)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// ❌ Vulnerable to timing attacks</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">unsafeDecrypt</span>(<span class="hljs-params inline">ciphertext</span>) {
  <span class="hljs-comment inline">// Decryption time related to private key</span>
  <span class="hljs-keyword inline">return</span> privateKey.<span class="hljs-title function_ inline">decrypt</span>(ciphertext);
}

<span class="hljs-comment inline">// ✅ Use constant-time algorithm</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">safeDecrypt</span>(<span class="hljs-params inline">ciphertext</span>) {
  <span class="hljs-comment inline">// Node.js crypto module already implements timing attack protection</span>
  <span class="hljs-keyword inline">return</span> crypto.<span class="hljs-title function_ inline">privateDecrypt</span>({
    <span class="hljs-attr inline">key</span>: privateKey,
    <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>
  }, ciphertext);
}
</code></pre>
            </div>
        
<h3 id="padding-attack-principles-and-oaep-protection-mechanisms" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#padding-attack-principles-and-oaep-protection-mechanisms" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Padding Attack Principles and OAEP Protection Mechanisms">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Padding Attack Principles and OAEP Protection Mechanisms
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">PKCS#1 v1.5 Padding Vulnerabilities</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="Raw%20RSA%3A%20c%20%3D%20m%5Ee%20mod%20n%0APKCS%231%20v1.5%3A%2000%20%7C%7C%20BT%20%7C%7C%20PS%20%7C%7C%2000%20%7C%7C%20D%0AProblem%3A%20Fixed%20padding%20format%2C%20vulnerable%20to%20padding%20attacks">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>Raw RSA: c = m^e <span class="hljs-keyword inline">mod</span> n
PKCS#<span class="hljs-number inline">1</span> v1<span class="hljs-number inline">.5</span>: <span class="hljs-number inline">00</span> |<span class="hljs-type inline">| BT</span> |<span class="hljs-type inline">| PS</span> |<span class="hljs-type inline">| 00</span> |<span class="hljs-type inline">| D</span>

Problem: Fixed padding format, vulnerable to padding attacks
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">OAEP Padding Protection Mechanisms</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="OAEP%3A%20Uses%20random%20numbers%20and%20mask%20generation%20functions%0AResult%3A%20Same%20plaintext%20produces%20different%20encryption%20each%20time">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>OAEP: Uses <span class="hljs-built_in inline">random</span> numbers <span class="hljs-keyword inline">and</span> mask generation functions
Result: Same plaintext produces different encryption <span class="hljs-keyword inline">each</span> <span class="hljs-built_in inline">time</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Mathematical Representation</strong>:</p>
<p class="text-base leading-7 mb-4 text-foreground"><span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>OAEP</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mo>⊕</mo><mi>G</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>⊕</mo><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{OAEP}(m, r) = (X \oplus G(Y)) \| (Y \oplus H(X))</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text inline"><span class="mord inline">OAEP</span></span><span class="mopen inline">(</span><span class="mord mathnormal inline">m</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord mathnormal inline" style="margin-right:0.02778em;">r</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen inline">(</span><span class="mord mathnormal inline" style="margin-right:0.07847em;">X</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⊕</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline">G</span><span class="mopen inline">(</span><span class="mord mathnormal inline" style="margin-right:0.22222em;">Y</span><span class="mclose inline">))</span><span class="mord inline">∥</span><span class="mopen inline">(</span><span class="mord mathnormal inline" style="margin-right:0.22222em;">Y</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">⊕</span><span class="mspace inline" style="margin-right:0.2222em;"></span></span><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline" style="margin-right:0.08125em;">H</span><span class="mopen inline">(</span><span class="mord mathnormal inline" style="margin-right:0.07847em;">X</span><span class="mclose inline">))</span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">Where:</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline">m</span></span></span></span>: Original message</li>
<li class="text-foreground leading-relaxed"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.4306em;"></span><span class="mord mathnormal inline" style="margin-right:0.02778em;">r</span></span></span></span>: Random number</li>
<li class="text-foreground leading-relaxed"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6833em;"></span><span class="mord mathnormal inline">G</span></span></span></span>, <span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6833em;"></span><span class="mord mathnormal inline" style="margin-right:0.08125em;">H</span></span></span></span>: Mask generation functions</li>
</ul>
<h2 id="complete-code-analysis" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#complete-code-analysis" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete Code Analysis">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete Code Analysis
        </h2>
<h3 id="backend-rsa-key-management-core-implementation-srcutilsrsacryptojs" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#backend-rsa-key-management-core-implementation-srcutilsrsacryptojs" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Backend RSA Key Management Core Implementation (src/utils/rsaCrypto.js)">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Backend RSA Key Management Core Implementation (<code>src/utils/rsaCrypto.js</code>)
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Module%20imports%3A%20key%20generation%20library%20and%20Node.js%20native%20crypto%20module%0Aconst%20jsrsasign%20%3D%20require('jsrsasign')%3B%20%20%20%20%2F%2F%20For%20key%20generation%20and%20management%0Aconst%20%7B%20KEYUTIL%20%7D%20%3D%20jsrsasign%3B%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Key%20utility%20class%0Aconst%20crypto%20%3D%20require('crypto')%3B%20%20%20%20%20%20%20%20%20%20%2F%2F%20Node.js%20native%20crypto%20module%2C%20better%20performance%0Aclass%20RSACrypto%20%7B%0Aconstructor()%20%7B%0Athis.keySize%20%3D%202048%3B%0Athis.initializeKeys()%3B%0A%7D%0A%2F%2F%20Initialize%20RSA%20key%20pair%20from%20environment%20variables%20or%20generate%20new%20key%20pair%0AinitializeKeys()%20%7B%0Aif%20(process.env.RSA_PUBLIC_KEY%20%26%26%20process.env.RSA_PRIVATE_KEY)%20%7B%0A%2F%2F%20Handle%20escaped%20and%20non-escaped%20newlines%20(compatibility%20consideration)%0Athis.publicKeyPEM%20%3D%20process.env.RSA_PUBLIC_KEY.includes('%5C%5Cn')%0A%3F%20process.env.RSA_PUBLIC_KEY.replace(%2F%5C%5Cn%2Fg%2C%20'%5Cn')%0A%3A%20process.env.RSA_PUBLIC_KEY%3B%0Athis.privateKeyPEM%20%3D%20process.env.RSA_PRIVATE_KEY.includes('%5C%5Cn')%0A%3F%20process.env.RSA_PRIVATE_KEY.replace(%2F%5C%5Cn%2Fg%2C%20'%5Cn')%0A%3A%20process.env.RSA_PRIVATE_KEY%3B%0A%7D%20else%20%7B%0Aconsole.warn('RSA%20keys%20not%20found%20in%20environment.%20Generating%20new%20keys...')%3B%0Aconst%20keyPair%20%3D%20this.generateKeyPair()%3B%0Athis.publicKeyPEM%20%3D%20keyPair.publicKeyPEM%3B%0Athis.privateKeyPEM%20%3D%20keyPair.privateKeyPEM%3B%0Aconsole.log('Generated%20RSA%20Public%20Key%3A'%2C%20this.publicKeyPEM)%3B%0Aconsole.log('Generated%20RSA%20Private%20Key%3A'%2C%20this.privateKeyPEM)%3B%0Aconsole.log('Please%20add%20these%20keys%20to%20your%20.env%20file%3A')%3B%0Aconsole.log('RSA_PUBLIC_KEY%3D%22'%20%2B%20this.publicKeyPEM.replace(%2F%5Cn%2Fg%2C%20'%5C%5Cn')%20%2B%20'%22')%3B%0Aconsole.log('RSA_PRIVATE_KEY%3D%22'%20%2B%20this.privateKeyPEM.replace(%2F%5Cn%2Fg%2C%20'%5C%5Cn')%20%2B%20'%22')%3B%0A%7D%0A%7D%0A%2F%2F%20RSA%20key%20pair%20generation%3A%20use%20jsrsasign%20to%20generate%20standard%20format%20keys%0AgenerateKeyPair(keySize%20%3D%202048)%20%7B%0Atry%20%7B%0Aconst%20keyPair%20%3D%20KEYUTIL.generateKeypair('RSA'%2C%20keySize)%3B%0Aconst%20publicKeyPEM%20%3D%20KEYUTIL.getPEM(keyPair.pubKeyObj)%3B%20%20%20%20%20%20%20%2F%2F%20Public%20key%20PEM%20format%0Aconst%20privateKeyPEM%20%3D%20KEYUTIL.getPEM(keyPair.prvKeyObj%2C%20'PKCS8PRV')%3B%20%20%2F%2F%20Private%20key%20PKCS8%20format%0Areturn%20%7B%20publicKeyPEM%2C%20privateKeyPEM%20%7D%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20key%20generation%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Public%20key%20distribution%20interface%3A%20for%20frontend%20to%20get%20public%20key%0AgetPublicKey()%20%7B%0Areturn%20this.publicKeyPEM%3B%0A%7D%0A%2F%2F%20RSA-OAEP%20encryption%20implementation%3A%20use%20Node.js%20crypto%20module%20to%20ensure%20optimal%20performance%20and%20security%0Aencrypt(plaintext)%20%7B%0Atry%20%7B%0A%2F%2F%20Input%20validation%3A%20ensure%20plaintext%20is%20valid%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0A%2F%2F%20UTF-8%20encoding%20conversion%3A%20ensure%20proper%20handling%20of%20Chinese%20and%20other%20characters%0Aconst%20buffer%20%3D%20Buffer.from(plaintext%2C%20'utf8')%3B%0A%2F%2F%20Core%20encryption%20logic%3A%20RSA%20encryption%20with%20OAEP%20padding%0A%2F%2F%20Choose%20Node.js%20crypto%20over%20jsrsasign%3A%20more%20reliable%20OAEP%20implementation%0Aconst%20encrypted%20%3D%20crypto.publicEncrypt(%0A%7B%0Akey%3A%20this.publicKeyPEM%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20PEM%20format%20public%20key%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%20%20%20%2F%2F%20OAEP%20padding%2C%20prevents%20padding%20attacks%0AoaepHash%3A%20'sha256'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20SHA-256%20hash%20function%0A%7D%2C%0Abuffer%0A)%3B%0A%2F%2F%20Base64%20encoding%3A%20convenient%20for%20network%20transmission%20and%20storage%0Areturn%20encrypted.toString('base64')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20RSA-OAEP%20decryption%20implementation%3A%20core%20of%20temporary%20decryption%20strategy%0Adecrypt(encryptedData)%20%7B%0Atry%20%7B%0A%2F%2F%20Input%20validation%3A%20ensure%20ciphertext%20format%20is%20correct%0Aif%20(!encryptedData%20%7C%7C%20typeof%20encryptedData%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20encrypted%20data%20for%20decryption')%3B%0A%7D%0A%2F%2F%20Base64%20decoding%3A%20restore%20binary%20ciphertext%0Aconst%20encryptedBuffer%20%3D%20Buffer.from(encryptedData%2C%20'base64')%3B%0A%2F%2F%20Core%20decryption%20logic%3A%20decrypt%20using%20private%20key%0Aconst%20decrypted%20%3D%20crypto.privateDecrypt(%0A%7B%0Akey%3A%20this.privateKeyPEM%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20PEM%20format%20private%20key%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%20%20%20%2F%2F%20Consistent%20padding%20with%20encryption%0AoaepHash%3A%20'sha256'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Consistent%20hash%20with%20encryption%0A%7D%2C%0AencryptedBuffer%0A)%3B%0A%2F%2F%20UTF-8%20decoding%3A%20restore%20original%20string%0Areturn%20decrypted.toString('utf8')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20decryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Flexible%20encryption%20interface%3A%20support%20encryption%20with%20arbitrary%20public%20key%20(for%20testing)%0AencryptWithPublicKey(plaintext%2C%20publicKeyPEM)%20%7B%0Atry%20%7B%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0Aconst%20buffer%20%3D%20Buffer.from(plaintext%2C%20'utf8')%3B%0A%2F%2F%20Encrypt%20using%20externally%20provided%20public%20key%0Aconst%20encrypted%20%3D%20crypto.publicEncrypt(%0A%7B%0Akey%3A%20publicKeyPEM%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20External%20public%20key%0Apadding%3A%20crypto.constants.RSA_PKCS1_OAEP_PADDING%2C%0AoaepHash%3A%20'sha256'%2C%0A%7D%2C%0Abuffer%0A)%3B%0Areturn%20encrypted.toString('base64')%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20with%20provided%20key%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Key%20validation%20utility%3A%20ensure%20key%20format%20is%20correct%0AvalidateKey(keyPEM%2C%20isPrivate%20%3D%20false)%20%7B%0Atry%20%7B%0Aconst%20keyObj%20%3D%20KEYUTIL.getKey(keyPEM)%3B%0Areturn%20keyObj%20%26%26%20(isPrivate%20%3F%20keyObj.isPrivate%20%3A%20keyObj.isPublic)%3B%0A%7D%20catch%20(error)%20%7B%0Areturn%20false%3B%20%20%20%2F%2F%20Return%20false%20on%20validation%20failure%20instead%20of%20throwing%20exception%0A%7D%0A%7D%0A%7D%0A%2F%2F%20Singleton%20pattern%20export%3A%20global%20unique%20instance%2C%20saves%20memory%20and%20ensures%20cache%20consistency%0Aconst%20rsaCrypto%20%3D%20new%20RSACrypto()%3B%0A%2F%2F%20Module%20export%3A%20provide%20multiple%20usage%20methods%0Amodule.exports%20%3D%20%7B%0ARSACrypto%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Export%20class%20(for%20extension)%0ArsaCrypto%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Export%20singleton%20instance%0AgenerateKeyPair%3A%20(keySize)%20%3D%3E%20rsaCrypto.generateKeyPair(keySize)%2C%20%20%20%20%20%2F%2F%20Convenience%20function%0Aencrypt%3A%20(plaintext)%20%3D%3E%20rsaCrypto.encrypt(plaintext)%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Convenience%20function%0Adecrypt%3A%20(encryptedData)%20%3D%3E%20rsaCrypto.decrypt(encryptedData)%2C%20%20%20%20%20%20%20%20%20%2F%2F%20Convenience%20function%0AgetPublicKey%3A%20()%20%3D%3E%20rsaCrypto.getPublicKey()%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Convenience%20function%0AencryptWithPublicKey%3A%20(plaintext%2C%20publicKey)%20%3D%3E%20rsaCrypto.encryptWithPublicKey(plaintext%2C%20publicKey)%2C%0AvalidateKey%3A%20(keyPEM%2C%20isPrivate)%20%3D%3E%20rsaCrypto.validateKey(keyPEM%2C%20isPrivate)%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Module imports: key generation library and Node.js native crypto module</span>
<span class="hljs-keyword inline">const</span> jsrsasign = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;jsrsasign&#x27;</span>);    <span class="hljs-comment inline">// For key generation and management</span>
<span class="hljs-keyword inline">const</span> { <span class="hljs-variable constant_ inline">KEYUTIL</span> } = jsrsasign;            <span class="hljs-comment inline">// Key utility class</span>
<span class="hljs-keyword inline">const</span> crypto = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;crypto&#x27;</span>);          <span class="hljs-comment inline">// Node.js native crypto module, better performance</span>

<span class="hljs-keyword inline">class</span> <span class="hljs-title class_ inline">RSACrypto</span> {
  <span class="hljs-title function_ inline">constructor</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">keySize</span> = <span class="hljs-number inline">2048</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">initializeKeys</span>();
  }

  <span class="hljs-comment inline">// Initialize RSA key pair from environment variables or generate new key pair</span>
  <span class="hljs-title function_ inline">initializeKeys</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">if</span> (process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span> &amp;&amp; process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>) {
      <span class="hljs-comment inline">// Handle escaped and non-escaped newlines (compatibility consideration)</span>
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span> = process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span>.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27;\\n&#x27;</span>) 
        ? process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\\n/g</span>, <span class="hljs-string inline">&#x27;\n&#x27;</span>)
        : process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PUBLIC_KEY</span>;
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span> = process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27;\\n&#x27;</span>)
        ? process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\\n/g</span>, <span class="hljs-string inline">&#x27;\n&#x27;</span>)
        : process.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">RSA_PRIVATE_KEY</span>;
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;RSA keys not found in environment. Generating new keys...&#x27;</span>);
      
      <span class="hljs-keyword inline">const</span> keyPair = <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">generateKeyPair</span>();
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span> = keyPair.<span class="hljs-property inline">publicKeyPEM</span>;
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span> = keyPair.<span class="hljs-property inline">privateKeyPEM</span>;
      
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Generated RSA Public Key:&#x27;</span>, <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Generated RSA Private Key:&#x27;</span>, <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Please add these keys to your .env file:&#x27;</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;RSA_PUBLIC_KEY=&quot;&#x27;</span> + <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\n/g</span>, <span class="hljs-string inline">&#x27;\\n&#x27;</span>) + <span class="hljs-string inline">&#x27;&quot;&#x27;</span>);
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;RSA_PRIVATE_KEY=&quot;&#x27;</span> + <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span>.<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\n/g</span>, <span class="hljs-string inline">&#x27;\\n&#x27;</span>) + <span class="hljs-string inline">&#x27;&quot;&#x27;</span>);
    }
  }

  <span class="hljs-comment inline">// RSA key pair generation: use jsrsasign to generate standard format keys</span>
  <span class="hljs-title function_ inline">generateKeyPair</span>(<span class="hljs-params inline">keySize = <span class="hljs-number inline">2048</span></span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">const</span> keyPair = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">generateKeypair</span>(<span class="hljs-string inline">&#x27;RSA&#x27;</span>, keySize);
      <span class="hljs-keyword inline">const</span> publicKeyPEM = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getPEM</span>(keyPair.<span class="hljs-property inline">pubKeyObj</span>);       <span class="hljs-comment inline">// Public key PEM format</span>
      <span class="hljs-keyword inline">const</span> privateKeyPEM = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getPEM</span>(keyPair.<span class="hljs-property inline">prvKeyObj</span>, <span class="hljs-string inline">&#x27;PKCS8PRV&#x27;</span>);  <span class="hljs-comment inline">// Private key PKCS8 format</span>
      
      <span class="hljs-keyword inline">return</span> { publicKeyPEM, privateKeyPEM };
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA key generation failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// Public key distribution interface: for frontend to get public key</span>
  <span class="hljs-title function_ inline">getPublicKey</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>;
  }

  <span class="hljs-comment inline">// RSA-OAEP encryption implementation: use Node.js crypto module to ensure optimal performance and security</span>
  <span class="hljs-title function_ inline">encrypt</span>(<span class="hljs-params inline">plaintext</span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-comment inline">// Input validation: ensure plaintext is valid</span>
      <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
      }

      <span class="hljs-comment inline">// UTF-8 encoding conversion: ensure proper handling of Chinese and other characters</span>
      <span class="hljs-keyword inline">const</span> buffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(plaintext, <span class="hljs-string inline">&#x27;utf8&#x27;</span>);
      
      <span class="hljs-comment inline">// Core encryption logic: RSA encryption with OAEP padding</span>
      <span class="hljs-comment inline">// Choose Node.js crypto over jsrsasign: more reliable OAEP implementation</span>
      <span class="hljs-keyword inline">const</span> encrypted = crypto.<span class="hljs-title function_ inline">publicEncrypt</span>(
        {
          <span class="hljs-attr inline">key</span>: <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKeyPEM</span>,                              <span class="hljs-comment inline">// PEM format public key</span>
          <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,   <span class="hljs-comment inline">// OAEP padding, prevents padding attacks</span>
          <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,                                  <span class="hljs-comment inline">// SHA-256 hash function</span>
        },
        buffer
      );

      <span class="hljs-comment inline">// Base64 encoding: convenient for network transmission and storage</span>
      <span class="hljs-keyword inline">return</span> encrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;base64&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// RSA-OAEP decryption implementation: core of temporary decryption strategy</span>
  <span class="hljs-title function_ inline">decrypt</span>(<span class="hljs-params inline">encryptedData</span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-comment inline">// Input validation: ensure ciphertext format is correct</span>
      <span class="hljs-keyword inline">if</span> (!encryptedData || <span class="hljs-keyword inline">typeof</span> encryptedData !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid encrypted data for decryption&#x27;</span>);
      }

      <span class="hljs-comment inline">// Base64 decoding: restore binary ciphertext</span>
      <span class="hljs-keyword inline">const</span> encryptedBuffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(encryptedData, <span class="hljs-string inline">&#x27;base64&#x27;</span>);
      
      <span class="hljs-comment inline">// Core decryption logic: decrypt using private key</span>
      <span class="hljs-keyword inline">const</span> decrypted = crypto.<span class="hljs-title function_ inline">privateDecrypt</span>(
        {
          <span class="hljs-attr inline">key</span>: <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">privateKeyPEM</span>,                             <span class="hljs-comment inline">// PEM format private key</span>
          <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,   <span class="hljs-comment inline">// Consistent padding with encryption</span>
          <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,                                  <span class="hljs-comment inline">// Consistent hash with encryption</span>
        },
        encryptedBuffer
      );

      <span class="hljs-comment inline">// UTF-8 decoding: restore original string</span>
      <span class="hljs-keyword inline">return</span> decrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;utf8&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA decryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// Flexible encryption interface: support encryption with arbitrary public key (for testing)</span>
  <span class="hljs-title function_ inline">encryptWithPublicKey</span>(<span class="hljs-params inline">plaintext, publicKeyPEM</span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
      }

      <span class="hljs-keyword inline">const</span> buffer = <span class="hljs-title class_ inline">Buffer</span>.<span class="hljs-title function_ inline">from</span>(plaintext, <span class="hljs-string inline">&#x27;utf8&#x27;</span>);
      
      <span class="hljs-comment inline">// Encrypt using externally provided public key</span>
      <span class="hljs-keyword inline">const</span> encrypted = crypto.<span class="hljs-title function_ inline">publicEncrypt</span>(
        {
          <span class="hljs-attr inline">key</span>: publicKeyPEM,                                   <span class="hljs-comment inline">// External public key</span>
          <span class="hljs-attr inline">padding</span>: crypto.<span class="hljs-property inline">constants</span>.<span class="hljs-property inline">RSA_PKCS1_OAEP_PADDING</span>,
          <span class="hljs-attr inline">oaepHash</span>: <span class="hljs-string inline">&#x27;sha256&#x27;</span>,
        },
        buffer
      );

      <span class="hljs-keyword inline">return</span> encrypted.<span class="hljs-title function_ inline">toString</span>(<span class="hljs-string inline">&#x27;base64&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption with provided key failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-comment inline">// Key validation utility: ensure key format is correct</span>
  <span class="hljs-title function_ inline">validateKey</span>(<span class="hljs-params inline">keyPEM, isPrivate = <span class="hljs-literal inline">false</span></span>) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">const</span> keyObj = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getKey</span>(keyPEM);
      <span class="hljs-keyword inline">return</span> keyObj &amp;&amp; (isPrivate ? keyObj.<span class="hljs-property inline">isPrivate</span> : keyObj.<span class="hljs-property inline">isPublic</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>;   <span class="hljs-comment inline">// Return false on validation failure instead of throwing exception</span>
    }
  }
}

<span class="hljs-comment inline">// Singleton pattern export: global unique instance, saves memory and ensures cache consistency</span>
<span class="hljs-keyword inline">const</span> rsaCrypto = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RSACrypto</span>();

<span class="hljs-comment inline">// Module export: provide multiple usage methods</span>
<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = {
  <span class="hljs-title class_ inline">RSACrypto</span>,                                                    <span class="hljs-comment inline">// Export class (for extension)</span>
  rsaCrypto,                                                   <span class="hljs-comment inline">// Export singleton instance</span>
  <span class="hljs-attr inline">generateKeyPair</span>: <span class="hljs-function inline">(<span class="hljs-params inline">keySize</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">generateKeyPair</span>(keySize),     <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">encrypt</span>: <span class="hljs-function inline">(<span class="hljs-params inline">plaintext</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">encrypt</span>(plaintext),                 <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">decrypt</span>: <span class="hljs-function inline">(<span class="hljs-params inline">encryptedData</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">decrypt</span>(encryptedData),         <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">getPublicKey</span>: <span class="hljs-function inline">() =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">getPublicKey</span>(),                         <span class="hljs-comment inline">// Convenience function</span>
  <span class="hljs-attr inline">encryptWithPublicKey</span>: <span class="hljs-function inline">(<span class="hljs-params inline">plaintext, publicKey</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">encryptWithPublicKey</span>(plaintext, publicKey),
  <span class="hljs-attr inline">validateKey</span>: <span class="hljs-function inline">(<span class="hljs-params inline">keyPEM, isPrivate</span>) =&gt;</span> rsaCrypto.<span class="hljs-title function_ inline">validateKey</span>(keyPEM, isPrivate)
};
</code></pre>
            </div>
        
<h3 id="frontend-rsa-encryption-core-implementation-srcutilsrsacryptots" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#frontend-rsa-encryption-core-implementation-srcutilsrsacryptots" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Frontend RSA Encryption Core Implementation (src/utils/rsaCrypto.ts)">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Frontend RSA Encryption Core Implementation (<code>src/utils/rsaCrypto.ts</code>)
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="import%20*%20as%20jsrsasign%20from%20'jsrsasign'%3B%20%20%20%2F%2F%20RSA%20key%20operation%20library%0Aconst%20%7BKEYUTIL%7D%20%3D%20jsrsasign%3B%0Aexport%20class%20RSACrypto%20%7B%0Aprivate%20publicKey%3A%20string%20%7C%20null%20%3D%20null%3B%20%20%20%2F%2F%20Store%20public%20key%20obtained%20from%20backend%0A%2F%2F%20Static%20utility%20method%3A%20encrypt%20using%20specified%20public%20key%20(for%20testing)%0Astatic%20async%20encryptWithKey(plaintext%3A%20string%2C%20publicKeyPEM%3A%20string)%3A%20Promisestring%3E%20%7B%0Aconst%20rsa%20%3D%20new%20RSACrypto()%3B%0Arsa.setPublicKey(publicKeyPEM)%3B%0Areturn%20await%20rsa.encrypt(plaintext)%3B%0A%7D%0A%2F%2F%20Static%20security%20validation%3A%20ensure%20public%20key%20format%20is%20correct%20and%20doesn't%20contain%20private%20key%20information%0Astatic%20validatePublicKey(keyPEM%3A%20string)%3A%20boolean%20%7B%0Atry%20%7B%0Aconst%20keyObj%20%3D%20KEYUTIL.getKey(keyPEM)%3B%0A%2F%2F%20Critical%20security%20check%3A%20RSA%20public%20key%20should%20only%20contain%20modulus(n)%20and%20public%20key%20exponent(e)%0A%2F%2F%20Must%20never%20contain%20private%20key%20exponent(d)%20-%20this%20is%20the%20core%20of%20security%20protection%0Areturn%20keyObj%20%26%26%0A'n'%20in%20keyObj%20%26%26%20%20%20%20%2F%2F%20Modulus%20n%20must%20exist%0A'e'%20in%20keyObj%20%26%26%20%20%20%20%2F%2F%20Public%20key%20exponent%20e%20must%20exist%0A!('d'%20in%20keyObj)%3B%20%20%20%2F%2F%20Private%20key%20exponent%20d%20must%20never%20exist!%0A%7D%20catch%20%7B%0Areturn%20false%3B%20%20%20%2F%2F%20Parse%20failed%2C%20safely%20reject%0A%7D%0A%7D%0A%2F%2F%20Key%20setting%3A%20receive%20public%20key%20distributed%20from%20backend%0AsetPublicKey(publicKeyPEM%3A%20string)%20%7B%0Athis.publicKey%20%3D%20publicKeyPEM%3B%0A%7D%0A%2F%2F%20Key%20retrieval%3A%20return%20currently%20set%20public%20key%0AgetPublicKey()%3A%20string%20%7C%20null%20%7B%0Areturn%20this.publicKey%3B%0A%7D%0A%2F%2F%20Core%20encryption%20method%3A%20implement%20RSA-OAEP%20encryption%20using%20Web%20Crypto%20API%0Aasync%20encrypt(plaintext%3A%20string)%3A%20Promisestring%3E%20%7B%0A%2F%2F%20Pre-check%3A%20ensure%20public%20key%20is%20set%0Aif%20(!this.publicKey)%20%7B%0Athrow%20new%20Error('Public%20key%20not%20set.%20Call%20setPublicKey()%20first.')%3B%0A%7D%0A%2F%2F%20Input%20validation%3A%20ensure%20plaintext%20is%20valid%0Aif%20(!plaintext%20%7C%7C%20typeof%20plaintext%20!%3D%3D%20'string')%20%7B%0Athrow%20new%20Error('Invalid%20plaintext%20for%20encryption')%3B%0A%7D%0Atry%20%7B%0A%2F%2F%20Step%201%3A%20Convert%20PEM%20format%20key%20to%20ArrayBuffer%20required%20by%20Web%20Crypto%20API%0Aconst%20publicKeyBuffer%20%3D%20this.pemToArrayBuffer(this.publicKey)%3B%0A%2F%2F%20Step%202%3A%20Import%20public%20key%20to%20Web%20Crypto%20API%0A%2F%2F%20Use%20standard%20SPKI%20format%20and%20RSA-OAEP%20algorithm%0Aconst%20cryptoKey%20%3D%20await%20window.crypto.subtle.importKey(%0A'spki'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Subject%20Public%20Key%20Info%20format%0ApublicKeyBuffer%2C%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Binary%20key%20data%0A%7B%0Aname%3A%20'RSA-OAEP'%2C%20%20%20%20%20%20%20%2F%2F%20Algorithm%20name%2C%20consistent%20with%20backend%0Ahash%3A%20'SHA-256'%2C%20%20%20%20%20%20%20%20%2F%2F%20Hash%20function%2C%20consistent%20with%20backend%0A%7D%2C%0Afalse%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Don't%20allow%20key%20extraction%20(security%20consideration)%0A%5B'encrypt'%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Only%20allow%20encryption%20operations%0A)%3B%0A%2F%2F%20Step%203%3A%20Plaintext%20encoding%20and%20encryption%0Aconst%20plaintextBuffer%20%3D%20new%20TextEncoder().encode(plaintext)%3B%20%20%2F%2F%20UTF-8%20encoding%0Aconst%20encryptedBuffer%20%3D%20await%20window.crypto.subtle.encrypt(%0A%7B%0Aname%3A%20'RSA-OAEP'%2C%20%20%20%20%20%20%2F%2F%20Use%20OAEP%20padding%0A%7D%2C%0AcryptoKey%2C%0AplaintextBuffer%0A)%3B%0A%2F%2F%20Step%204%3A%20Base64%20encoding%20to%20match%20backend%20format%0Areturn%20this.arrayBufferToBase64(encryptedBuffer)%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60RSA%20encryption%20failed%3A%20%24%7Berror%20instanceof%20Error%20%3F%20error.message%20%3A%20'Unknown%20error'%7D%60)%3B%0A%7D%0A%7D%0A%2F%2F%20Private%20utility%20method%3A%20PEM%20format%20to%20ArrayBuffer%0Aprivate%20pemToArrayBuffer(pem%3A%20string)%3A%20ArrayBuffer%20%7B%0A%2F%2F%20Step%201%3A%20Remove%20PEM%20format%20header%2Ffooter%20and%20all%20whitespace%20characters%0Aconst%20pemHeader%20%3D%20'-----BEGIN%20PUBLIC%20KEY-----'%3B%0Aconst%20pemFooter%20%3D%20'-----END%20PUBLIC%20KEY-----'%3B%0Aconst%20pemContents%20%3D%20pem.replace(pemHeader%2C%20'')%0A.replace(pemFooter%2C%20'')%0A.replace(%2F%5Cs%2Fg%2C%20'')%3B%20%20%20%2F%2F%20Remove%20all%20whitespace%20characters%0A%2F%2F%20Step%202%3A%20Base64%20decode%20to%20binary%20string%0Aconst%20binaryString%20%3D%20atob(pemContents)%3B%0A%2F%2F%20Step%203%3A%20Binary%20string%20to%20ArrayBuffer%20(Web%20Crypto%20API%20standard%20format)%0Aconst%20bytes%20%3D%20new%20Uint8Array(binaryString.length)%3B%0Afor%20(let%20i%20%3D%200%3B%20i%20length%3B%20i%2B%2B)%20%7B%0Abytes%5Bi%5D%20%3D%20binaryString.charCodeAt(i)%3B%20%20%20%2F%2F%20Convert%20byte%20by%20byte%0A%7D%0Areturn%20bytes.buffer%3B%0A%7D%0A%2F%2F%20Private%20utility%20method%3A%20ArrayBuffer%20to%20Base64%20(network%20transmission%20format)%0Aprivate%20arrayBufferToBase64(buffer%3A%20ArrayBuffer)%3A%20string%20%7B%0Aconst%20bytes%20%3D%20new%20Uint8Array(buffer)%3B%0Alet%20binary%20%3D%20''%3B%0A%2F%2F%20Convert%20byte%20by%20byte%20to%20binary%20string%0Afor%20(let%20i%20%3D%200%3B%20i%20byteLength%3B%20i%2B%2B)%20%7B%0Abinary%20%2B%3D%20String.fromCharCode(bytes%5Bi%5D)%3B%0A%7D%0Areturn%20btoa(binary)%3B%20%20%20%2F%2F%20Base64%20encoding%0A%7D%0A%7D%0A%2F%2F%20Export%20singleton%20instance%3A%20globally%20unique%2C%20convenient%20for%20state%20management%0Aexport%20const%20rsaCrypto%20%3D%20new%20RSACrypto()%3B%0A%2F%2F%20Export%20utility%20functions%3A%20convenient%20for%20direct%20calls%0Aexport%20const%20encryptWithKey%20%3D%20RSACrypto.encryptWithKey%3B%0Aexport%20const%20validatePublicKey%20%3D%20RSACrypto.validatePublicKey%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">import</span> * <span class="hljs-keyword inline">as</span> jsrsasign <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;jsrsasign&#x27;</span>;   <span class="hljs-comment inline">// RSA key operation library</span>

<span class="hljs-keyword inline">const</span> {<span class="hljs-variable constant_ inline">KEYUTIL</span>} = jsrsasign;

<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">class</span> <span class="hljs-title class_ inline">RSACrypto</span> {
    <span class="hljs-keyword inline">private</span> <span class="hljs-attr inline">publicKey</span>: <span class="hljs-built_in inline">string</span> | <span class="hljs-literal inline">null</span> = <span class="hljs-literal inline">null</span>;   <span class="hljs-comment inline">// Store public key obtained from backend</span>

    <span class="hljs-comment inline">// Static utility method: encrypt using specified public key (for testing)</span>
    <span class="hljs-keyword inline">static</span> <span class="hljs-keyword inline">async</span> <span class="hljs-title function_ inline">encryptWithKey</span>(<span class="hljs-attr inline">plaintext</span>: <span class="hljs-built_in inline">string</span>, <span class="hljs-attr inline">publicKeyPEM</span>: <span class="hljs-built_in inline">string</span>): <span class="hljs-title class_ inline">Promise</span>&lt;<span class="hljs-built_in inline">string</span>&gt; {
        <span class="hljs-keyword inline">const</span> rsa = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RSACrypto</span>();
        rsa.<span class="hljs-title function_ inline">setPublicKey</span>(publicKeyPEM);
        <span class="hljs-keyword inline">return</span> <span class="hljs-keyword inline">await</span> rsa.<span class="hljs-title function_ inline">encrypt</span>(plaintext);
    }

    <span class="hljs-comment inline">// Static security validation: ensure public key format is correct and doesn&#x27;t contain private key information</span>
    <span class="hljs-keyword inline">static</span> <span class="hljs-title function_ inline">validatePublicKey</span>(<span class="hljs-attr inline">keyPEM</span>: <span class="hljs-built_in inline">string</span>): <span class="hljs-built_in inline">boolean</span> {
        <span class="hljs-keyword inline">try</span> {
            <span class="hljs-keyword inline">const</span> keyObj = <span class="hljs-variable constant_ inline">KEYUTIL</span>.<span class="hljs-title function_ inline">getKey</span>(keyPEM);
            <span class="hljs-comment inline">// Critical security check: RSA public key should only contain modulus(n) and public key exponent(e)</span>
            <span class="hljs-comment inline">// Must never contain private key exponent(d) - this is the core of security protection</span>
            <span class="hljs-keyword inline">return</span> keyObj &amp;&amp; 
                   <span class="hljs-string inline">&#x27;n&#x27;</span> <span class="hljs-keyword inline">in</span> keyObj &amp;&amp;    <span class="hljs-comment inline">// Modulus n must exist</span>
                   <span class="hljs-string inline">&#x27;e&#x27;</span> <span class="hljs-keyword inline">in</span> keyObj &amp;&amp;    <span class="hljs-comment inline">// Public key exponent e must exist</span>
                   !(<span class="hljs-string inline">&#x27;d&#x27;</span> <span class="hljs-keyword inline">in</span> keyObj);   <span class="hljs-comment inline">// Private key exponent d must never exist!</span>
        } <span class="hljs-keyword inline">catch</span> {
            <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>;   <span class="hljs-comment inline">// Parse failed, safely reject</span>
        }
    }

    <span class="hljs-comment inline">// Key setting: receive public key distributed from backend</span>
    <span class="hljs-title function_ inline">setPublicKey</span>(<span class="hljs-params inline"><span class="hljs-attr inline">publicKeyPEM</span>: <span class="hljs-built_in inline">string</span></span>) {
        <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKey</span> = publicKeyPEM;
    }

    <span class="hljs-comment inline">// Key retrieval: return currently set public key</span>
    <span class="hljs-title function_ inline">getPublicKey</span>(): <span class="hljs-built_in inline">string</span> | <span class="hljs-literal inline">null</span> {
        <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKey</span>;
    }

    <span class="hljs-comment inline">// Core encryption method: implement RSA-OAEP encryption using Web Crypto API</span>
    <span class="hljs-keyword inline">async</span> <span class="hljs-title function_ inline">encrypt</span>(<span class="hljs-attr inline">plaintext</span>: <span class="hljs-built_in inline">string</span>): <span class="hljs-title class_ inline">Promise</span>&lt;<span class="hljs-built_in inline">string</span>&gt; {
        <span class="hljs-comment inline">// Pre-check: ensure public key is set</span>
        <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKey</span>) {
            <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Public key not set. Call setPublicKey() first.&#x27;</span>);
        }

        <span class="hljs-comment inline">// Input validation: ensure plaintext is valid</span>
        <span class="hljs-keyword inline">if</span> (!plaintext || <span class="hljs-keyword inline">typeof</span> plaintext !== <span class="hljs-string inline">&#x27;string&#x27;</span>) {
            <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;Invalid plaintext for encryption&#x27;</span>);
        }

        <span class="hljs-keyword inline">try</span> {
            <span class="hljs-comment inline">// Step 1: Convert PEM format key to ArrayBuffer required by Web Crypto API</span>
            <span class="hljs-keyword inline">const</span> publicKeyBuffer = <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">pemToArrayBuffer</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">publicKey</span>);

            <span class="hljs-comment inline">// Step 2: Import public key to Web Crypto API</span>
            <span class="hljs-comment inline">// Use standard SPKI format and RSA-OAEP algorithm</span>
            <span class="hljs-keyword inline">const</span> cryptoKey = <span class="hljs-keyword inline">await</span> <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">crypto</span>.<span class="hljs-property inline">subtle</span>.<span class="hljs-title function_ inline">importKey</span>(
                <span class="hljs-string inline">&#x27;spki&#x27;</span>,                     <span class="hljs-comment inline">// Subject Public Key Info format</span>
                publicKeyBuffer,            <span class="hljs-comment inline">// Binary key data</span>
                {
                    <span class="hljs-attr inline">name</span>: <span class="hljs-string inline">&#x27;RSA-OAEP&#x27;</span>,       <span class="hljs-comment inline">// Algorithm name, consistent with backend</span>
                    <span class="hljs-attr inline">hash</span>: <span class="hljs-string inline">&#x27;SHA-256&#x27;</span>,        <span class="hljs-comment inline">// Hash function, consistent with backend</span>
                },
                <span class="hljs-literal inline">false</span>,                      <span class="hljs-comment inline">// Don&#x27;t allow key extraction (security consideration)</span>
                [<span class="hljs-string inline">&#x27;encrypt&#x27;</span>]                 <span class="hljs-comment inline">// Only allow encryption operations</span>
            );

            <span class="hljs-comment inline">// Step 3: Plaintext encoding and encryption</span>
            <span class="hljs-keyword inline">const</span> plaintextBuffer = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">TextEncoder</span>().<span class="hljs-title function_ inline">encode</span>(plaintext);  <span class="hljs-comment inline">// UTF-8 encoding</span>
            <span class="hljs-keyword inline">const</span> encryptedBuffer = <span class="hljs-keyword inline">await</span> <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">crypto</span>.<span class="hljs-property inline">subtle</span>.<span class="hljs-title function_ inline">encrypt</span>(
                {
                    <span class="hljs-attr inline">name</span>: <span class="hljs-string inline">&#x27;RSA-OAEP&#x27;</span>,      <span class="hljs-comment inline">// Use OAEP padding</span>
                },
                cryptoKey,
                plaintextBuffer
            );

            <span class="hljs-comment inline">// Step 4: Base64 encoding to match backend format</span>
            <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">arrayBufferToBase64</span>(encryptedBuffer);
        } <span class="hljs-keyword inline">catch</span> (error) {
            <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`RSA encryption failed: <span class="hljs-subst inline">${error <span class="hljs-keyword inline">instanceof</span> <span class="hljs-built_in inline">Error</span> ? error.message : <span class="hljs-string inline">&#x27;Unknown error&#x27;</span>}</span>`</span>);
        }
    }

    <span class="hljs-comment inline">// Private utility method: PEM format to ArrayBuffer</span>
    <span class="hljs-keyword inline">private</span> <span class="hljs-title function_ inline">pemToArrayBuffer</span>(<span class="hljs-attr inline">pem</span>: <span class="hljs-built_in inline">string</span>): <span class="hljs-title class_ inline">ArrayBuffer</span> {
        <span class="hljs-comment inline">// Step 1: Remove PEM format header/footer and all whitespace characters</span>
        <span class="hljs-keyword inline">const</span> pemHeader = <span class="hljs-string inline">&#x27;-----BEGIN PUBLIC KEY-----&#x27;</span>;
        <span class="hljs-keyword inline">const</span> pemFooter = <span class="hljs-string inline">&#x27;-----END PUBLIC KEY-----&#x27;</span>;
        <span class="hljs-keyword inline">const</span> pemContents = pem.<span class="hljs-title function_ inline">replace</span>(pemHeader, <span class="hljs-string inline">&#x27;&#x27;</span>)
                              .<span class="hljs-title function_ inline">replace</span>(pemFooter, <span class="hljs-string inline">&#x27;&#x27;</span>)
                              .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/\s/g</span>, <span class="hljs-string inline">&#x27;&#x27;</span>);   <span class="hljs-comment inline">// Remove all whitespace characters</span>

        <span class="hljs-comment inline">// Step 2: Base64 decode to binary string</span>
        <span class="hljs-keyword inline">const</span> binaryString = <span class="hljs-title function_ inline">atob</span>(pemContents);

        <span class="hljs-comment inline">// Step 3: Binary string to ArrayBuffer (Web Crypto API standard format)</span>
        <span class="hljs-keyword inline">const</span> bytes = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Uint8Array</span>(binaryString.<span class="hljs-property inline">length</span>);
        <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> i = <span class="hljs-number inline">0</span>; i &lt; binaryString.<span class="hljs-property inline">length</span>; i++) {
            bytes[i] = binaryString.<span class="hljs-title function_ inline">charCodeAt</span>(i);   <span class="hljs-comment inline">// Convert byte by byte</span>
        }

        <span class="hljs-keyword inline">return</span> bytes.<span class="hljs-property inline">buffer</span>;
    }

    <span class="hljs-comment inline">// Private utility method: ArrayBuffer to Base64 (network transmission format)</span>
    <span class="hljs-keyword inline">private</span> <span class="hljs-title function_ inline">arrayBufferToBase64</span>(<span class="hljs-attr inline">buffer</span>: <span class="hljs-title class_ inline">ArrayBuffer</span>): <span class="hljs-built_in inline">string</span> {
        <span class="hljs-keyword inline">const</span> bytes = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Uint8Array</span>(buffer);
        <span class="hljs-keyword inline">let</span> binary = <span class="hljs-string inline">&#x27;&#x27;</span>;
        <span class="hljs-comment inline">// Convert byte by byte to binary string</span>
        <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> i = <span class="hljs-number inline">0</span>; i &lt; bytes.<span class="hljs-property inline">byteLength</span>; i++) {
            binary += <span class="hljs-title class_ inline">String</span>.<span class="hljs-title function_ inline">fromCharCode</span>(bytes[i]);
        }
        <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">btoa</span>(binary);   <span class="hljs-comment inline">// Base64 encoding</span>
    }
}

<span class="hljs-comment inline">// Export singleton instance: globally unique, convenient for state management</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">const</span> rsaCrypto = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">RSACrypto</span>();

<span class="hljs-comment inline">// Export utility functions: convenient for direct calls</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">const</span> encryptWithKey = <span class="hljs-title class_ inline">RSACrypto</span>.<span class="hljs-property inline">encryptWithKey</span>;
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">const</span> validatePublicKey = <span class="hljs-title class_ inline">RSACrypto</span>.<span class="hljs-property inline">validatePublicKey</span>;
</code></pre>
            </div>
        
<h3 id="user-model-decryption-logic-core-implementation-srcmodelsuserjs" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#user-model-decryption-logic-core-implementation-srcmodelsuserjs" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to User Model Decryption Logic Core Implementation (src/models/User.js)">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            User Model Decryption Logic Core Implementation (<code>src/models/User.js</code>)
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Method%20to%20decrypt%20API%20key%20using%20RSA%0AuserSchema.methods.decryptApiKey%20%3D%20function(encryptedKey%20%3D%20null)%20%7B%0Atry%20%7B%0Aconst%20keyToDecrypt%20%3D%20encryptedKey%20%7C%7C%20this.apiKey%3B%0Aif%20(!keyToDecrypt)%20%7B%0Areturn%20null%3B%0A%7D%0A%2F%2F%20Check%20if%20it's%20RSA%20encrypted%20(base64%20format%20from%20frontend)%0Aif%20(keyToDecrypt.startsWith('rsa%3A'))%20%7B%0Aconst%20encryptedData%20%3D%20keyToDecrypt.substring(4)%3B%0Areturn%20decrypt(encryptedData)%3B%0A%7D%0A%2F%2F%20If%20not%20encrypted%2C%20return%20directly%20(for%20development%2Ftesting)%0Areturn%20keyToDecrypt%3B%0A%7D%20catch%20(error)%20%7B%0Athrow%20new%20Error(%60API%20key%20decryption%20failed%3A%20%24%7Berror.message%7D%60)%3B%0A%7D%0A%7D%3B%0A%2F%2F%20On-demand%20decryption%20security%20strategy%3A%20only%20decrypt%20when%20truly%20needed%0AuserSchema.methods.getDecryptedApiKey%20%3D%20function()%20%7B%0A%2F%2F%20Dual%20security%20check%3A%20must%20satisfy%20both%20having%20key%20and%20enabling%20custom%20key%0Aif%20(!this.apiKey%20%7C%7C%20!this.useCustomApiKey)%20%7B%0Areturn%20null%3B%20%20%20%2F%2F%20Conditions%20not%20met%2C%20return%20null%0A%7D%0A%2F%2F%20Temporary%20decryption%3A%20call%20decryption%20method%20to%20get%20plaintext%20key%0Areturn%20this.decryptApiKey()%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Method to decrypt API key using RSA</span>
userSchema.<span class="hljs-property inline">methods</span>.<span class="hljs-property inline">decryptApiKey</span> = <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">encryptedKey = <span class="hljs-literal inline">null</span></span>) {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> keyToDecrypt = encryptedKey || <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">apiKey</span>;
    
    <span class="hljs-keyword inline">if</span> (!keyToDecrypt) {
      <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
    }

    <span class="hljs-comment inline">// Check if it&#x27;s RSA encrypted (base64 format from frontend)</span>
    <span class="hljs-keyword inline">if</span> (keyToDecrypt.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;rsa:&#x27;</span>)) {
      <span class="hljs-keyword inline">const</span> encryptedData = keyToDecrypt.<span class="hljs-title function_ inline">substring</span>(<span class="hljs-number inline">4</span>);
      <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">decrypt</span>(encryptedData);
    }
    
    <span class="hljs-comment inline">// If not encrypted, return directly (for development/testing)</span>
    <span class="hljs-keyword inline">return</span> keyToDecrypt;
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">`API key decryption failed: <span class="hljs-subst inline">${error.message}</span>`</span>);
  }
};

<span class="hljs-comment inline">// On-demand decryption security strategy: only decrypt when truly needed</span>
userSchema.<span class="hljs-property inline">methods</span>.<span class="hljs-property inline">getDecryptedApiKey</span> = <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline"></span>) {
  <span class="hljs-comment inline">// Dual security check: must satisfy both having key and enabling custom key</span>
  <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">apiKey</span> || !<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">useCustomApiKey</span>) {
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;   <span class="hljs-comment inline">// Conditions not met, return null</span>
  }
  <span class="hljs-comment inline">// Temporary decryption: call decryption method to get plaintext key</span>
  <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">decryptApiKey</span>();
};
</code></pre>
            </div>
        
<h3 id="authentication-controller-key-management-core-implementation-srccontrollersauthcontrollerjs" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#authentication-controller-key-management-core-implementation-srccontrollersauthcontrollerjs" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Authentication Controller Key Management Core Implementation (src/controllers/authController.js)">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Authentication Controller Key Management Core Implementation (<code>src/controllers/authController.js</code>)
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20API%20interface%3A%20update%20user%20API%20key%0A%2F%2F%20%40desc%20%20%20%20Update%20user%20API%20key%0A%2F%2F%20%40route%20%20%20PUT%20%2Fapi%2Fauth%2Fapi-key%0A%2F%2F%20%40access%20%20Private%20(requires%20authentication)%0Aexports.updateApiKey%20%3D%20async%20(req%2C%20res)%20%3D%3E%20%7B%0Atry%20%7B%0Aconst%20%7B%20apiKey%2C%20useCustomApiKey%20%7D%20%3D%20req.body%3B%0A%2F%2F%20Input%20validation%20boundary%20condition%20handling%3A%20precise%20validation%20logic%0A%2F%2F%20Only%20report%20error%20when%20explicitly%20wanting%20to%20use%20custom%20key%20and%20empty%20string%20is%20provided%0A%2F%2F%20Allow%20setting%20useCustomApiKey%20%3D%20true%20but%20not%20providing%20key%20yet%0Aif%20(useCustomApiKey%20%26%26%20apiKey%20%26%26%20apiKey.trim().length%20%3D%3D%3D%200)%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('auth.apiKeyRequired')%20%20%20%2F%2F%20Internationalized%20error%20message%0A%7D)%3B%0A%7D%0A%2F%2F%20User%20authentication%3A%20ensure%20user%20exists%0Aconst%20user%20%3D%20await%20User.findById(req.user.id)%3B%0Aif%20(!user)%20%7B%0Areturn%20res.status(404).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('auth.userNotFound')%0A%7D)%3B%0A%7D%0A%2F%2F%20Core%20logic%20of%20key%20update%3A%20atomic%20operation%20of%20state%20management%0Aif%20(useCustomApiKey)%20%7B%0A%2F%2F%20Critical%20security%20decision%3A%20directly%20store%20frontend%20encrypted%20data%2C%20never%20decrypt%20here%0A%2F%2F%20Frontend%20sends%20RSA%20encrypted%20data%2C%20format%20is%20'rsa%3ABase64EncryptedData'%0Aif%20(apiKey%20%26%26%20apiKey.trim().length%20%3E%200)%20%7B%0Auser.apiKey%20%3D%20apiKey.trim()%3B%20%20%20%2F%2F%20Directly%20store%20ciphertext%2C%20maintain%20encrypted%20state%0A%7D%20else%20%7B%0Auser.apiKey%20%3D%20undefined%3B%20%20%20%20%20%20%20%2F%2F%20Clear%20key%20data%0A%7D%0Auser.useCustomApiKey%20%3D%20true%3B%20%20%20%20%20%2F%2F%20Enable%20custom%20key%20flag%0A%7D%20else%20%7B%0A%2F%2F%20Disable%20custom%20key%3A%20clear%20both%20key%20data%20and%20flag%2C%20ensure%20data%20consistency%0Auser.apiKey%20%3D%20undefined%3B%0Auser.useCustomApiKey%20%3D%20false%3B%0A%7D%0A%2F%2F%20Atomic%20database%20operation%3A%20ensure%20consistency%20of%20state%20changes%0Aawait%20user.save()%3B%0A%2F%2F%20Success%20response%3A%20return%20operation%20result%20and%20new%20state%0Ares.status(200).json(%7B%0Asuccess%3A%20true%2C%0Amessage%3A%20req.t('auth.apiKeyUpdatedSuccessfully')%2C%0AuseCustomApiKey%3A%20user.useCustomApiKey%20%20%20%20%2F%2F%20Return%20current%20state%20for%20frontend%20confirmation%0A%7D)%3B%0A%7D%20catch%20(error)%20%7B%0A%2F%2F%20Unified%20error%20handling%3A%20log%20error%20and%20return%20user-friendly%20error%20message%0Ares.status(500).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('auth.serverError')%0A%7D)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// API interface: update user API key</span>
<span class="hljs-comment inline">// @desc    Update user API key</span>
<span class="hljs-comment inline">// @route   PUT /api/auth/api-key</span>
<span class="hljs-comment inline">// @access  Private (requires authentication)</span>
<span class="hljs-built_in inline">exports</span>.<span class="hljs-property inline">updateApiKey</span> = <span class="hljs-title function_ inline">async</span> (req, res) =&gt; {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> { apiKey, useCustomApiKey } = req.<span class="hljs-property inline">body</span>;

    <span class="hljs-comment inline">// Input validation boundary condition handling: precise validation logic</span>
    <span class="hljs-comment inline">// Only report error when explicitly wanting to use custom key and empty string is provided</span>
    <span class="hljs-comment inline">// Allow setting useCustomApiKey = true but not providing key yet</span>
    <span class="hljs-keyword inline">if</span> (useCustomApiKey &amp;&amp; apiKey &amp;&amp; apiKey.<span class="hljs-title function_ inline">trim</span>().<span class="hljs-property inline">length</span> === <span class="hljs-number inline">0</span>) {
      <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
        <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.apiKeyRequired&#x27;</span>)   <span class="hljs-comment inline">// Internationalized error message</span>
      });
    }

    <span class="hljs-comment inline">// User authentication: ensure user exists</span>
    <span class="hljs-keyword inline">const</span> user = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">User</span>.<span class="hljs-title function_ inline">findById</span>(req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>);
    <span class="hljs-keyword inline">if</span> (!user) {
      <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">404</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
        <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.userNotFound&#x27;</span>)
      });
    }

    <span class="hljs-comment inline">// Core logic of key update: atomic operation of state management</span>
    <span class="hljs-keyword inline">if</span> (useCustomApiKey) {
      <span class="hljs-comment inline">// Critical security decision: directly store frontend encrypted data, never decrypt here</span>
      <span class="hljs-comment inline">// Frontend sends RSA encrypted data, format is &#x27;rsa:Base64EncryptedData&#x27;</span>
      <span class="hljs-keyword inline">if</span> (apiKey &amp;&amp; apiKey.<span class="hljs-title function_ inline">trim</span>().<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>) {
        user.<span class="hljs-property inline">apiKey</span> = apiKey.<span class="hljs-title function_ inline">trim</span>();   <span class="hljs-comment inline">// Directly store ciphertext, maintain encrypted state</span>
      } <span class="hljs-keyword inline">else</span> {
        user.<span class="hljs-property inline">apiKey</span> = <span class="hljs-literal inline">undefined</span>;       <span class="hljs-comment inline">// Clear key data</span>
      }
      user.<span class="hljs-property inline">useCustomApiKey</span> = <span class="hljs-literal inline">true</span>;     <span class="hljs-comment inline">// Enable custom key flag</span>
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-comment inline">// Disable custom key: clear both key data and flag, ensure data consistency</span>
      user.<span class="hljs-property inline">apiKey</span> = <span class="hljs-literal inline">undefined</span>;
      user.<span class="hljs-property inline">useCustomApiKey</span> = <span class="hljs-literal inline">false</span>;
    }

    <span class="hljs-comment inline">// Atomic database operation: ensure consistency of state changes</span>
    <span class="hljs-keyword inline">await</span> user.<span class="hljs-title function_ inline">save</span>();

    <span class="hljs-comment inline">// Success response: return operation result and new state</span>
    res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">200</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.apiKeyUpdatedSuccessfully&#x27;</span>),
      <span class="hljs-attr inline">useCustomApiKey</span>: user.<span class="hljs-property inline">useCustomApiKey</span>    <span class="hljs-comment inline">// Return current state for frontend confirmation</span>
    });
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-comment inline">// Unified error handling: log error and return user-friendly error message</span>
    res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">500</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;auth.serverError&#x27;</span>)
    });
  }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Core Design Principles of Code Architecture</strong>:</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Security First Principle</strong>: Backend never stores plaintext keys, only temporarily decrypts when using</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Separation of Responsibilities Principle</strong>: Frontend responsible for encryption, backend responsible for storage and on-demand decryption</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Data Consistency Principle</strong>: Ensure atomic updates of key data and usage flags</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Error Handling Principle</strong>: Each layer has detailed error handling and internationalization support</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Forward Compatibility Principle</strong>: Support debugging needs in development environment, maintain system flexibility</li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground">Through detailed analysis of these codes, we can see that every detail of the RSA implementation in the Questions Party project has been carefully considered, ensuring both security and maintainability and usability. The entire architecture reflects the best practices of modern web security development.</p>
<h2 id="complete-end-to-end-encryption-flow-tracking" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#complete-end-to-end-encryption-flow-tracking" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete End-to-End Encryption Flow Tracking">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete End-to-End Encryption Flow Tracking
        </h2>
<h3 id="complete-tracking-from-user-input-to-database-storage" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#complete-tracking-from-user-input-to-database-storage" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete Tracking from User Input to Database Storage">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete Tracking from User Input to Database Storage
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">API Key Update Flow</strong>:</p>
<div class="mermaid block" id="mermaid-1767525093360-kh2le02">sequenceDiagram
    participant U as User
    participant F as Frontend
    participant B as Backend
    participant D as Database
    
    U->>F: Input API Key
    F->>B: Get RSA Public Key
    B->>F: Return Public Key
    F->>F: RSA Encrypt Key
    F->>B: Send Encrypted Data
    B->>D: Directly Store Encrypted Data
    D->>B: Confirm Storage
    B->>F: Return Success Status
    F->>U: Display Success Message</div>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">API Key Usage Flow</strong>:</p>
<div class="mermaid block" id="mermaid-1767525093360-rseoa98">sequenceDiagram
    participant U as User
    participant F as Frontend
    participant B as Backend
    participant D as Database
    participant A as Large Model API
    
    U->>F: Send Request
    F->>B: Request Processing
    B->>D: Read Encrypted Key
    D->>B: Return Encrypted Data
    B->>B: Temporarily Decrypt Key
    B->>A: Use Plaintext Key to Call API
    A->>B: Return API Response
    B->>B: Clean Plaintext Key
    B->>F: Return Processing Result
    F->>U: Display Result</div>
<h3 id="data-state-changes-at-each-step" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#data-state-changes-at-each-step" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Data State Changes at Each Step">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Data State Changes at Each Step
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">API Key Update Flow Data State</strong>:</p>
<table class="w-full border-collapse mb-4 shadow-sm rounded-lg overflow-hidden">
<thead class="bg-surface">
<tr class="border-b border-gray-200"><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Step</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Location</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Data State</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Format</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Security</th></tr>
</thead>
<tbody class="bg-background divide-y divide-gray-200">
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">1</td><td class="px-4 py-3 text-sm text-foreground">User Input</td><td class="px-4 py-3 text-sm text-foreground">Plaintext</td><td class="px-4 py-3 text-sm text-foreground">String</td><td class="px-4 py-3 text-sm text-foreground">Low</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">2</td><td class="px-4 py-3 text-sm text-foreground">Frontend Memory</td><td class="px-4 py-3 text-sm text-foreground">Plaintext</td><td class="px-4 py-3 text-sm text-foreground">String</td><td class="px-4 py-3 text-sm text-foreground">Low</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">3</td><td class="px-4 py-3 text-sm text-foreground">Frontend Encryption</td><td class="px-4 py-3 text-sm text-foreground">Ciphertext</td><td class="px-4 py-3 text-sm text-foreground">Base64</td><td class="px-4 py-3 text-sm text-foreground">High</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">4</td><td class="px-4 py-3 text-sm text-foreground">Network Transmission</td><td class="px-4 py-3 text-sm text-foreground">Ciphertext+TLS</td><td class="px-4 py-3 text-sm text-foreground">Encrypted</td><td class="px-4 py-3 text-sm text-foreground">Very High</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">5</td><td class="px-4 py-3 text-sm text-foreground">Backend Reception</td><td class="px-4 py-3 text-sm text-foreground">Ciphertext</td><td class="px-4 py-3 text-sm text-foreground">Base64</td><td class="px-4 py-3 text-sm text-foreground">High</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">6</td><td class="px-4 py-3 text-sm text-foreground">Database Storage</td><td class="px-4 py-3 text-sm text-foreground">Ciphertext</td><td class="px-4 py-3 text-sm text-foreground">rsa:Base64</td><td class="px-4 py-3 text-sm text-foreground">High</td></tr>
</tbody>
</table>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">API Key Usage Flow Data State</strong>:</p>
<table class="w-full border-collapse mb-4 shadow-sm rounded-lg overflow-hidden">
<thead class="bg-surface">
<tr class="border-b border-gray-200"><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Step</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Location</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Data State</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Format</th><th class="px-4 py-3 text-left text-xs font-medium text-foreground uppercase tracking-wider bg-surface">Security</th></tr>
</thead>
<tbody class="bg-background divide-y divide-gray-200">
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">1</td><td class="px-4 py-3 text-sm text-foreground">Database Read</td><td class="px-4 py-3 text-sm text-foreground">Ciphertext</td><td class="px-4 py-3 text-sm text-foreground">rsa:Base64</td><td class="px-4 py-3 text-sm text-foreground">High</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">2</td><td class="px-4 py-3 text-sm text-foreground">Backend Temporary Decryption</td><td class="px-4 py-3 text-sm text-foreground">Plaintext</td><td class="px-4 py-3 text-sm text-foreground">String</td><td class="px-4 py-3 text-sm text-foreground">Medium</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">3</td><td class="px-4 py-3 text-sm text-foreground">Call Large Model API</td><td class="px-4 py-3 text-sm text-foreground">Plaintext</td><td class="px-4 py-3 text-sm text-foreground">String</td><td class="px-4 py-3 text-sm text-foreground">Medium</td></tr>
<tr class="border-b border-gray-200"><td class="px-4 py-3 text-sm text-foreground">4</td><td class="px-4 py-3 text-sm text-foreground">Memory Cleanup</td><td class="px-4 py-3 text-sm text-foreground">Destroyed</td><td class="px-4 py-3 text-sm text-foreground">-</td><td class="px-4 py-3 text-sm text-foreground">Very High</td></tr>
</tbody>
</table>
<h3 id="debugging-and-monitoring-best-practices" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#debugging-and-monitoring-best-practices" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Debugging and Monitoring Best Practices">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Debugging and Monitoring Best Practices
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Logging Strategy</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E2%9C%85%20Safe%20logging%0Aconsole.log('API%20key%20updated%20for%20user%3A'%2C%20user.id)%3B%0Aconsole.log('Using%20custom%20API%20key%3A'%2C%20user.useCustomApiKey)%3B%0A%2F%2F%20%E2%9D%8C%20Dangerous%20logging%0Aconsole.log('API%20key%3A'%2C%20apiKey)%3B%20%20%2F%2F%20Never%20log%20sensitive%20data%0Aconsole.log('Decrypted%20key%3A'%2C%20decryptedKey)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// ✅ Safe logging</span>
<span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;API key updated for user:&#x27;</span>, user.<span class="hljs-property inline">id</span>);
<span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Using custom API key:&#x27;</span>, user.<span class="hljs-property inline">useCustomApiKey</span>);

<span class="hljs-comment inline">// ❌ Dangerous logging</span>
<span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;API key:&#x27;</span>, apiKey);  <span class="hljs-comment inline">// Never log sensitive data</span>
<span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;Decrypted key:&#x27;</span>, decryptedKey);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">Monitoring Metrics</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20securityMetrics%20%3D%20%7B%0AencryptionSuccessRate%3A%20'99.9%25'%2C%0AdecryptionErrorRate%3A%20'0.1%25'%2C%0AkeyRotationFrequency%3A%20'90%20days'%2C%0AsuspiciousActivityCount%3A%200%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="Copy code">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">Copy</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> securityMetrics = {
  <span class="hljs-attr inline">encryptionSuccessRate</span>: <span class="hljs-string inline">&#x27;99.9%&#x27;</span>,
  <span class="hljs-attr inline">decryptionErrorRate</span>: <span class="hljs-string inline">&#x27;0.1%&#x27;</span>,
  <span class="hljs-attr inline">keyRotationFrequency</span>: <span class="hljs-string inline">&#x27;90 days&#x27;</span>,
  <span class="hljs-attr inline">suspiciousActivityCount</span>: <span class="hljs-number inline">0</span>
};
</code></pre>
            </div>
        
<h2 id="system-architecture-summary-and-best-practices" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#system-architecture-summary-and-best-practices" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to System Architecture Summary and Best Practices">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            System Architecture Summary and Best Practices
        </h2>
<h3 id="complete-rsa-architecture-in-modern-web-applications" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#complete-rsa-architecture-in-modern-web-applications" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Complete RSA Architecture in Modern Web Applications">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Complete RSA Architecture in Modern Web Applications
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Through in-depth analysis of the Questions Party project, we can summarize a complete RSA encryption architecture:</p>
<div class="mermaid block" id="mermaid-1767525093360-1xw28bo">graph TB
    subgraph "Security Boundaries"
        subgraph "Frontend Security Domain"
            A[User Input] --> B[Data Validation]
            B --> C[Get Public Key]
            C --> D[RSA Encryption]
            D --> E[Secure Transmission]
        end
        
        subgraph "Transmission Security Domain"
            E --> F[HTTPS Tunnel]
            F --> G[TLS Termination]
        end
        
        subgraph "Backend Security Domain"
            G --> H[Data Reception]
            H --> I[Authentication]
            I --> J[Direct Ciphertext Storage]
            J --> K[On-Demand Temporary Decryption]
            K --> L[Business Processing]
            L --> M[Memory Cleanup]
        end
        
        subgraph "Storage Security Domain"
            M --> N[Database]
            N --> O[Backup Encryption]
        end
    end
    
    subgraph "Key Management Domain"
        P[Key Generation] --> Q[Key Distribution]
        Q --> R[Key Rotation]
        R --> S[Key Destruction]
    end
    
    Q --> C
    P --> K</div>
<h2 id="final-words" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#final-words" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Final Words">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Final Words
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">When designing a secure encryption architecture, I assume: the frontend code has been reverse engineered, and the intermediate transmission has been intercepted, their algorithms and data are completely exposed to the attacker’s eyes, only the backend is secure. In this case, what kind of encryption process can ensure security?</p>
<p class="text-base leading-7 mb-4 text-foreground">If only the backend is secure, then to solve this problem, we can only start from the backend. That is—I need something secure to guard the decryption step, ensuring that plaintext keys only temporarily exist in the backend, minimizing the possibility of attackers stealing keys.</p>
<p class="text-base leading-7 mb-4 text-foreground">Later I thought of asymmetric encryption.</p>
<p class="text-base leading-7 mb-4 text-foreground"><em class="italic text-foreground">May your encryption be as unpredictable as the scars on an ancient planet. The public key and the private key are at opposite ends. Cross the long river of the unknown in the middle and safely bring the message in your heart to the other side.</em> 🔐✨</p>
d:["$","$L1d",null,{"htmlContent":"$1e","frontMatter":{"title":"The Double-Edged Sword of Keys: RSA Encryption's Security Protection Path in Modern Web Applications","description":"From Mathematical Principles to Engineering Practice—Analyzing End-to-End Encryption Implementation in Questions Party","date":"2025-06-22","author":"MilkWind","tags":["RSA"],"references":{}},"readingTime":"32 min read","category":"questions-party","tocItems":[{"id":"the-double-edged-sword-of-keys-rsa-encryption’s-security-protection-path-in-modern-web-applications","text":"The Double-Edged Sword of Keys: RSA Encryption’s Security Protection Path in Modern Web Applications","level":1},{"id":"mathematical-foundation-of-the-rsa-algorithm","text":"Mathematical Foundation of the RSA Algorithm","level":2},{"id":"the-mathematical-challenge-of-large-number-factorization","text":"The Mathematical Challenge of Large Number Factorization","level":3},{"id":"euler’s-totient-function-and-modular-arithmetic","text":"Euler’s Totient Function and Modular Arithmetic","level":3},{"id":"mathematical-process-of-public-private-key-generation","text":"Mathematical Process of Public-Private Key Generation","level":3},{"id":"detailed-explanation-of-the-extended-euclidean-algorithm","text":"Detailed Explanation of the Extended Euclidean Algorithm","level":3},{"id":"mathematical-principles-of-encryption-and-decryption","text":"Mathematical Principles of Encryption and Decryption","level":3},{"id":"rsa’s-role-positioning-in-web-security","text":"RSA’s Role Positioning in Web Security","level":2},{"id":"selection-strategy-symmetric-vs-asymmetric-encryption","text":"Selection Strategy: Symmetric vs Asymmetric Encryption","level":3},{"id":"security-of-rsa-oaep-padding-scheme","text":"Security of RSA-OAEP Padding Scheme","level":3},{"id":"questions-party-security-architecture-design","text":"Questions Party Security Architecture Design","level":3},{"id":"rsa-implementation-architecture-in-the-questions-party-project","text":"RSA Implementation Architecture in the Questions Party Project","level":2},{"id":"overall-security-architecture-design","text":"Overall Security Architecture Design","level":3},{"id":"encryption-strategy-in-frontend-backend-separation-architecture","text":"Encryption Strategy in Frontend-Backend Separation Architecture","level":3},{"id":"key-management-and-distribution-mechanism","text":"Key Management and Distribution Mechanism","level":3},{"id":"key-initialization-design","text":"Key Initialization Design","level":3},{"id":"encrypted-data-storage-strategy","text":"Encrypted Data Storage Strategy","level":3},{"id":"backend-rsa-key-management-and-encryption-service","text":"Backend RSA Key Management and Encryption Service","level":2},{"id":"singleton-pattern-design-of-rsacrypto-class","text":"Singleton Pattern Design of RSACrypto Class","level":3},{"id":"key-initialization-strategy","text":"Key Initialization Strategy","level":3},{"id":"nodejs-crypto-module’s-oaep-implementation","text":"Node.js Crypto Module’s OAEP Implementation","level":3},{"id":"deep-analysis-of-frontend-rsa-encryption-implementation","text":"Deep Analysis of Frontend RSA Encryption Implementation","level":2},{"id":"usage-of-web-crypto-api","text":"Usage of Web Crypto API","level":3},{"id":"processing-of-pem-format-keys","text":"Processing of PEM Format Keys","level":3},{"id":"arraybuffer-and-base64-conversion","text":"ArrayBuffer and Base64 Conversion","level":3},{"id":"complete-implementation-of-api-key-update-process","text":"Complete Implementation of API Key Update Process","level":2},{"id":"design-philosophy-of-updateapikey-interface","text":"Design Philosophy of updateApiKey Interface","level":3},{"id":"complete-flow-frontend-encryption-→-transmission-→-backend-decryption","text":"Complete Flow: Frontend Encryption → Transmission → Backend Decryption","level":3},{"id":"error-handling-and-user-experience-optimization","text":"Error Handling and User Experience Optimization","level":3},{"id":"data-storage-and-decryption-strategy","text":"Data Storage and Decryption Strategy","level":2},{"id":"database-storage-format-for-encrypted-data","text":"Database Storage Format for Encrypted Data","level":3},{"id":"rsa-prefix-identification-mechanism","text":"rsa: Prefix Identification Mechanism","level":3},{"id":"decryption-timing-selection-strategy","text":"Decryption Timing Selection Strategy","level":3},{"id":"lifecycle-management-of-plaintext-data-in-memory","text":"Lifecycle Management of Plaintext Data in Memory","level":3},{"id":"security-analysis-and-attack-prevention","text":"Security Analysis and Attack Prevention","level":2},{"id":"common-rsa-attack-methods-and-protection-measures","text":"Common RSA Attack Methods and Protection Measures","level":3},{"id":"padding-attack-principles-and-oaep-protection-mechanisms","text":"Padding Attack Principles and OAEP Protection Mechanisms","level":3},{"id":"complete-code-analysis","text":"Complete Code Analysis","level":2},{"id":"backend-rsa-key-management-core-implementation-srcutilsrsacryptojs","text":"Backend RSA Key Management Core Implementation (src/utils/rsaCrypto.js)","level":3},{"id":"frontend-rsa-encryption-core-implementation-srcutilsrsacryptots","text":"Frontend RSA Encryption Core Implementation (src/utils/rsaCrypto.ts)","level":3},{"id":"user-model-decryption-logic-core-implementation-srcmodelsuserjs","text":"User Model Decryption Logic Core Implementation (src/models/User.js)","level":3},{"id":"authentication-controller-key-management-core-implementation-srccontrollersauthcontrollerjs","text":"Authentication Controller Key Management Core Implementation (src/controllers/authController.js)","level":3},{"id":"complete-end-to-end-encryption-flow-tracking","text":"Complete End-to-End Encryption Flow Tracking","level":2},{"id":"complete-tracking-from-user-input-to-database-storage","text":"Complete Tracking from User Input to Database Storage","level":3},{"id":"data-state-changes-at-each-step","text":"Data State Changes at Each Step","level":3},{"id":"debugging-and-monitoring-best-practices","text":"Debugging and Monitoring Best Practices","level":3},{"id":"system-architecture-summary-and-best-practices","text":"System Architecture Summary and Best Practices","level":2},{"id":"complete-rsa-architecture-in-modern-web-applications","text":"Complete RSA Architecture in Modern Web Applications","level":3},{"id":"final-words","text":"Final Words","level":2}],"translations":{"common":{"welcome":"Welcome","loading":"Loading...","error":"Something went wrong","retry":"Try again","theme":"Theme","language":"Language","light":"Light","dark":"Dark"},"navigation":{"home":"Home","personal":"Personal","works":"Works","contributions":"Contributions","documents":"Documents","about":"About","contact":"Contact"},"personal":{"technicalSkills":"Technical Skills","email":"Email","github":"GitHub","resume":"Resume","codeRepository":"Code Repository","loadingPersonalInfo":"Loading personal information...","loadingResume":"Loading resume...","closeResume":"Close Resume","emailCopied":"Email copied to clipboard!","galaxyDefaultDescription":"Expert in full-stack development, cross-platform architecture, AI technology integration, and high-performance system optimization","skillGalaxy":"Skill Galaxy","stirGalaxy":"Stir Galaxy","stirring":"Stirring...","fullStackEngineer":"MilkWind - Full Stack Engineer","professionalProfile":"About Me"},"documents":{"technicalDocuments":"Technical Documents","description":"Basic principles, code splitting, and some random thoughts.","articles":"Articles","categories":"Categories","allCategories":"All Categories","noArticlesFound":"No articles found","noArticlesAvailable":"No articles available in English.","noArticlesInCategory":"No articles found in the category.","readMore":"Read more","loadingDocuments":"Loading documents...","backToDocuments":"← Back to Documents","documentNotFound":"Document Not Found","documentNotFoundDescription":"The requested document could not be found.","technicalInsights":"Insights","untitledDocument":"Untitled Document","byAuthor":"By","search":"Search articles...","searchByTags":"Filter by tags","searching":"Searching...","noSearchResults":"No articles match your search criteria","clearSearch":"Clear search","selectedTags":"Selected tags","allTags":"All tags","searchInTitle":"Search in titles, descriptions, and content","enterImmersiveMode":"Immersive Reading","exitImmersiveMode":"Exit Immersive Mode","immersiveReading":"Immersive Reading Mode","exploreContent":"Explore content by category","browseBy":"Browse by","exploreAll":"All content in one place","categoryDescription":"Articles in this category","totalArticles":"Articles","totalCategories":"Categories","foundArticles":"Found articles","categoriesWithResults":"Categories with results"},"works":{"workCases":"Work Cases","projects":"Portfolio","loadingProjects":"Loading projects...","grid":"Grid","stack":"Stack","of":"of","workCasesPageTitle":"Work Cases Page","pageWorkingCorrectly":"This page is working! The routing is correct.","try3DVersion":"Try 3D Version","dragToScroll":"Drag to scroll","dragToChange":"Drag to change","swipeCards":"Swipe cards","keyboardNav":"Keyboard navigation"},"contributions":{"contributionCases":"Open Source","contributions":"Contributions","loadingContributions":"Loading contributions...","grid":"Grid","stack":"Stack","of":"of","contributionCasesPageTitle":"Contribution Cases Page","pageWorkingCorrectly":"This page is working! The routing is correct.","try3DVersion":"Try 3D Version","dragToScroll":"Drag to scroll","dragToChange":"Drag to change","swipeCards":"Swipe cards","keyboardNav":"Keyboard navigation"},"contribution":{"contributionPreview":"Contribution Preview","accessible":"Accessible","code":"Code","maintenance":"Maintenance","enhancement":"Enhancement","documentation":"Documentation","community":"Community","moreItems":"more","technicalDetails":"Technical Details","technologies":"Technologies:","contributionDetail":"Contribution Detail","description":"Description:","seeDetails":"See Details","github":"GitHub","viewContribution":"View Contribution","viewCode":"View Code"},"project":{"projectPreview":"Project Preview","accessible":"Accessible","tool":"Tool","plugin":"Plugin","toy":"Toy","moreItems":"more","technicalDetails":"Technical Details","technologies":"Technologies:","description":"Description:","seeDetails":"See Details","github":"GitHub","gitee":"Gitee","viewLiveDemo":"View Live Demo","viewCode":"View Code","access":"Access","videos":"Videos","watchVideo":"Watch Video","hasVideo":"Has Video"},"codeblock":{"copy":"Copy","copySuccess":"Code copied to clipboard!","copyError":"Failed to copy code","copyTooltip":"Copy code"},"toc":{"contents":"Contents","autoScroll":"Auto-scroll to section","collapse":"Collapse","expand":"Expand"},"loading":{"loading":"LOADING","preparingExperience":"Preparing experience"}},"lang":"en","theme":"dark"}]
12:null
18:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
11:null
1c:{"metadata":[["$","title","0",{"children":"The Double-Edged Sword of Keys: RSA Encryption's Security Protection Path in Modern Web Applications | Interactive Portfolio"}],["$","meta","1",{"name":"description","content":"From Mathematical Principles to Engineering Practice—Analyzing End-to-End Encryption Implementation in Questions Party"}],["$","meta","2",{"name":"author","content":"Developer"}],["$","meta","3",{"name":"keywords","content":"portfolio,3D,interactive,web development,Three.js,Next.js"}],["$","meta","4",{"property":"og:title","content":"The Double-Edged Sword of Keys: RSA Encryption's Security Protection Path in Modern Web Applications | Interactive Portfolio"}],["$","meta","5",{"property":"og:description","content":"From Mathematical Principles to Engineering Practice—Analyzing End-to-End Encryption Implementation in Questions Party"}],["$","meta","6",{"property":"og:type","content":"article"}],["$","meta","7",{"property":"article:published_time","content":"2025-06-22"}],["$","meta","8",{"property":"article:tag","content":"RSA"}],["$","meta","9",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","10",{"name":"twitter:title","content":"The Double-Edged Sword of Keys: RSA Encryption's Security Protection Path in Modern Web Applications | Interactive Portfolio"}],["$","meta","11",{"name":"twitter:description","content":"From Mathematical Principles to Engineering Practice—Analyzing End-to-End Encryption Implementation in Questions Party"}],["$","link","12",{"rel":"icon","href":"/MilkWind-Website/favicon.ico","type":"image/x-icon","sizes":"32x32"}]],"error":null,"digest":"$undefined"}
14:{"metadata":"$1c:metadata","error":null,"digest":"$undefined"}
