1:"$Sreact.fragment"
2:I[38735,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"default"]
3:I[19945,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"default"]
4:I[65337,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"default"]
5:I[96190,["46","static/chunks/46-268e24d727b280ef.js","7177","static/chunks/app/layout-af4a6e723c0ff668.js"],"ClientProviders"]
6:I[87555,[],""]
7:I[51901,["8039","static/chunks/app/error-dda32be1d095a86c.js"],"default"]
8:I[31295,[],""]
9:I[6874,["6874","static/chunks/6874-fbe9a08eb79b991c.js","4345","static/chunks/app/not-found-9ff98b2ccf24cac7.js"],""]
a:I[94970,[],"ClientSegmentRoot"]
b:I[44065,["206","static/chunks/206-4f4cbf4d7156f437.js","3092","static/chunks/app/documents/layout-28408791defde09e.js"],"default"]
e:I[59665,[],"MetadataBoundary"]
10:I[59665,[],"OutletBoundary"]
13:I[74911,[],"AsyncMetadataOutlet"]
15:I[39460,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","5650","static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js"],"default"]
16:I[88610,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","4209","static/chunks/app/loading-68f227fb49b3ac8c.js"],"default"]
17:I[59665,[],"ViewportBoundary"]
19:I[26614,[],""]
:HL["/MilkWind-Website/_next/static/css/f034c804622acb16.css","style"]
:HL["/MilkWind-Website/_next/static/css/276b387d8ca46690.css","style"]
:HL["/MilkWind-Website/_next/static/css/5eacd01f773eed7f.css","style"]
0:{"P":null,"b":"VfIBorA4Pr-iS5Xp1a-dx","p":"/MilkWind-Website","c":["","documents","zh","light","plugins","remarkable-katex-plus",""],"i":false,"f":[[["",{"children":["documents",{"children":[["slug","zh/light/plugins/remarkable-katex-plus","c"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/f034c804622acb16.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/276b387d8ca46690.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_9b7fb1 __variable_ca2a15 __variable_591dcc font-sans antialiased min-h-screen bg-background text-foreground","suppressHydrationWarning":true,"children":[["$","$L2",null,{}],["$","$L3",null,{}],["$","$L4",null,{}],["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$7","errorStyles":[],"errorScripts":[],"template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"z-10 relative min-h-screen flex items-center justify-center bg-background p-8","children":["$","div",null,{"className":"text-center max-w-md","children":[["$","div",null,{"className":"text-8xl font-bold text-primary mb-4","children":"404"}],["$","h2",null,{"className":"text-2xl font-bold text-foreground mb-4","children":"Page Not Found"}],["$","p",null,{"className":"text-foreground/70 mb-8","children":"The page you're looking for doesn't exist or has been moved to a different location."}],["$","div",null,{"className":"flex flex-col sm:flex-row gap-4 justify-center","children":[["$","$L9",null,{"href":"/","className":"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors","children":"Go Home"}],["$","$L9",null,{"href":"/works","className":"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors","children":"View Works"}]]}],["$","div",null,{"className":"absolute inset-0 overflow-hidden pointer-events-none -z-10","children":[["$","div",null,{"className":"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float"}],["$","div",null,{"className":"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float","style":{"animationDelay":"1s"}}],["$","div",null,{"className":"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float","style":{"animationDelay":"2s"}}]]}]]}]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]}]]}],{"children":["documents",["$","$1","c",{"children":[null,["$","$La",null,{"Component":"$b","slots":{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@c"}]]}],{"children":[["slug","zh/light/plugins/remarkable-katex-plus","c"],["$","$1","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$Ld",["$","$Le",null,{"children":"$Lf"}],[["$","link","0",{"rel":"stylesheet","href":"/MilkWind-Website/_next/static/css/5eacd01f773eed7f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L10",null,{"children":["$L11","$L12",["$","$L13",null,{"promise":"$@14"}]]}]]}],{},null,false]},null,false]},[["$","$L15","l",{}],[],[]],false]},[["$","$L16","l",{}],[],[]],false],["$","$1","h",{"children":[null,["$","$1","LKEhrzeR8IpUtY5q5tk4c",{"children":[["$","$L17",null,{"children":"$L18"}],null]}],null]}],false]],"m":"$undefined","G":["$19","$undefined"],"s":false,"S":true}
1a:"$Sreact.suspense"
1b:I[74911,[],"AsyncMetadata"]
c:{}
f:["$","$1a",null,{"fallback":null,"children":["$","$L1b",null,{"promise":"$@1c"}]}]
1d:I[57340,["5584","static/chunks/b498d07c-095637f0f10883c6.js","2415","static/chunks/2415-689c103fb3d2c28d.js","6874","static/chunks/6874-fbe9a08eb79b991c.js","9554","static/chunks/9554-b714f9de28e85d30.js","1873","static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js"],"DocumentPageClient"]
1e:T509ac,<h1 id="remarkable-katex-plus-插件代码解析" class="group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight">
            <a href="#remarkable-katex-plus-插件代码解析" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Remarkable KaTeX Plus 插件代码解析">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Remarkable KaTeX Plus 插件代码解析
        </h1>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">插件版本：v1.1.2</strong></p>
<p class="text-base leading-7 mb-4 text-foreground">本篇文章将会对 <code>remarkable-katex-plus</code> 插件代码进行逐行解析，包括主要的插件文件 <code>index.js</code> 和测试文件 <code>index.test.js</code>。本解析不仅解释每行代码的作用，还详细说明所有非JavaScript标准库函数的用法和原理。</p>
<h2 id="概览" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#概览" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 概览">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            概览
        </h2>
<p class="text-base leading-7 mb-4 text-foreground"><code>remarkable-katex-plus</code> 是一个用于 Remarkable Markdown 处理器的插件，它能够将 <code>$...$</code> 和 <code>$$..$$</code> 序列转换为使用 KaTeX 包渲染的数学公式 HTML。</p>
<h2 id="依赖库函数说明" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#依赖库函数说明" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 依赖库函数说明">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            依赖库函数说明
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">在深入代码解析之前，先了解本插件使用的主要非标准库函数：</p>
<h3 id="nodejs-相关函数" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#nodejs-相关函数" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Node.js 相关函数">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Node.js 相关函数
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require(moduleName)</code></strong>: Node.js模块加载函数，用于导入外部模块或库
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>moduleName</code> (string): 模块名称或路径字符串</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 导入的模块对象或函数</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%AF%BC%E5%85%A5%E5%A4%96%E9%83%A8npm%E5%8C%85%0Aconst%20katex%20%3D%20require('katex')%3B%0A%2F%2F%20%E5%AF%BC%E5%85%A5%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%A8%A1%E5%9D%97%0Aconst%20plugin%20%3D%20require('.%2Findex.js')%3B%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E8%A7%A3%E6%9E%84%E8%AF%AD%E6%B3%95%E5%AF%BC%E5%85%A5%E7%89%B9%E5%AE%9A%E5%AF%BC%E5%87%BA%0Aconst%20%7B%20Remarkable%20%7D%20%3D%20require('remarkable')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 导入外部npm包</span>
<span class="hljs-keyword inline">const</span> katex = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;katex&#x27;</span>);

<span class="hljs-comment inline">// 导入本地文件模块</span>
<span class="hljs-keyword inline">const</span> plugin = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;./index.js&#x27;</span>);

<span class="hljs-comment inline">// 使用解构语法导入特定导出</span>
<span class="hljs-keyword inline">const</span> { <span class="hljs-title class_ inline">Remarkable</span> } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;remarkable&#x27;</span>);
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>module.exports</code></strong>: Node.js模块导出对象，用于向外部提供模块功能
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>: 无（这是一个属性，不是函数）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 无</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%AF%BC%E5%87%BA%E5%8D%95%E4%B8%AA%E5%87%BD%E6%95%B0%0Amodule.exports%20%3D%20rkatex%3B%0A%2F%2F%20%E5%AF%BC%E5%87%BA%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E5%87%BD%E6%95%B0%E7%9A%84%E5%AF%B9%E8%B1%A1%0Amodule.exports%20%3D%20%7B%20renderKatex%2C%20parseInlineKatex%20%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 导出单个函数</span>
<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = rkatex;

<span class="hljs-comment inline">// 导出包含多个函数的对象</span>
<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = { renderKatex, parseInlineKatex };
</code></pre>
            </div>
        </li>
</ul></li>
</ul>
<h3 id="katex-库函数" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#katex-库函数" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to KaTeX 库函数">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            KaTeX 库函数
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>katex.renderToString(expression, options)</code></strong>: KaTeX核心渲染函数
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>expression</code> (string): 要渲染的LaTeX数学表达式字符串</li>
<li class="text-foreground leading-relaxed"><code>options</code> (Object): 渲染选项对象，包含以下可选配置：
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>displayMode</code> (boolean): 是否使用块级显示模式，默认false</li>
<li class="text-foreground leading-relaxed"><code>throwOnError</code> (boolean): 遇到错误是否抛出异常，默认true</li>
<li class="text-foreground leading-relaxed"><code>errorColor</code> (string): 错误文本颜色，默认’#cc0000’</li>
<li class="text-foreground leading-relaxed"><code>macros</code> (Object): 自定义宏定义</li>
<li class="text-foreground leading-relaxed"><code>strict</code> (boolean): 是否使用严格模式，默认true</li>
</ul></li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 渲染后的HTML字符串</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%86%85%E8%81%94%E6%A8%A1%E5%BC%8F%E6%B8%B2%E6%9F%93%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F%0Aconst%20inlineHtml%20%3D%20katex.renderToString('x%5E2%20%2B%20y%5E2%20%3D%20z%5E2'%2C%20%7B%0AdisplayMode%3A%20false%2C%20%20%20%20%2F%2F%20%E5%86%85%E8%81%94%E6%A8%A1%E5%BC%8F%0AthrowOnError%3A%20false%20%20%20%20%2F%2F%20%E9%81%87%E5%88%B0%E9%94%99%E8%AF%AF%E4%B8%8D%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%0A%7D)%3B%0A%2F%2F%20%E5%9D%97%E7%BA%A7%E6%A8%A1%E5%BC%8F%E6%B8%B2%E6%9F%93%E5%88%86%E6%95%B0%E5%85%AC%E5%BC%8F%0Aconst%20blockHtml%20%3D%20katex.renderToString('%5C%5Cfrac%7Ba%7D%7Bb%7D'%2C%20%7B%0AdisplayMode%3A%20true%2C%20%20%20%20%20%2F%2F%20%E5%9D%97%E7%BA%A7%E6%98%BE%E7%A4%BA%E6%A8%A1%E5%BC%8F%0AthrowOnError%3A%20false%2C%20%20%20%2F%2F%20%E9%81%87%E5%88%B0%E9%94%99%E8%AF%AF%E4%B8%8D%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%0AerrorColor%3A%20'%23ff0000'%20%20%2F%2F%20%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E9%A2%9C%E8%89%B2%E4%B8%BA%E7%BA%A2%E8%89%B2%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 内联模式渲染数学公式</span>
<span class="hljs-keyword inline">const</span> inlineHtml = katex.<span class="hljs-title function_ inline">renderToString</span>(<span class="hljs-string inline">&#x27;x^2 + y^2 = z^2&#x27;</span>, {
  <span class="hljs-attr inline">displayMode</span>: <span class="hljs-literal inline">false</span>,    <span class="hljs-comment inline">// 内联模式</span>
  <span class="hljs-attr inline">throwOnError</span>: <span class="hljs-literal inline">false</span>    <span class="hljs-comment inline">// 遇到错误不抛出异常</span>
});

<span class="hljs-comment inline">// 块级模式渲染分数公式</span>
<span class="hljs-keyword inline">const</span> blockHtml = katex.<span class="hljs-title function_ inline">renderToString</span>(<span class="hljs-string inline">&#x27;\\frac{a}{b}&#x27;</span>, {
  <span class="hljs-attr inline">displayMode</span>: <span class="hljs-literal inline">true</span>,     <span class="hljs-comment inline">// 块级显示模式</span>
  <span class="hljs-attr inline">throwOnError</span>: <span class="hljs-literal inline">false</span>,   <span class="hljs-comment inline">// 遇到错误不抛出异常</span>
  <span class="hljs-attr inline">errorColor</span>: <span class="hljs-string inline">&#x27;#ff0000&#x27;</span>  <span class="hljs-comment inline">// 自定义错误颜色为红色</span>
});
</code></pre>
            </div>
        </li>
</ul></li>
</ul>
<h3 id="remarkable-解析器状态对象属性" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#remarkable-解析器状态对象属性" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Remarkable 解析器状态对象属性">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Remarkable 解析器状态对象属性
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.bMarks[line]</code></strong>: 每行开始位置的标记数组（begin marks）
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: Array<number></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 存储每行文本开始位置的字符索引（不包含前导空格）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E7%AC%AC%E4%B8%80%E8%A1%8C%E7%9A%84%E5%BC%80%E5%A7%8B%E4%BD%8D%E7%BD%AE%E7%B4%A2%E5%BC%95%0Aconst%20lineStart%20%3D%20state.bMarks%5B0%5D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取第一行的开始位置索引</span>
<span class="hljs-keyword inline">const</span> lineStart = state.<span class="hljs-property inline">bMarks</span>[<span class="hljs-number inline">0</span>];
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.tShift[line]</code></strong>: 每行前导空格数组（tab shift）
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: Array<number></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 存储每行的缩进量（空格和制表符的数量）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E7%AC%AC%E4%B8%80%E8%A1%8C%E7%9A%84%E7%BC%A9%E8%BF%9B%E9%87%8F%EF%BC%88%E7%A9%BA%E6%A0%BC%E6%95%B0%EF%BC%89%0Aconst%20indent%20%3D%20state.tShift%5B0%5D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取第一行的缩进量（空格数）</span>
<span class="hljs-keyword inline">const</span> indent = state.<span class="hljs-property inline">tShift</span>[<span class="hljs-number inline">0</span>];
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.eMarks[line]</code></strong>: 每行结束位置的标记数组（end marks）
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: Array<number></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 存储每行文本结束位置的字符索引</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E7%AC%AC%E4%B8%80%E8%A1%8C%E7%9A%84%E7%BB%93%E6%9D%9F%E4%BD%8D%E7%BD%AE%E7%B4%A2%E5%BC%95%0Aconst%20lineEnd%20%3D%20state.eMarks%5B0%5D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取第一行的结束位置索引</span>
<span class="hljs-keyword inline">const</span> lineEnd = state.<span class="hljs-property inline">eMarks</span>[<span class="hljs-number inline">0</span>];
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.src</code></strong>: 完整的源文本字符串
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: string</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 包含整个待解析的Markdown文本</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E4%BD%8D%E7%BD%AE%E7%9A%84%E5%AD%97%E7%AC%A6%0Aconst%20char%20%3D%20state.src.charAt(pos)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取指定位置的字符</span>
<span class="hljs-keyword inline">const</span> char = state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos);
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.pos</code></strong>: 当前解析位置
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: number</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 当前解析器在源文本中的位置索引</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E8%A7%A3%E6%9E%90%E4%BD%8D%E7%BD%AE%0Astate.pos%20%3D%20newPos%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 更新当前解析位置</span>
state.<span class="hljs-property inline">pos</span> = newPos;
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.posMax</code></strong>: 最大解析位置
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: number</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 解析器能够处理的最大位置索引</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%88%B0%E8%BE%BE%E8%A7%A3%E6%9E%90%E6%9C%AB%E5%B0%BE%0Aif%20(state.pos%20%3E%3D%20state.posMax)%20%7B%0Areturn%20false%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 检查是否到达解析末尾</span>
<span class="hljs-keyword inline">if</span> (state.<span class="hljs-property inline">pos</span> &gt;= state.<span class="hljs-property inline">posMax</span>) { 
  <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; 
}
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.level</code></strong>: 当前嵌套级别
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: number</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 当前解析元素的嵌套深度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E5%85%83%E7%B4%A0%E7%9A%84%E5%B5%8C%E5%A5%97%E7%BA%A7%E5%88%AB%0Aconst%20tokenLevel%20%3D%20state.level%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取当前元素的嵌套级别</span>
<span class="hljs-keyword inline">const</span> tokenLevel = state.<span class="hljs-property inline">level</span>;
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.line</code></strong>: 当前行号
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: number</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 当前解析器处理的行号（从0开始）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E5%A4%84%E7%90%86%E7%9A%84%E8%A1%8C%E5%8F%B7%0Astate.line%20%3D%20nextLine%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 更新当前处理的行号</span>
state.<span class="hljs-property inline">line</span> = nextLine;
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.blkIndent</code></strong>: 块级元素缩进量
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">类型</strong>: number</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">说明</strong>: 当前块级元素的缩进量</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E5%9D%97%E7%BA%A7%E5%85%83%E7%B4%A0%E7%9A%84%E7%BC%A9%E8%BF%9B%E9%87%8F%0Aconst%20blockIndent%20%3D%20state.blkIndent%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取当前块级元素的缩进量</span>
<span class="hljs-keyword inline">const</span> blockIndent = state.<span class="hljs-property inline">blkIndent</span>;
</code></pre>
            </div>
        </li>
</ul></li>
</ul>
<h3 id="remarkable-解析器状态方法" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#remarkable-解析器状态方法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Remarkable 解析器状态方法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Remarkable 解析器状态方法
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.skipChars(pos, char)</code></strong>: 从指定位置跳过连续的相同字符
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>pos</code> (number): 起始位置索引</li>
<li class="text-foreground leading-relaxed"><code>char</code> (string): 要跳过的字符</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: (number) 跳过连续字符后的新位置索引</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E4%BB%8E%E4%BD%8D%E7%BD%AE0%E5%BC%80%E5%A7%8B%E8%B7%B3%E8%BF%87%E8%BF%9E%E7%BB%AD%E7%9A%84%24%E5%AD%97%E7%AC%A6%0Aconst%20pos%20%3D%20state.skipChars(0%2C%20'%24')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 从位置0开始跳过连续的$字符</span>
<span class="hljs-keyword inline">const</span> pos = state.<span class="hljs-title function_ inline">skipChars</span>(<span class="hljs-number inline">0</span>, <span class="hljs-string inline">&#x27;$&#x27;</span>);
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.skipSpaces(pos)</code></strong>: 从指定位置跳过空格字符
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>pos</code> (number): 起始位置索引</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: (number) 跳过空格和制表符后的位置索引</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%B7%B3%E8%BF%87%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%E7%9A%84%E7%A9%BA%E6%A0%BC%E5%92%8C%E5%88%B6%E8%A1%A8%E7%AC%A6%0Aconst%20newPos%20%3D%20state.skipSpaces(pos)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 跳过当前位置的空格和制表符</span>
<span class="hljs-keyword inline">const</span> newPos = state.<span class="hljs-title function_ inline">skipSpaces</span>(pos);
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.getLines(startLine, endLine, indent, keepLastLF)</code></strong>: 获取指定行范围的文本
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>startLine</code> (number): 起始行号（包含）</li>
<li class="text-foreground leading-relaxed"><code>endLine</code> (number): 结束行号（不包含）</li>
<li class="text-foreground leading-relaxed"><code>indent</code> (number): 要移除的缩进量</li>
<li class="text-foreground leading-relaxed"><code>keepLastLF</code> (boolean): 是否保留最后的换行符</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: (string) 提取的文本字符串</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96%E7%AC%AC1-4%E8%A1%8C%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E6%97%A0%E7%BC%A9%E8%BF%9B%E7%A7%BB%E9%99%A4%EF%BC%8C%E4%BF%9D%E7%95%99%E6%8D%A2%E8%A1%8C%E7%AC%A6%0Aconst%20content%20%3D%20state.getLines(1%2C%205%2C%200%2C%20true)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取第1-4行的内容，无缩进移除，保留换行符</span>
<span class="hljs-keyword inline">const</span> content = state.<span class="hljs-title function_ inline">getLines</span>(<span class="hljs-number inline">1</span>, <span class="hljs-number inline">5</span>, <span class="hljs-number inline">0</span>, <span class="hljs-literal inline">true</span>);
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.push(token)</code></strong>: 向tokens数组添加新的token对象
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>token</code> (Object): 要添加的token对象</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 无</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%B7%BB%E5%8A%A0%E5%86%85%E8%81%94%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8Ftoken%0Astate.push(%7B%0Atype%3A%20'katex'%2C%20%20%20%20%20%20%20%20%20%20%2F%2F%20token%E7%B1%BB%E5%9E%8B%0Acontent%3A%20'x%5E2'%2C%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%95%B0%E5%AD%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%86%85%E5%AE%B9%0Ablock%3A%20false%2C%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%86%85%E8%81%94%E6%A8%A1%E5%BC%8F%0Alevel%3A%20state.level%20%20%20%20%20%20%2F%2F%20%E5%BD%93%E5%89%8D%E5%B5%8C%E5%A5%97%E7%BA%A7%E5%88%AB%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 添加内联数学公式token</span>
state.<span class="hljs-title function_ inline">push</span>({ 
  <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;katex&#x27;</span>,          <span class="hljs-comment inline">// token类型</span>
  <span class="hljs-attr inline">content</span>: <span class="hljs-string inline">&#x27;x^2&#x27;</span>,         <span class="hljs-comment inline">// 数学表达式内容</span>
  <span class="hljs-attr inline">block</span>: <span class="hljs-literal inline">false</span>,           <span class="hljs-comment inline">// 内联模式</span>
  <span class="hljs-attr inline">level</span>: state.<span class="hljs-property inline">level</span>      <span class="hljs-comment inline">// 当前嵌套级别</span>
});
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.tokens.push(token)</code></strong>: 直接向tokens数组添加token
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>token</code> (Object): 要添加的token对象</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: (number) 数组新的长度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E7%9B%B4%E6%8E%A5%E5%90%91tokens%E6%95%B0%E7%BB%84%E6%B7%BB%E5%8A%A0%E5%9D%97%E7%BA%A7%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8Ftoken%0Astate.tokens.push(%7B%0Atype%3A%20'katex'%2C%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20token%E7%B1%BB%E5%9E%8B%0Acontent%3A%20'%5C%5Cfrac%7Ba%7D%7Bb%7D'%2C%20%20%2F%2F%20LaTeX%E5%88%86%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F%0Ablock%3A%20true%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%9D%97%E7%BA%A7%E6%A8%A1%E5%BC%8F%0Alevel%3A%20state.level%20%20%20%20%20%20%20%20%2F%2F%20%E5%BD%93%E5%89%8D%E5%B5%8C%E5%A5%97%E7%BA%A7%E5%88%AB%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 直接向tokens数组添加块级数学公式token</span>
state.<span class="hljs-property inline">tokens</span>.<span class="hljs-title function_ inline">push</span>({
  <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;katex&#x27;</span>,            <span class="hljs-comment inline">// token类型</span>
  <span class="hljs-attr inline">content</span>: <span class="hljs-string inline">&#x27;\\frac{a}{b}&#x27;</span>,  <span class="hljs-comment inline">// LaTeX分数表达式</span>
  <span class="hljs-attr inline">block</span>: <span class="hljs-literal inline">true</span>,              <span class="hljs-comment inline">// 块级模式</span>
  <span class="hljs-attr inline">level</span>: state.<span class="hljs-property inline">level</span>        <span class="hljs-comment inline">// 当前嵌套级别</span>
});
</code></pre>
            </div>
        </li>
</ul></li>
</ul>
<h3 id="remarkable-插件api" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#remarkable-插件api" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Remarkable 插件API">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Remarkable 插件API
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.inline.ruler.push(name, fn, options)</code></strong>: 注册内联解析规则
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>name</code> (string): 规则名称，用于标识解析规则</li>
<li class="text-foreground leading-relaxed"><code>fn</code> (function): 解析函数，接收state和silent参数</li>
<li class="text-foreground leading-relaxed"><code>options</code> (Object): 解析选项（可选）</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 无</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%B3%A8%E5%86%8C%E5%86%85%E8%81%94KaTeX%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99%0Amd.inline.ruler.push('katex'%2C%20parseInlineKatex%2C%20%7B%0Aalt%3A%20%5B'paragraph'%2C%20'text'%5D%20%20%2F%2F%20%E5%8F%AF%E9%80%89%E7%9A%84%E6%9B%BF%E4%BB%A3%E8%A7%84%E5%88%99%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 注册内联KaTeX解析规则</span>
md.<span class="hljs-property inline">inline</span>.<span class="hljs-property inline">ruler</span>.<span class="hljs-title function_ inline">push</span>(<span class="hljs-string inline">&#x27;katex&#x27;</span>, parseInlineKatex, {
  <span class="hljs-attr inline">alt</span>: [<span class="hljs-string inline">&#x27;paragraph&#x27;</span>, <span class="hljs-string inline">&#x27;text&#x27;</span>]  <span class="hljs-comment inline">// 可选的替代规则</span>
});
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.block.ruler.push(name, fn, options)</code></strong>: 注册块级解析规则
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>name</code> (string): 规则名称，用于标识解析规则</li>
<li class="text-foreground leading-relaxed"><code>fn</code> (function): 解析函数，接收state、startLine和endLine参数</li>
<li class="text-foreground leading-relaxed"><code>options</code> (Object): 解析选项（可选）</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 无</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%B3%A8%E5%86%8C%E5%9D%97%E7%BA%A7KaTeX%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99%0Amd.block.ruler.push('katex'%2C%20parseBlockKatex%2C%20%7B%0Aalt%3A%20%5B'paragraph'%2C%20'blockquote'%5D%20%20%2F%2F%20%E5%8F%AF%E9%80%89%E7%9A%84%E6%9B%BF%E4%BB%A3%E8%A7%84%E5%88%99%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 注册块级KaTeX解析规则</span>
md.<span class="hljs-property inline">block</span>.<span class="hljs-property inline">ruler</span>.<span class="hljs-title function_ inline">push</span>(<span class="hljs-string inline">&#x27;katex&#x27;</span>, parseBlockKatex, {
  <span class="hljs-attr inline">alt</span>: [<span class="hljs-string inline">&#x27;paragraph&#x27;</span>, <span class="hljs-string inline">&#x27;blockquote&#x27;</span>]  <span class="hljs-comment inline">// 可选的替代规则</span>
});
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.renderer.rules[name]</code></strong>: 渲染规则对象，用于定义如何将token转换为HTML
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>name</code> (string): token类型名称</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 渲染函数</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%AE%9A%E4%B9%89KaTeX%20token%E7%9A%84%E6%B8%B2%E6%9F%93%E8%A7%84%E5%88%99%0Amd.renderer.rules.katex%20%3D%20function(tokens%2C%20idx)%20%7B%0Aconst%20token%20%3D%20tokens%5Bidx%5D%3B%20%20%2F%2F%20%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8Dtoken%0A%2F%2F%20%E8%B0%83%E7%94%A8KaTeX%E6%B8%B2%E6%9F%93%E5%87%BD%E6%95%B0%0Areturn%20renderKatex(token.content%2C%20token.block)%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 定义KaTeX token的渲染规则</span>
md.<span class="hljs-property inline">renderer</span>.<span class="hljs-property inline">rules</span>.<span class="hljs-property inline">katex</span> = <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">tokens, idx</span>) {
  <span class="hljs-keyword inline">const</span> token = tokens[idx];  <span class="hljs-comment inline">// 获取当前token</span>
  <span class="hljs-comment inline">// 调用KaTeX渲染函数</span>
  <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">renderKatex</span>(token.<span class="hljs-property inline">content</span>, token.<span class="hljs-property inline">block</span>);
};
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.use(plugin, options)</code></strong>: 使用插件
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>plugin</code> (function): 插件函数</li>
<li class="text-foreground leading-relaxed"><code>options</code> (Object): 插件选项（可选）</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: Remarkable实例（支持链式调用）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%88%9B%E5%BB%BARemarkable%E5%AE%9E%E4%BE%8B%E5%B9%B6%E4%BD%BF%E7%94%A8KaTeX%E6%8F%92%E4%BB%B6%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(katexPlugin%2C%20%7B%0Adelimiter%3A%20'%24'%2C%20%20%20%20%20%20%20%20%20%2F%2F%20%E4%BD%BF%E7%94%A8%24%E4%BD%9C%E4%B8%BA%E5%88%86%E9%9A%94%E7%AC%A6%0AthrowOnError%3A%20false%20%20%20%20%20%2F%2F%20%E9%81%87%E5%88%B0%E9%94%99%E8%AF%AF%E4%B8%8D%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 创建Remarkable实例并使用KaTeX插件</span>
<span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
md.<span class="hljs-title function_ inline">use</span>(katexPlugin, { 
  <span class="hljs-attr inline">delimiter</span>: <span class="hljs-string inline">&#x27;$&#x27;</span>,         <span class="hljs-comment inline">// 使用$作为分隔符</span>
  <span class="hljs-attr inline">throwOnError</span>: <span class="hljs-literal inline">false</span>     <span class="hljs-comment inline">// 遇到错误不抛出异常</span>
});
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.render(markdown)</code></strong>: 将Markdown文本渲染为HTML
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>markdown</code> (string): 待渲染的Markdown文本</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: (string) 渲染后的HTML字符串</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%B8%B2%E6%9F%93%E5%8C%85%E5%90%AB%E5%86%85%E8%81%94%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F%E7%9A%84Markdown%E6%96%87%E6%9C%AC%0Aconst%20html%20%3D%20md.render('This%20is%20%24x%5E2%24%20inline%20math.')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 渲染包含内联数学公式的Markdown文本</span>
<span class="hljs-keyword inline">const</span> html = md.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;This is $x^2$ inline math.&#x27;</span>);
</code></pre>
            </div>
        </li>
</ul></li>
</ul>
<h3 id="测试框架函数" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#测试框架函数" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 测试框架函数">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            测试框架函数
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>vows.describe(name)</code></strong>: 创建测试套件
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>name</code> (string): 测试套件名称</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 测试套件对象</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%88%9B%E5%BB%BA%E5%90%8D%E4%B8%BA'KatexPlugin'%E7%9A%84%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%0Avows.describe('KatexPlugin').addBatch(%7B%0A'Test%20case%201'%3A%20%7B%0Atopic%3A%20function()%20%7B%20%2F*%20%E5%87%86%E5%A4%87%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%20*%2F%20%7D%2C%0A'should%20work'%3A%20function(topic)%20%7B%20%2F*%20%E9%AA%8C%E8%AF%81%E7%BB%93%E6%9E%9C%20*%2F%20%7D%0A%7D%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 创建名为&#x27;KatexPlugin&#x27;的测试套件</span>
vows.<span class="hljs-title function_ inline">describe</span>(<span class="hljs-string inline">&#x27;KatexPlugin&#x27;</span>).<span class="hljs-title function_ inline">addBatch</span>({
  <span class="hljs-string inline">&#x27;Test case 1&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline"></span>) { <span class="hljs-comment inline">/* 准备测试数据 */</span> },
    <span class="hljs-string inline">&#x27;should work&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) { <span class="hljs-comment inline">/* 验证结果 */</span> }
  }
});
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>addBatch(tests)</code></strong>: 添加测试批次
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">形参</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>tests</code> (Object): 测试用例对象</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">返回值</strong>: 测试套件对象（支持链式调用）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%90%91%E6%B5%8B%E8%AF%95%E5%A5%97%E4%BB%B6%E6%B7%BB%E5%8A%A0%E6%B5%8B%E8%AF%95%E6%89%B9%E6%AC%A1%0Asuite.addBatch(%7B%0A'Basic%20functionality'%3A%20%7B%0Atopic%3A%20'test%20data'%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%B5%8B%E8%AF%95%E4%B8%BB%E9%A2%98%E6%95%B0%E6%8D%AE%0A'should%20pass'%3A%20function(topic)%20%7B%20%20%20%20%20%20%20%2F%2F%20%E6%96%AD%E8%A8%80%E6%B5%8B%E8%AF%95%0Aassert.equal(topic%2C%20'test%20data')%3B%20%20%20%2F%2F%20%E9%AA%8C%E8%AF%81%E7%9B%B8%E7%AD%89%E6%80%A7%0A%7D%0A%7D%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 向测试套件添加测试批次</span>
suite.<span class="hljs-title function_ inline">addBatch</span>({
  <span class="hljs-string inline">&#x27;Basic functionality&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: <span class="hljs-string inline">&#x27;test data&#x27;</span>,                    <span class="hljs-comment inline">// 测试主题数据</span>
    <span class="hljs-string inline">&#x27;should pass&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {       <span class="hljs-comment inline">// 断言测试</span>
      assert.<span class="hljs-title function_ inline">equal</span>(topic, <span class="hljs-string inline">&#x27;test data&#x27;</span>);   <span class="hljs-comment inline">// 验证相等性</span>
    }
  }
});
</code></pre>
            </div>
        </li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>assert.*</code></strong>: Node.js断言库的各种断言方法
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">常用方法</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>assert.equal(actual, expected)</code>: 严格相等比较</li>
<li class="text-foreground leading-relaxed"><code>assert.isTrue(value)</code>: 检查值是否为真</li>
<li class="text-foreground leading-relaxed"><code>assert.notEqual(actual, unexpected)</code>: 检查值不相等</li>
<li class="text-foreground leading-relaxed"><code>assert.throws(fn)</code>: 检查函数是否抛出异常</li>
<li class="text-foreground leading-relaxed"><code>assert.isObject(value)</code>: 检查是否为对象</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">使用示例</strong>:

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E9%AA%8C%E8%AF%81%E7%BB%93%E6%9E%9C%E4%B8%8E%E6%9C%9F%E6%9C%9B%E5%80%BC%E7%9B%B8%E7%AD%89%0Aassert.equal(result%2C%20'test')%3B%0A%2F%2F%20%E9%AA%8C%E8%AF%81HTML%E5%8C%85%E5%90%ABKaTeX%E5%85%83%E7%B4%A0%0Aassert.isTrue(html.includes(''))%3B%0A%2F%2F%20%E9%AA%8C%E8%AF%81%E5%87%BD%E6%95%B0%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%0Aassert.throws(function()%20%7B%20throw%20new%20Error()%3B%20%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 验证结果与期望值相等</span>
assert.<span class="hljs-title function_ inline">equal</span>(result, <span class="hljs-string inline">&#x27;&lt;p&gt;test&lt;/p&gt;&#x27;</span>);

<span class="hljs-comment inline">// 验证HTML包含KaTeX元素</span>
assert.<span class="hljs-title function_ inline">isTrue</span>(html.<span class="hljs-title function_ inline">includes</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex&quot;&gt;&#x27;</span>));

<span class="hljs-comment inline">// 验证函数抛出异常</span>
assert.<span class="hljs-title function_ inline">throws</span>(<span class="hljs-keyword inline">function</span>(<span class="hljs-params inline"></span>) { <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(); });
</code></pre>
            </div>
        </li>
</ul></li>
</ul>
<hr class="border-0 h-px bg-gray-300 my-8">
<h2 id="indexjs-代码逐行解析" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#indexjs-代码逐行解析" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to index.js 代码逐行解析">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            index.js 代码逐行解析
        </h2>
<h3 id="文件开头和模块声明" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#文件开头和模块声明" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 文件开头和模块声明">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            文件开头和模块声明
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%22use%20strict%22%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-meta inline">&quot;use strict&quot;</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第1行</strong>: 使用严格模式，确保代码在严格的 JavaScript 环境中运行，有助于捕获常见的编程错误。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F**%0A*%20Plugin%20for%20Remarkable%20Markdown%20processor%20which%20transforms%20%24..%24%20and%20%24%24..%24%24%20sequences%20into%20math%20HTML%20using%20the%0A*%20Katex%20package.%0A*%2F">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">/**
 * Plugin for Remarkable Markdown processor which transforms $..$ and $$..$$ sequences into math HTML using the
 * Katex package.
 */</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第3-6行</strong>: JSDoc 注释，描述了这个插件的作用：为 Remarkable Markdown 处理器提供插件，将数学公式标记转换为 KaTeX 渲染的 HTML。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20rkatex%20%3D%20(md%2C%20options)%20%3D%3E%20%7B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">rkatex</span> = (<span class="hljs-params inline">md, options</span>) =&gt; {
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第7行</strong>: 定义主函数 <code>rkatex</code>，接受两个参数：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>md</code>: Remarkable 实例</li>
<li class="text-foreground leading-relaxed"><code>options</code>: 配置选项对象</li>
</ul>
<h3 id="基础配置和变量声明" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#基础配置和变量声明" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 基础配置和变量声明">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            基础配置和变量声明
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20backslash%20%3D%20'%5C%5C'%3B%0Aconst%20dollar%20%3D%20'%24'%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-keyword inline">const</span> backslash = <span class="hljs-string inline">&#x27;\\&#x27;</span>;
  <span class="hljs-keyword inline">const</span> dollar = <span class="hljs-string inline">&#x27;$&#x27;</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第8-9行</strong>: 定义常量字符：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>backslash</code>: 反斜杠字符，用于转义</li>
<li class="text-foreground leading-relaxed"><code>dollar</code>: 美元符号，默认的数学公式分隔符</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20opts%20%3D%20options%20%7C%7C%20%7B%7D%3B%0Aconst%20delimiter%20%3D%20opts.delimiter%20%7C%7C%20dollar%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-keyword inline">const</span> opts = options || {};
  <span class="hljs-keyword inline">const</span> delimiter = opts.<span class="hljs-property inline">delimiter</span> || dollar;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第10-11行</strong>: 处理配置选项：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>opts</code>: 确保 options 存在，如果为空则使用空对象</li>
<li class="text-foreground leading-relaxed"><code>delimiter</code>: 从选项中获取分隔符，默认使用美元符号</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="if%20(delimiter.length%20!%3D%3D%201)%20%7B%20throw%20new%20Error('invalid%20delimiter')%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-keyword inline">if</span> (delimiter.<span class="hljs-property inline">length</span> !== <span class="hljs-number inline">1</span>) { <span class="hljs-keyword inline">throw</span> <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Error</span>(<span class="hljs-string inline">&#x27;invalid delimiter&#x27;</span>); }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第12行</strong>: 验证分隔符长度，只允许单字符分隔符，否则抛出错误。</p>
<h3 id="工具模块导入和样式配置" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#工具模块导入和样式配置" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 工具模块导入和样式配置">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            工具模块导入和样式配置
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Import%20styling%20utilities%0Aconst%20%7B%20applyCustomStyling%20%7D%20%3D%20require('.%2Futils')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-comment inline">// Import styling utilities</span>
  <span class="hljs-keyword inline">const</span> { applyCustomStyling } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;./utils&#x27;</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第14-15行</strong>: 从 utils 模块导入自定义样式处理函数。</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require('./utils')</code></strong>: Node.js模块加载函数，相对路径加载同目录下的utils.js文件</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">解构赋值</strong>: 从utils模块中提取applyCustomStyling函数</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Extract%20styling%20configuration%20(kept%20for%20backward%20compatibility)%0Aconst%20stylingConfig%20%3D%20%7B%0AuseTailwind%3A%20opts.useTailwind%20%7C%7C%20false%2C%0A%2F%2F%20Add%20other%20styling%20options%20here%20as%20needed%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-comment inline">// Extract styling configuration (kept for backward compatibility)</span>
  <span class="hljs-keyword inline">const</span> stylingConfig = {
    <span class="hljs-attr inline">useTailwind</span>: opts.<span class="hljs-property inline">useTailwind</span> || <span class="hljs-literal inline">false</span>,
    <span class="hljs-comment inline">// Add other styling options here as needed</span>
  };
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第17-21行</strong>: 创建样式配置对象：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>useTailwind</code>: 是否使用 Tailwind CSS，默认为 false</li>
<li class="text-foreground leading-relaxed">保留向后兼容性，可以添加其他样式选项</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20katex%20%3D%20require(%22katex%22)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-keyword inline">const</span> katex = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&quot;katex&quot;</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第23行</strong>: 导入 KaTeX 库，用于数学公式渲染。</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require(&quot;katex&quot;)</code></strong>: 加载KaTeX npm包，这是一个快速的数学公式渲染库</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">KaTeX</strong>: 由Khan Academy开发的JavaScript数学公式渲染库，支持LaTeX语法</li>
</ul>
<h3 id="katex-渲染函数" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#katex-渲染函数" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to KaTeX 渲染函数">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            KaTeX 渲染函数
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F**%0A*%20Render%20the%20contents%20as%20KaTeX%0A*%2F%0Aconst%20renderKatex%20%3D%20(source%2C%20displayMode)%20%3D%3E%20%7B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-comment inline">/**
   * Render the contents as KaTeX
   */</span>
  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">renderKatex</span> = (<span class="hljs-params inline">source, displayMode</span>) =&gt; {
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第25-28行</strong>: 定义 KaTeX 渲染函数，接受源内容和显示模式参数。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20rendered%20%3D%20katex.renderToString(source%2C%20%7B%0AdisplayMode%3A%20displayMode%2C%0AthrowOnError%3A%20false%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">const</span> rendered = katex.<span class="hljs-title function_ inline">renderToString</span>(source, {
      <span class="hljs-attr inline">displayMode</span>: displayMode,
      <span class="hljs-attr inline">throwOnError</span>: <span class="hljs-literal inline">false</span>
    });
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第29-32行</strong>: 使用 KaTeX 渲染数学公式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>katex.renderToString()</code></strong>: KaTeX核心渲染函数，将LaTeX表达式转换为HTML字符串
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>source</code>: 输入的LaTeX数学表达式字符串</li>
<li class="text-foreground leading-relaxed"><code>options</code>: 渲染配置对象</li>
</ul></li>
<li class="text-foreground leading-relaxed"><code>displayMode</code>: 布尔值，true时使用块级显示模式（居中、大字号），false时使用内联模式</li>
<li class="text-foreground leading-relaxed"><code>throwOnError: false</code>: 遇到LaTeX语法错误时不抛出异常，而是渲染错误提示信息</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Always%20apply%20custom%20styling%20to%20process%20aria-hidden%20elements%0Areturn%20applyCustomStyling(rendered%2C%20stylingConfig)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-comment inline">// Always apply custom styling to process aria-hidden elements</span>
    <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">applyCustomStyling</span>(rendered, stylingConfig);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第34-35行</strong>: 对渲染结果应用自定义样式处理，特别是处理 aria-hidden 元素。</p>
<h3 id="块级-katex-解析函数" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#块级-katex-解析函数" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 块级 KaTeX 解析函数">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            块级 KaTeX 解析函数
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F**%0A*%20Parse%20'%24%24'%20as%20a%20block.%20Based%20off%20of%20similar%20method%20in%20remarkable.%0A*%2F%0Aconst%20parseBlockKatex%20%3D%20(state%2C%20startLine%2C%20endLine)%20%3D%3E%20%7B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-comment inline">/**
   * Parse &#x27;$$&#x27; as a block. Based off of similar method in remarkable.
   */</span>
  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">parseBlockKatex</span> = (<span class="hljs-params inline">state, startLine, endLine</span>) =&gt; {
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第39-42行</strong>: 定义块级 KaTeX 解析函数，基于 Remarkable 的类似方法实现。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="let%20haveEndMarker%20%3D%20false%3B%0Alet%20pos%20%3D%20state.bMarks%5BstartLine%5D%20%2B%20state.tShift%5BstartLine%5D%3B%0Alet%20max%20%3D%20state.eMarks%5BstartLine%5D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">let</span> haveEndMarker = <span class="hljs-literal inline">false</span>;
    <span class="hljs-keyword inline">let</span> pos = state.<span class="hljs-property inline">bMarks</span>[startLine] + state.<span class="hljs-property inline">tShift</span>[startLine];
    <span class="hljs-keyword inline">let</span> max = state.<span class="hljs-property inline">eMarks</span>[startLine];
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第43-45行</strong>: 初始化解析状态：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>haveEndMarker</code>: 布尔标志，跟踪是否找到匹配的结束标记</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.bMarks[startLine]</code></strong>: Remarkable状态对象属性，获取指定行的开始字符位置（不包含前导空格）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.tShift[startLine]</code></strong>: Remarkable状态对象属性，获取指定行的前导空格/制表符数量</li>
<li class="text-foreground leading-relaxed"><code>pos</code>: 计算得出的实际解析起始位置（跳过前导空格后的位置）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.eMarks[startLine]</code></strong>: Remarkable状态对象属性，获取指定行的结束字符位置</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="if%20(pos%20%2B%201%20%3E%20max)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">if</span> (pos + <span class="hljs-number inline">1</span> &gt; max) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第47行</strong>: 检查是否有足够的字符来形成标记，如果不够则返回 false。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20marker%20%3D%20state.src.charAt(pos)%3B%0Aif%20(marker%20!%3D%3D%20delimiter)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">const</span> marker = state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos);
    <span class="hljs-keyword inline">if</span> (marker !== delimiter) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第49-50行</strong>: 检查当前字符是否为分隔符，如果不是则返回 false。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20scan%20marker%20length%0Alet%20mem%20%3D%20pos%3B%0Apos%20%3D%20state.skipChars(pos%2C%20marker)%3B%0Alet%20len%20%3D%20pos%20-%20mem%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-comment inline">// scan marker length</span>
    <span class="hljs-keyword inline">let</span> mem = pos;
    pos = state.<span class="hljs-title function_ inline">skipChars</span>(pos, marker);
    <span class="hljs-keyword inline">let</span> len = pos - mem;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第52-55行</strong>: 扫描标记长度：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>mem</code>: 记住起始位置，用于后续长度计算</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.skipChars(pos, marker)</code></strong>: Remarkable状态方法，从指定位置开始跳过连续的相同字符
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>pos</code>: 起始位置</li>
<li class="text-foreground leading-relaxed"><code>marker</code>: 要跳过的字符（这里是分隔符，如’$’）</li>
<li class="text-foreground leading-relaxed">返回值: 跳过连续字符后的新位置</li>
</ul></li>
<li class="text-foreground leading-relaxed"><code>len</code>: 计算标记长度（连续分隔符的数量）</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="if%20(len%20!%3D%3D%202)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">if</span> (len !== <span class="hljs-number inline">2</span>) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第57行</strong>: 块级公式需要恰好两个分隔符（如 $$），否则返回 false。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20search%20end%20of%20block%0Alet%20nextLine%20%3D%20startLine%3B%0Afor%20(%3B%20%3B)%20%7B%0A%2B%2BnextLine%3B%0Aif%20(nextLine%20%3E%3D%20endLine)%20%7B%20break%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-comment inline">// search end of block</span>
    <span class="hljs-keyword inline">let</span> nextLine = startLine;

    <span class="hljs-keyword inline">for</span> (; ;) {
      ++nextLine;
      <span class="hljs-keyword inline">if</span> (nextLine &gt;= endLine) { <span class="hljs-keyword inline">break</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第59-64行</strong>: 开始搜索块的结束标记，遍历后续行。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="pos%20%3D%20mem%20%3D%20state.bMarks%5BnextLine%5D%20%2B%20state.tShift%5BnextLine%5D%3B%0Amax%20%3D%20state.eMarks%5BnextLine%5D%3B%0Aif%20(pos%20tShift%5BnextLine%5D%20blkIndent)%20%7B%20break%3B%20%7D%0Aif%20(state.src.charAt(pos)%20!%3D%3D%20delimiter)%20%7B%20continue%3B%20%7D%0Aif%20(state.tShift%5BnextLine%5D%20-%20state.blkIndent%20%3E%3D%204)%20%7B%20continue%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">      pos = mem = state.<span class="hljs-property inline">bMarks</span>[nextLine] + state.<span class="hljs-property inline">tShift</span>[nextLine];
      max = state.<span class="hljs-property inline">eMarks</span>[nextLine];

      <span class="hljs-keyword inline">if</span> (pos &lt; max &amp;&amp; state.<span class="hljs-property inline">tShift</span>[nextLine] &lt; state.<span class="hljs-property inline">blkIndent</span>) { <span class="hljs-keyword inline">break</span>; }
      <span class="hljs-keyword inline">if</span> (state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos) !== delimiter) { <span class="hljs-keyword inline">continue</span>; }
      <span class="hljs-keyword inline">if</span> (state.<span class="hljs-property inline">tShift</span>[nextLine] - state.<span class="hljs-property inline">blkIndent</span> &gt;= <span class="hljs-number inline">4</span>) { <span class="hljs-keyword inline">continue</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第66-71行</strong>: 检查每一行：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">计算当前行的位置信息</li>
<li class="text-foreground leading-relaxed">检查缩进是否合适</li>
<li class="text-foreground leading-relaxed">检查是否以分隔符开始</li>
<li class="text-foreground leading-relaxed">检查缩进是否超过4个空格（代码块规则）</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="pos%20%3D%20state.skipChars(pos%2C%20marker)%3B%0Aif%20(pos%20-%20mem%20continue%3B%20%7D%0Apos%20%3D%20state.skipSpaces(pos)%3B%0Aif%20(pos%20continue%3B%20%7D%0AhaveEndMarker%20%3D%20true%3B%0Abreak%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">      pos = state.<span class="hljs-title function_ inline">skipChars</span>(pos, marker);
      <span class="hljs-keyword inline">if</span> (pos - mem &lt; len) { <span class="hljs-keyword inline">continue</span>; }

      pos = state.<span class="hljs-title function_ inline">skipSpaces</span>(pos);
      <span class="hljs-keyword inline">if</span> (pos &lt; max) { <span class="hljs-keyword inline">continue</span>; }

      haveEndMarker = <span class="hljs-literal inline">true</span>;
      <span class="hljs-keyword inline">break</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第73-80行</strong>: 验证结束标记：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.skipChars(pos, marker)</code></strong>: 跳过连续的分隔符字符</li>
<li class="text-foreground leading-relaxed">检查跳过的字符数量是否与起始标记长度匹配</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.skipSpaces(pos)</code></strong>: Remarkable状态方法，从指定位置跳过空格和制表符
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>pos</code>: 起始位置</li>
<li class="text-foreground leading-relaxed">返回值: 跳过空格后的新位置</li>
</ul></li>
<li class="text-foreground leading-relaxed">如果跳过空格后行上还有其他内容，说明不是有效的结束标记</li>
<li class="text-foreground leading-relaxed">找到有效的结束标记，设置标志并退出循环</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Only%20process%20if%20we%20found%20a%20complete%20block%20(with%20end%20marker)%0Aif%20(!haveEndMarker)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-comment inline">// Only process if we found a complete block (with end marker)</span>
    <span class="hljs-keyword inline">if</span> (!haveEndMarker) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第83-84行</strong>: 只有找到完整的块（有结束标记）才继续处理。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20If%20a%20fence%20has%20heading%20spaces%2C%20they%20should%20be%20removed%20from%20its%20inner%20block%0Alen%20%3D%20state.tShift%5BstartLine%5D%3B%0Astate.line%20%3D%20nextLine%20%2B%201%3B%20%2F%2F%20Always%20advance%20past%20the%20end%20marker%0Aconst%20content%20%3D%20state.getLines(startLine%20%2B%201%2C%20nextLine%2C%20len%2C%20true)%0A.replace(%2F%5B%20%5Cn%5D%2B%2Fg%2C%20'%20')%0A.trim()%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-comment inline">// If a fence has heading spaces, they should be removed from its inner block</span>
    len = state.<span class="hljs-property inline">tShift</span>[startLine];
    state.<span class="hljs-property inline">line</span> = nextLine + <span class="hljs-number inline">1</span>; <span class="hljs-comment inline">// Always advance past the end marker</span>
    <span class="hljs-keyword inline">const</span> content = state.<span class="hljs-title function_ inline">getLines</span>(startLine + <span class="hljs-number inline">1</span>, nextLine, len, <span class="hljs-literal inline">true</span>)
      .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/[ \n]+/g</span>, <span class="hljs-string inline">&#x27; &#x27;</span>)
      .<span class="hljs-title function_ inline">trim</span>();
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第86-91行</strong>: 提取块内容：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">记录起始行的缩进量，用于后续内容提取时保持一致的缩进处理</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.line</code></strong>: 更新Remarkable状态对象的当前行号，跳过结束标记行</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.getLines(startLine + 1, nextLine, len, true)</code></strong>: Remarkable状态方法，提取指定行范围的文本
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>startLine + 1</code>: 从起始标记的下一行开始（跳过开始的$$行）</li>
<li class="text-foreground leading-relaxed"><code>nextLine</code>: 到结束标记行结束（不包含结束的$$行）</li>
<li class="text-foreground leading-relaxed"><code>len</code>: 要移除的缩进量（与起始行缩进保持一致）</li>
<li class="text-foreground leading-relaxed"><code>true</code>: 保留最后的换行符</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>.replace(/[ \n]+/g, ' ')</code></strong>: 使用正则表达式将多个连续空格和换行符替换为单个空格</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>.trim()</code></strong>: 去除字符串首尾的空白字符</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="state.tokens.push(%7B%0Atype%3A%20'katex'%2C%20params%3A%20null%2C%20content%3A%20content%2C%20lines%3A%20%5BstartLine%2C%20state.line%5D%2C%0Alevel%3A%20state.level%2C%20block%3A%20true%0A%7D)%3B%0Areturn%20true%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    state.<span class="hljs-property inline">tokens</span>.<span class="hljs-title function_ inline">push</span>({
      <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;katex&#x27;</span>, <span class="hljs-attr inline">params</span>: <span class="hljs-literal inline">null</span>, <span class="hljs-attr inline">content</span>: content, <span class="hljs-attr inline">lines</span>: [startLine, state.<span class="hljs-property inline">line</span>],
      <span class="hljs-attr inline">level</span>: state.<span class="hljs-property inline">level</span>, <span class="hljs-attr inline">block</span>: <span class="hljs-literal inline">true</span>
    });
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">true</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第93-97行</strong>: 创建并添加 token：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.tokens.push()</code></strong>: 向Remarkable状态对象的tokens数组添加新的token对象</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Token对象结构</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>type: 'katex'</code>: 指定token类型，用于后续渲染器识别</li>
<li class="text-foreground leading-relaxed"><code>params: null</code>: 附加参数（此处为空）</li>
<li class="text-foreground leading-relaxed"><code>content: content</code>: 提取的LaTeX数学表达式内容</li>
<li class="text-foreground leading-relaxed"><code>lines: [startLine, state.line]</code>: 记录token在源文档中的行号范围</li>
<li class="text-foreground leading-relaxed"><code>level: state.level</code>: 当前嵌套级别</li>
<li class="text-foreground leading-relaxed"><code>block: true</code>: 标记为块级元素（与内联元素区分）</li>
</ul></li>
<li class="text-foreground leading-relaxed"><code>return true</code>: 返回true表示成功解析并处理了这个块</li>
</ul>
<h3 id="内联-katex-解析函数" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#内联-katex-解析函数" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 内联 KaTeX 解析函数">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            内联 KaTeX 解析函数
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F**%0A*%20Look%20for%20'%24'%20or%20'%24%24'%20spans%20in%20Markdown%20text.%20Based%20off%20of%20the%20'fenced'%20parser%20in%20remarkable.%0A*%2F%0Aconst%20parseInlineKatex%20%3D%20(state%2C%20silent)%20%3D%3E%20%7B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-comment inline">/**
   * Look for &#x27;$&#x27; or &#x27;$$&#x27; spans in Markdown text. Based off of the &#x27;fenced&#x27; parser in remarkable.
   */</span>
  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">parseInlineKatex</span> = (<span class="hljs-params inline">state, silent</span>) =&gt; {
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第101-104行</strong>: 定义内联 KaTeX 解析函数，基于 Remarkable 的 fenced 解析器。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20start%20%3D%20state.pos%3B%0Aconst%20max%20%3D%20state.posMax%3B%0Alet%20pos%20%3D%20start%3B%0A%2F%2F%20Unexpected%20starting%20character%0Aif%20(state.src.charAt(pos)%20!%3D%3D%20delimiter)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">const</span> start = state.<span class="hljs-property inline">pos</span>;
    <span class="hljs-keyword inline">const</span> max = state.<span class="hljs-property inline">posMax</span>;
    <span class="hljs-keyword inline">let</span> pos = start;

    <span class="hljs-comment inline">// Unexpected starting character</span>
    <span class="hljs-keyword inline">if</span> (state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos) !== delimiter) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第105-110行</strong>: 初始化解析状态并检查起始字符是否为分隔符。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2B%2Bpos%3B%0Awhile%20(pos%20src.charAt(pos)%20%3D%3D%3D%20delimiter)%20%7B%20%2B%2Bpos%3B%20%7D%0A%2F%2F%20Capture%20the%20length%20of%20the%20starting%20delimiter%20--%20closing%20one%20must%20match%20in%20size%0Aconst%20marker%20%3D%20state.src.slice(start%2C%20pos)%3B%0Aif%20(marker.length%20%3E%202)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    ++pos;
    <span class="hljs-keyword inline">while</span> (pos &lt; max &amp;&amp; state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos) === delimiter) { ++pos; }

    <span class="hljs-comment inline">// Capture the length of the starting delimiter -- closing one must match in size</span>
    <span class="hljs-keyword inline">const</span> marker = state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">slice</span>(start, pos);
    <span class="hljs-keyword inline">if</span> (marker.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">2</span>) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第112-117行</strong>: 扫描起始标记：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">跳过第一个分隔符</li>
<li class="text-foreground leading-relaxed">继续跳过连续的分隔符</li>
<li class="text-foreground leading-relaxed">记录标记内容</li>
<li class="text-foreground leading-relaxed">限制标记长度不超过2（<span class="katex-error inline" title="ParseError: KaTeX parse error: Can&#x27;t use function &#x27;$&#x27; in math mode at position 3: 或 $̲" style="color:#cc0000"><span class="cjk_fallback inline">或 $</span></span>）</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20spanStart%20%3D%20pos%3B%0Alet%20escapedDepth%20%3D%200%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">const</span> spanStart = pos;
    <span class="hljs-keyword inline">let</span> escapedDepth = <span class="hljs-number inline">0</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第119-120行</strong>: 初始化内容解析：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>spanStart</code>: 记录内容开始位置</li>
<li class="text-foreground leading-relaxed"><code>escapedDepth</code>: 跟踪大括号嵌套深度</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="while%20(pos%20const%20char%20%3D%20state.src.charAt(pos)%3B%0Aif%20(char%20%3D%3D%3D%20'%7B'%20%26%26%20(pos%20%3D%3D%200%20%7C%7C%20state.src.charAt(pos%20-%201)%20!%3D%20backslash))%20%7B%0AescapedDepth%20%2B%3D%201%3B%0A%7D%20else%20if%20(char%20%3D%3D%3D%20'%7D'%20%26%26%20(pos%20%3D%3D%200%20%7C%7C%20state.src.charAt(pos%20-%201)%20!%3D%20backslash))%20%7B%0AescapedDepth%20-%3D%201%3B%0Aif%20(escapedDepth%200)%20%7B%20return%20false%3B%20%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">    <span class="hljs-keyword inline">while</span> (pos &lt; max) {
      <span class="hljs-keyword inline">const</span> char = state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos);
      <span class="hljs-keyword inline">if</span> (char === <span class="hljs-string inline">&#x27;{&#x27;</span> &amp;&amp; (pos == <span class="hljs-number inline">0</span> || state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos - <span class="hljs-number inline">1</span>) != backslash)) {
        escapedDepth += <span class="hljs-number inline">1</span>;
      } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (char === <span class="hljs-string inline">&#x27;}&#x27;</span> &amp;&amp; (pos == <span class="hljs-number inline">0</span> || state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(pos - <span class="hljs-number inline">1</span>) != backslash)) {
        escapedDepth -= <span class="hljs-number inline">1</span>;
        <span class="hljs-keyword inline">if</span> (escapedDepth &lt; <span class="hljs-number inline">0</span>) { <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>; }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第121-127行</strong>: 处理大括号嵌套：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">遇到未转义的 <code>{</code> 时增加深度</li>
<li class="text-foreground leading-relaxed">遇到未转义的 <code>}</code> 时减少深度</li>
<li class="text-foreground leading-relaxed">如果深度为负数说明括号不匹配</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%7D%20else%20if%20(char%20%3D%3D%3D%20delimiter%20%26%26%20escapedDepth%20%3D%3D%3D%200)%20%7B%0Aconst%20matchStart%20%3D%20pos%3B%0Alet%20matchEnd%20%3D%20pos%20%2B%201%3B%0Awhile%20(matchEnd%20src.charAt(matchEnd)%20%3D%3D%3D%20delimiter)%20%7B%20%2B%2BmatchEnd%3B%20%7D%0Aif%20(matchEnd%20-%20matchStart%20%3D%3D%3D%20marker.length)%20%7B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">      } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (char === delimiter &amp;&amp; escapedDepth === <span class="hljs-number inline">0</span>) {
        <span class="hljs-keyword inline">const</span> matchStart = pos;
        <span class="hljs-keyword inline">let</span> matchEnd = pos + <span class="hljs-number inline">1</span>;
        <span class="hljs-keyword inline">while</span> (matchEnd &lt; max &amp;&amp; state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">charAt</span>(matchEnd) === delimiter) { ++matchEnd; }

        <span class="hljs-keyword inline">if</span> (matchEnd - matchStart === marker.<span class="hljs-property inline">length</span>) {
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第128-133行</strong>: 寻找匹配的结束标记：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">只在大括号平衡时才考虑分隔符</li>
<li class="text-foreground leading-relaxed">计算连续分隔符的长度</li>
<li class="text-foreground leading-relaxed">检查长度是否与起始标记匹配</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="if%20(!silent)%20%7B%0Aconst%20content%20%3D%20state.src.slice(spanStart%2C%20matchStart)%0A.replace(%2F%5B%20%5Cn%5D%2B%2Fg%2C%20'%20')%0A.trim()%3B%0Astate.push(%7B%20type%3A%20'katex'%2C%20content%3A%20content%2C%20block%3A%20marker.length%20%3E%201%2C%20level%3A%20state.level%20%7D)%3B%0A%7D%0Astate.pos%20%3D%20matchEnd%3B%0Areturn%20true%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">          <span class="hljs-keyword inline">if</span> (!silent) {
            <span class="hljs-keyword inline">const</span> content = state.<span class="hljs-property inline">src</span>.<span class="hljs-title function_ inline">slice</span>(spanStart, matchStart)
              .<span class="hljs-title function_ inline">replace</span>(<span class="hljs-regexp inline">/[ \n]+/g</span>, <span class="hljs-string inline">&#x27; &#x27;</span>)
              .<span class="hljs-title function_ inline">trim</span>();
            state.<span class="hljs-title function_ inline">push</span>({ <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;katex&#x27;</span>, <span class="hljs-attr inline">content</span>: content, <span class="hljs-attr inline">block</span>: marker.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">1</span>, <span class="hljs-attr inline">level</span>: state.<span class="hljs-property inline">level</span> });
          }
          state.<span class="hljs-property inline">pos</span> = matchEnd;
          <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">true</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第134-141行</strong>: 处理匹配的标记：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>!silent</code>: 检查是否为非静默模式（静默模式只检查语法不创建token）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.src.slice(spanStart, matchStart)</code></strong>: 从源文本中提取指定范围的内容
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>spanStart</code>: 内容开始位置（跳过起始分隔符后）</li>
<li class="text-foreground leading-relaxed"><code>matchStart</code>: 结束分隔符开始位置（不包含结束分隔符）</li>
</ul></li>
<li class="text-foreground leading-relaxed">内容清理：替换多空格/换行为单空格，去除首尾空白</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.push(tokenObject)</code></strong>: Remarkable状态方法，向tokens数组添加token
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>type: 'katex'</code>: token类型</li>
<li class="text-foreground leading-relaxed"><code>content: content</code>: 处理后的LaTeX表达式</li>
<li class="text-foreground leading-relaxed"><code>block: marker.length &gt; 1</code>: 根据分隔符长度判断是否为块级（$<span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>为块级，</mtext></mrow><annotation encoding="application/x-tex">为块级，</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:0.6833em;"></span><span class="mord cjk_fallback inline">为块级，</span></span></span></span>为内联）</li>
<li class="text-foreground leading-relaxed"><code>level: state.level</code>: 当前嵌套级别</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>state.pos</code></strong>: 更新Remarkable状态对象的当前解析位置到结束分隔符之后</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%7D%0A%7D%0Apos%20%2B%3D%201%3B%0A%7D%0A%2F%2F%20If%20we%20reach%20here%2C%20no%20matching%20closing%20delimiter%20was%20found%0A%2F%2F%20Don't%20add%20anything%20to%20pending%20and%20don't%20advance%20position%20to%20avoid%20partial%20rendering%0Areturn%20false%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">        }
      }
      pos += <span class="hljs-number inline">1</span>;
    }

    <span class="hljs-comment inline">// If we reach here, no matching closing delimiter was found</span>
    <span class="hljs-comment inline">// Don&#x27;t add anything to pending and don&#x27;t advance position to avoid partial rendering</span>
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">false</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第142-148行</strong>: 处理未找到匹配标记的情况：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">继续向前搜索</li>
<li class="text-foreground leading-relaxed">如果到达末尾仍未找到匹配的结束标记</li>
<li class="text-foreground leading-relaxed">返回 false，不创建 token，避免部分渲染</li>
</ul>
<h3 id="插件注册" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#插件注册" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 插件注册">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            插件注册
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="md.inline.ruler.push('katex'%2C%20parseInlineKatex%2C%20options)%3B%0Amd.block.ruler.push('katex'%2C%20parseBlockKatex%2C%20options)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  md.<span class="hljs-property inline">inline</span>.<span class="hljs-property inline">ruler</span>.<span class="hljs-title function_ inline">push</span>(<span class="hljs-string inline">&#x27;katex&#x27;</span>, parseInlineKatex, options);
  md.<span class="hljs-property inline">block</span>.<span class="hljs-property inline">ruler</span>.<span class="hljs-title function_ inline">push</span>(<span class="hljs-string inline">&#x27;katex&#x27;</span>, parseBlockKatex, options);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第151-152行</strong>: 向 Remarkable 注册解析规则：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.inline.ruler.push()</code></strong>: Remarkable插件API，向内联解析器注册新的解析规则
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>'katex'</code>: 规则名称，用于标识和排序</li>
<li class="text-foreground leading-relaxed"><code>parseInlineKatex</code>: 内联解析函数</li>
<li class="text-foreground leading-relaxed"><code>options</code>: 解析选项（可选）</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.block.ruler.push()</code></strong>: Remarkable插件API，向块级解析器注册新的解析规则
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>'katex'</code>: 规则名称</li>
<li class="text-foreground leading-relaxed"><code>parseBlockKatex</code>: 块级解析函数</li>
<li class="text-foreground leading-relaxed"><code>options</code>: 解析选项（可选）</li>
</ul></li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="md.renderer.rules.katex%20%3D%20(tokens%2C%20idx)%20%3D%3E%20%7B%0Aconst%20token%20%3D%20tokens%5Bidx%5D%3B%0Aconst%20rendered%20%3D%20renderKatex(token.content%2C%20token.block)%3B%0A%2F%2F%20Return%20clean%20HTML%20without%20any%20markdown%20artifacts%0Areturn%20rendered%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  md.<span class="hljs-property inline">renderer</span>.<span class="hljs-property inline">rules</span>.<span class="hljs-property inline">katex</span> = <span class="hljs-function inline">(<span class="hljs-params inline">tokens, idx</span>) =&gt;</span> {
    <span class="hljs-keyword inline">const</span> token = tokens[idx];
    <span class="hljs-keyword inline">const</span> rendered = <span class="hljs-title function_ inline">renderKatex</span>(token.<span class="hljs-property inline">content</span>, token.<span class="hljs-property inline">block</span>);
    <span class="hljs-comment inline">// Return clean HTML without any markdown artifacts</span>
    <span class="hljs-keyword inline">return</span> rendered;
  };
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第153-158行</strong>: 定义渲染规则：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>md.renderer.rules.katex</code></strong>: Remarkable渲染器API，为’katex’类型的token定义渲染函数</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">渲染函数参数</strong>:
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>tokens</code>: 完整的tokens数组</li>
<li class="text-foreground leading-relaxed"><code>idx</code>: 当前要渲染的token在数组中的索引</li>
</ul></li>
<li class="text-foreground leading-relaxed"><code>tokens[idx]</code>: 获取当前要渲染的token对象</li>
<li class="text-foreground leading-relaxed"><code>renderKatex(token.content, token.block)</code>: 调用前面定义的KaTeX渲染函数</li>
<li class="text-foreground leading-relaxed">返回渲染后的HTML字符串，无Markdown语法残留</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="md.renderer.rules.katex.delimiter%20%3D%20delimiter%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  md.<span class="hljs-property inline">renderer</span>.<span class="hljs-property inline">rules</span>.<span class="hljs-property inline">katex</span>.<span class="hljs-property inline">delimiter</span> = delimiter;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第159行</strong>: 将分隔符信息附加到渲染规则上，便于调试和配置检查。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%7D%3B%0Amodule.exports%20%3D%20rkatex%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">};

<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = rkatex;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第160-162行</strong>: 结束函数定义并导出模块。</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>};</code>: 结束rkatex函数定义</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>module.exports</code></strong>: Node.js模块导出机制，使rkatex函数可被其他模块通过require()导入使用</li>
</ul>
<hr class="border-0 h-px bg-gray-300 my-8">
<h2 id="indextestjs-代码逐行解析" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#indextestjs-代码逐行解析" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to index.test.js 代码逐行解析">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            index.test.js 代码逐行解析
        </h2>
<h3 id="测试文件头部" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#测试文件头部" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 测试文件头部">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            测试文件头部
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%22use%20strict%22%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-meta inline">&quot;use strict&quot;</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第1行</strong>: 启用严格模式。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20vows%20%3D%20require('vows')%3B%0Aconst%20assert%20%3D%20require('assert')%3B%0Aconst%20%7B%20Remarkable%20%7D%20%3D%20require('remarkable')%3B%0Aconst%20plugin%20%3D%20require('.%2Findex.js')%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> vows = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;vows&#x27;</span>);
<span class="hljs-keyword inline">const</span> assert = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;assert&#x27;</span>);
<span class="hljs-keyword inline">const</span> { <span class="hljs-title class_ inline">Remarkable</span> } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;remarkable&#x27;</span>);

<span class="hljs-keyword inline">const</span> plugin = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;./index.js&#x27;</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第3-6行</strong>: 导入测试依赖：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require('vows')</code></strong>: 导入vows测试框架，一个用于Node.js的BDD（行为驱动开发）测试框架</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require('assert')</code></strong>: 导入Node.js内置断言库，提供各种断言方法用于测试验证</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require('remarkable')</code></strong>: 导入Remarkable Markdown处理器，使用解构语法获取Remarkable构造函数</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require('./index.js')</code></strong>: 导入当前目录下的插件主文件（相对路径导入）</li>
</ul>
<h3 id="测试实例准备" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#测试实例准备" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 测试实例准备">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            测试实例准备
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20mdWithDollar%20%3D%20new%20Remarkable()%3B%0AmdWithDollar.use(plugin)%3B%0Aconst%20mdWithAt%20%3D%20new%20Remarkable()%3B%0AmdWithAt.use(plugin%2C%20%7Bdelimiter%3A%20'%40'%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> mdWithDollar = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
mdWithDollar.<span class="hljs-title function_ inline">use</span>(plugin);

<span class="hljs-keyword inline">const</span> mdWithAt = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
mdWithAt.<span class="hljs-title function_ inline">use</span>(plugin, {<span class="hljs-attr inline">delimiter</span>: <span class="hljs-string inline">&#x27;@&#x27;</span>});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第8-12行</strong>: 创建测试实例：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>new Remarkable()</code></strong>: 创建Remarkable Markdown处理器实例</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>mdWithDollar.use(plugin)</code></strong>: 使用Remarkable插件API加载KaTeX插件（使用默认配置）
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>plugin</code>: 前面导入的KaTeX插件函数</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>mdWithAt.use(plugin, {delimiter: '@'})</code></strong>: 加载插件并传入自定义配置
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>{delimiter: '@'}</code>: 配置对象，指定使用@符号作为数学公式分隔符替代默认的$符号</li>
</ul></li>
</ul>
<h3 id="测试套件开始" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#测试套件开始" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 测试套件开始">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            测试套件开始
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="vows.describe('KatexPlugin').addBatch(%7B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">vows.<span class="hljs-title function_ inline">describe</span>(<span class="hljs-string inline">&#x27;KatexPlugin&#x27;</span>).<span class="hljs-title function_ inline">addBatch</span>({
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第14行</strong>: 使用 vows 框架创建名为 ‘KatexPlugin’ 的测试套件。</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>vows.describe('KatexPlugin')</code></strong>: vows测试框架API，创建一个测试套件（Test Suite）
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>'KatexPlugin'</code>: 测试套件的名称，用于测试输出和组织</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>.addBatch(testObject)</code></strong>: vows框架方法，向测试套件添加一批测试用例
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>testObject</code>: 包含多个测试用例的对象</li>
</ul></li>
</ul>
<h3 id="配置测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#配置测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 配置测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            配置测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Config%20empty%20delimiter'%3A%20%7B%0Atopic()%20%7B%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(plugin%2C%20%7Bdelimiter%3A%20''%7D)%3B%0Areturn%20md%3B%0A%7D%2C%0A'Uses%20default%20delimiter'%3A%20function(topic)%20%7B%0Aassert.equal(topic.renderer.rules.katex.delimiter%2C%20'%24')%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Config empty delimiter&#x27;</span>: {
    <span class="hljs-title function_ inline">topic</span>(<span class="hljs-params inline"></span>) {
      <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
      md.<span class="hljs-title function_ inline">use</span>(plugin, {<span class="hljs-attr inline">delimiter</span>: <span class="hljs-string inline">&#x27;&#x27;</span>});
      <span class="hljs-keyword inline">return</span> md;
    },
    <span class="hljs-string inline">&#x27;Uses default delimiter&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-property inline">renderer</span>.<span class="hljs-property inline">rules</span>.<span class="hljs-property inline">katex</span>.<span class="hljs-property inline">delimiter</span>, <span class="hljs-string inline">&#x27;$&#x27;</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第15-24行</strong>: 测试空分隔符配置：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">创建使用空分隔符的实例</li>
<li class="text-foreground leading-relaxed">验证是否回退到默认的 $ 分隔符</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Multi-char%20delimiter'%3A%20%7B%0Atopic()%20%7B%0Areturn%20()%20%3D%3E%20%7B%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(plugin%2C%20%7Bdelimiter%3A%20'%24%24'%7D)%3B%0Areturn%20md%3B%0A%7D%3B%0A%7D%2C%0A'Throws%20exception'%3A%20function(topic)%20%7B%0Aassert.throws(topic)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Multi-char delimiter&#x27;</span>: {
    <span class="hljs-title function_ inline">topic</span>(<span class="hljs-params inline"></span>) {
      <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
        md.<span class="hljs-title function_ inline">use</span>(plugin, {<span class="hljs-attr inline">delimiter</span>: <span class="hljs-string inline">&#x27;$$&#x27;</span>});
        <span class="hljs-keyword inline">return</span> md;
      };
    },
    <span class="hljs-string inline">&#x27;Throws exception&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">throws</span>(topic);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第25-36行</strong>: 测试多字符分隔符：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">尝试使用两个字符的分隔符</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>assert.throws(topic)</code></strong>: Node.js断言库方法，验证函数调用是否抛出异常
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>topic</code>: 要测试的函数（这里是返回Remarkable实例创建函数的函数）</li>
<li class="text-foreground leading-relaxed">如果函数没有抛出异常，断言失败</li>
</ul></li>
</ul>
<h3 id="基础文本渲染测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#基础文本渲染测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 基础文本渲染测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            基础文本渲染测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Render%20plain%20text'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('This%20is%20a%20test.')%2C%0A'Nothing%20done'%3A%20function(topic)%20%7B%0Aassert.equal(topic%2C%20'This%20is%20a%20test.%5Cn')%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Render plain text&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;This is a test.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Nothing done&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic, <span class="hljs-string inline">&#x27;&lt;p&gt;This is a test.&lt;/p&gt;\n&#x27;</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第37-42行</strong>: 测试纯文本渲染：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>mdWithDollar.render('This is a test.')</code></strong>: 使用Remarkable实例的render方法处理Markdown文本
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>render()</code>: Remarkable核心方法，将Markdown文本转换为HTML</li>
<li class="text-foreground leading-relaxed">返回值: 渲染后的HTML字符串</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>assert.equal(actual, expected)</code></strong>: Node.js断言库方法，验证两个值是否严格相等
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>actual</code>: 实际得到的值（render方法的返回值）</li>
<li class="text-foreground leading-relaxed"><code>expected</code>: 期望的值（’<p class="text-base leading-7 mb-4 text-foreground">This is a test.</p>\n’）</li>
</ul></li>
<li class="text-foreground leading-relaxed">确保插件不影响普通文本的正常渲染</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Render%20with%20single%20%24%20in%20text'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('The%20car%20cost%20%2420%2C000%20new.')%2C%0A'Nothing%20done'%3A%20function(topic)%20%7B%0Aassert.equal(topic%2C%20'The%20car%20cost%20%2420%2C000%20new.%5Cn')%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Render with single $ in text&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;The car cost $20,000 new.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Nothing done&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic, <span class="hljs-string inline">&#x27;&lt;p&gt;The car cost $20,000 new.&lt;/p&gt;\n&#x27;</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第43-48行</strong>: 测试单个美元符号：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证单独的 $ 符号不被误认为数学公式标记</li>
<li class="text-foreground leading-relaxed">确保正常文本中的货币符号正确显示</li>
</ul>
<h3 id="内联数学公式测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#内联数学公式测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 内联数学公式测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            内联数学公式测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Render%20%24...%24%20in%20text'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Equation%20%24x%20%2B%20y%24.')%2C%0A'Starts%20with%20%22Equation%20%22'%3A%20function(topic)%20%7B%0Aassert.isTrue(topic.startsWith('Equation%20'))%3B%0A%7D%2C%0A'Ends%20with%20%22.%22'%3A%20function(topic)%20%7B%0Aassert.isTrue(topic.endsWith('.%5Cn'))%3B%0A%7D%2C%0A'Contains%20math%20span'%3A%20function(topic)%20%7B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Render $...$ in text&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Equation $x + y$.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Starts with &quot;&lt;p&gt;Equation &quot;&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">isTrue</span>(topic.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;&lt;p&gt;Equation &#x27;</span>));
    },
    <span class="hljs-string inline">&#x27;Ends with &quot;.&lt;/p&gt;&quot;&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">isTrue</span>(topic.<span class="hljs-title function_ inline">endsWith</span>(<span class="hljs-string inline">&#x27;&lt;/span&gt;.&lt;/p&gt;\n&#x27;</span>));
    },
    <span class="hljs-string inline">&#x27;Contains math span&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第49-61行</strong>: 测试基本内联数学公式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>assert.isTrue(condition)</code></strong>: Node.js断言库方法，验证条件是否为真值
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>topic.startsWith('&lt;p&gt;Equation ')</code>: JavaScript字符串方法，检查字符串是否以指定前缀开始</li>
<li class="text-foreground leading-relaxed"><code>topic.endsWith('&lt;/span&gt;.&lt;/p&gt;\n')</code>: JavaScript字符串方法，检查字符串是否以指定后缀结束</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>assert.notEqual(actual, unexpected)</code></strong>: Node.js断言库方法，验证两个值不相等
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>topic.indexOf('&lt;span class=&quot;katex&quot;&gt;')</code>: JavaScript字符串方法，查找子字符串在字符串中的位置</li>
<li class="text-foreground leading-relaxed"><code>-1</code>: indexOf方法未找到时的返回值</li>
<li class="text-foreground leading-relaxed">这个断言确保HTML中包含KaTeX渲染的span元素</li>
</ul></li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Render%20%24...%24%20in%20text%20with%20embedded%20%7B%24...%24%7D'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Equation%20%24%5C%5Ccolorbox%7Baqua%7D%7B%24F%3Dma%24%7D%24.')%2C%0A%2F%2F%20...%20%E7%B1%BB%E4%BC%BC%E7%9A%84%E6%96%AD%E8%A8%80%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Render $...$ in text with embedded {$...$}&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Equation $\\colorbox{aqua}{$F=ma$}$.&#x27;</span>),
    <span class="hljs-comment inline">// ... 类似的断言</span>
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第62-74行</strong>: 测试嵌套大括号的复杂公式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证插件正确处理嵌套的大括号结构</li>
<li class="text-foreground leading-relaxed">确保复杂的 LaTeX 命令正确渲染</li>
</ul>
<h3 id="块级数学公式测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#块级数学公式测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 块级数学公式测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            块级数学公式测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Render%20%24%24...%24%24%20in%20text'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Before%5Cn%24%24%5Cnx%20%2B%20y%5Cn%24%24%5Cnafter.')%2C%0A'Starts%20with%20%22Before%20%22'%3A%20function(topic)%20%7B%0Aassert.isTrue(topic.startsWith('Before%5Cn'))%3B%0A%7D%2C%0A'Ends%20with%20%22after.%22'%3A%20function(topic)%20%7B%0Aassert.isTrue(topic.endsWith('%5Cnafter.%5Cn'))%3B%0A%7D%2C%0A'Contains%20math%20span'%3A%20function(topic)%20%7B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Render $$...$$ in text&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Before\n$$\nx + y\n$$\nafter.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Starts with &quot;&lt;p&gt;Before &quot;&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">isTrue</span>(topic.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;&lt;p&gt;Before\n&#x27;</span>));
    },
    <span class="hljs-string inline">&#x27;Ends with &quot;after.&lt;/p&gt;&quot;&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">isTrue</span>(topic.<span class="hljs-title function_ inline">endsWith</span>(<span class="hljs-string inline">&#x27;&lt;/span&gt;\nafter.&lt;/p&gt;\n&#x27;</span>));
    },
    <span class="hljs-string inline">&#x27;Contains math span&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex-display&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第87-99行</strong>: 测试块级数学公式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证多行的 $$ 块正确渲染</li>
<li class="text-foreground leading-relaxed">确保使用 katex-display 类名</li>
</ul>
<h3 id="自定义分隔符测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#自定义分隔符测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 自定义分隔符测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            自定义分隔符测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Render%20%40...%40%20in%20text'%3A%20%7B%0Atopic%3A%20mdWithAt.render('Equation%20%40x%20%2B%20y%40.')%2C%0A%2F%2F%20...%20%E9%AA%8C%E8%AF%81%E4%BD%BF%E7%94%A8%20%40%20%E5%88%86%E9%9A%94%E7%AC%A6%E7%9A%84%E5%86%85%E8%81%94%E5%85%AC%E5%BC%8F%0A%7D%2C%0A'Render%20%40%40...%40%40%20in%20text'%3A%20%7B%0Atopic%3A%20mdWithAt.render('Before%20%40%40x%20%2B%20y%40%40%20after.')%2C%0A%2F%2F%20...%20%E9%AA%8C%E8%AF%81%E4%BD%BF%E7%94%A8%20%40%20%E5%88%86%E9%9A%94%E7%AC%A6%E7%9A%84%E5%9D%97%E7%BA%A7%E5%85%AC%E5%BC%8F%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Render @...@ in text&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithAt.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Equation @x + y@.&#x27;</span>),
    <span class="hljs-comment inline">// ... 验证使用 @ 分隔符的内联公式</span>
  },
  <span class="hljs-string inline">&#x27;Render @@...@@ in text&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithAt.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Before @@x + y@@ after.&#x27;</span>),
    <span class="hljs-comment inline">// ... 验证使用 @ 分隔符的块级公式</span>
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第75-86行 和 100-112行</strong>: 测试自定义分隔符：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证插件支持自定义分隔符（@ 替代 $）</li>
<li class="text-foreground leading-relaxed">确保内联和块级公式都能正确使用自定义分隔符</li>
</ul>
<h3 id="错误处理测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#错误处理测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 错误处理测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            错误处理测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Incomplete%20inline%20expression%20(no%20closing%20delimiter)'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('This%20has%20%24incomplete%20math%20expression.')%2C%0A'Original%20text%20preserved'%3A%20function(topic)%20%7B%0Aassert.equal(topic%2C%20'This%20has%20%24incomplete%20math%20expression.%5Cn')%3B%0A%7D%2C%0A'No%20KaTeX%20HTML%20generated'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Incomplete inline expression (no closing delimiter)&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;This has $incomplete math expression.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Original text preserved&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic, <span class="hljs-string inline">&#x27;&lt;p&gt;This has $incomplete math expression.&lt;/p&gt;\n&#x27;</span>);
    },
    <span class="hljs-string inline">&#x27;No KaTeX HTML generated&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第113-122行</strong>: 测试不完整的内联表达式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证缺少结束分隔符时保持原文</li>
<li class="text-foreground leading-relaxed">确保不生成错误的 KaTeX HTML</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Incomplete%20block%20expression%20(no%20closing%20delimiter)'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Before%5Cn%24%24%5Cnincomplete%20block%5Cnafter.')%2C%0A'Original%20text%20preserved'%3A%20function(topic)%20%7B%0Aassert.equal(topic%2C%20'Before%5Cn%24%24%5Cnincomplete%20block%5Cnafter.%5Cn')%3B%0A%7D%2C%0A'No%20KaTeX%20HTML%20generated'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Incomplete block expression (no closing delimiter)&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Before\n$$\nincomplete block\nafter.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Original text preserved&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic, <span class="hljs-string inline">&#x27;&lt;p&gt;Before\n$$\nincomplete block\nafter.&lt;/p&gt;\n&#x27;</span>);
    },
    <span class="hljs-string inline">&#x27;No KaTeX HTML generated&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex-display&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第123-132行</strong>: 测试不完整的块级表达式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证缺少结束标记时保持原文</li>
<li class="text-foreground leading-relaxed">确保不生成部分的数学公式 HTML</li>
</ul>
<h3 id="内容清理测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#内容清理测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 内容清理测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            内容清理测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Original%20expression%20completely%20removed%20in%20inline%20math'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Test%20%24x%5E2%24%20here.')%2C%0A'No%20dollar%20signs%20in%20output'%3A%20function(topic)%20%7B%0A%2F%2F%20Should%20not%20contain%20the%20original%20%24%20delimiters%0Aassert.equal(topic.indexOf('%24x%5E2%24')%2C%20-1)%3B%0A%7D%2C%0A'Contains%20rendered%20math'%3A%20function(topic)%20%7B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%2C%0A'Contains%20x%5E2%20in%20rendered%20form'%3A%20function(topic)%20%7B%0A%2F%2F%20KaTeX%20should%20render%20x%5E2%20as%20superscript%0Aassert.notEqual(topic.indexOf('x')%2C%20-1)%3B%0Aassert.notEqual(topic.indexOf('2')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Original expression completely removed in inline math&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Test $x^2$ here.&#x27;</span>),
    <span class="hljs-string inline">&#x27;No dollar signs in output&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// Should not contain the original $ delimiters</span>
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$x^2$&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;Contains rendered math&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;Contains x^2 in rendered form&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// KaTeX should render x^2 as superscript</span>
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;x&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;2&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第133-149行</strong>: 测试原始表达式的完全移除：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证原始的 $ 分隔符不出现在输出中</li>
<li class="text-foreground leading-relaxed">确保内容被正确转换为 KaTeX HTML</li>
<li class="text-foreground leading-relaxed">验证数学符号正确渲染</li>
</ul>
<h3 id="katex-注释保留测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#katex-注释保留测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to KaTeX 注释保留测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            KaTeX 注释保留测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Original%20expression%20completely%20removed%20in%20block%20math'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Before%5Cn%24%24%5Cn%5C%5Cfrac%7Ba%7D%7Bb%7D%5Cn%24%24%5Cnafter.')%2C%0A'No%20double%20dollar%20signs%20in%20output'%3A%20function(topic)%20%7B%0A%2F%2F%20Should%20not%20contain%20the%20original%20%24%24%20delimiters%0Aassert.equal(topic.indexOf('%24%24')%2C%20-1)%3B%0A%7D%2C%0A'Raw%20LaTeX%20preserved%20in%20annotation%20(correct%20behavior)'%3A%20function(topic)%20%7B%0A%2F%2F%20KaTeX%20preserves%20original%20LaTeX%20in%20annotation%20tags%20-%20this%20is%20correct%0Aassert.notEqual(topic.indexOf('%5C%5Cfrac%7Ba%7D%7Bb%7D')%2C%20-1)%3B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%2C%0A'Contains%20rendered%20math'%3A%20function(topic)%20%7B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Original expression completely removed in block math&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Before\n$$\n\\frac{a}{b}\n$$\nafter.&#x27;</span>),
    <span class="hljs-string inline">&#x27;No double dollar signs in output&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// Should not contain the original $$ delimiters</span>
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$$&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;Raw LaTeX preserved in annotation (correct behavior)&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// KaTeX preserves original LaTeX in annotation tags - this is correct</span>
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;\\frac{a}{b}&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;Contains rendered math&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex-display&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第150-165行</strong>: 测试块级公式的处理：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证 $$ 分隔符被移除</li>
<li class="text-foreground leading-relaxed">确认 KaTeX 在注释标签中保留原始 LaTeX（这是正确行为）</li>
<li class="text-foreground leading-relaxed">验证包含渲染的数学元素</li>
</ul>
<h3 id="多个表达式测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#多个表达式测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 多个表达式测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            多个表达式测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Multiple%20expressions%20all%20converted'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('First%20%24a%2Bb%24%20and%20second%20%24c%2Bd%24%20expressions.')%2C%0A'No%20dollar%20signs%20remain'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('%24a%2Bb%24')%2C%20-1)%3B%0Aassert.equal(topic.indexOf('%24c%2Bd%24')%2C%20-1)%3B%0A%7D%2C%0A'Two%20math%20spans%20created'%3A%20function(topic)%20%7B%0Aconst%20matches%20%3D%20topic.match(%2F%2Fg)%3B%0Aassert.equal(matches%20%3F%20matches.length%20%3A%200%2C%202)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Multiple expressions all converted&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;First $a+b$ and second $c+d$ expressions.&#x27;</span>),
    <span class="hljs-string inline">&#x27;No dollar signs remain&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$a+b$&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$c+d$&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;Two math spans created&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-keyword inline">const</span> matches = topic.<span class="hljs-title function_ inline">match</span>(<span class="hljs-regexp inline">/&lt;span class=&quot;katex&quot;&gt;/g</span>);
      assert.<span class="hljs-title function_ inline">equal</span>(matches ? matches.<span class="hljs-property inline">length</span> : <span class="hljs-number inline">0</span>, <span class="hljs-number inline">2</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第166-177行</strong>: 测试多个数学表达式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证所有原始分隔符都被移除</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>topic.match(/&lt;span class=&quot;katex&quot;&gt;/g)</code></strong>: JavaScript字符串正则匹配方法
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>/&lt;span class=&quot;katex&quot;&gt;/g</code>: 全局正则表达式，查找所有KaTeX span标签</li>
<li class="text-foreground leading-relaxed"><code>g</code>标志: 全局匹配，返回所有匹配项而不是只返回第一个</li>
<li class="text-foreground leading-relaxed">返回值: 匹配项数组或null（无匹配时）</li>
</ul></li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">三元运算符 <code>matches ? matches.length : 0</code></strong>: 安全获取匹配数量
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">如果matches不为null，返回数组长度</li>
<li class="text-foreground leading-relaxed">如果matches为null（无匹配），返回0</li>
</ul></li>
<li class="text-foreground leading-relaxed">确保创建了正确数量（2个）的数学span元素</li>
</ul>
<h3 id="混合表达式测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#混合表达式测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 混合表达式测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            混合表达式测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Mixed%20inline%20and%20block%20expressions'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Inline%20%24x%24%20and%20block%3A%5Cn%24%24%5Cny%20%3D%20mx%20%2B%20b%5Cn%24%24%5Cndone.')%2C%0A'No%20original%20delimiters%20remain'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('%24x%24')%2C%20-1)%3B%0Aassert.equal(topic.indexOf('%24%24')%2C%20-1)%3B%0A%2F%2F%20Note%3A%20%22y%20%3D%20mx%20%2B%20b%22%20will%20be%20preserved%20in%20KaTeX%20annotation%20-%20this%20is%20correct%0A%7D%2C%0A'Contains%20both%20inline%20and%20block%20math'%3A%20function(topic)%20%7B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%2C%0A'LaTeX%20content%20preserved%20in%20annotations'%3A%20function(topic)%20%7B%0A%2F%2F%20KaTeX%20correctly%20preserves%20LaTeX%20in%20annotations%0Aassert.notEqual(topic.indexOf('x')%2C%20-1)%3B%0Aassert.notEqual(topic.indexOf('y%20%3D%20mx%20%2B%20b')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Mixed inline and block expressions&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Inline $x$ and block:\n$$\ny = mx + b\n$$\ndone.&#x27;</span>),
    <span class="hljs-string inline">&#x27;No original delimiters remain&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$x$&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$$&#x27;</span>), -<span class="hljs-number inline">1</span>);
      <span class="hljs-comment inline">// Note: &quot;y = mx + b&quot; will be preserved in KaTeX annotation - this is correct</span>
    },
    <span class="hljs-string inline">&#x27;Contains both inline and block math&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex-display&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;LaTeX content preserved in annotations&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// KaTeX correctly preserves LaTeX in annotations</span>
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x&lt;/annotation&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;y = mx + b&lt;/annotation&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第178-194行</strong>: 测试内联和块级表达式的混合使用：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证所有原始分隔符被移除</li>
<li class="text-foreground leading-relaxed">确保同时包含内联和块级数学元素</li>
<li class="text-foreground leading-relaxed">验证 LaTeX 内容在注释中的正确保留</li>
</ul>
<h3 id="错误处理配置测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#错误处理配置测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 错误处理配置测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            错误处理配置测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'KaTeX%20error%20handling%20(throwOnError%3A%20false)'%3A%20%7B%0Atopic%3A%20mdWithDollar.render('Invalid%20math%3A%20%24%5C%5Cinvalidcommand%7Btest%7D%24.')%2C%0A'Renders%20without%20throwing'%3A%20function(topic)%20%7B%0A%2F%2F%20Should%20render%20something%20even%20with%20invalid%20LaTeX%20(due%20to%20throwOnError%3A%20false)%0Aassert.isTrue(topic.length%20%3E%200)%3B%0Aassert.notEqual(topic.indexOf('')%2C%20-1)%3B%0A%7D%2C%0A'No%20original%20delimiters%20remain'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('%24%5C%5Cinvalidcommand%7Btest%7D%24')%2C%20-1)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;KaTeX error handling (throwOnError: false)&#x27;</span>: {
    <span class="hljs-attr inline">topic</span>: mdWithDollar.<span class="hljs-title function_ inline">render</span>(<span class="hljs-string inline">&#x27;Invalid math: $\\invalidcommand{test}$.&#x27;</span>),
    <span class="hljs-string inline">&#x27;Renders without throwing&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// Should render something even with invalid LaTeX (due to throwOnError: false)</span>
      assert.<span class="hljs-title function_ inline">isTrue</span>(topic.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;&lt;span class=&quot;katex&quot;&gt;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    },
    <span class="hljs-string inline">&#x27;No original delimiters remain&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;$\\invalidcommand{test}$&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第195-206行</strong>: 测试 KaTeX 错误处理：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证无效的 LaTeX 命令不会抛出异常</li>
<li class="text-foreground leading-relaxed">确保仍然生成某种输出（错误显示）</li>
<li class="text-foreground leading-relaxed">验证原始分隔符被移除</li>
</ul>
<h3 id="配置选项测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#配置选项测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 配置选项测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            配置选项测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Config%20with%20useTailwind%3Dfalse%20(default)'%3A%20%7B%0Atopic()%20%7B%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(plugin%2C%20%7B%20useTailwind%3A%20false%20%7D)%3B%0Areturn%20md%3B%0A%7D%2C%0A'Configuration%20applied%20correctly'%3A%20function(topic)%20%7B%0A%2F%2F%20Test%20that%20configuration%20is%20accepted%20without%20error%0Aassert.isObject(topic)%3B%0A%7D%0A%7D%2C%0A'Config%20with%20useTailwind%3Dtrue'%3A%20%7B%0Atopic()%20%7B%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(plugin%2C%20%7B%20useTailwind%3A%20true%20%7D)%3B%0Areturn%20md%3B%0A%7D%2C%0A'Configuration%20applied%20correctly'%3A%20function(topic)%20%7B%0A%2F%2F%20Test%20that%20configuration%20is%20accepted%20without%20error%0Aassert.isObject(topic)%3B%0A%7D%0A%7D%2C">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Config with useTailwind=false (default)&#x27;</span>: {
    <span class="hljs-title function_ inline">topic</span>(<span class="hljs-params inline"></span>) {
      <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
      md.<span class="hljs-title function_ inline">use</span>(plugin, { <span class="hljs-attr inline">useTailwind</span>: <span class="hljs-literal inline">false</span> });
      <span class="hljs-keyword inline">return</span> md;
    },
    <span class="hljs-string inline">&#x27;Configuration applied correctly&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// Test that configuration is accepted without error</span>
      assert.<span class="hljs-title function_ inline">isObject</span>(topic);
    }
  },
  <span class="hljs-string inline">&#x27;Config with useTailwind=true&#x27;</span>: {
    <span class="hljs-title function_ inline">topic</span>(<span class="hljs-params inline"></span>) {
      <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
      md.<span class="hljs-title function_ inline">use</span>(plugin, { <span class="hljs-attr inline">useTailwind</span>: <span class="hljs-literal inline">true</span> });
      <span class="hljs-keyword inline">return</span> md;
    },
    <span class="hljs-string inline">&#x27;Configuration applied correctly&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      <span class="hljs-comment inline">// Test that configuration is accepted without error</span>
      assert.<span class="hljs-title function_ inline">isObject</span>(topic);
    }
  },
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第207-225行</strong>: 测试 Tailwind 配置选项：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证 <code>useTailwind: false</code> 配置正确应用</li>
<li class="text-foreground leading-relaxed">验证 <code>useTailwind: true</code> 配置正确应用</li>
<li class="text-foreground leading-relaxed">确保配置被接受且不产生错误</li>
</ul>
<h3 id="样式处理测试" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#样式处理测试" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 样式处理测试">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            样式处理测试
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="'Aria-hidden%20processing%20with%20default%20styling'%3A%20%7B%0Atopic()%20%7B%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(plugin%2C%20%7B%20useTailwind%3A%20false%20%7D)%3B%0A%2F%2F%20Create%20a%20mock%20rendered%20output%20with%20aria-hidden%20elements%0Aconst%20%7B%20applyCustomStyling%20%7D%20%3D%20require('.%2Futils')%3B%0Aconst%20mockHtml%20%3D%20'hidden%20content'%3B%0Areturn%20applyCustomStyling(mockHtml%2C%20%7B%20useTailwind%3A%20false%20%7D)%3B%0A%7D%2C%0A'Removes%20inline%20class%20and%20adds%20display%3Anone%20style'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('class%3D%22inline%22')%2C%20-1)%3B%0Aassert.notEqual(topic.indexOf('style%3D%22display%3Anone%22')%2C%20-1)%3B%0A%7D%0A%7D%2C%0A'Aria-hidden%20processing%20with%20Tailwind%20styling'%3A%20%7B%0Atopic()%20%7B%0Aconst%20md%20%3D%20new%20Remarkable()%3B%0Amd.use(plugin%2C%20%7B%20useTailwind%3A%20true%20%7D)%3B%0A%2F%2F%20Create%20a%20mock%20rendered%20output%20with%20aria-hidden%20elements%0Aconst%20%7B%20applyCustomStyling%20%7D%20%3D%20require('.%2Futils')%3B%0Aconst%20mockHtml%20%3D%20'hidden%20content'%3B%0Areturn%20applyCustomStyling(mockHtml%2C%20%7B%20useTailwind%3A%20true%20%7D)%3B%0A%7D%2C%0A'Removes%20inline%20class%20and%20adds%20display%3Anone%20style'%3A%20function(topic)%20%7B%0Aassert.equal(topic.indexOf('class%3D%22inline%22')%2C%20-1)%3B%0Aassert.notEqual(topic.indexOf('style%3D%22display%3Anone%22')%2C%20-1)%3B%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">  <span class="hljs-string inline">&#x27;Aria-hidden processing with default styling&#x27;</span>: {
    <span class="hljs-title function_ inline">topic</span>(<span class="hljs-params inline"></span>) {
      <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
      md.<span class="hljs-title function_ inline">use</span>(plugin, { <span class="hljs-attr inline">useTailwind</span>: <span class="hljs-literal inline">false</span> });
      <span class="hljs-comment inline">// Create a mock rendered output with aria-hidden elements</span>
      <span class="hljs-keyword inline">const</span> { applyCustomStyling } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;./utils&#x27;</span>);
      <span class="hljs-keyword inline">const</span> mockHtml = <span class="hljs-string inline">&#x27;&lt;span class=&quot;inline&quot; aria-hidden=&quot;true&quot;&gt;hidden content&lt;/span&gt;&#x27;</span>;
      <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">applyCustomStyling</span>(mockHtml, { <span class="hljs-attr inline">useTailwind</span>: <span class="hljs-literal inline">false</span> });
    },
    <span class="hljs-string inline">&#x27;Removes inline class and adds display:none style&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;class=&quot;inline&quot;&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;style=&quot;display:none&quot;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  },
  <span class="hljs-string inline">&#x27;Aria-hidden processing with Tailwind styling&#x27;</span>: {
    <span class="hljs-title function_ inline">topic</span>(<span class="hljs-params inline"></span>) {
      <span class="hljs-keyword inline">const</span> md = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Remarkable</span>();
      md.<span class="hljs-title function_ inline">use</span>(plugin, { <span class="hljs-attr inline">useTailwind</span>: <span class="hljs-literal inline">true</span> });
      <span class="hljs-comment inline">// Create a mock rendered output with aria-hidden elements</span>
      <span class="hljs-keyword inline">const</span> { applyCustomStyling } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;./utils&#x27;</span>);
      <span class="hljs-keyword inline">const</span> mockHtml = <span class="hljs-string inline">&#x27;&lt;span class=&quot;inline&quot; aria-hidden=&quot;true&quot;&gt;hidden content&lt;/span&gt;&#x27;</span>;
      <span class="hljs-keyword inline">return</span> <span class="hljs-title function_ inline">applyCustomStyling</span>(mockHtml, { <span class="hljs-attr inline">useTailwind</span>: <span class="hljs-literal inline">true</span> });
    },
    <span class="hljs-string inline">&#x27;Removes inline class and adds display:none style&#x27;</span>: <span class="hljs-keyword inline">function</span>(<span class="hljs-params inline">topic</span>) {
      assert.<span class="hljs-title function_ inline">equal</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;class=&quot;inline&quot;&#x27;</span>), -<span class="hljs-number inline">1</span>);
      assert.<span class="hljs-title function_ inline">notEqual</span>(topic.<span class="hljs-title function_ inline">indexOf</span>(<span class="hljs-string inline">&#x27;style=&quot;display:none&quot;&#x27;</span>), -<span class="hljs-number inline">1</span>);
    }
  }
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第226-250行</strong>: 测试 aria-hidden 元素的样式处理：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>require('./utils')</code></strong>: 重新导入utils模块以直接测试applyCustomStyling函数</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">模拟HTML测试</strong>: 创建包含aria-hidden属性的测试HTML片段</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>applyCustomStyling(mockHtml, config)</code></strong>: 调用样式处理函数
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>mockHtml</code>: 模拟的KaTeX渲染HTML</li>
<li class="text-foreground leading-relaxed"><code>config</code>: 样式配置对象（包含useTailwind等选项）</li>
</ul></li>
<li class="text-foreground leading-relaxed">测试不同配置下的样式处理行为</li>
<li class="text-foreground leading-relaxed">验证可访问性改进：inline类被移除，display:none样式被添加</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%7D).export(module)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript">}).<span class="hljs-title function_ inline">export</span>(<span class="hljs-variable language_ inline">module</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">第251行</strong>: 导出测试套件模块。</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground"><code>.export(module)</code></strong>: vows测试框架方法，导出测试套件以便能够被测试运行器执行
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>module</code>: Node.js当前模块对象</li>
<li class="text-foreground leading-relaxed">这使得测试文件可以通过命令行工具运行</li>
</ul></li>
</ul>
<hr class="border-0 h-px bg-gray-300 my-8">
<h2 id="总结" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#总结" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 总结">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            总结
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">这个插件的核心功能包括：</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">灵活的分隔符支持</strong>: 支持自定义分隔符（默认为 $）</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">内联和块级支持</strong>: 同时支持 <code>$...$</code> (内联) 和 <code>$$...$$</code> (块级)</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">智能解析</strong>: 正确处理嵌套大括号和转义字符</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">错误处理</strong>: 不完整的表达式保持原文，无效的 LaTeX 显示错误而不崩溃</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">样式自定义</strong>: 支持 Tailwind CSS 和自定义样式处理</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">可访问性</strong>: 处理 aria-hidden 元素以改善可访问性</li>
</ol>
<h3 id="非标准库函数使用总结" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#非标准库函数使用总结" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 非标准库函数使用总结">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            非标准库函数使用总结
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">本插件主要依赖以下非JavaScript标准库的函数和API：</p>
<h4 id="nodejs-生态系统" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#nodejs-生态系统" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Node.js 生态系统">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Node.js 生态系统
        </h4>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">模块系统</strong>: <code>require()</code>, <code>module.exports</code> 用于模块的导入导出</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">断言库</strong>: <code>assert.*</code> 方法群用于测试验证</li>
</ul>
<h4 id="remarkable-markdown-处理器" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#remarkable-markdown-处理器" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Remarkable Markdown 处理器">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Remarkable Markdown 处理器
        </h4>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">解析器状态管理</strong>: <code>state.bMarks</code>, <code>state.tShift</code>, <code>state.eMarks</code> 等属性管理文本位置信息</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">文本处理方法</strong>: <code>state.skipChars()</code>, <code>state.skipSpaces()</code>, <code>state.getLines()</code> 等方法处理文本解析</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Token管理</strong>: <code>state.push()</code>, <code>state.tokens.push()</code> 用于创建语法树节点</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">插件注册</strong>: <code>md.inline.ruler.push()</code>, <code>md.block.ruler.push()</code> 注册解析规则</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">渲染系统</strong>: <code>md.renderer.rules.*</code> 定义HTML渲染逻辑</li>
</ul>
<h4 id="katex-数学渲染库" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#katex-数学渲染库" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to KaTeX 数学渲染库">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            KaTeX 数学渲染库
        </h4>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">核心渲染</strong>: <code>katex.renderToString()</code> 将LaTeX转换为HTML</li>
</ul>
<h4 id="vows-测试框架" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#vows-测试框架" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Vows 测试框架">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Vows 测试框架
        </h4>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">测试组织</strong>: <code>vows.describe()</code>, <code>.addBatch()</code>, <code>.export()</code> 构建测试结构</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">行为验证</strong>: 各种 assert 方法进行功能验证</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">测试覆盖了所有主要功能和边界情况，通过详细的函数级解析确保对插件架构和实现的深入理解。</p>
d:["$","$L1d",null,{"htmlContent":"$1e","frontMatter":{"title":"remarkable-katex-plus代码全解析","description":"详细解析remarkable-katex-plus插件代码","date":"2025-06-22","author":"MilkWind","tags":["代码解析","插件"],"references":{}},"readingTime":"40 min read","category":"plugins","tocItems":[{"id":"remarkable-katex-plus-插件代码解析","text":"Remarkable KaTeX Plus 插件代码解析","level":1},{"id":"概览","text":"概览","level":2},{"id":"依赖库函数说明","text":"依赖库函数说明","level":2},{"id":"nodejs-相关函数","text":"Node.js 相关函数","level":3},{"id":"katex-库函数","text":"KaTeX 库函数","level":3},{"id":"remarkable-解析器状态对象属性","text":"Remarkable 解析器状态对象属性","level":3},{"id":"remarkable-解析器状态方法","text":"Remarkable 解析器状态方法","level":3},{"id":"remarkable-插件api","text":"Remarkable 插件API","level":3},{"id":"测试框架函数","text":"测试框架函数","level":3},{"id":"indexjs-代码逐行解析","text":"index.js 代码逐行解析","level":2},{"id":"文件开头和模块声明","text":"文件开头和模块声明","level":3},{"id":"基础配置和变量声明","text":"基础配置和变量声明","level":3},{"id":"工具模块导入和样式配置","text":"工具模块导入和样式配置","level":3},{"id":"katex-渲染函数","text":"KaTeX 渲染函数","level":3},{"id":"块级-katex-解析函数","text":"块级 KaTeX 解析函数","level":3},{"id":"内联-katex-解析函数","text":"内联 KaTeX 解析函数","level":3},{"id":"插件注册","text":"插件注册","level":3},{"id":"indextestjs-代码逐行解析","text":"index.test.js 代码逐行解析","level":2},{"id":"测试文件头部","text":"测试文件头部","level":3},{"id":"测试实例准备","text":"测试实例准备","level":3},{"id":"测试套件开始","text":"测试套件开始","level":3},{"id":"配置测试","text":"配置测试","level":3},{"id":"基础文本渲染测试","text":"基础文本渲染测试","level":3},{"id":"内联数学公式测试","text":"内联数学公式测试","level":3},{"id":"块级数学公式测试","text":"块级数学公式测试","level":3},{"id":"自定义分隔符测试","text":"自定义分隔符测试","level":3},{"id":"错误处理测试","text":"错误处理测试","level":3},{"id":"内容清理测试","text":"内容清理测试","level":3},{"id":"katex-注释保留测试","text":"KaTeX 注释保留测试","level":3},{"id":"多个表达式测试","text":"多个表达式测试","level":3},{"id":"混合表达式测试","text":"混合表达式测试","level":3},{"id":"错误处理配置测试","text":"错误处理配置测试","level":3},{"id":"配置选项测试","text":"配置选项测试","level":3},{"id":"样式处理测试","text":"样式处理测试","level":3},{"id":"总结","text":"总结","level":2},{"id":"非标准库函数使用总结","text":"非标准库函数使用总结","level":3},{"id":"nodejs-生态系统","text":"Node.js 生态系统","level":4},{"id":"remarkable-markdown-处理器","text":"Remarkable Markdown 处理器","level":4},{"id":"katex-数学渲染库","text":"KaTeX 数学渲染库","level":4},{"id":"vows-测试框架","text":"Vows 测试框架","level":4}],"translations":{"common":{"welcome":"欢迎","loading":"加载中...","error":"出现了一些问题","retry":"重试","theme":"主题","language":"语言","light":"浅色","dark":"深色"},"navigation":{"home":"首页","personal":"个人","works":"作品","contributions":"贡献","documents":"文档","about":"关于","contact":"联系"},"personal":{"technicalSkills":"技术技能","email":"邮箱","github":"代码仓库","resume":"简历","codeRepository":"代码仓库","loadingPersonalInfo":"加载个人信息中...","loadingResume":"加载简历中...","closeResume":"关闭简历","emailCopied":"邮箱已复制到剪贴板！","galaxyDefaultDescription":"精通全栈开发技术，具备跨平台架构能力，擅长AI技术整合与高性能系统优化","skillGalaxy":"技能星系","stirGalaxy":"搅动星系","stirring":"搅动中...","fullStackEngineer":"MilkWind - 全栈工程师","professionalProfile":"关于我"},"documents":{"technicalDocuments":"技术文档","description":"基本原理、代码拆分以及一些碎碎念。","articles":"文章","categories":"分类","allCategories":"所有分类","noArticlesFound":"未找到文章","noArticlesAvailable":"中文暂无文章。","noArticlesInCategory":"该分类下未找到文章。","readMore":"阅读更多","loadingDocuments":"加载文档中...","backToDocuments":"← 返回文档","documentNotFound":"文档未找到","documentNotFoundDescription":"请求的文档无法找到。","technicalInsights":"技术拆解","untitledDocument":"无标题文档","byAuthor":"作者：","search":"搜索文章...","searchByTags":"按标签筛选","searching":"搜索中...","noSearchResults":"没有找到符合搜索条件的文章","clearSearch":"清除搜索","selectedTags":"已选标签","allTags":"所有标签","searchInTitle":"在标题、描述和内容中搜索","enterImmersiveMode":"沉浸阅读","exitImmersiveMode":"退出沉浸模式","immersiveReading":"沉浸阅读模式","exploreContent":"按分类探索内容","browseBy":"浏览方式","exploreAll":"所有内容汇总","categoryDescription":"该分类下的文章","totalArticles":"文章","totalCategories":"分类","foundArticles":"找到文章","categoriesWithResults":"有结果的分类"},"works":{"workCases":"作品案例","projects":"作品集","loadingProjects":"加载项目中...","grid":"网格","stack":"堆叠","of":"共","workCasesPageTitle":"作品案例页面","pageWorkingCorrectly":"此页面运行正常！路由配置正确。","try3DVersion":"尝试3D版本","dragToScroll":"拖拽滚动","dragToChange":"拖拽切换","swipeCards":"切换卡片","keyboardNav":"键盘导航"},"contributions":{"contributionCases":"开源项目","contributions":"贡献","loadingContributions":"加载贡献中...","grid":"网格","stack":"堆叠","of":"共","contributionCasesPageTitle":"贡献案例页面","pageWorkingCorrectly":"此页面运行正常！路由配置正确。","try3DVersion":"尝试3D版本","dragToScroll":"拖拽滚动","dragToChange":"拖拽切换","swipeCards":"切换卡片","keyboardNav":"键盘导航"},"contribution":{"contributionPreview":"贡献预览","accessible":"可访问","code":"代码","maintenance":"维护","enhancement":"增强","documentation":"文档","community":"社区","moreItems":"更多","technicalDetails":"技术详情","technologies":"技术栈：","contributionDetail":"贡献详情","description":"描述：","seeDetails":"查看详情","github":"代码仓库","viewContribution":"查看贡献","viewCode":"查看代码"},"project":{"projectPreview":"项目预览","accessible":"可访问","tool":"工具","plugin":"插件","toy":"小玩意","moreItems":"更多","technicalDetails":"技术详情","technologies":"技术栈：","description":"描述：","seeDetails":"查看详情","github":"GitHub","gitee":"Gitee","viewLiveDemo":"查看演示","viewCode":"查看代码","access":"访问","videos":"视频","watchVideo":"观看视频","hasVideo":"有视频"},"codeblock":{"copy":"复制","copySuccess":"代码已复制到剪贴板！","copyError":"复制代码失败","copyTooltip":"复制代码"},"toc":{"contents":"目录","autoScroll":"自动滚动到章节","collapse":"折叠","expand":"展开"},"loading":{"loading":"加载中","preparingExperience":"准备体验中"}},"lang":"zh","theme":"light"}]
12:null
18:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
11:null
1c:{"metadata":[["$","title","0",{"children":"remarkable-katex-plus代码全解析 | Interactive Portfolio"}],["$","meta","1",{"name":"description","content":"详细解析remarkable-katex-plus插件代码"}],["$","meta","2",{"name":"author","content":"Developer"}],["$","meta","3",{"name":"keywords","content":"portfolio,3D,interactive,web development,Three.js,Next.js"}],["$","meta","4",{"property":"og:title","content":"remarkable-katex-plus代码全解析 | Interactive Portfolio"}],["$","meta","5",{"property":"og:description","content":"详细解析remarkable-katex-plus插件代码"}],["$","meta","6",{"property":"og:type","content":"article"}],["$","meta","7",{"property":"article:published_time","content":"2025-06-22"}],["$","meta","8",{"property":"article:tag","content":"代码解析"}],["$","meta","9",{"property":"article:tag","content":"插件"}],["$","meta","10",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","11",{"name":"twitter:title","content":"remarkable-katex-plus代码全解析 | Interactive Portfolio"}],["$","meta","12",{"name":"twitter:description","content":"详细解析remarkable-katex-plus插件代码"}],["$","link","13",{"rel":"icon","href":"/MilkWind-Website/favicon.ico","type":"image/x-icon","sizes":"32x32"}]],"error":null,"digest":"$undefined"}
14:{"metadata":"$1c:metadata","error":null,"digest":"$undefined"}
