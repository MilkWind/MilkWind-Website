<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/f034c804622acb16.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b226d7ef8e491b72.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5eacd01f773eed7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-18c0f30037e967de.js"/><script src="/_next/static/chunks/4bd1b696-5119e10e90c1bd1b.js" async=""></script><script src="/_next/static/chunks/1684-be5e4efdb509cc75.js" async=""></script><script src="/_next/static/chunks/main-app-c5f95d71e93250dc.js" async=""></script><script src="/_next/static/chunks/46-72724587da45cdb8.js" async=""></script><script src="/_next/static/chunks/app/layout-af4a6e723c0ff668.js" async=""></script><script src="/_next/static/chunks/app/error-dda32be1d095a86c.js" async=""></script><script src="/_next/static/chunks/6874-fbe9a08eb79b991c.js" async=""></script><script src="/_next/static/chunks/app/not-found-9ff98b2ccf24cac7.js" async=""></script><script src="/_next/static/chunks/206-4f4cbf4d7156f437.js" async=""></script><script src="/_next/static/chunks/app/documents/layout-28408791defde09e.js" async=""></script><script src="/_next/static/chunks/2415-689c103fb3d2c28d.js" async=""></script><script src="/_next/static/chunks/8610-7bd3f91f3cf2a4d6.js" async=""></script><script src="/_next/static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js" async=""></script><script src="/_next/static/chunks/app/loading-68f227fb49b3ac8c.js" async=""></script><script src="/_next/static/chunks/b498d07c-095637f0f10883c6.js" async=""></script><script src="/_next/static/chunks/9554-b714f9de28e85d30.js" async=""></script><script src="/_next/static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js" async=""></script><title>requestAnimationFrame | Interactive Portfolio</title><meta name="description" content="浏览器基础知识篇-requestAnimationFrame"/><meta name="author" content="Developer"/><meta name="keywords" content="portfolio,3D,interactive,web development,Three.js,Next.js"/><meta property="og:title" content="requestAnimationFrame | Interactive Portfolio"/><meta property="og:description" content="浏览器基础知识篇-requestAnimationFrame"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-06-22"/><meta property="article:tag" content="浏览器"/><meta property="article:tag" content="基础知识"/><meta property="article:tag" content="requestAnimationFrame"/><meta property="article:tag" content="动画"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="requestAnimationFrame | Interactive Portfolio"/><meta name="twitter:description" content="浏览器基础知识篇-requestAnimationFrame"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_d4c88d __variable_7b4e2b __variable_c3272d font-sans antialiased min-h-screen bg-background text-foreground"><div class="fixed inset-0 w-full h-full overflow-hidden pointer-events-none z-0" style="background:linear-gradient(135deg, hsl(210, 80%, 60%), hsl(180, 40%, 50%))"></div><div class="fixed top-20 right-5 z-50"><div class="w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40"></div></div><!--$--><style>
:root {
  --bprogress-color: #0066cc;
  --bprogress-height: 4px;
  --bprogress-spinner-size: 18px;
  --bprogress-spinner-animation-duration: 400ms;
  --bprogress-spinner-border-size: 2px;
  --bprogress-box-shadow: 0 0 10px #0066cc, 0 0 5px #0066cc;
  --bprogress-z-index: 99999;
  --bprogress-spinner-top: 15px;
  --bprogress-spinner-bottom: auto;
  --bprogress-spinner-right: 15px;
  --bprogress-spinner-left: auto;
}

.bprogress {
  width: 0;
  height: 0;
  pointer-events: none;
  z-index: var(--bprogress-z-index);
}

.bprogress .bar {
  background: var(--bprogress-color);
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
}

/* Fancy blur effect */
.bprogress .peg {
  display: block;
  position: absolute;
  right: 0;
  width: 100px;
  height: 100%;
  box-shadow: var(--bprogress-box-shadow);
  opacity: 1.0;
  transform: rotate(3deg) translate(0px, -4px);
}

/* Remove these to get rid of the spinner */
.bprogress .spinner {
  display: block;
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: var(--bprogress-spinner-top);
  bottom: var(--bprogress-spinner-bottom);
  right: var(--bprogress-spinner-right);
  left: var(--bprogress-spinner-left);
}

.bprogress .spinner-icon {
  width: var(--bprogress-spinner-size);
  height: var(--bprogress-spinner-size);
  box-sizing: border-box;
  border: solid var(--bprogress-spinner-border-size) transparent;
  border-top-color: var(--bprogress-color);
  border-left-color: var(--bprogress-color);
  border-radius: 50%;
  -webkit-animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
  animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
}

.bprogress-custom-parent {
  overflow: hidden;
  position: relative;
}

.bprogress-custom-parent .bprogress .spinner,
.bprogress-custom-parent .bprogress .bar {
  position: absolute;
}

.bprogress .indeterminate {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
  overflow: hidden;
}

.bprogress .indeterminate .inc,
.bprogress .indeterminate .dec {
  position: absolute;
  top: 0;
  height: 100%;
  background-color: var(--bprogress-color);
}

.bprogress .indeterminate .inc {
  animation: bprogress-indeterminate-increase 2s infinite;
}

.bprogress .indeterminate .dec {
  animation: bprogress-indeterminate-decrease 2s 0.5s infinite;
}

@-webkit-keyframes bprogress-spinner {
  0%   { -webkit-transform: rotate(0deg); transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }
}

@keyframes bprogress-spinner {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes bprogress-indeterminate-increase {
  from { left: -5%; width: 5%; }
  to { left: 130%; width: 100%; }
}

@keyframes bprogress-indeterminate-decrease {
  from { left: -80%; width: 80%; }
  to { left: 110%; width: 10%; }
}
</style><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><!--$--><div class="relative z-30 min-h-screen bg-background "><div class="container mx-auto px-4 py-8 max-w-4xl"><div class="mb-8"><a class="inline-flex items-center text-primary hover:text-primary/80 transition-colors" href="/documents/">documents.backToDocuments</a></div><header class="mb-12"><div class="flex items-center gap-4 mb-4 text-sm text-foreground/60"><span class="px-3 py-1 bg-primary/20 text-primary rounded-full capitalize">basic knowledge</span><span>10 min read</span></div><h1 class="font-bold mb-4 bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent text-4xl md:text-5xl">requestAnimationFrame</h1><p class="text-xl text-foreground/80 max-w-3xl">浏览器基础知识篇-requestAnimationFrame</p><div class="flex flex-wrap gap-2 mt-6"><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">浏览器</span><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">基础知识</span><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">requestAnimationFrame</span><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">动画</span></div></header><article class="prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-foreground prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg max-w-none "><div class="prose-pre:p-4 prose-pre:bg-surface w-full"><p class="text-base leading-7 mb-4 text-foreground"><code>requestAnimationFrame</code> 是浏览器提供的原生 API，用于创建平滑的动画效果。它会在下一次重绘之前调用指定的回调函数，确保动画与浏览器的刷新率保持同步。</p>
<h3 id="基本作用" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#基本作用" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 基本作用">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">基本作用</strong>
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><code>requestAnimationFrame</code> 的主要作用是：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">在浏览器下一次重绘前执行动画函数</li>
<li class="text-foreground leading-relaxed">与显示器刷新率同步（通常是 60fps）</li>
<li class="text-foreground leading-relaxed">当页面不可见时自动暂停，节省性能</li>
<li class="text-foreground leading-relaxed">提供更流畅的动画体验</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="function%20animate()%20%7B%0A%2F%2F%20%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0Aconsole.log('%E6%89%A7%E8%A1%8C%E5%8A%A8%E7%94%BB%E5%B8%A7')%3B%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0ArequestAnimationFrame(animate)%3B%0A%7D%0A%2F%2F%20%E5%BC%80%E5%A7%8B%E5%8A%A8%E7%94%BB%0ArequestAnimationFrame(animate)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">animate</span>(<span class="hljs-params inline"></span>) {
  <span class="hljs-comment inline">// 动画逻辑</span>
  <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;执行动画帧&#x27;</span>);
  
  <span class="hljs-comment inline">// 请求下一帧</span>
  <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
}

<span class="hljs-comment inline">// 开始动画</span>
<span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
</code></pre>
            </div>
        
<h3 id="基本用法" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#基本用法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 基本用法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">基本用法</strong>
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="function%20animate(timestamp)%20%7B%0A%2F%2F%20timestamp%3A%20%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E6%88%B3%EF%BC%88%E6%AF%AB%E7%A7%92%EF%BC%89%0Aconsole.log('%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%3A'%2C%20timestamp)%3B%0A%2F%2F%20%E6%89%A7%E8%A1%8C%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0Aelement.style.left%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%20%2B%20'px'%3B%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0ArequestAnimationFrame(animate)%3B%0A%7D%0A%2F%2F%20%E5%90%AF%E5%8A%A8%E5%8A%A8%E7%94%BB%0Aconst%20animationId%20%3D%20requestAnimationFrame(animate)%3B%0A%2F%2F%20%E5%8F%96%E6%B6%88%E5%8A%A8%E7%94%BB%0AcancelAnimationFrame(animationId)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">animate</span>(<span class="hljs-params inline">timestamp</span>) {
  <span class="hljs-comment inline">// timestamp: 当前时间戳（毫秒）</span>
  <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;当前时间:&#x27;</span>, timestamp);
  
  <span class="hljs-comment inline">// 执行动画逻辑</span>
  element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(timestamp / <span class="hljs-number inline">1000</span>) * <span class="hljs-number inline">100</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>;
  
  <span class="hljs-comment inline">// 请求下一帧</span>
  <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
}

<span class="hljs-comment inline">// 启动动画</span>
<span class="hljs-keyword inline">const</span> animationId = <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);

<span class="hljs-comment inline">// 取消动画</span>
<span class="hljs-title function_ inline">cancelAnimationFrame</span>(animationId);
</code></pre>
            </div>
        
<h3 id="工作原理与常见问题" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#工作原理与常见问题" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 工作原理与常见问题">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            工作原理与常见问题
        </h3>
<h4 id="为什么一般在使用requestanimationframe函数的时候，都是递归调用？" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#为什么一般在使用requestanimationframe函数的时候，都是递归调用？" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 为什么一般在使用requestAnimationFrame函数的时候，都是递归调用？">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            为什么一般在使用requestAnimationFrame函数的时候，都是递归调用？
        </h4>
<p class="text-base leading-7 mb-4 text-foreground"><code>requestAnimationFrame</code>采用递归调用是因为它本质上是一次性的：每次调用只会在下一次重绘前执行一次回调函数。为了创建连续的动画效果，需要在每次回调结束时再次请求下一帧，形成递归调用的模式。这种方式能确保动画帧与浏览器重绘节奏精确同步。</p>
<h4 id="持续性递归调用requestanimationframe难道不会导致栈溢出吗？" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#持续性递归调用requestanimationframe难道不会导致栈溢出吗？" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 持续性递归调用requestAnimationFrame难道不会导致栈溢出吗？">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            持续性递归调用requestAnimationFrame难道不会导致栈溢出吗？
        </h4>
<p class="text-base leading-7 mb-4 text-foreground">不会导致栈溢出。因为<code>requestAnimationFrame</code>的回调函数是在当前执行栈为空时，由浏览器的事件循环机制调度执行的，属于异步执行模式。每次调用后，回调函数会在浏览器下一次重绘前被触发，而触发时上一次的函数调用栈已经执行完毕并释放，因此调用栈不会无限增长。</p>
<h4 id="什么是浏览器的重绘任务队列？" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#什么是浏览器的重绘任务队列？" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 什么是浏览器的重绘任务队列？">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            什么是浏览器的重绘任务队列？
        </h4>
<p class="text-base leading-7 mb-4 text-foreground">浏览器的重绘任务队列是用于管理视觉更新操作的任务队列。当DOM或CSS发生变化需要更新屏幕时，这些更新操作会被加入重绘队列。浏览器会定期（通常与显示器刷新率同步）从队列中取出任务执行，以确保视觉更新的流畅性。</p>
<h4 id="requestanimationframe是如何确保与浏览器刷新率同步的？" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#requestanimationframe是如何确保与浏览器刷新率同步的？" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to requestAnimationFrame是如何确保与浏览器刷新率同步的？">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            requestAnimationFrame是如何确保与浏览器刷新率同步的？
        </h4>
<p class="text-base leading-7 mb-4 text-foreground">浏览器会以自身的刷新率（通常是 60Hz，即每秒 60 次）定期触发重绘，以更新页面显示。<code>requestAnimationFrame</code> 的回调函数会被加入浏览器的<strong class="font-bold text-foreground">重绘任务队列</strong>，在下一次重绘前执行，因此天然与重绘频率对齐。</p>
<p class="text-base leading-7 mb-4 text-foreground">同时，浏览器会根据设备性能或页面状态（如切换到后台时）调整刷新率（例如降为 30Hz），<code>requestAnimationFrame</code> 会自动适配这种变化，回调触发频率会随浏览器实际重绘频率同步改变，无需手动干预。</p>
<h3 id="与传统方案的对比" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#与传统方案的对比" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 与传统方案的对比">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">与传统方案的对比</strong>
        </h3>
<h4 id="settimeoutsetinterval-的问题" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#settimeoutsetinterval-的问题" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to setTimeout/setInterval 的问题">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">setTimeout/setInterval 的问题</strong>
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%EF%BC%9A%E4%BD%BF%E7%94%A8%20setTimeout%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89%0Afunction%20animateWithTimeout()%20%7B%0Aelement.style.left%20%3D%20parseInt(element.style.left%20%7C%7C%200)%20%2B%201%20%2B%20'px'%3B%0AsetTimeout(animateWithTimeout%2C%2016)%3B%20%2F%2F%20%E7%BA%A6%2060fps%0A%7D%0A%2F%2F%20%E9%97%AE%E9%A2%98%EF%BC%9A%0A%2F%2F%201.%20%E4%B8%8D%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E5%88%B7%E6%96%B0%E7%8E%87%E5%90%8C%E6%AD%A5%0A%2F%2F%202.%20%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%97%B6%E4%BB%8D%E7%84%B6%E6%89%A7%E8%A1%8C%0A%2F%2F%203.%20%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E4%B8%A2%E5%B8%A7%E6%88%96%E5%8D%A1%E9%A1%BF">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 传统方式：使用 setTimeout（不推荐）</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">animateWithTimeout</span>(<span class="hljs-params inline"></span>) {
  element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = <span class="hljs-built_in inline">parseInt</span>(element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> || <span class="hljs-number inline">0</span>) + <span class="hljs-number inline">1</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>;
  <span class="hljs-built_in inline">setTimeout</span>(animateWithTimeout, <span class="hljs-number inline">16</span>); <span class="hljs-comment inline">// 约 60fps</span>
}

<span class="hljs-comment inline">// 问题：</span>
<span class="hljs-comment inline">// 1. 不与浏览器刷新率同步</span>
<span class="hljs-comment inline">// 2. 页面不可见时仍然执行</span>
<span class="hljs-comment inline">// 3. 可能导致丢帧或卡顿</span>
</code></pre>
            </div>
        
<h4 id="requestanimationframe-的优势" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#requestanimationframe-的优势" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to requestAnimationFrame 的优势">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">requestAnimationFrame 的优势</strong>
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E7%8E%B0%E4%BB%A3%E6%96%B9%E5%BC%8F%EF%BC%9A%E4%BD%BF%E7%94%A8%20requestAnimationFrame%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89%0Afunction%20animateWithRAF(timestamp)%20%7B%0Aelement.style.left%20%3D%20parseInt(element.style.left%20%7C%7C%200)%20%2B%201%20%2B%20'px'%3B%0ArequestAnimationFrame(animateWithRAF)%3B%0A%7D%0A%2F%2F%20%E4%BC%98%E5%8A%BF%EF%BC%9A%0A%2F%2F%201.%20%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E5%88%B7%E6%96%B0%E7%8E%87%E5%90%8C%E6%AD%A5%0A%2F%2F%202.%20%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%97%B6%E8%87%AA%E5%8A%A8%E6%9A%82%E5%81%9C%0A%2F%2F%203.%20%E6%9B%B4%E5%A5%BD%E7%9A%84%E6%80%A7%E8%83%BD%E5%92%8C%E7%94%B5%E6%B1%A0%E7%BB%AD%E8%88%AA">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 现代方式：使用 requestAnimationFrame（推荐）</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">animateWithRAF</span>(<span class="hljs-params inline">timestamp</span>) {
  element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = <span class="hljs-built_in inline">parseInt</span>(element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> || <span class="hljs-number inline">0</span>) + <span class="hljs-number inline">1</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>;
  <span class="hljs-title function_ inline">requestAnimationFrame</span>(animateWithRAF);
}

<span class="hljs-comment inline">// 优势：</span>
<span class="hljs-comment inline">// 1. 与浏览器刷新率同步</span>
<span class="hljs-comment inline">// 2. 页面不可见时自动暂停</span>
<span class="hljs-comment inline">// 3. 更好的性能和电池续航</span>
</code></pre>
            </div>
        
<h3 id="实用示例" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#实用示例" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 实用示例">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">实用示例</strong>
        </h3>
<h4 id="简单的移动动画" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#简单的移动动画" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 简单的移动动画">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">简单的移动动画</strong>
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="class%20Animator%20%7B%0Aconstructor(element)%20%7B%0Athis.element%20%3D%20element%3B%0Athis.isRunning%20%3D%20false%3B%0Athis.animationId%20%3D%20null%3B%0A%7D%0Astart()%20%7B%0Aif%20(this.isRunning)%20return%3B%0Athis.isRunning%20%3D%20true%3B%0Athis.animate()%3B%0A%7D%0Astop()%20%7B%0Athis.isRunning%20%3D%20false%3B%0Aif%20(this.animationId)%20%7B%0AcancelAnimationFrame(this.animationId)%3B%0A%7D%0A%7D%0Aanimate%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!this.isRunning)%20return%3B%0A%2F%2F%20%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0Aconst%20x%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20200%3B%0Athis.element.style.transform%20%3D%20%60translateX(%24%7Bx%7Dpx)%60%3B%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0Athis.animationId%20%3D%20requestAnimationFrame(this.animate)%3B%0A%7D%0A%7D%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%0Aconst%20element%20%3D%20document.getElementById('myElement')%3B%0Aconst%20animator%20%3D%20new%20Animator(element)%3B%0Aanimator.start()%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">class</span> <span class="hljs-title class_ inline">Animator</span> {
  <span class="hljs-title function_ inline">constructor</span>(<span class="hljs-params inline">element</span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">element</span> = element;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span> = <span class="hljs-literal inline">false</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span> = <span class="hljs-literal inline">null</span>;
  }

  <span class="hljs-title function_ inline">start</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span>) <span class="hljs-keyword inline">return</span>;
    
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span> = <span class="hljs-literal inline">true</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">animate</span>();
  }

  <span class="hljs-title function_ inline">stop</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span> = <span class="hljs-literal inline">false</span>;
    <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span>) {
      <span class="hljs-title function_ inline">cancelAnimationFrame</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span>);
    }
  }

  animate = <span class="hljs-function inline">(<span class="hljs-params inline">timestamp</span>) =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span>) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-comment inline">// 动画逻辑</span>
    <span class="hljs-keyword inline">const</span> x = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(timestamp / <span class="hljs-number inline">1000</span>) * <span class="hljs-number inline">200</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">element</span>.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">transform</span> = <span class="hljs-string inline">`translateX(<span class="hljs-subst inline">${x}</span>px)`</span>;

    <span class="hljs-comment inline">// 请求下一帧</span>
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span> = <span class="hljs-title function_ inline">requestAnimationFrame</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animate</span>);
  }
}

<span class="hljs-comment inline">// 使用示例</span>
<span class="hljs-keyword inline">const</span> element = <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">getElementById</span>(<span class="hljs-string inline">&#x27;myElement&#x27;</span>);
<span class="hljs-keyword inline">const</span> animator = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Animator</span>(element);
animator.<span class="hljs-title function_ inline">start</span>();
</code></pre>
            </div>
        
<h4 id="时间控制的动画" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#时间控制的动画" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 时间控制的动画">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">时间控制的动画</strong>
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="class%20TimedAnimation%20%7B%0Aconstructor(element%2C%20duration%20%3D%202000)%20%7B%0Athis.element%20%3D%20element%3B%0Athis.duration%20%3D%20duration%3B%0Athis.startTime%20%3D%20null%3B%0A%7D%0Astart()%20%7B%0Athis.startTime%20%3D%20null%3B%0Athis.animate()%3B%0A%7D%0Aanimate%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!this.startTime)%20%7B%0Athis.startTime%20%3D%20timestamp%3B%0A%7D%0Aconst%20elapsed%20%3D%20timestamp%20-%20this.startTime%3B%0Aconst%20progress%20%3D%20Math.min(elapsed%20%2F%20this.duration%2C%201)%3B%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%BC%93%E5%8A%A8%E5%87%BD%E6%95%B0%0Aconst%20easeProgress%20%3D%20this.easeInOutQuad(progress)%3B%0A%2F%2F%20%E5%BA%94%E7%94%A8%E5%8A%A8%E7%94%BB%0Athis.element.style.transform%20%3D%20%60translateX(%24%7BeaseProgress%20*%20300%7Dpx)%60%3B%0A%2F%2F%20%E7%BB%A7%E7%BB%AD%E5%8A%A8%E7%94%BB%E6%88%96%E7%BB%93%E6%9D%9F%0Aif%20(progress%201)%20%7B%0ArequestAnimationFrame(this.animate)%3B%0A%7D%20else%20%7B%0Aconsole.log('%E5%8A%A8%E7%94%BB%E5%AE%8C%E6%88%90')%3B%0A%7D%0A%7D%0AeaseInOutQuad(t)%20%7B%0Areturn%20t%200.5%20%3F%202%20*%20t%20*%20t%20%3A%20-1%20%2B%20(4%20-%202%20*%20t)%20*%20t%3B%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">class</span> <span class="hljs-title class_ inline">TimedAnimation</span> {
  <span class="hljs-title function_ inline">constructor</span>(<span class="hljs-params inline">element, duration = <span class="hljs-number inline">2000</span></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">element</span> = element;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">duration</span> = duration;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">startTime</span> = <span class="hljs-literal inline">null</span>;
  }

  <span class="hljs-title function_ inline">start</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">startTime</span> = <span class="hljs-literal inline">null</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">animate</span>();
  }

  animate = <span class="hljs-function inline">(<span class="hljs-params inline">timestamp</span>) =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">startTime</span>) {
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">startTime</span> = timestamp;
    }

    <span class="hljs-keyword inline">const</span> elapsed = timestamp - <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">startTime</span>;
    <span class="hljs-keyword inline">const</span> progress = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(elapsed / <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">duration</span>, <span class="hljs-number inline">1</span>);

    <span class="hljs-comment inline">// 使用缓动函数</span>
    <span class="hljs-keyword inline">const</span> easeProgress = <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">easeInOutQuad</span>(progress);
    
    <span class="hljs-comment inline">// 应用动画</span>
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">element</span>.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">transform</span> = <span class="hljs-string inline">`translateX(<span class="hljs-subst inline">${easeProgress * <span class="hljs-number inline">300</span>}</span>px)`</span>;

    <span class="hljs-comment inline">// 继续动画或结束</span>
    <span class="hljs-keyword inline">if</span> (progress &lt; <span class="hljs-number inline">1</span>) {
      <span class="hljs-title function_ inline">requestAnimationFrame</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animate</span>);
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;动画完成&#x27;</span>);
    }
  }

  <span class="hljs-title function_ inline">easeInOutQuad</span>(<span class="hljs-params inline">t</span>) {
    <span class="hljs-keyword inline">return</span> t &lt; <span class="hljs-number inline">0.5</span> ? <span class="hljs-number inline">2</span> * t * t : -<span class="hljs-number inline">1</span> + (<span class="hljs-number inline">4</span> - <span class="hljs-number inline">2</span> * t) * t;
  }
}
</code></pre>
            </div>
        
<h3 id="性能优化技巧" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#性能优化技巧" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 性能优化技巧">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">性能优化技巧</strong>
        </h3>
<h4 id="避免强制重排（forced-reflow）" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#避免强制重排（forced-reflow）" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 避免强制重排（Forced Reflow）">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">避免强制重排（Forced Reflow）</strong>
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E4%B8%8D%E5%A5%BD%E7%9A%84%E5%81%9A%E6%B3%95%EF%BC%9A%E5%A4%9A%E6%AC%A1%E8%AF%BB%E5%8F%96%2F%E5%86%99%E5%85%A5%E6%A0%B7%E5%BC%8F%0Afunction%20badAnimate()%20%7B%0Aelement1.style.left%20%3D%20element1.offsetLeft%20%2B%201%20%2B%20'px'%3B%20%2F%2F%20%E8%AF%BB%E5%8F%96%E8%A7%A6%E5%8F%91%E9%87%8D%E6%8E%92%0Aelement2.style.left%20%3D%20element2.offsetLeft%20%2B%201%20%2B%20'px'%3B%20%2F%2F%20%E5%86%8D%E6%AC%A1%E8%A7%A6%E5%8F%91%E9%87%8D%E6%8E%92%0A%7D%0A%2F%2F%20%E5%A5%BD%E7%9A%84%E5%81%9A%E6%B3%95%EF%BC%9A%E6%89%B9%E9%87%8F%E5%A4%84%E7%90%86%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C%0Afunction%20goodAnimate()%20%7B%0A%2F%2F%20%E5%85%88%E8%AF%BB%E5%8F%96%E6%89%80%E6%9C%89%E9%9C%80%E8%A6%81%E7%9A%84%E5%80%BC%0Aconst%20left1%20%3D%20element1.offsetLeft%3B%0Aconst%20left2%20%3D%20element2.offsetLeft%3B%0A%2F%2F%20%E5%86%8D%E6%89%B9%E9%87%8F%E5%86%99%E5%85%A5%0Aelement1.style.left%20%3D%20left1%20%2B%201%20%2B%20'px'%3B%0Aelement2.style.left%20%3D%20left2%20%2B%201%20%2B%20'px'%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 不好的做法：多次读取/写入样式</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">badAnimate</span>(<span class="hljs-params inline"></span>) {
  element1.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = element1.<span class="hljs-property inline">offsetLeft</span> + <span class="hljs-number inline">1</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>; <span class="hljs-comment inline">// 读取触发重排</span>
  element2.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = element2.<span class="hljs-property inline">offsetLeft</span> + <span class="hljs-number inline">1</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>; <span class="hljs-comment inline">// 再次触发重排</span>
}

<span class="hljs-comment inline">// 好的做法：批量处理样式操作</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">goodAnimate</span>(<span class="hljs-params inline"></span>) {
  <span class="hljs-comment inline">// 先读取所有需要的值</span>
  <span class="hljs-keyword inline">const</span> left1 = element1.<span class="hljs-property inline">offsetLeft</span>;
  <span class="hljs-keyword inline">const</span> left2 = element2.<span class="hljs-property inline">offsetLeft</span>;
  
  <span class="hljs-comment inline">// 再批量写入</span>
  element1.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = left1 + <span class="hljs-number inline">1</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>;
  element2.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = left2 + <span class="hljs-number inline">1</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>;
}
</code></pre>
            </div>
        
<h4 id="使用-css-变换代替位置改变" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#使用-css-变换代替位置改变" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 使用 CSS 变换代替位置改变">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">使用 CSS 变换代替位置改变</strong>
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%80%A7%E8%83%BD%E8%BE%83%E5%B7%AE%EF%BC%9A%E6%94%B9%E5%8F%98%20left%2Ftop%0Afunction%20slowAnimate(timestamp)%20%7B%0Aelement.style.left%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%20%2B%20'px'%3B%0A%7D%0A%2F%2F%20%E6%80%A7%E8%83%BD%E6%9B%B4%E5%A5%BD%EF%BC%9A%E4%BD%BF%E7%94%A8%20transform%0Afunction%20fastAnimate(timestamp)%20%7B%0Aconst%20x%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%3B%0Aelement.style.transform%20%3D%20%60translateX(%24%7Bx%7Dpx)%60%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 性能较差：改变 left/top</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">slowAnimate</span>(<span class="hljs-params inline">timestamp</span>) {
  element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">left</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(timestamp / <span class="hljs-number inline">1000</span>) * <span class="hljs-number inline">100</span> + <span class="hljs-string inline">&#x27;px&#x27;</span>;
}

<span class="hljs-comment inline">// 性能更好：使用 transform</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">fastAnimate</span>(<span class="hljs-params inline">timestamp</span>) {
  <span class="hljs-keyword inline">const</span> x = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(timestamp / <span class="hljs-number inline">1000</span>) * <span class="hljs-number inline">100</span>;
  element.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">transform</span> = <span class="hljs-string inline">`translateX(<span class="hljs-subst inline">${x}</span>px)`</span>;
}
</code></pre>
            </div>
        
<h3 id="react-中的使用" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#react-中的使用" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to React 中的使用">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">React 中的使用</strong>
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="jsx" data-code="import%20React%2C%20%7B%20useEffect%2C%20useRef%2C%20useState%20%7D%20from%20'react'%3B%0Afunction%20AnimatedComponent()%20%7B%0Aconst%20elementRef%20%3D%20useRef(null)%3B%0Aconst%20animationRef%20%3D%20useRef(null)%3B%0Aconst%20%5BisAnimating%2C%20setIsAnimating%5D%20%3D%20useState(false)%3B%0Aconst%20animate%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!elementRef.current%20%7C%7C%20!isAnimating)%20return%3B%0Aconst%20x%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%3B%0AelementRef.current.style.transform%20%3D%20%60translateX(%24%7Bx%7Dpx)%60%3B%0AanimationRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%3B%0Aconst%20startAnimation%20%3D%20()%20%3D%3E%20%7B%0AsetIsAnimating(true)%3B%0A%7D%3B%0Aconst%20stopAnimation%20%3D%20()%20%3D%3E%20%7B%0AsetIsAnimating(false)%3B%0Aif%20(animationRef.current)%20%7B%0AcancelAnimationFrame(animationRef.current)%3B%0A%7D%0A%7D%3B%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isAnimating)%20%7B%0AanimationRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(animationRef.current)%20%7B%0AcancelAnimationFrame(animationRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5BisAnimating%5D)%3B%0Areturn%20(%0Adiv%3E%0Adiv%20ref%3D%7BelementRef%7D%20style%3D%7B%7B%20width%3A%2050%2C%20height%3A%2050%2C%20backgroundColor%3A%20'blue'%20%7D%7D%3E%0A%E5%8A%A8%E7%94%BB%E5%85%83%E7%B4%A0%0Adiv%3E%0Abutton%20onClick%3D%7BisAnimating%20%3F%20stopAnimation%20%3A%20startAnimation%7D%3E%0A%7BisAnimating%20%3F%20'%E5%81%9C%E6%AD%A2'%20%3A%20'%E5%BC%80%E5%A7%8B'%7D%E5%8A%A8%E7%94%BB%0Abutton%3E%0Adiv%3E%0A)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">jsx</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-jsx"><span class="hljs-keyword inline">import</span> <span class="hljs-title class_ inline">React</span>, { useEffect, useRef, useState } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;react&#x27;</span>;

<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">AnimatedComponent</span>(<span class="hljs-params inline"></span>) {
  <span class="hljs-keyword inline">const</span> elementRef = <span class="hljs-title function_ inline">useRef</span>(<span class="hljs-literal inline">null</span>);
  <span class="hljs-keyword inline">const</span> animationRef = <span class="hljs-title function_ inline">useRef</span>(<span class="hljs-literal inline">null</span>);
  <span class="hljs-keyword inline">const</span> [isAnimating, setIsAnimating] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);

  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">animate</span> = (<span class="hljs-params inline">timestamp</span>) =&gt; {
    <span class="hljs-keyword inline">if</span> (!elementRef.<span class="hljs-property inline">current</span> || !isAnimating) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-keyword inline">const</span> x = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(timestamp / <span class="hljs-number inline">1000</span>) * <span class="hljs-number inline">100</span>;
    elementRef.<span class="hljs-property inline">current</span>.<span class="hljs-property inline">style</span>.<span class="hljs-property inline">transform</span> = <span class="hljs-string inline">`translateX(<span class="hljs-subst inline">${x}</span>px)`</span>;

    animationRef.<span class="hljs-property inline">current</span> = <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
  };

  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">startAnimation</span> = (<span class="hljs-params inline"></span>) =&gt; {
    <span class="hljs-title function_ inline">setIsAnimating</span>(<span class="hljs-literal inline">true</span>);
  };

  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">stopAnimation</span> = (<span class="hljs-params inline"></span>) =&gt; {
    <span class="hljs-title function_ inline">setIsAnimating</span>(<span class="hljs-literal inline">false</span>);
    <span class="hljs-keyword inline">if</span> (animationRef.<span class="hljs-property inline">current</span>) {
      <span class="hljs-title function_ inline">cancelAnimationFrame</span>(animationRef.<span class="hljs-property inline">current</span>);
    }
  };

  <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (isAnimating) {
      animationRef.<span class="hljs-property inline">current</span> = <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
    }

    <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
      <span class="hljs-keyword inline">if</span> (animationRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-title function_ inline">cancelAnimationFrame</span>(animationRef.<span class="hljs-property inline">current</span>);
      }
    };
  }, [isAnimating]);

  <span class="hljs-keyword inline">return</span> (
    <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">ref</span>=<span class="hljs-string inline">{elementRef}</span> <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span> <span class="hljs-attr inline">width:</span> <span class="hljs-attr inline">50</span>, <span class="hljs-attr inline">height:</span> <span class="hljs-attr inline">50</span>, <span class="hljs-attr inline">backgroundColor:</span> &#x27;<span class="hljs-attr inline">blue</span>&#x27; }}&gt;</span>
        动画元素
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span> <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{isAnimating</span> ? <span class="hljs-attr inline">stopAnimation</span> <span class="hljs-attr inline">:</span> <span class="hljs-attr inline">startAnimation</span>}&gt;</span>
        {isAnimating ? &#x27;停止&#x27; : &#x27;开始&#x27;}动画
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
  );
}
</code></pre>
            </div>
        
<h3 id="自定义动画-hook" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#自定义动画-hook" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 自定义动画 Hook">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">自定义动画 Hook</strong>
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="jsx" data-code="import%20%7B%20useEffect%2C%20useRef%2C%20useCallback%20%7D%20from%20'react'%3B%0Afunction%20useAnimationFrame(callback%2C%20isRunning%20%3D%20true)%20%7B%0Aconst%20requestRef%20%3D%20useRef()%3B%0Aconst%20animate%20%3D%20useCallback((timestamp)%20%3D%3E%20%7B%0Acallback(timestamp)%3B%0Aif%20(isRunning)%20%7B%0ArequestRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%0A%7D%2C%20%5Bcallback%2C%20isRunning%5D)%3B%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isRunning)%20%7B%0ArequestRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%20else%20%7B%0Aif%20(requestRef.current)%20%7B%0AcancelAnimationFrame(requestRef.current)%3B%0A%7D%0A%7D%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(requestRef.current)%20%7B%0AcancelAnimationFrame(requestRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5Banimate%2C%20isRunning%5D)%3B%0A%7D%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%0Afunction%20MyAnimatedComponent()%20%7B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useState(0)%3B%0AuseAnimationFrame((timestamp)%20%3D%3E%20%7B%0AsetPosition(Math.sin(timestamp%20%2F%201000)%20*%20100)%3B%0A%7D)%3B%0Areturn%20(%0Adiv%20style%3D%7B%7B%20transform%3A%20%60translateX(%24%7Bposition%7Dpx)%60%20%7D%7D%3E%0A%E5%8A%A8%E7%94%BB%E5%86%85%E5%AE%B9%0Adiv%3E%0A)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">jsx</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-jsx"><span class="hljs-keyword inline">import</span> { useEffect, useRef, useCallback } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;react&#x27;</span>;

<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">useAnimationFrame</span>(<span class="hljs-params inline">callback, isRunning = <span class="hljs-literal inline">true</span></span>) {
  <span class="hljs-keyword inline">const</span> requestRef = <span class="hljs-title function_ inline">useRef</span>();

  <span class="hljs-keyword inline">const</span> animate = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline">timestamp</span>) =&gt;</span> {
    <span class="hljs-title function_ inline">callback</span>(timestamp);
    <span class="hljs-keyword inline">if</span> (isRunning) {
      requestRef.<span class="hljs-property inline">current</span> = <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
    }
  }, [callback, isRunning]);

  <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (isRunning) {
      requestRef.<span class="hljs-property inline">current</span> = <span class="hljs-title function_ inline">requestAnimationFrame</span>(animate);
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-keyword inline">if</span> (requestRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-title function_ inline">cancelAnimationFrame</span>(requestRef.<span class="hljs-property inline">current</span>);
      }
    }

    <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
      <span class="hljs-keyword inline">if</span> (requestRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-title function_ inline">cancelAnimationFrame</span>(requestRef.<span class="hljs-property inline">current</span>);
      }
    };
  }, [animate, isRunning]);
}

<span class="hljs-comment inline">// 使用示例</span>
<span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">MyAnimatedComponent</span>(<span class="hljs-params inline"></span>) {
  <span class="hljs-keyword inline">const</span> [position, setPosition] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-number inline">0</span>);

  <span class="hljs-title function_ inline">useAnimationFrame</span>(<span class="hljs-function inline">(<span class="hljs-params inline">timestamp</span>) =&gt;</span> {
    <span class="hljs-title function_ inline">setPosition</span>(<span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(timestamp / <span class="hljs-number inline">1000</span>) * <span class="hljs-number inline">100</span>);
  });

  <span class="hljs-keyword inline">return</span> (
    <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span> <span class="hljs-attr inline">transform:</span> `<span class="hljs-attr inline">translateX</span>(${<span class="hljs-attr inline">position</span>}<span class="hljs-attr inline">px</span>)` }}&gt;</span>
      动画内容
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
  );
}
</code></pre>
            </div>
        
<h3 id="实际应用场景" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#实际应用场景" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 实际应用场景">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">实际应用场景</strong>
        </h3>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">平滑滚动</strong>：页面滚动到指定位置</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">粒子系统</strong>：创建粒子动画效果</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">数据可视化</strong>：图表动画和过渡</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">游戏开发</strong>：游戏循环和角色动画</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">UI 动效</strong>：按钮点击、页面切换动画</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">性能监控</strong>：FPS 计算和性能分析</li>
</ul>
<h3 id="注意事项" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#注意事项" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 注意事项">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">注意事项</strong>
        </h3>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">内存管理</strong>：始终使用 <code>cancelAnimationFrame</code> 清理动画</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">条件检查</strong>：在回调中检查动画是否应该继续</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">性能考虑</strong>：避免在动画中进行复杂计算</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">浏览器兼容性</strong>：现代浏览器都支持，需要时使用 polyfill</li>
</ol>
<h3 id="完整的动画管理器示例" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#完整的动画管理器示例" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 完整的动画管理器示例">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            <strong class="font-bold text-foreground">完整的动画管理器示例</strong>
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="class%20AnimationManager%20%7B%0Aconstructor()%20%7B%0Athis.animations%20%3D%20new%20Map()%3B%0Athis.isRunning%20%3D%20false%3B%0Athis.animationId%20%3D%20null%3B%0A%7D%0Aadd(key%2C%20animationFn)%20%7B%0Athis.animations.set(key%2C%20%7B%0Afn%3A%20animationFn%2C%0Aactive%3A%20true%0A%7D)%3B%0Aif%20(!this.isRunning)%20%7B%0Athis.start()%3B%0A%7D%0A%7D%0Aremove(key)%20%7B%0Athis.animations.delete(key)%3B%0Aif%20(this.animations.size%20%3D%3D%3D%200)%20%7B%0Athis.stop()%3B%0A%7D%0A%7D%0Astart()%20%7B%0Aif%20(this.isRunning)%20return%3B%0Athis.isRunning%20%3D%20true%3B%0Athis.tick()%3B%0A%7D%0Astop()%20%7B%0Athis.isRunning%20%3D%20false%3B%0Aif%20(this.animationId)%20%7B%0AcancelAnimationFrame(this.animationId)%3B%0A%7D%0A%7D%0Atick%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!this.isRunning)%20return%3B%0A%2F%2F%20%E6%89%A7%E8%A1%8C%E6%89%80%E6%9C%89%E6%B4%BB%E8%B7%83%E7%9A%84%E5%8A%A8%E7%94%BB%0Afor%20(const%20%5Bkey%2C%20animation%5D%20of%20this.animations)%20%7B%0Aif%20(animation.active)%20%7B%0Aanimation.fn(timestamp)%3B%0A%7D%0A%7D%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0Athis.animationId%20%3D%20requestAnimationFrame(this.tick)%3B%0A%7D%0A%7D%0A%2F%2F%20%E5%85%A8%E5%B1%80%E5%8A%A8%E7%94%BB%E7%AE%A1%E7%90%86%E5%99%A8%0Aconst%20animationManager%20%3D%20new%20AnimationManager()%3B%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%0AanimationManager.add('myAnimation'%2C%20(timestamp)%20%3D%3E%20%7B%0A%2F%2F%20%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0A%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">class</span> <span class="hljs-title class_ inline">AnimationManager</span> {
  <span class="hljs-title function_ inline">constructor</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animations</span> = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Map</span>();
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span> = <span class="hljs-literal inline">false</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span> = <span class="hljs-literal inline">null</span>;
  }

  <span class="hljs-title function_ inline">add</span>(<span class="hljs-params inline">key, animationFn</span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animations</span>.<span class="hljs-title function_ inline">set</span>(key, {
      <span class="hljs-attr inline">fn</span>: animationFn,
      <span class="hljs-attr inline">active</span>: <span class="hljs-literal inline">true</span>
    });
    
    <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span>) {
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">start</span>();
    }
  }

  <span class="hljs-title function_ inline">remove</span>(<span class="hljs-params inline">key</span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animations</span>.<span class="hljs-title function_ inline">delete</span>(key);
    
    <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animations</span>.<span class="hljs-property inline">size</span> === <span class="hljs-number inline">0</span>) {
      <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">stop</span>();
    }
  }

  <span class="hljs-title function_ inline">start</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span>) <span class="hljs-keyword inline">return</span>;
    
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span> = <span class="hljs-literal inline">true</span>;
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-title function_ inline">tick</span>();
  }

  <span class="hljs-title function_ inline">stop</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span> = <span class="hljs-literal inline">false</span>;
    <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span>) {
      <span class="hljs-title function_ inline">cancelAnimationFrame</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span>);
    }
  }

  tick = <span class="hljs-function inline">(<span class="hljs-params inline">timestamp</span>) =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">isRunning</span>) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-comment inline">// 执行所有活跃的动画</span>
    <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">const</span> [key, animation] <span class="hljs-keyword inline">of</span> <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animations</span>) {
      <span class="hljs-keyword inline">if</span> (animation.<span class="hljs-property inline">active</span>) {
        animation.<span class="hljs-title function_ inline">fn</span>(timestamp);
      }
    }

    <span class="hljs-comment inline">// 请求下一帧</span>
    <span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">animationId</span> = <span class="hljs-title function_ inline">requestAnimationFrame</span>(<span class="hljs-variable language_ inline">this</span>.<span class="hljs-property inline">tick</span>);
  }
}

<span class="hljs-comment inline">// 全局动画管理器</span>
<span class="hljs-keyword inline">const</span> animationManager = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">AnimationManager</span>();

<span class="hljs-comment inline">// 使用示例</span>
animationManager.<span class="hljs-title function_ inline">add</span>(<span class="hljs-string inline">&#x27;myAnimation&#x27;</span>, <span class="hljs-function inline">(<span class="hljs-params inline">timestamp</span>) =&gt;</span> {
  <span class="hljs-comment inline">// 动画逻辑</span>
});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>requestAnimationFrame</code> 是现代 Web 动画的核心 API，提供了流畅、高效的动画解决方案。</p>
</div></article><footer class="mt-16 pt-8 border-t border-foreground/20"><div class="flex items-center justify-between"><a class="inline-flex items-center px-4 py-2 bg-primary text-foreground rounded-lg hover:bg-primary/90 transition-colors" href="/documents/">documents.backToDocuments</a><div class="text-sm text-foreground/60"><span>documents.byAuthor<!-- --> <!-- -->MilkWind</span></div></div></footer></div></div><!--$--><!--/$--><!--$--><!--/$--><!--/$--><!--/$--><script src="/_next/static/chunks/webpack-18c0f30037e967de.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[38735,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n3:I[19945,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n4:I[65337,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n5:I[96190,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"ClientProviders\"]\n6:I[87555,[],\"\"]\n7:I[51901,[\"8039\",\"static/chunks/app/error-dda32be1d095a86c.js\"],\"default\"]\n8:I[31295,[],\"\"]\n9:I[6874,[\"6874\",\"static/chunks/6874-fbe9a08eb79b991c.js\",\"4345\",\"static/chunks/app/not-found-9ff98b2ccf24cac7.js\"],\"\"]\na:I[94970,[],\"ClientSegmentRoot\"]\nb:I[44065,[\"206\",\"static/chunks/206-4f4cbf4d7156f437.js\",\"3092\",\"static/chunks/app/documents/layout-28408791defde09e.js\"],\"default\"]\ne:I[59665,[],\"MetadataBoundary\"]\n10:I[59665,[],\"OutletBoundary\"]\n13:I[74911,[],\"AsyncMetadataOutlet\"]\n15:I[39460,[\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"8610\",\"static/chunks/8610-7bd3f91f3cf2a4d6.js\",\"5650\",\"static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js\"],\"default\"]\n16:I[88610,[\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"8610\",\"static/chunks/8610-7bd3f91f3cf2a4d6.js\",\"4209\",\"static/chunks/app/loading-68f227fb49b3ac8c.js\"],\"default\"]\n17:I[59665,[],\"ViewportBoundary\"]\n19:I[26614,[],\"\"]\n:HL[\"/_next/static/css/f034c804622acb16.css\",\"style\"]\n:HL[\"/_next/static/css/b226d7ef8e491b72.css\",\"style\"]\n:HL[\"/_next/static/css/5eacd01f773eed7f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"VBTZvHNp6tlBlJCFUsE6O\",\"p\":\"\",\"c\":[\"\",\"documents\",\"zh\",\"light\",\"basic-knowledge\",\"browser-request-animation-frame\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"documents\",{\"children\":[[\"slug\",\"zh/light/basic-knowledge/browser-request-animation-frame\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f034c804622acb16.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b226d7ef8e491b72.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_d4c88d __variable_7b4e2b __variable_c3272d font-sans antialiased min-h-screen bg-background text-foreground\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$7\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"z-10 relative min-h-screen flex items-center justify-center bg-background p-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"text-center max-w-md\",\"children\":[[\"$\",\"div\",null,{\"className\":\"text-8xl font-bold text-primary mb-4\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold text-foreground mb-4\",\"children\":\"Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"text-foreground/70 mb-8\",\"children\":\"The page you're looking for doesn't exist or has been moved to a different location.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col sm:flex-row gap-4 justify-center\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"className\":\"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors\",\"children\":\"Go Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/works\",\"className\":\"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors\",\"children\":\"View Works\"}]]}],[\"$\",\"div\",null,{\"className\":\"absolute inset-0 overflow-hidden pointer-events-none -z-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float\"}],[\"$\",\"div\",null,{\"className\":\"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float\",\"style\":{\"animationDelay\":\"1s\"}}],[\"$\",\"div\",null,{\"className\":\"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float\",\"style\":{\"animationDelay\":\"2s\"}}]]}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]}]]}],{\"children\":[\"documents\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$La\",null,{\"Component\":\"$b\",\"slots\":{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"params\":{},\"promise\":\"$@c\"}]]}],{\"children\":[[\"slug\",\"zh/light/basic-knowledge/browser-request-animation-frame\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$Ld\",[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5eacd01f773eed7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L10\",null,{\"children\":[\"$L11\",\"$L12\",[\"$\",\"$L13\",null,{\"promise\":\"$@14\"}]]}]]}],{},null,false]},null,false]},[[\"$\",\"$L15\",\"l\",{}],[],[]],false]},[[\"$\",\"$L16\",\"l\",{}],[],[]],false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"dpr9RE9feHxurWKQp398W\",{\"children\":[[\"$\",\"$L17\",null,{\"children\":\"$L18\"}],null]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$19\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"1a:\"$Sreact.suspense\"\n1b:I[74911,[],\"AsyncMetadata\"]\nc:{}\nf:[\"$\",\"$1a\",null,{\"fallback\":null,\"children\":[\"$\",\"$L1b\",null,{\"promise\":\"$@1c\"}]}]\n"])</script><script>self.__next_f.push([1,"1d:I[57340,[\"5584\",\"static/chunks/b498d07c-095637f0f10883c6.js\",\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"6874\",\"static/chunks/6874-fbe9a08eb79b991c.js\",\"9554\",\"static/chunks/9554-b714f9de28e85d30.js\",\"1873\",\"static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js\"],\"DocumentPageClient\"]\n1e:T1477c,"])</script><script>self.__next_f.push([1,"\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003erequestAnimationFrame\u003c/code\u003e 是浏览器提供的原生 API，用于创建平滑的动画效果。它会在下一次重绘之前调用指定的回调函数，确保动画与浏览器的刷新率保持同步。\u003c/p\u003e\n\u003ch3 id=\"基本作用\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#基本作用\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 基本作用\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e基本作用\u003c/strong\u003e\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003erequestAnimationFrame\u003c/code\u003e 的主要作用是：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e在浏览器下一次重绘前执行动画函数\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e与显示器刷新率同步（通常是 60fps）\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e当页面不可见时自动暂停，节省性能\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e提供更流畅的动画体验\u003c/li\u003e\n\u003c/ul\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"function%20animate()%20%7B%0A%2F%2F%20%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0Aconsole.log('%E6%89%A7%E8%A1%8C%E5%8A%A8%E7%94%BB%E5%B8%A7')%3B%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0ArequestAnimationFrame(animate)%3B%0A%7D%0A%2F%2F%20%E5%BC%80%E5%A7%8B%E5%8A%A8%E7%94%BB%0ArequestAnimationFrame(animate)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eanimate\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-comment inline\"\u003e// 动画逻辑\u003c/span\u003e\n  \u003cspan class=\"hljs-variable language_ inline\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;执行动画帧\u0026#x27;\u003c/span\u003e);\n  \n  \u003cspan class=\"hljs-comment inline\"\u003e// 请求下一帧\u003c/span\u003e\n  \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 开始动画\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"基本用法\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#基本用法\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 基本用法\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e基本用法\u003c/strong\u003e\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"function%20animate(timestamp)%20%7B%0A%2F%2F%20timestamp%3A%20%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%E6%88%B3%EF%BC%88%E6%AF%AB%E7%A7%92%EF%BC%89%0Aconsole.log('%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4%3A'%2C%20timestamp)%3B%0A%2F%2F%20%E6%89%A7%E8%A1%8C%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0Aelement.style.left%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%20%2B%20'px'%3B%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0ArequestAnimationFrame(animate)%3B%0A%7D%0A%2F%2F%20%E5%90%AF%E5%8A%A8%E5%8A%A8%E7%94%BB%0Aconst%20animationId%20%3D%20requestAnimationFrame(animate)%3B%0A%2F%2F%20%E5%8F%96%E6%B6%88%E5%8A%A8%E7%94%BB%0AcancelAnimationFrame(animationId)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eanimate\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) {\n  \u003cspan class=\"hljs-comment inline\"\u003e// timestamp: 当前时间戳（毫秒）\u003c/span\u003e\n  \u003cspan class=\"hljs-variable language_ inline\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;当前时间:\u0026#x27;\u003c/span\u003e, timestamp);\n  \n  \u003cspan class=\"hljs-comment inline\"\u003e// 执行动画逻辑\u003c/span\u003e\n  element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(timestamp / \u003cspan class=\"hljs-number inline\"\u003e1000\u003c/span\u003e) * \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e;\n  \n  \u003cspan class=\"hljs-comment inline\"\u003e// 请求下一帧\u003c/span\u003e\n  \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 启动动画\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e animationId = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 取消动画\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(animationId);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"工作原理与常见问题\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#工作原理与常见问题\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 工作原理与常见问题\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            工作原理与常见问题\n        \u003c/h3\u003e\n\u003ch4 id=\"为什么一般在使用requestanimationframe函数的时候，都是递归调用？\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#为什么一般在使用requestanimationframe函数的时候，都是递归调用？\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 为什么一般在使用requestAnimationFrame函数的时候，都是递归调用？\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            为什么一般在使用requestAnimationFrame函数的时候，都是递归调用？\n        \u003c/h4\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003erequestAnimationFrame\u003c/code\u003e采用递归调用是因为它本质上是一次性的：每次调用只会在下一次重绘前执行一次回调函数。为了创建连续的动画效果，需要在每次回调结束时再次请求下一帧，形成递归调用的模式。这种方式能确保动画帧与浏览器重绘节奏精确同步。\u003c/p\u003e\n\u003ch4 id=\"持续性递归调用requestanimationframe难道不会导致栈溢出吗？\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#持续性递归调用requestanimationframe难道不会导致栈溢出吗？\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 持续性递归调用requestAnimationFrame难道不会导致栈溢出吗？\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            持续性递归调用requestAnimationFrame难道不会导致栈溢出吗？\n        \u003c/h4\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e不会导致栈溢出。因为\u003ccode\u003erequestAnimationFrame\u003c/code\u003e的回调函数是在当前执行栈为空时，由浏览器的事件循环机制调度执行的，属于异步执行模式。每次调用后，回调函数会在浏览器下一次重绘前被触发，而触发时上一次的函数调用栈已经执行完毕并释放，因此调用栈不会无限增长。\u003c/p\u003e\n\u003ch4 id=\"什么是浏览器的重绘任务队列？\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#什么是浏览器的重绘任务队列？\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 什么是浏览器的重绘任务队列？\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            什么是浏览器的重绘任务队列？\n        \u003c/h4\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e浏览器的重绘任务队列是用于管理视觉更新操作的任务队列。当DOM或CSS发生变化需要更新屏幕时，这些更新操作会被加入重绘队列。浏览器会定期（通常与显示器刷新率同步）从队列中取出任务执行，以确保视觉更新的流畅性。\u003c/p\u003e\n\u003ch4 id=\"requestanimationframe是如何确保与浏览器刷新率同步的？\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#requestanimationframe是如何确保与浏览器刷新率同步的？\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to requestAnimationFrame是如何确保与浏览器刷新率同步的？\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            requestAnimationFrame是如何确保与浏览器刷新率同步的？\n        \u003c/h4\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e浏览器会以自身的刷新率（通常是 60Hz，即每秒 60 次）定期触发重绘，以更新页面显示。\u003ccode\u003erequestAnimationFrame\u003c/code\u003e 的回调函数会被加入浏览器的\u003cstrong class=\"font-bold text-foreground\"\u003e重绘任务队列\u003c/strong\u003e，在下一次重绘前执行，因此天然与重绘频率对齐。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e同时，浏览器会根据设备性能或页面状态（如切换到后台时）调整刷新率（例如降为 30Hz），\u003ccode\u003erequestAnimationFrame\u003c/code\u003e 会自动适配这种变化，回调触发频率会随浏览器实际重绘频率同步改变，无需手动干预。\u003c/p\u003e\n\u003ch3 id=\"与传统方案的对比\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#与传统方案的对比\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 与传统方案的对比\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e与传统方案的对比\u003c/strong\u003e\n        \u003c/h3\u003e\n\u003ch4 id=\"settimeoutsetinterval-的问题\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#settimeoutsetinterval-的问题\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to setTimeout/setInterval 的问题\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003esetTimeout/setInterval 的问题\u003c/strong\u003e\n        \u003c/h4\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"%2F%2F%20%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%EF%BC%9A%E4%BD%BF%E7%94%A8%20setTimeout%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89%0Afunction%20animateWithTimeout()%20%7B%0Aelement.style.left%20%3D%20parseInt(element.style.left%20%7C%7C%200)%20%2B%201%20%2B%20'px'%3B%0AsetTimeout(animateWithTimeout%2C%2016)%3B%20%2F%2F%20%E7%BA%A6%2060fps%0A%7D%0A%2F%2F%20%E9%97%AE%E9%A2%98%EF%BC%9A%0A%2F%2F%201.%20%E4%B8%8D%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E5%88%B7%E6%96%B0%E7%8E%87%E5%90%8C%E6%AD%A5%0A%2F%2F%202.%20%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%97%B6%E4%BB%8D%E7%84%B6%E6%89%A7%E8%A1%8C%0A%2F%2F%203.%20%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E4%B8%A2%E5%B8%A7%E6%88%96%E5%8D%A1%E9%A1%BF\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 传统方式：使用 setTimeout（不推荐）\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eanimateWithTimeout\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n  element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003eparseInt\u003c/span\u003e(element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e || \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e) + \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e;\n  \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(animateWithTimeout, \u003cspan class=\"hljs-number inline\"\u003e16\u003c/span\u003e); \u003cspan class=\"hljs-comment inline\"\u003e// 约 60fps\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 问题：\u003c/span\u003e\n\u003cspan class=\"hljs-comment inline\"\u003e// 1. 不与浏览器刷新率同步\u003c/span\u003e\n\u003cspan class=\"hljs-comment inline\"\u003e// 2. 页面不可见时仍然执行\u003c/span\u003e\n\u003cspan class=\"hljs-comment inline\"\u003e// 3. 可能导致丢帧或卡顿\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch4 id=\"requestanimationframe-的优势\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#requestanimationframe-的优势\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to requestAnimationFrame 的优势\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003erequestAnimationFrame 的优势\u003c/strong\u003e\n        \u003c/h4\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"%2F%2F%20%E7%8E%B0%E4%BB%A3%E6%96%B9%E5%BC%8F%EF%BC%9A%E4%BD%BF%E7%94%A8%20requestAnimationFrame%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89%0Afunction%20animateWithRAF(timestamp)%20%7B%0Aelement.style.left%20%3D%20parseInt(element.style.left%20%7C%7C%200)%20%2B%201%20%2B%20'px'%3B%0ArequestAnimationFrame(animateWithRAF)%3B%0A%7D%0A%2F%2F%20%E4%BC%98%E5%8A%BF%EF%BC%9A%0A%2F%2F%201.%20%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E5%88%B7%E6%96%B0%E7%8E%87%E5%90%8C%E6%AD%A5%0A%2F%2F%202.%20%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%97%B6%E8%87%AA%E5%8A%A8%E6%9A%82%E5%81%9C%0A%2F%2F%203.%20%E6%9B%B4%E5%A5%BD%E7%9A%84%E6%80%A7%E8%83%BD%E5%92%8C%E7%94%B5%E6%B1%A0%E7%BB%AD%E8%88%AA\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 现代方式：使用 requestAnimationFrame（推荐）\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eanimateWithRAF\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) {\n  element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003eparseInt\u003c/span\u003e(element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e || \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e) + \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e;\n  \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animateWithRAF);\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 优势：\u003c/span\u003e\n\u003cspan class=\"hljs-comment inline\"\u003e// 1. 与浏览器刷新率同步\u003c/span\u003e\n\u003cspan class=\"hljs-comment inline\"\u003e// 2. 页面不可见时自动暂停\u003c/span\u003e\n\u003cspan class=\"hljs-comment inline\"\u003e// 3. 更好的性能和电池续航\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"实用示例\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#实用示例\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 实用示例\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e实用示例\u003c/strong\u003e\n        \u003c/h3\u003e\n\u003ch4 id=\"简单的移动动画\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#简单的移动动画\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 简单的移动动画\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e简单的移动动画\u003c/strong\u003e\n        \u003c/h4\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"class%20Animator%20%7B%0Aconstructor(element)%20%7B%0Athis.element%20%3D%20element%3B%0Athis.isRunning%20%3D%20false%3B%0Athis.animationId%20%3D%20null%3B%0A%7D%0Astart()%20%7B%0Aif%20(this.isRunning)%20return%3B%0Athis.isRunning%20%3D%20true%3B%0Athis.animate()%3B%0A%7D%0Astop()%20%7B%0Athis.isRunning%20%3D%20false%3B%0Aif%20(this.animationId)%20%7B%0AcancelAnimationFrame(this.animationId)%3B%0A%7D%0A%7D%0Aanimate%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!this.isRunning)%20return%3B%0A%2F%2F%20%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0Aconst%20x%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20200%3B%0Athis.element.style.transform%20%3D%20%60translateX(%24%7Bx%7Dpx)%60%3B%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0Athis.animationId%20%3D%20requestAnimationFrame(this.animate)%3B%0A%7D%0A%7D%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%0Aconst%20element%20%3D%20document.getElementById('myElement')%3B%0Aconst%20animator%20%3D%20new%20Animator(element)%3B%0Aanimator.start()%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eAnimator\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_ inline\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003eelement\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eelement\u003c/span\u003e = element;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003estart\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n    \n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eanimate\u003c/span\u003e();\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003estop\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e);\n    }\n  }\n\n  animate = \u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 动画逻辑\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e x = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(timestamp / \u003cspan class=\"hljs-number inline\"\u003e1000\u003c/span\u003e) * \u003cspan class=\"hljs-number inline\"\u003e200\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eelement\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003etransform\u003c/span\u003e = \u003cspan class=\"hljs-string inline\"\u003e`translateX(\u003cspan class=\"hljs-subst inline\"\u003e${x}\u003c/span\u003epx)`\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 请求下一帧\u003c/span\u003e\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimate\u003c/span\u003e);\n  }\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 使用示例\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e element = \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;myElement\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e animator = \u003cspan class=\"hljs-keyword inline\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eAnimator\u003c/span\u003e(element);\nanimator.\u003cspan class=\"hljs-title function_ inline\"\u003estart\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch4 id=\"时间控制的动画\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#时间控制的动画\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 时间控制的动画\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e时间控制的动画\u003c/strong\u003e\n        \u003c/h4\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"class%20TimedAnimation%20%7B%0Aconstructor(element%2C%20duration%20%3D%202000)%20%7B%0Athis.element%20%3D%20element%3B%0Athis.duration%20%3D%20duration%3B%0Athis.startTime%20%3D%20null%3B%0A%7D%0Astart()%20%7B%0Athis.startTime%20%3D%20null%3B%0Athis.animate()%3B%0A%7D%0Aanimate%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!this.startTime)%20%7B%0Athis.startTime%20%3D%20timestamp%3B%0A%7D%0Aconst%20elapsed%20%3D%20timestamp%20-%20this.startTime%3B%0Aconst%20progress%20%3D%20Math.min(elapsed%20%2F%20this.duration%2C%201)%3B%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%BC%93%E5%8A%A8%E5%87%BD%E6%95%B0%0Aconst%20easeProgress%20%3D%20this.easeInOutQuad(progress)%3B%0A%2F%2F%20%E5%BA%94%E7%94%A8%E5%8A%A8%E7%94%BB%0Athis.element.style.transform%20%3D%20%60translateX(%24%7BeaseProgress%20*%20300%7Dpx)%60%3B%0A%2F%2F%20%E7%BB%A7%E7%BB%AD%E5%8A%A8%E7%94%BB%E6%88%96%E7%BB%93%E6%9D%9F%0Aif%20(progress%201)%20%7B%0ArequestAnimationFrame(this.animate)%3B%0A%7D%20else%20%7B%0Aconsole.log('%E5%8A%A8%E7%94%BB%E5%AE%8C%E6%88%90')%3B%0A%7D%0A%7D%0AeaseInOutQuad(t)%20%7B%0Areturn%20t%200.5%20%3F%202%20*%20t%20*%20t%20%3A%20-1%20%2B%20(4%20-%202%20*%20t)%20*%20t%3B%0A%7D%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eTimedAnimation\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_ inline\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003eelement, duration = \u003cspan class=\"hljs-number inline\"\u003e2000\u003c/span\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eelement\u003c/span\u003e = element;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eduration\u003c/span\u003e = duration;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estartTime\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003estart\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estartTime\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eanimate\u003c/span\u003e();\n  }\n\n  animate = \u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estartTime\u003c/span\u003e) {\n      \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estartTime\u003c/span\u003e = timestamp;\n    }\n\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e elapsed = timestamp - \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estartTime\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e progress = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(elapsed / \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eduration\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 使用缓动函数\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e easeProgress = \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eeaseInOutQuad\u003c/span\u003e(progress);\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 应用动画\u003c/span\u003e\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eelement\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003etransform\u003c/span\u003e = \u003cspan class=\"hljs-string inline\"\u003e`translateX(\u003cspan class=\"hljs-subst inline\"\u003e${easeProgress * \u003cspan class=\"hljs-number inline\"\u003e300\u003c/span\u003e}\u003c/span\u003epx)`\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 继续动画或结束\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (progress \u0026lt; \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimate\u003c/span\u003e);\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-variable language_ inline\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;动画完成\u0026#x27;\u003c/span\u003e);\n    }\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003eeaseInOutQuad\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003et\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e t \u0026lt; \u003cspan class=\"hljs-number inline\"\u003e0.5\u003c/span\u003e ? \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * t * t : -\u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + (\u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * t) * t;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"性能优化技巧\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#性能优化技巧\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 性能优化技巧\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e性能优化技巧\u003c/strong\u003e\n        \u003c/h3\u003e\n\u003ch4 id=\"避免强制重排（forced-reflow）\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#避免强制重排（forced-reflow）\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 避免强制重排（Forced Reflow）\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e避免强制重排（Forced Reflow）\u003c/strong\u003e\n        \u003c/h4\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"%2F%2F%20%E4%B8%8D%E5%A5%BD%E7%9A%84%E5%81%9A%E6%B3%95%EF%BC%9A%E5%A4%9A%E6%AC%A1%E8%AF%BB%E5%8F%96%2F%E5%86%99%E5%85%A5%E6%A0%B7%E5%BC%8F%0Afunction%20badAnimate()%20%7B%0Aelement1.style.left%20%3D%20element1.offsetLeft%20%2B%201%20%2B%20'px'%3B%20%2F%2F%20%E8%AF%BB%E5%8F%96%E8%A7%A6%E5%8F%91%E9%87%8D%E6%8E%92%0Aelement2.style.left%20%3D%20element2.offsetLeft%20%2B%201%20%2B%20'px'%3B%20%2F%2F%20%E5%86%8D%E6%AC%A1%E8%A7%A6%E5%8F%91%E9%87%8D%E6%8E%92%0A%7D%0A%2F%2F%20%E5%A5%BD%E7%9A%84%E5%81%9A%E6%B3%95%EF%BC%9A%E6%89%B9%E9%87%8F%E5%A4%84%E7%90%86%E6%A0%B7%E5%BC%8F%E6%93%8D%E4%BD%9C%0Afunction%20goodAnimate()%20%7B%0A%2F%2F%20%E5%85%88%E8%AF%BB%E5%8F%96%E6%89%80%E6%9C%89%E9%9C%80%E8%A6%81%E7%9A%84%E5%80%BC%0Aconst%20left1%20%3D%20element1.offsetLeft%3B%0Aconst%20left2%20%3D%20element2.offsetLeft%3B%0A%2F%2F%20%E5%86%8D%E6%89%B9%E9%87%8F%E5%86%99%E5%85%A5%0Aelement1.style.left%20%3D%20left1%20%2B%201%20%2B%20'px'%3B%0Aelement2.style.left%20%3D%20left2%20%2B%201%20%2B%20'px'%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 不好的做法：多次读取/写入样式\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ebadAnimate\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n  element1.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = element1.\u003cspan class=\"hljs-property inline\"\u003eoffsetLeft\u003c/span\u003e + \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e; \u003cspan class=\"hljs-comment inline\"\u003e// 读取触发重排\u003c/span\u003e\n  element2.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = element2.\u003cspan class=\"hljs-property inline\"\u003eoffsetLeft\u003c/span\u003e + \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e; \u003cspan class=\"hljs-comment inline\"\u003e// 再次触发重排\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 好的做法：批量处理样式操作\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egoodAnimate\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-comment inline\"\u003e// 先读取所有需要的值\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e left1 = element1.\u003cspan class=\"hljs-property inline\"\u003eoffsetLeft\u003c/span\u003e;\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e left2 = element2.\u003cspan class=\"hljs-property inline\"\u003eoffsetLeft\u003c/span\u003e;\n  \n  \u003cspan class=\"hljs-comment inline\"\u003e// 再批量写入\u003c/span\u003e\n  element1.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = left1 + \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e;\n  element2.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = left2 + \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch4 id=\"使用-css-变换代替位置改变\" class=\"group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#使用-css-变换代替位置改变\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 使用 CSS 变换代替位置改变\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e使用 CSS 变换代替位置改变\u003c/strong\u003e\n        \u003c/h4\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"%2F%2F%20%E6%80%A7%E8%83%BD%E8%BE%83%E5%B7%AE%EF%BC%9A%E6%94%B9%E5%8F%98%20left%2Ftop%0Afunction%20slowAnimate(timestamp)%20%7B%0Aelement.style.left%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%20%2B%20'px'%3B%0A%7D%0A%2F%2F%20%E6%80%A7%E8%83%BD%E6%9B%B4%E5%A5%BD%EF%BC%9A%E4%BD%BF%E7%94%A8%20transform%0Afunction%20fastAnimate(timestamp)%20%7B%0Aconst%20x%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%3B%0Aelement.style.transform%20%3D%20%60translateX(%24%7Bx%7Dpx)%60%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 性能较差：改变 left/top\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eslowAnimate\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) {\n  element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(timestamp / \u003cspan class=\"hljs-number inline\"\u003e1000\u003c/span\u003e) * \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e + \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;px\u0026#x27;\u003c/span\u003e;\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 性能更好：使用 transform\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003efastAnimate\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e x = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(timestamp / \u003cspan class=\"hljs-number inline\"\u003e1000\u003c/span\u003e) * \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e;\n  element.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003etransform\u003c/span\u003e = \u003cspan class=\"hljs-string inline\"\u003e`translateX(\u003cspan class=\"hljs-subst inline\"\u003e${x}\u003c/span\u003epx)`\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"react-中的使用\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#react-中的使用\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to React 中的使用\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003eReact 中的使用\u003c/strong\u003e\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"jsx\" data-code=\"import%20React%2C%20%7B%20useEffect%2C%20useRef%2C%20useState%20%7D%20from%20'react'%3B%0Afunction%20AnimatedComponent()%20%7B%0Aconst%20elementRef%20%3D%20useRef(null)%3B%0Aconst%20animationRef%20%3D%20useRef(null)%3B%0Aconst%20%5BisAnimating%2C%20setIsAnimating%5D%20%3D%20useState(false)%3B%0Aconst%20animate%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!elementRef.current%20%7C%7C%20!isAnimating)%20return%3B%0Aconst%20x%20%3D%20Math.sin(timestamp%20%2F%201000)%20*%20100%3B%0AelementRef.current.style.transform%20%3D%20%60translateX(%24%7Bx%7Dpx)%60%3B%0AanimationRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%3B%0Aconst%20startAnimation%20%3D%20()%20%3D%3E%20%7B%0AsetIsAnimating(true)%3B%0A%7D%3B%0Aconst%20stopAnimation%20%3D%20()%20%3D%3E%20%7B%0AsetIsAnimating(false)%3B%0Aif%20(animationRef.current)%20%7B%0AcancelAnimationFrame(animationRef.current)%3B%0A%7D%0A%7D%3B%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isAnimating)%20%7B%0AanimationRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(animationRef.current)%20%7B%0AcancelAnimationFrame(animationRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5BisAnimating%5D)%3B%0Areturn%20(%0Adiv%3E%0Adiv%20ref%3D%7BelementRef%7D%20style%3D%7B%7B%20width%3A%2050%2C%20height%3A%2050%2C%20backgroundColor%3A%20'blue'%20%7D%7D%3E%0A%E5%8A%A8%E7%94%BB%E5%85%83%E7%B4%A0%0Adiv%3E%0Abutton%20onClick%3D%7BisAnimating%20%3F%20stopAnimation%20%3A%20startAnimation%7D%3E%0A%7BisAnimating%20%3F%20'%E5%81%9C%E6%AD%A2'%20%3A%20'%E5%BC%80%E5%A7%8B'%7D%E5%8A%A8%E7%94%BB%0Abutton%3E%0Adiv%3E%0A)%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejsx\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-jsx\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e, { useEffect, useRef, useState } \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eAnimatedComponent\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e elementRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e animationRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isAnimating, setIsAnimating] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eanimate\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!elementRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e || !isAnimating) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e x = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(timestamp / \u003cspan class=\"hljs-number inline\"\u003e1000\u003c/span\u003e) * \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e;\n    elementRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003etransform\u003c/span\u003e = \u003cspan class=\"hljs-string inline\"\u003e`translateX(\u003cspan class=\"hljs-subst inline\"\u003e${x}\u003c/span\u003epx)`\u003c/span\u003e;\n\n    animationRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n  };\n\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003estartAnimation\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsAnimating\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n  };\n\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003estopAnimation\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsAnimating\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (animationRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(animationRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    }\n  };\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isAnimating) {\n      animationRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n    }\n\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (animationRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(animationRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n      }\n    };\n  }, [isAnimating]);\n\n  \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n    \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eref\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{elementRef}\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ewidth:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003eheight:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ebackgroundColor:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003eblue\u003c/span\u003e\u0026#x27; }}\u0026gt;\u003c/span\u003e\n        动画元素\n      \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{isAnimating\u003c/span\u003e ? \u003cspan class=\"hljs-attr inline\"\u003estopAnimation\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003estartAnimation\u003c/span\u003e}\u0026gt;\u003c/span\u003e\n        {isAnimating ? \u0026#x27;停止\u0026#x27; : \u0026#x27;开始\u0026#x27;}动画\n      \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  );\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"自定义动画-hook\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#自定义动画-hook\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 自定义动画 Hook\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e自定义动画 Hook\u003c/strong\u003e\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"jsx\" data-code=\"import%20%7B%20useEffect%2C%20useRef%2C%20useCallback%20%7D%20from%20'react'%3B%0Afunction%20useAnimationFrame(callback%2C%20isRunning%20%3D%20true)%20%7B%0Aconst%20requestRef%20%3D%20useRef()%3B%0Aconst%20animate%20%3D%20useCallback((timestamp)%20%3D%3E%20%7B%0Acallback(timestamp)%3B%0Aif%20(isRunning)%20%7B%0ArequestRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%0A%7D%2C%20%5Bcallback%2C%20isRunning%5D)%3B%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isRunning)%20%7B%0ArequestRef.current%20%3D%20requestAnimationFrame(animate)%3B%0A%7D%20else%20%7B%0Aif%20(requestRef.current)%20%7B%0AcancelAnimationFrame(requestRef.current)%3B%0A%7D%0A%7D%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(requestRef.current)%20%7B%0AcancelAnimationFrame(requestRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5Banimate%2C%20isRunning%5D)%3B%0A%7D%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%0Afunction%20MyAnimatedComponent()%20%7B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useState(0)%3B%0AuseAnimationFrame((timestamp)%20%3D%3E%20%7B%0AsetPosition(Math.sin(timestamp%20%2F%201000)%20*%20100)%3B%0A%7D)%3B%0Areturn%20(%0Adiv%20style%3D%7B%7B%20transform%3A%20%60translateX(%24%7Bposition%7Dpx)%60%20%7D%7D%3E%0A%E5%8A%A8%E7%94%BB%E5%86%85%E5%AE%B9%0Adiv%3E%0A)%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejsx\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-jsx\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e { useEffect, useRef, useCallback } \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003euseAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003ecallback, isRunning = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e requestRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e();\n\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e animate = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-title function_ inline\"\u003ecallback\u003c/span\u003e(timestamp);\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isRunning) {\n      requestRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n    }\n  }, [callback, isRunning]);\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isRunning) {\n      requestRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(animate);\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (requestRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(requestRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n      }\n    }\n\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (requestRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(requestRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n      }\n    };\n  }, [animate, isRunning]);\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 使用示例\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eMyAnimatedComponent\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003euseAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(\u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(timestamp / \u003cspan class=\"hljs-number inline\"\u003e1000\u003c/span\u003e) * \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e);\n  });\n\n  \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n    \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransform:\u003c/span\u003e `\u003cspan class=\"hljs-attr inline\"\u003etranslateX\u003c/span\u003e(${\u003cspan class=\"hljs-attr inline\"\u003eposition\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e)` }}\u0026gt;\u003c/span\u003e\n      动画内容\n    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  );\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"实际应用场景\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#实际应用场景\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 实际应用场景\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e实际应用场景\u003c/strong\u003e\n        \u003c/h3\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e平滑滚动\u003c/strong\u003e：页面滚动到指定位置\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e粒子系统\u003c/strong\u003e：创建粒子动画效果\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e数据可视化\u003c/strong\u003e：图表动画和过渡\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e游戏开发\u003c/strong\u003e：游戏循环和角色动画\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eUI 动效\u003c/strong\u003e：按钮点击、页面切换动画\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e性能监控\u003c/strong\u003e：FPS 计算和性能分析\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"注意事项\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#注意事项\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 注意事项\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e注意事项\u003c/strong\u003e\n        \u003c/h3\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e内存管理\u003c/strong\u003e：始终使用 \u003ccode\u003ecancelAnimationFrame\u003c/code\u003e 清理动画\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e条件检查\u003c/strong\u003e：在回调中检查动画是否应该继续\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e性能考虑\u003c/strong\u003e：避免在动画中进行复杂计算\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e浏览器兼容性\u003c/strong\u003e：现代浏览器都支持，需要时使用 polyfill\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"完整的动画管理器示例\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#完整的动画管理器示例\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 完整的动画管理器示例\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            \u003cstrong class=\"font-bold text-foreground\"\u003e完整的动画管理器示例\u003c/strong\u003e\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"javascript\" data-code=\"class%20AnimationManager%20%7B%0Aconstructor()%20%7B%0Athis.animations%20%3D%20new%20Map()%3B%0Athis.isRunning%20%3D%20false%3B%0Athis.animationId%20%3D%20null%3B%0A%7D%0Aadd(key%2C%20animationFn)%20%7B%0Athis.animations.set(key%2C%20%7B%0Afn%3A%20animationFn%2C%0Aactive%3A%20true%0A%7D)%3B%0Aif%20(!this.isRunning)%20%7B%0Athis.start()%3B%0A%7D%0A%7D%0Aremove(key)%20%7B%0Athis.animations.delete(key)%3B%0Aif%20(this.animations.size%20%3D%3D%3D%200)%20%7B%0Athis.stop()%3B%0A%7D%0A%7D%0Astart()%20%7B%0Aif%20(this.isRunning)%20return%3B%0Athis.isRunning%20%3D%20true%3B%0Athis.tick()%3B%0A%7D%0Astop()%20%7B%0Athis.isRunning%20%3D%20false%3B%0Aif%20(this.animationId)%20%7B%0AcancelAnimationFrame(this.animationId)%3B%0A%7D%0A%7D%0Atick%20%3D%20(timestamp)%20%3D%3E%20%7B%0Aif%20(!this.isRunning)%20return%3B%0A%2F%2F%20%E6%89%A7%E8%A1%8C%E6%89%80%E6%9C%89%E6%B4%BB%E8%B7%83%E7%9A%84%E5%8A%A8%E7%94%BB%0Afor%20(const%20%5Bkey%2C%20animation%5D%20of%20this.animations)%20%7B%0Aif%20(animation.active)%20%7B%0Aanimation.fn(timestamp)%3B%0A%7D%0A%7D%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E4%B8%8B%E4%B8%80%E5%B8%A7%0Athis.animationId%20%3D%20requestAnimationFrame(this.tick)%3B%0A%7D%0A%7D%0A%2F%2F%20%E5%85%A8%E5%B1%80%E5%8A%A8%E7%94%BB%E7%AE%A1%E7%90%86%E5%99%A8%0Aconst%20animationManager%20%3D%20new%20AnimationManager()%3B%0A%2F%2F%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%0AanimationManager.add('myAnimation'%2C%20(timestamp)%20%3D%3E%20%7B%0A%2F%2F%20%E5%8A%A8%E7%94%BB%E9%80%BB%E8%BE%91%0A%7D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejavascript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eAnimationManager\u003c/span\u003e {\n  \u003cspan class=\"hljs-title function_ inline\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimations\u003c/span\u003e = \u003cspan class=\"hljs-keyword inline\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eMap\u003c/span\u003e();\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003eadd\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003ekey, animationFn\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimations\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eset\u003c/span\u003e(key, {\n      \u003cspan class=\"hljs-attr inline\"\u003efn\u003c/span\u003e: animationFn,\n      \u003cspan class=\"hljs-attr inline\"\u003eactive\u003c/span\u003e: \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e\n    });\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e) {\n      \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003estart\u003c/span\u003e();\n    }\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003eremove\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003ekey\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimations\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003edelete\u003c/span\u003e(key);\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimations\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003esize\u003c/span\u003e === \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e) {\n      \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003estop\u003c/span\u003e();\n    }\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003estart\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n    \n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003etick\u003c/span\u003e();\n  }\n\n  \u003cspan class=\"hljs-title function_ inline\"\u003estop\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e) {\n      \u003cspan class=\"hljs-title function_ inline\"\u003ecancelAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e);\n    }\n  }\n\n  tick = \u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eisRunning\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 执行所有活跃的动画\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003efor\u003c/span\u003e (\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [key, animation] \u003cspan class=\"hljs-keyword inline\"\u003eof\u003c/span\u003e \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimations\u003c/span\u003e) {\n      \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (animation.\u003cspan class=\"hljs-property inline\"\u003eactive\u003c/span\u003e) {\n        animation.\u003cspan class=\"hljs-title function_ inline\"\u003efn\u003c/span\u003e(timestamp);\n      }\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 请求下一帧\u003c/span\u003e\n    \u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eanimationId\u003c/span\u003e = \u003cspan class=\"hljs-title function_ inline\"\u003erequestAnimationFrame\u003c/span\u003e(\u003cspan class=\"hljs-variable language_ inline\"\u003ethis\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003etick\u003c/span\u003e);\n  }\n}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 全局动画管理器\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e animationManager = \u003cspan class=\"hljs-keyword inline\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eAnimationManager\u003c/span\u003e();\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 使用示例\u003c/span\u003e\nanimationManager.\u003cspan class=\"hljs-title function_ inline\"\u003eadd\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;myAnimation\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003etimestamp\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment inline\"\u003e// 动画逻辑\u003c/span\u003e\n});\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003erequestAnimationFrame\u003c/code\u003e 是现代 Web 动画的核心 API，提供了流畅、高效的动画解决方案。\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"$L1d\",null,{\"htmlContent\":\"$1e\",\"frontMatter\":{\"title\":\"requestAnimationFrame\",\"description\":\"浏览器基础知识篇-requestAnimationFrame\",\"date\":\"2025-06-22\",\"author\":\"MilkWind\",\"tags\":[\"浏览器\",\"基础知识\",\"requestAnimationFrame\",\"动画\"],\"references\":{}},\"readingTime\":\"10 min read\",\"category\":\"basic-knowledge\",\"tocItems\":[{\"id\":\"基本作用\",\"text\":\"基本作用\",\"level\":3},{\"id\":\"基本用法\",\"text\":\"基本用法\",\"level\":3},{\"id\":\"工作原理与常见问题\",\"text\":\"工作原理与常见问题\",\"level\":3},{\"id\":\"为什么一般在使用requestanimationframe函数的时候，都是递归调用？\",\"text\":\"为什么一般在使用requestAnimationFrame函数的时候，都是递归调用？\",\"level\":4},{\"id\":\"持续性递归调用requestanimationframe难道不会导致栈溢出吗？\",\"text\":\"持续性递归调用requestAnimationFrame难道不会导致栈溢出吗？\",\"level\":4},{\"id\":\"什么是浏览器的重绘任务队列？\",\"text\":\"什么是浏览器的重绘任务队列？\",\"level\":4},{\"id\":\"requestanimationframe是如何确保与浏览器刷新率同步的？\",\"text\":\"requestAnimationFrame是如何确保与浏览器刷新率同步的？\",\"level\":4},{\"id\":\"与传统方案的对比\",\"text\":\"与传统方案的对比\",\"level\":3},{\"id\":\"settimeoutsetinterval-的问题\",\"text\":\"setTimeout/setInterval 的问题\",\"level\":4},{\"id\":\"requestanimationframe-的优势\",\"text\":\"requestAnimationFrame 的优势\",\"level\":4},{\"id\":\"实用示例\",\"text\":\"实用示例\",\"level\":3},{\"id\":\"简单的移动动画\",\"text\":\"简单的移动动画\",\"level\":4},{\"id\":\"时间控制的动画\",\"text\":\"时间控制的动画\",\"level\":4},{\"id\":\"性能优化技巧\",\"text\":\"性能优化技巧\",\"level\":3},{\"id\":\"避免强制重排（forced-reflow）\",\"text\":\"避免强制重排（Forced Reflow）\",\"level\":4},{\"id\":\"使用-css-变换代替位置改变\",\"text\":\"使用 CSS 变换代替位置改变\",\"level\":4},{\"id\":\"react-中的使用\",\"text\":\"React 中的使用\",\"level\":3},{\"id\":\"自定义动画-hook\",\"text\":\"自定义动画 Hook\",\"level\":3},{\"id\":\"实际应用场景\",\"text\":\"实际应用场景\",\"level\":3},{\"id\":\"注意事项\",\"text\":\"注意事项\",\"level\":3},{\"id\":\"完整的动画管理器示例\",\"text\":\"完整的动画管理器示例\",\"level\":3}],\"translations\":{\"common\":{\"welcome\":\"欢迎\",\"loading\":\"加载中...\",\"error\":\"出现了一些问题\",\"retry\":\"重试\",\"theme\":\"主题\",\"language\":\"语言\",\"light\":\"浅色\",\"dark\":\"深色\"},\"navigation\":{\"home\":\"首页\",\"personal\":\"个人\",\"works\":\"作品\",\"contributions\":\"贡献\",\"documents\":\"文档\",\"about\":\"关于\",\"contact\":\"联系\"},\"personal\":{\"technicalSkills\":\"技术技能\",\"email\":\"邮箱\",\"github\":\"代码仓库\",\"resume\":\"简历\",\"codeRepository\":\"代码仓库\",\"loadingPersonalInfo\":\"加载个人信息中...\",\"loadingResume\":\"加载简历中...\",\"closeResume\":\"关闭简历\",\"emailCopied\":\"邮箱已复制到剪贴板！\",\"galaxyDefaultDescription\":\"精通全栈开发技术，具备跨平台架构能力，擅长AI技术整合与高性能系统优化\",\"skillGalaxy\":\"技能星系\",\"stirGalaxy\":\"搅动星系\",\"stirring\":\"搅动中...\",\"fullStackEngineer\":\"MilkWind - 全栈工程师\",\"professionalProfile\":\"关于我\"},\"documents\":{\"technicalDocuments\":\"技术文档\",\"description\":\"基本原理、代码拆分以及一些碎碎念。\",\"articles\":\"文章\",\"categories\":\"分类\",\"allCategories\":\"所有分类\",\"noArticlesFound\":\"未找到文章\",\"noArticlesAvailable\":\"中文暂无文章。\",\"noArticlesInCategory\":\"该分类下未找到文章。\",\"readMore\":\"阅读更多\",\"loadingDocuments\":\"加载文档中...\",\"backToDocuments\":\"← 返回文档\",\"documentNotFound\":\"文档未找到\",\"documentNotFoundDescription\":\"请求的文档无法找到。\",\"technicalInsights\":\"技术拆解\",\"untitledDocument\":\"无标题文档\",\"byAuthor\":\"作者：\",\"search\":\"搜索文章...\",\"searchByTags\":\"按标签筛选\",\"searching\":\"搜索中...\",\"noSearchResults\":\"没有找到符合搜索条件的文章\",\"clearSearch\":\"清除搜索\",\"selectedTags\":\"已选标签\",\"allTags\":\"所有标签\",\"searchInTitle\":\"在标题、描述和内容中搜索\",\"enterImmersiveMode\":\"沉浸阅读\",\"exitImmersiveMode\":\"退出沉浸模式\",\"immersiveReading\":\"沉浸阅读模式\",\"exploreContent\":\"按分类探索内容\",\"browseBy\":\"浏览方式\",\"exploreAll\":\"所有内容汇总\",\"categoryDescription\":\"该分类下的文章\",\"totalArticles\":\"文章\",\"totalCategories\":\"分类\",\"foundArticles\":\"找到文章\",\"categoriesWithResults\":\"有结果的分类\"},\"works\":{\"workCases\":\"作品案例\",\"projects\":\"作品集\",\"loadingProjects\":\"加载项目中...\",\"grid\":\"网格\",\"stack\":\"堆叠\",\"of\":\"共\",\"workCasesPageTitle\":\"作品案例页面\",\"pageWorkingCorrectly\":\"此页面运行正常！路由配置正确。\",\"try3DVersion\":\"尝试3D版本\",\"dragToScroll\":\"拖拽滚动\",\"dragToChange\":\"拖拽切换\",\"swipeCards\":\"切换卡片\",\"keyboardNav\":\"键盘导航\"},\"contributions\":{\"contributionCases\":\"开源项目\",\"contributions\":\"贡献\",\"loadingContributions\":\"加载贡献中...\",\"grid\":\"网格\",\"stack\":\"堆叠\",\"of\":\"共\",\"contributionCasesPageTitle\":\"贡献案例页面\",\"pageWorkingCorrectly\":\"此页面运行正常！路由配置正确。\",\"try3DVersion\":\"尝试3D版本\",\"dragToScroll\":\"拖拽滚动\",\"dragToChange\":\"拖拽切换\",\"swipeCards\":\"切换卡片\",\"keyboardNav\":\"键盘导航\"},\"contribution\":{\"contributionPreview\":\"贡献预览\",\"accessible\":\"可访问\",\"code\":\"代码\",\"maintenance\":\"维护\",\"enhancement\":\"增强\",\"documentation\":\"文档\",\"community\":\"社区\",\"moreItems\":\"更多\",\"technicalDetails\":\"技术详情\",\"technologies\":\"技术栈：\",\"contributionDetail\":\"贡献详情\",\"description\":\"描述：\",\"seeDetails\":\"查看详情\",\"github\":\"代码仓库\",\"viewContribution\":\"查看贡献\",\"viewCode\":\"查看代码\"},\"project\":{\"projectPreview\":\"项目预览\",\"accessible\":\"可访问\",\"tool\":\"工具\",\"plugin\":\"插件\",\"toy\":\"小玩意\",\"moreItems\":\"更多\",\"technicalDetails\":\"技术详情\",\"technologies\":\"技术栈：\",\"description\":\"描述：\",\"seeDetails\":\"查看详情\",\"github\":\"GitHub\",\"gitee\":\"Gitee\",\"viewLiveDemo\":\"查看演示\",\"viewCode\":\"查看代码\",\"access\":\"访问\",\"videos\":\"视频\",\"watchVideo\":\"观看视频\",\"hasVideo\":\"有视频\"},\"codeblock\":{\"copy\":\"复制\",\"copySuccess\":\"代码已复制到剪贴板！\",\"copyError\":\"复制代码失败\",\"copyTooltip\":\"复制代码\"},\"toc\":{\"contents\":\"目录\",\"autoScroll\":\"自动滚动到章节\",\"collapse\":\"折叠\",\"expand\":\"展开\"},\"loading\":{\"loading\":\"加载中\",\"preparingExperience\":\"准备体验中\"}},\"lang\":\"zh\",\"theme\":\"light\"}]\n"])</script><script>self.__next_f.push([1,"12:null\n"])</script><script>self.__next_f.push([1,"18:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n11:null\n"])</script><script>self.__next_f.push([1,"1c:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"requestAnimationFrame | Interactive Portfolio\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"浏览器基础知识篇-requestAnimationFrame\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Developer\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"portfolio,3D,interactive,web development,Three.js,Next.js\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"requestAnimationFrame | Interactive Portfolio\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"浏览器基础知识篇-requestAnimationFrame\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"7\",{\"property\":\"article:published_time\",\"content\":\"2025-06-22\"}],[\"$\",\"meta\",\"8\",{\"property\":\"article:tag\",\"content\":\"浏览器\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:tag\",\"content\":\"基础知识\"}],[\"$\",\"meta\",\"10\",{\"property\":\"article:tag\",\"content\":\"requestAnimationFrame\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:tag\",\"content\":\"动画\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\"requestAnimationFrame | Interactive Portfolio\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"浏览器基础知识篇-requestAnimationFrame\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}]],\"error\":null,\"digest\":\"$undefined\"}\n14:{\"metadata\":\"$1c:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>