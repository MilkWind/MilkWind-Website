<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/704956702722271c.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b226d7ef8e491b72.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5eacd01f773eed7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-18c0f30037e967de.js"/><script src="/_next/static/chunks/4bd1b696-5119e10e90c1bd1b.js" async=""></script><script src="/_next/static/chunks/1684-be5e4efdb509cc75.js" async=""></script><script src="/_next/static/chunks/main-app-c5f95d71e93250dc.js" async=""></script><script src="/_next/static/chunks/46-72724587da45cdb8.js" async=""></script><script src="/_next/static/chunks/app/layout-af4a6e723c0ff668.js" async=""></script><script src="/_next/static/chunks/app/error-dda32be1d095a86c.js" async=""></script><script src="/_next/static/chunks/6874-fbe9a08eb79b991c.js" async=""></script><script src="/_next/static/chunks/app/not-found-9ff98b2ccf24cac7.js" async=""></script><script src="/_next/static/chunks/206-4f4cbf4d7156f437.js" async=""></script><script src="/_next/static/chunks/app/documents/layout-28408791defde09e.js" async=""></script><script src="/_next/static/chunks/2415-689c103fb3d2c28d.js" async=""></script><script src="/_next/static/chunks/8610-7bd3f91f3cf2a4d6.js" async=""></script><script src="/_next/static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js" async=""></script><script src="/_next/static/chunks/app/loading-68f227fb49b3ac8c.js" async=""></script><script src="/_next/static/chunks/b498d07c-095637f0f10883c6.js" async=""></script><script src="/_next/static/chunks/9554-b714f9de28e85d30.js" async=""></script><script src="/_next/static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js" async=""></script><title>浮动导航球：从数学原理到交互实现 | Interactive Portfolio</title><meta name="description" content="详细解析可拖拽、可吸附、可展开的圆形菜单系统"/><meta name="author" content="Developer"/><meta name="keywords" content="portfolio,3D,interactive,web development,Three.js,Next.js"/><meta property="og:title" content="浮动导航球：从数学原理到交互实现 | Interactive Portfolio"/><meta property="og:description" content="详细解析可拖拽、可吸附、可展开的圆形菜单系统"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-06-22"/><meta property="article:tag" content="导航设计"/><meta property="article:tag" content="交互设计"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="浮动导航球：从数学原理到交互实现 | Interactive Portfolio"/><meta name="twitter:description" content="详细解析可拖拽、可吸附、可展开的圆形菜单系统"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="32x32"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_d4c88d __variable_7b4e2b __variable_c3272d font-sans antialiased min-h-screen bg-background text-foreground"><div class="fixed inset-0 w-full h-full overflow-hidden pointer-events-none z-0" style="background:linear-gradient(135deg, hsl(210, 80%, 60%), hsl(180, 40%, 50%))"></div><div class="fixed top-20 right-5 z-50"><div class="w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40"></div></div><!--$--><style>
:root {
  --bprogress-color: #0066cc;
  --bprogress-height: 4px;
  --bprogress-spinner-size: 18px;
  --bprogress-spinner-animation-duration: 400ms;
  --bprogress-spinner-border-size: 2px;
  --bprogress-box-shadow: 0 0 10px #0066cc, 0 0 5px #0066cc;
  --bprogress-z-index: 99999;
  --bprogress-spinner-top: 15px;
  --bprogress-spinner-bottom: auto;
  --bprogress-spinner-right: 15px;
  --bprogress-spinner-left: auto;
}

.bprogress {
  width: 0;
  height: 0;
  pointer-events: none;
  z-index: var(--bprogress-z-index);
}

.bprogress .bar {
  background: var(--bprogress-color);
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
}

/* Fancy blur effect */
.bprogress .peg {
  display: block;
  position: absolute;
  right: 0;
  width: 100px;
  height: 100%;
  box-shadow: var(--bprogress-box-shadow);
  opacity: 1.0;
  transform: rotate(3deg) translate(0px, -4px);
}

/* Remove these to get rid of the spinner */
.bprogress .spinner {
  display: block;
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: var(--bprogress-spinner-top);
  bottom: var(--bprogress-spinner-bottom);
  right: var(--bprogress-spinner-right);
  left: var(--bprogress-spinner-left);
}

.bprogress .spinner-icon {
  width: var(--bprogress-spinner-size);
  height: var(--bprogress-spinner-size);
  box-sizing: border-box;
  border: solid var(--bprogress-spinner-border-size) transparent;
  border-top-color: var(--bprogress-color);
  border-left-color: var(--bprogress-color);
  border-radius: 50%;
  -webkit-animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
  animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
}

.bprogress-custom-parent {
  overflow: hidden;
  position: relative;
}

.bprogress-custom-parent .bprogress .spinner,
.bprogress-custom-parent .bprogress .bar {
  position: absolute;
}

.bprogress .indeterminate {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
  overflow: hidden;
}

.bprogress .indeterminate .inc,
.bprogress .indeterminate .dec {
  position: absolute;
  top: 0;
  height: 100%;
  background-color: var(--bprogress-color);
}

.bprogress .indeterminate .inc {
  animation: bprogress-indeterminate-increase 2s infinite;
}

.bprogress .indeterminate .dec {
  animation: bprogress-indeterminate-decrease 2s 0.5s infinite;
}

@-webkit-keyframes bprogress-spinner {
  0%   { -webkit-transform: rotate(0deg); transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }
}

@keyframes bprogress-spinner {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes bprogress-indeterminate-increase {
  from { left: -5%; width: 5%; }
  to { left: 130%; width: 100%; }
}

@keyframes bprogress-indeterminate-decrease {
  from { left: -80%; width: 80%; }
  to { left: 110%; width: 10%; }
}
</style><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--><!--$--><div class="relative z-30 min-h-screen bg-background "><div class="container mx-auto px-4 py-8 max-w-4xl"><div class="mb-8"><a class="inline-flex items-center text-primary hover:text-primary/80 transition-colors" href="/documents/">documents.backToDocuments</a></div><header class="mb-12"><div class="flex items-center gap-4 mb-4 text-sm text-foreground/60"><span class="px-3 py-1 bg-primary/20 text-primary rounded-full capitalize">personal website</span><span>40 min read</span></div><h1 class="font-bold mb-4 bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent text-4xl md:text-5xl">浮动导航球：从数学原理到交互实现</h1><p class="text-xl text-foreground/80 max-w-3xl">详细解析可拖拽、可吸附、可展开的圆形菜单系统</p><div class="flex flex-wrap gap-2 mt-6"><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">导航设计</span><span class="px-3 py-1 text-sm bg-accent/20 text-accent rounded-full">交互设计</span></div></header><article class="prose prose-headings:mt-8 prose-headings:font-semibold prose-headings:text-foreground prose-h1:text-5xl prose-h2:text-4xl prose-h3:text-3xl prose-h4:text-2xl prose-h5:text-xl prose-h6:text-lg max-w-none "><div class="prose-pre:p-4 prose-pre:bg-surface w-full"><h1 id="浮动导航球：从数学原理到交互实现" class="group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight">
            <a href="#浮动导航球：从数学原理到交互实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 浮动导航球：从数学原理到交互实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            浮动导航球：从数学原理到交互实现
        </h1>
<p class="text-base leading-7 mb-4 text-foreground">编写导航栏菜单的时候我就在想，如何在突破传统布局的基础上表现出现代感与科技感呢？要不整个悬浮球类型的导航栏？…于是我就这么做了。</p>
<p class="text-base leading-7 mb-4 text-foreground">想象一下，如果你的网站导航可以像一个智能助手一样，平时安静地待在角落，需要时优雅地滑向屏幕中央展开所有功能，用完后又乖巧地回到原位…嗯，确实挺不错的。</p>
<p class="text-base leading-7 mb-4 text-foreground">这个浮动导航球集成了复杂的交互逻辑：可拖拽、可吸附到屏幕边缘、可展开为圆形菜单、还有流畅的动画过渡。在这篇文章中，我将从最基础的坐标计算开始，逐步深入每一个实现细节，全面剖析这个看似简单实则复杂的交互系统。</p>
<h2 id="状态管理" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#状态管理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 状态管理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            状态管理
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">任何复杂的交互系统都需要精心设计的状态管理，我们的浮动导航球也不例外。我们可以先快速阅览一下总体的状态成员：</p>
<h3 id="状态定义" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#状态定义" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 状态定义">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            状态定义
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">为什么需要这么多状态变量？因为每一个状态都承载着特定的职责，它们共同构成了一个完整的交互生态系统。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> [mounted, setMounted] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [isExpanded, setIsExpanded] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [position, setPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});
<span class="hljs-keyword inline">const</span> [originalPosition, setOriginalPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});
<span class="hljs-keyword inline">const</span> [isDragging, setIsDragging] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [dragOffset, setDragOffset] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});
<span class="hljs-keyword inline">const</span> [dragStartPosition, setDragStartPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});
<span class="hljs-keyword inline">const</span> [showRipple, setShowRipple] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
</code></pre>
            </div>
        
<h3 id="核心状态详解" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#核心状态详解" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 核心状态详解">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            核心状态详解
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">让我逐一解释这些状态的作用：</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">mounted</strong>: 这是一个&quot;保险丝&quot;状态。在服务端渲染的世界里，<code>window.innerWidth</code>在初始渲染时是未定义的，所以我们需要等到组件真正挂载到浏览器中后再进行位置计算。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">isExpanded</strong>: 导航球的&quot;开关&quot;状态。<code>false</code>时是一个小球，<code>true</code>时展开为圆形菜单。这个状态控制着整个UI的形态变化。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">position</strong>: 当前的实时位置坐标。这是整个拖拽系统的核心，所有的位置变化都反映在这里。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">originalPosition</strong>: &quot;记忆中的家&quot;。当导航球展开时，它会移动到屏幕中央，但我们需要记住它原来的位置，这样收起时就能回到原地。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">isDragging</strong>: 拖拽状态的标记。当用户按下鼠标开始拖拽时为<code>true</code>，释放鼠标时为<code>false</code>。这个状态影响着鼠标事件的监听和视觉反馈。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">dragOffset</strong>: 这个是最容易被忽视但又最重要的状态。它记录了鼠标点击位置相对于导航球左上角的偏移量，确保拖拽时球不会&quot;跳跃&quot;到鼠标位置。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">dragStartPosition</strong>: 拖拽起始点的记录员。我们需要它来计算拖拽距离，区分&quot;点击&quot;和&quot;真正的拖拽&quot;。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">showRipple</strong>: 视觉反馈的开关。在拖拽过程中显示波纹效果，让用户知道&quot;我正在移动这个东西&quot;。</p>
<h3 id="状态机设计" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#状态机设计" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 状态机设计">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            状态机设计
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">这些状态之间的关系构成了一个复杂的状态机：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="%E6%AD%A3%E5%B8%B8%E7%8A%B6%E6%80%81%20%E2%86%90%E2%86%92%20%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%20%E2%86%92%20%E5%90%B8%E9%99%84%E7%8A%B6%E6%80%81%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%91%0A%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%20%E2%86%90--------------%E2%94%98">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>正常状态 ←→ 拖拽状态 → 吸附状态
    ↓                  ↑
展开状态 ←<span class="hljs-comment inline">--------------┘</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">关键的状态转换逻辑：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">正常→拖拽</strong>: <code>mouseDown</code>事件触发，同时设置<code>isDragging=true</code>和记录初始偏移</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">拖拽→吸附</strong>: <code>mouseUp</code>事件触发，执行边缘吸附算法</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">正常→展开</strong>: 点击事件触发（非拖拽），移动到屏幕中央</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">展开→正常</strong>: 再次点击或点击背景，回到原始位置</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">这个状态机的精妙之处在于它能够正确处理边界情况，比如用户在拖拽过程中快速点击，或者在展开状态下开始拖拽等等。</p>
<h2 id="坐标系统与位置记录" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#坐标系统与位置记录" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 坐标系统与位置记录">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            坐标系统与位置记录
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">在浏览器的世界里，有很多种坐标系统可以选择，我们的选择决定了整个系统的复杂度和性能。</p>
<h3 id="坐标系统选择" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#坐标系统选择" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 坐标系统选择">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            坐标系统选择
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">我选择了绝对定位(<code>position: fixed</code>) + <code>left/top</code>属性的方案，而不是更现代的<code>transform</code>方案。为什么？</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8%E7%9A%84%E6%96%B9%E6%A1%88%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0A%7D%7D%0A%2F%2F%20%E8%80%8C%E4%B8%8D%E6%98%AF%E8%BF%99%E6%A0%B7%0Astyle%3D%7B%7B%0Atransform%3A%20%60translate(%24%7Bposition.x%7Dpx%2C%20%24%7Bposition.y%7Dpx)%60%0A%7D%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 我们使用的方案</span>
style={{
    <span class="hljs-attr inline">left</span>: <span class="hljs-string inline">`<span class="hljs-subst inline">${position.x}</span>px`</span>,
    <span class="hljs-attr inline">top</span>: <span class="hljs-string inline">`<span class="hljs-subst inline">${position.y}</span>px`</span>,
}}

<span class="hljs-comment inline">// 而不是这样</span>
style={{
    <span class="hljs-attr inline">transform</span>: <span class="hljs-string inline">`translate(<span class="hljs-subst inline">${position.x}</span>px, <span class="hljs-subst inline">${position.y}</span>px)`</span>
}}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><del class="line-through opacity-60">（主要是懒）</del>原因很简单：<strong class="font-bold text-foreground">计算的简单性</strong>。使用<code>left/top</code>时，坐标值就直接对应屏幕位置，我们可以直接用<code>getBoundingClientRect()</code>获取元素位置进行计算。而使用<code>transform</code>时，元素的实际渲染位置和CSS中记录的位置可能不一致，增加了计算复杂度。</p>
<p class="text-base leading-7 mb-4 text-foreground">虽然<code>transform</code>在某些情况下性能更好（GPU加速），但对于单个导航球来说，这点性能差异可以忽略不计。有时候，简单就是美。</p>
<h3 id="位置初始化策略" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#位置初始化策略" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 位置初始化策略">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            位置初始化策略
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20initialX%20%3D%20window.innerWidth%20-%2080%3B%0Aconst%20initialY%20%3D%20100%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> initialX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> - <span class="hljs-number inline">80</span>;
<span class="hljs-keyword inline">const</span> initialY = <span class="hljs-number inline">100</span>;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>window.innerWidth - 80</code>确保球完全在屏幕内，80px是球的大小加上一些余量，以确保浮动导航球在各种设备上都具有较高的初始可见性。</p>
<h3 id="dragoffset的数学原理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#dragoffset的数学原理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to dragOffset的数学原理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            dragOffset的数学原理
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">这是整个拖拽系统中最容易出错的部分。让我用一个例子来说明：</p>
<p class="text-base leading-7 mb-4 text-foreground">假设导航球的左上角位置是<code>(100, 50)</code>，用户在球的中心位置<code>(132, 82)</code>点击开始拖拽（球的大小是64x64px）。</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20132%20-%20100%20%3D%2032%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%2082%20-%2050%20%3D%2032%0A%7D)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">React</span>.<span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt; {
    <span class="hljs-keyword inline">const</span> rect = ballRef.<span class="hljs-property inline">current</span>?.<span class="hljs-title function_ inline">getBoundingClientRect</span>();
    <span class="hljs-keyword inline">if</span> (rect) {
        <span class="hljs-title function_ inline">setDragOffset</span>({
            <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - rect.<span class="hljs-property inline">left</span>,  <span class="hljs-comment inline">// 132 - 100 = 32</span>
            <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - rect.<span class="hljs-property inline">top</span>    <span class="hljs-comment inline">// 82 - 50 = 32</span>
        });
    }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">现在，当鼠标移动到<code>(200, 150)</code>时，新的球位置应该是：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%20%20%2F%2F%20200%20-%2032%20%3D%20168%0Ay%3A%20e.clientY%20-%20dragOffset.y%20%20%20%2F%2F%20150%20-%2032%20%3D%20118%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> newPos = {
    <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,  <span class="hljs-comment inline">// 200 - 32 = 168</span>
    <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>   <span class="hljs-comment inline">// 150 - 32 = 118</span>
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">这样，球的中心点就会跟随鼠标，而不会产生&quot;跳跃&quot;效果。倘若没有最后修正的-32像素，那么当拖拽实际发生时，光标会指向球的左上角，而非球心位置，造成拖拽偏移误差。</p>
<h2 id="拖拽系统实现" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#拖拽系统实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 拖拽系统实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            拖拽系统实现
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">拖拽系统是整个导航球的核心功能，它需要处理复杂的事件序列和状态变化。</p>
<h3 id="拖拽生命周期" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#拖拽生命周期" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 拖拽生命周期">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            拖拽生命周期
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">一次完整的拖拽操作包含三个阶段：</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">mouseDown</strong>: 初始化拖拽状态</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">mouseMove</strong>: 持续更新位置</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">mouseUp</strong>: 结束拖拽并执行后续逻辑</li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground">每个阶段都有其特定的职责和处理逻辑。</p>
<h3 id="防抖动画实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#防抖动画实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 防抖动画实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            防抖动画实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">传统的拖拽实现会在每次<code>mouseMove</code>时立即更新位置，但这会导致性能问题和视觉上的抖动。我采用了防抖策略：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E6%96%B0%E4%BD%8D%E7%BD%AE%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20%E5%AD%98%E5%82%A8%E5%BE%85%E6%9B%B4%E6%96%B0%E7%9A%84%E4%BD%8D%E7%BD%AE%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%0AsetShowRipple(true)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E5%B7%B2%E6%9C%89%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20%E8%AE%BE%E7%BD%AE%E6%96%B0%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%7D%2C%20%5BisDragging%2C%20dragOffset%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> handleMouseMove = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-comment inline">// 计算新位置</span>
    <span class="hljs-keyword inline">const</span> newPos = {
        <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,
        <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>
    };

    <span class="hljs-comment inline">// 存储待更新的位置</span>
    pendingPositionRef.<span class="hljs-property inline">current</span> = newPos;

    <span class="hljs-comment inline">// 立即显示波纹效果</span>
    <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">true</span>);

    <span class="hljs-comment inline">// 清除已有的防抖定时器</span>
    <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
    }

    <span class="hljs-comment inline">// 设置新的防抖定时器</span>
    debounceTimerRef.<span class="hljs-property inline">current</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-title function_ inline">setPosition</span>(newPos);
        <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);
    }, <span class="hljs-number inline">500</span>);
}, [isDragging, dragOffset]);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">注意：</strong>我使用了<code>ref</code>而非<code>state</code>来存储待更新的位置，这是因为<code>useState</code>的更新是异步的，当我使用异步更新状态时，会存在读值隐患，即：我在读取&quot;更新后&quot;的值时，异步更新尚未完成，所以实际上读取的是更新前的值，导致实际的结果异常。而<code>ref</code>的更新策略是同步的，不会存在线程安全问题，这意味着我在&quot;更新后&quot;读取到的值就是更新后的值。</p>
<h3 id="拖拽距离判定" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#拖拽距离判定" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 拖拽距离判定">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            拖拽距离判定
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">如何区分&quot;点击&quot;和&quot;拖拽&quot;？这是一个经典的UI交互问题。我的解决方案基于欧几里得距离：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E8%AE%B0%E5%BD%95%E6%8B%96%E6%8B%BD%E8%B5%B7%E5%A7%8B%E4%BD%8D%E7%BD%AE%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20%E5%9C%A8mouseMove%E4%B8%AD%E8%AE%A1%E7%AE%97%E8%B7%9D%E7%A6%BB%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 记录拖拽起始位置</span>
<span class="hljs-title function_ inline">setDragStartPosition</span>({<span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span>, <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span>});

<span class="hljs-comment inline">// 在mouseMove中计算距离</span>
<span class="hljs-keyword inline">const</span> dragDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sqrt</span>(
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientX</span> - dragStartPosition.<span class="hljs-property inline">x</span>, <span class="hljs-number inline">2</span>) +
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientY</span> - dragStartPosition.<span class="hljs-property inline">y</span>, <span class="hljs-number inline">2</span>)
);

<span class="hljs-keyword inline">if</span> (dragDistance &gt; <span class="hljs-number inline">3</span>) {
    hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">true</span>;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">只有在浮动导航球移动超过3像素时，才会被视为&quot;拖拽&quot;，否则会视为&quot;点击&quot;。一般来说，人手的自然抖动通常在1-2像素范围内，3像素可以有效过滤掉这些无意的微小移动，同时又不会妨碍真正的拖拽意图。</p>
<h3 id="拖拽结束的智能处理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#拖拽结束的智能处理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 拖拽结束的智能处理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            拖拽结束的智能处理
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0A%2F%2F%20%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%20-%20%E6%89%A7%E8%A1%8C%E5%90%B8%E9%99%84%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%0A%7D%0A%2F%2F%20%E9%87%8D%E7%BD%AE%E6%8B%96%E6%8B%BD%E6%A0%87%E8%AE%B0%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> handleMouseUp = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

    <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">false</span>);
    <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);

    <span class="hljs-comment inline">// 清除防抖定时器</span>
    <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
    }

    <span class="hljs-keyword inline">if</span> (hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-comment inline">// 显著拖拽 - 执行吸附</span>
        <span class="hljs-keyword inline">const</span> snappedPos = <span class="hljs-title function_ inline">snapToEdge</span>(pendingPositionRef.<span class="hljs-property inline">current</span>);
        <span class="hljs-title function_ inline">setPosition</span>(snappedPos);
        <span class="hljs-title function_ inline">setOriginalPosition</span>(snappedPos);
    }

    <span class="hljs-comment inline">// 重置拖拽标记</span>
    <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">false</span>;
    }, <span class="hljs-number inline">100</span>);
}, [isDragging]);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">这里有个细节：为什么重置拖拽标记要延迟100ms？因为<code>mouseUp</code>和<code>click</code>事件有时序差异，如果立即重置，可能会导致点击事件错误地被处理为拖拽后的点击。100ms的延迟确保了事件处理的正确顺序。</p>
<h2 id="边缘吸附算法" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#边缘吸附算法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 边缘吸附算法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            边缘吸附算法
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">吸附效果是一种人性化设计，它可以确保在你对导航球&quot;放手&quot;时，它会自动停留在距离屏幕边缘一个固定距离上的位置，解决视觉强迫症用户的核心痛点。<del class="line-through opacity-60">（比如说我）</del></p>
<h3 id="吸附算法核心逻辑" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#吸附算法核心逻辑" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 吸附算法核心逻辑">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            吸附算法核心逻辑
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">吸附的数学原理其实很简单：计算当前位置到四个边界的距离，然后移动到距离最近的边界：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%2F%2F%20%E7%90%83%E7%9A%84%E5%A4%A7%E5%B0%8F%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E8%BE%B9%E7%BC%98%E7%9A%84%E9%97%B4%E8%B7%9D%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%88%B0%E5%9B%9B%E4%B8%AA%E8%BE%B9%E7%95%8C%E7%9A%84%E8%B7%9D%E7%A6%BB%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20%E6%89%BE%E5%88%B0%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%0Aconst%20minDistance%20%3D%20Math.min(%0AdistanceToLeft%2C%0AdistanceToRight%2C%0AdistanceToTop%2C%0AdistanceToBottom%0A)%3B%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E5%86%B3%E5%AE%9A%E5%90%B8%E9%99%84%E6%96%B9%E5%90%91%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%0A%7D%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> snapToEdge = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">currentPos</span>: <span class="hljs-title class_ inline">Position</span></span>) =&gt;</span> {
    <span class="hljs-keyword inline">const</span> windowWidth = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span>;
    <span class="hljs-keyword inline">const</span> windowHeight = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span>;
    <span class="hljs-keyword inline">const</span> ballSize = <span class="hljs-number inline">70</span>;  <span class="hljs-comment inline">// 球的大小</span>
    <span class="hljs-keyword inline">const</span> margin = <span class="hljs-number inline">20</span>;    <span class="hljs-comment inline">// 距离边缘的间距</span>
    
    <span class="hljs-comment inline">// 计算到四个边界的距离</span>
    <span class="hljs-keyword inline">const</span> distanceToLeft = currentPos.<span class="hljs-property inline">x</span>;
    <span class="hljs-keyword inline">const</span> distanceToRight = windowWidth - currentPos.<span class="hljs-property inline">x</span>;
    <span class="hljs-keyword inline">const</span> distanceToTop = currentPos.<span class="hljs-property inline">y</span>;
    <span class="hljs-keyword inline">const</span> distanceToBottom = windowHeight - currentPos.<span class="hljs-property inline">y</span>;
    
    <span class="hljs-comment inline">// 找到最小距离</span>
    <span class="hljs-keyword inline">const</span> minDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(
        distanceToLeft, 
        distanceToRight, 
        distanceToTop, 
        distanceToBottom
    );
    
    <span class="hljs-keyword inline">let</span> newPos = {...currentPos};
    
    <span class="hljs-comment inline">// 根据最小距离决定吸附方向</span>
    <span class="hljs-keyword inline">if</span> (minDistance === distanceToLeft) {
        newPos.<span class="hljs-property inline">x</span> = margin;
    } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToRight) {
        newPos.<span class="hljs-property inline">x</span> = windowWidth - ballSize - margin;
    } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToTop) {
        newPos.<span class="hljs-property inline">y</span> = margin;
    } <span class="hljs-keyword inline">else</span> {
        newPos.<span class="hljs-property inline">y</span> = windowHeight - ballSize - margin;
    }
    
    <span class="hljs-keyword inline">return</span> newPos;
}, []);
</code></pre>
            </div>
        
<h3 id="边界计算的数学原理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#边界计算的数学原理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 边界计算的数学原理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            边界计算的数学原理
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">距离计算解释：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToLeft</strong>: 直接等于<code>currentPos.x</code>，因为左边界就是x=0</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToRight</strong>: <code>windowWidth - currentPos.x</code>，因为右边界是窗口宽度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToTop</strong>: 直接等于<code>currentPos.y</code>，因为上边界就是y=0</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">distanceToBottom</strong>: <code>windowWidth - currentPos.y</code>，因为下边界是窗口高度</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><code>Math.min()</code>会找到这四个值中的最小值，对应着距离最近的边界。</p>
<h3 id="边界约束实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#边界约束实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 边界约束实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            边界约束实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">这是一个防止边界超出的保护逻辑：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="newPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript">newPos.<span class="hljs-property inline">x</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowWidth - ballSize - margin, newPos.<span class="hljs-property inline">x</span>));
newPos.<span class="hljs-property inline">y</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowHeight - ballSize - margin, newPos.<span class="hljs-property inline">y</span>));
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">&quot;双重夹逼&quot;策略：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><code>Math.min()</code>确保位置不会超出右边界和下边界</li>
<li class="text-foreground leading-relaxed"><code>Math.max()</code>确保位置不会小于左边界和上边界</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">这样，无论算法计算出什么位置，最终的坐标都会被严格限制在安全范围内。</p>
<p class="text-base leading-7 mb-4 text-foreground">为什么需要<code>ballSize</code>？因为CSS的<code>left</code>和<code>top</code>属性定位的是元素的左上角，而不是中心点。如果不考虑球的大小，球就可能有一部分跑到屏幕外面。</p>
<h2 id="展开收起的动画系统" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#展开收起的动画系统" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 展开收起的动画系统">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            展开收起的动画系统
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">导航球的展开收起是一个具有过渡效果的动画过程，涉及位置移动、状态切换和时序控制。</p>
<h3 id="中心定位算法" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#中心定位算法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 中心定位算法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            中心定位算法
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">当用户点击导航球时，它需要移动到屏幕中央进行展开：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
<span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
<span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: centerX, <span class="hljs-attr inline">y</span>: centerY});
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">为什么要减去35</strong>？因为导航球的大小是70px，如果我们想让球的<strong class="font-bold text-foreground">中心</strong>对齐屏幕中心，就需要向左向上偏移半个球的大小（70/2 = 35px）。</p>
<p class="text-base leading-7 mb-4 text-foreground">这是视觉中心和几何中心的区别：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">几何中心</strong>: 元素边界框的中心点</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">视觉中心</strong>: 人眼感知到的元素中心点</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">对于圆形元素，这两者是一致的，所以我们使用几何计算即可。</p>
<h3 id="状态切换的时序控制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#状态切换的时序控制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 状态切换的时序控制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            状态切换的时序控制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">展开和收起的动画需要精确的时序控制：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20%E5%B1%95%E5%BC%80%EF%BC%9A%E5%85%88%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%EF%BC%8C%E5%86%8D%E7%A7%BB%E5%8A%A8%E5%88%B0%E4%B8%AD%E5%BF%83%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E6%94%B6%E8%B5%B7%EF%BC%9A%E5%85%88%E8%AE%BE%E7%BD%AE%E7%8A%B6%E6%80%81%EF%BC%8C%E5%BB%B6%E8%BF%9F150ms%E5%90%8E%E7%A7%BB%E5%8A%A8%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleBallClick</span> = (<span class="hljs-params inline"></span>) =&gt; {
    <span class="hljs-keyword inline">if</span> (!hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
        <span class="hljs-keyword inline">if</span> (!isExpanded) {
            <span class="hljs-comment inline">// 展开：先保存当前位置，再移动到中心</span>
            <span class="hljs-title function_ inline">setOriginalPosition</span>(position);
            <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
            <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;
            <span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: centerX, <span class="hljs-attr inline">y</span>: centerY});
            <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">true</span>);
        } <span class="hljs-keyword inline">else</span> {
            <span class="hljs-comment inline">// 收起：先设置状态，延迟150ms后移动</span>
            <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
            <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
                <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
            }, <span class="hljs-number inline">150</span>);
        }
    }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">这里有个关键的设计决策：收起时为什么要延迟150ms？</p>
<p class="text-base leading-7 mb-4 text-foreground">因为菜单项的消失动画需要时间。如果我们在设置<code>isExpanded=false</code>的同时立即移动球的位置，用户会看到菜单项还在消失的过程中，球就开始移动了，视觉效果会很突兀。</p>
<p class="text-base leading-7 mb-4 text-foreground">150ms的延迟刚好让菜单项的消失动画完成，然后球再开始移动回原位。这种时序安排让整个动画感觉更加连贯和自然。</p>
<h3 id="originalposition的保存机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#originalposition的保存机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to originalPosition的保存机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            originalPosition的保存机制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><code>originalPosition</code>的保存时机很关键：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E5%9C%A8%E5%B1%95%E5%BC%80%E4%B9%8B%E5%89%8D%E4%BF%9D%E5%AD%98%0AsetOriginalPosition(position)%3B%0A%2F%2F%20%E5%9C%A8%E6%8B%96%E6%8B%BD%E7%BB%93%E6%9D%9F%E5%90%8E%E6%9B%B4%E6%96%B0%0AsetOriginalPosition(snappedPos)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 在展开之前保存</span>
<span class="hljs-title function_ inline">setOriginalPosition</span>(position);

<span class="hljs-comment inline">// 在拖拽结束后更新</span>
<span class="hljs-title function_ inline">setOriginalPosition</span>(snappedPos);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">这确保了无论用户在展开前有没有拖拽过球，收起时都能回到正确的位置。如果用户拖拽球到新位置后再展开，收起时应该回到拖拽后的位置，而不是初始位置。</p>
<h2 id="圆形菜单布局算法" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#圆形菜单布局算法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 圆形菜单布局算法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            圆形菜单布局算法
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">当导航球展开时，菜单项需要均匀分布在一个圆形周围。这是一个典型的极坐标布局问题。</p>
<h3 id="极坐标布局的数学基础" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#极坐标布局的数学基础" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 极坐标布局的数学基础">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            极坐标布局的数学基础
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">圆形布局的核心是极坐标到笛卡尔坐标的转换：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%0A%7D%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCircularPosition</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">index</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">total</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">radius</span>: <span class="hljs-built_in inline">number</span> = <span class="hljs-number inline">120</span></span>) =&gt; {
    <span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">x</span>: centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius - <span class="hljs-number inline">60</span>,
        <span class="hljs-attr inline">y</span>: centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius - <span class="hljs-number inline">30</span>,
    };
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">让我逐行解释这个算法：</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">角度计算</strong>: <code>(2 * Math.PI * index) / total</code>将圆周（2π弧度）等分为<code>total</code>份，每个菜单项占据一份。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">起始角度调整</strong>: <code>- Math.PI / 2</code>将起始角度从3点钟方向（0弧度）调整到12点钟方向（-π/2弧度）。这样第一个菜单项会出现在正上方，符合视觉习惯。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">坐标转换</strong>: <code>Math.cos(angle) * radius</code>和<code>Math.sin(angle) * radius</code>将极坐标转换为相对于圆心的笛卡尔坐标。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">位置偏移</strong>: <code>- 60</code>和<code>- 30</code>是为了调整菜单项的定位点。这些值是根据菜单项的实际大小计算出来的，确保菜单项的中心点位于圆周上。</p>
<h3 id="角度分布策略" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#角度分布策略" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 角度分布策略">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            角度分布策略
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">假设我们有6个菜单项，它们的角度分布是这样的：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="%E9%A1%B9%E7%9B%AE0%3A%20(2%CF%80%20%C3%97%200)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F2%20%20%20(12%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE1%3A%20(2%CF%80%20%C3%97%201)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F6%20%20%20(2%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE2%3A%20(2%CF%80%20%C3%97%202)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F6%20%20%20%20(4%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE3%3A%20(2%CF%80%20%C3%97%203)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F2%20%20%20%20(6%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE4%3A%20(2%CF%80%20%C3%97%204)%20%2F%206%20-%20%CF%80%2F2%20%3D%205%CF%80%2F6%20%20%20(8%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE5%3A%20(2%CF%80%20%C3%97%205)%20%2F%206%20-%20%CF%80%2F2%20%3D%207%CF%80%2F6%20%20%20(10%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>项目<span class="hljs-number inline">0</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">0</span>) <span class="hljs-symbol inline">/</span> <span class="hljs-number inline">6</span> <span class="hljs-operator inline">-</span> π<span class="hljs-symbol inline">/2</span> <span class="hljs-operator inline">=</span> <span class="hljs-operator inline">-</span>π<span class="hljs-symbol inline">/2</span>   (<span class="hljs-number inline">12</span>点钟方向)
项目<span class="hljs-number inline">1</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">1</span>) <span class="hljs-symbol inline">/</span> <span class="hljs-number inline">6</span> <span class="hljs-operator inline">-</span> π<span class="hljs-symbol inline">/2</span> <span class="hljs-operator inline">=</span> <span class="hljs-operator inline">-</span>π<span class="hljs-symbol inline">/6</span>   (<span class="hljs-number inline">2</span>点钟方向)
项目<span class="hljs-number inline">2</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">2</span>) <span class="hljs-symbol inline">/</span> <span class="hljs-number inline">6</span> <span class="hljs-operator inline">-</span> π<span class="hljs-symbol inline">/2</span> <span class="hljs-operator inline">=</span> π<span class="hljs-symbol inline">/6</span>    (<span class="hljs-number inline">4</span>点钟方向)
项目<span class="hljs-number inline">3</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">3</span>) <span class="hljs-symbol inline">/</span> <span class="hljs-number inline">6</span> <span class="hljs-operator inline">-</span> π<span class="hljs-symbol inline">/2</span> <span class="hljs-operator inline">=</span> π<span class="hljs-symbol inline">/2</span>    (<span class="hljs-number inline">6</span>点钟方向)
项目<span class="hljs-number inline">4</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">4</span>) <span class="hljs-symbol inline">/</span> <span class="hljs-number inline">6</span> <span class="hljs-operator inline">-</span> π<span class="hljs-symbol inline">/2</span> <span class="hljs-operator inline">=</span> <span class="hljs-number inline">5</span>π<span class="hljs-symbol inline">/6</span>   (<span class="hljs-number inline">8</span>点钟方向)
项目<span class="hljs-number inline">5</span>: (<span class="hljs-number inline">2</span>π × <span class="hljs-number inline">5</span>) <span class="hljs-symbol inline">/</span> <span class="hljs-number inline">6</span> <span class="hljs-operator inline">-</span> π<span class="hljs-symbol inline">/2</span> <span class="hljs-operator inline">=</span> <span class="hljs-number inline">7</span>π<span class="hljs-symbol inline">/6</span>   (<span class="hljs-number inline">10</span>点钟方向)
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">这样的分布确保了菜单项在视觉上的均匀性和对称性。</p>
<h2 id="关键帧动画系统" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#关键帧动画系统" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 关键帧动画系统">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            关键帧动画系统
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">菜单项的出现和消失动画是保证流畅性的关键部分。</p>
<h3 id="css-in-js动画实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#css-in-js动画实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to CSS-in-JS动画实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            CSS-in-JS动画实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">我使用CSS-in-JS的动画定义方式来保持组件的封装性：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="jsx" data-code="%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">jsx</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-jsx">&lt;style jsx&gt;{<span class="hljs-string inline">`
    @keyframes menuItemAppear {
        0% {
            opacity: 0;
            transform: scale(0) translate(-50%, -50%);
        }
        50% {
            opacity: 0.7;
            transform: scale(0.8) translate(-25%, -25%);
        }
        100% {
            opacity: 1;
            transform: scale(1) translate(0%, 0%);
        }
    }
    
    .menu-item {
        animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
`</span>}&lt;/style&gt;
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">这个动画包含了三个关键帧：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">0%</strong>: 完全透明，零缩放，大幅偏移</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">50%</strong>: 半透明，80%缩放，小幅偏移</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">100%</strong>: 完全不透明，正常缩放，无偏移</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">为什么要包含translate偏移</strong>？纯粹的缩放动画会让菜单项从中心点&quot;爆发&quot;出来，加上translate偏移可以创造一种&quot;从远处飞来&quot;的动态效果。</p>
<h3 id="动画延迟的层次感" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#动画延迟的层次感" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 动画延迟的层次感">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            动画延迟的层次感
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="style%3D%7B%7B%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript">style={{
    <span class="hljs-attr inline">animationDelay</span>: <span class="hljs-string inline">`<span class="hljs-subst inline">${index * <span class="hljs-number inline">120</span>}</span>ms`</span>
}}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">每个菜单项的动画延迟120ms，这创造了一种&quot;波浪式&quot;的出现效果。菜单项不是同时出现，而是按顺序依次出现，就像多米诺骨牌一样。</p>
<h3 id="缓动函数选择" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#缓动函数选择" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 缓动函数选择">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            缓动函数选择
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><code>cubic-bezier(0.4, 0, 0.2, 1)</code>是Material Design中的&quot;标准&quot;缓动函数，它的特性是：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">慢启动</strong>: 开始时加速较慢，符合物理直觉</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">快结束</strong>: 结束时快速到达目标状态，避免拖沓感</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">平滑过渡</strong>: 整个过程没有突兀的速度变化</li>
</ul>
<h2 id="事件处理与性能优化" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#事件处理与性能优化" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 事件处理与性能优化">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            事件处理与性能优化
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">在处理复杂交互时，正确的事件管理和性能优化是必不可少的。</p>
<h3 id="事件监听器的生命周期管理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#事件监听器的生命周期管理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 事件监听器的生命周期管理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            事件监听器的生命周期管理
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">拖拽功能需要在文档级别监听鼠标事件，但这些监听器必须正确管理，避免内存泄漏：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="useEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E7%A1%AE%E4%BF%9D%E5%9C%A8%E9%9D%9E%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A7%BB%E9%99%A4%E7%9B%91%E5%90%AC%E5%99%A8%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20handleMouseMove%2C%20handleMouseUp%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (isDragging) {
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
        <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
        };
    } <span class="hljs-keyword inline">else</span> {
        <span class="hljs-comment inline">// 确保在非拖拽状态下移除监听器</span>
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
        <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
    }
}, [isDragging, handleMouseMove, handleMouseUp]);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground">设计特性：</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">条件监听</strong>: 只在拖拽状态下添加监听器，减少不必要的事件处理</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">自动清理</strong>: useEffect的返回函数确保组件卸载时清理监听器</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">状态同步</strong>: 当拖拽状态改变时，监听器也相应更新</li>
</ol>
<h3 id="usecallback的性能优化" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#usecallback的性能优化" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to useCallback的性能优化">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            useCallback的性能优化
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0A%2F%2F%20%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91...%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0A%2F%2F%20%E5%90%B8%E9%99%84%E9%80%BB%E8%BE%91...%0A%7D%2C%20%5B%5D)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> handleMouseMove = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt;</span> {
    <span class="hljs-comment inline">// 处理逻辑...</span>
}, [isDragging, dragOffset, dragStartPosition]);

<span class="hljs-keyword inline">const</span> snapToEdge = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">currentPos</span>: <span class="hljs-title class_ inline">Position</span></span>) =&gt;</span> {
    <span class="hljs-comment inline">// 吸附逻辑...</span>
}, []);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>useCallback</code>确保这些函数引用在依赖项不变时保持稳定，避免不必要的重新渲染和事件监听器的频繁添加/移除。</p>
<h3 id="防止事件冒泡的策略" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#防止事件冒泡的策略" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 防止事件冒泡的策略">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            防止事件冒泡的策略
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20%E9%98%B2%E6%AD%A2%E9%80%89%E4%B8%AD%E6%96%87%E6%9C%AC%E7%AD%89%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A6%81%E7%94%A8%E6%8B%96%E6%8B%BD%0AsetIsDragging(true)%3B%0A%2F%2F%20...%20%E5%85%B6%E4%BB%96%E9%80%BB%E8%BE%91%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">React</span>.<span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt; {
    e.<span class="hljs-title function_ inline">preventDefault</span>();  <span class="hljs-comment inline">// 防止选中文本等默认行为</span>
    <span class="hljs-keyword inline">if</span> (isExpanded) <span class="hljs-keyword inline">return</span>;  <span class="hljs-comment inline">// 展开状态下禁用拖拽</span>
    
    <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">true</span>);
    <span class="hljs-comment inline">// ... 其他逻辑</span>
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><code>e.preventDefault()</code>防止了一些可能干扰拖拽的默认浏览器行为，比如文本选择、图片拖拽等。</p>
<h2 id="可复用设计模式总结" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#可复用设计模式总结" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 可复用设计模式总结">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            可复用设计模式总结
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">通过这次深入的分析，我们可以提取出几个通用的设计模式，它们可以应用到其他类似的交互系统中。</p>
<h3 id="核心设计模式提取" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#核心设计模式提取" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 核心设计模式提取">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            核心设计模式提取
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">拖拽系统模式</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%201.%20%E7%8A%B6%E6%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0A%2F%2F%202.%20%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0Aconst%20handleMouseDown%20%3D%20(e)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20elementRef.current%3F.getBoundingClientRect()%3B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%0Ay%3A%20e.clientY%20-%20rect.top%0A%7D)%3B%0AsetIsDragging(true)%3B%0A%7D%3B%0A%2F%2F%203.%20%E4%BD%8D%E7%BD%AE%E6%9B%B4%E6%96%B0%0Aconst%20handleMouseMove%20%3D%20(e)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetPosition(%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D)%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 1. 状态初始化</span>
<span class="hljs-keyword inline">const</span> [isDragging, setIsDragging] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);
<span class="hljs-keyword inline">const</span> [dragOffset, setDragOffset] = <span class="hljs-title function_ inline">useState</span>({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});
<span class="hljs-keyword inline">const</span> [position, setPosition] = <span class="hljs-title function_ inline">useState</span>({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});

<span class="hljs-comment inline">// 2. 事件处理</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline">e</span>) =&gt; {
    <span class="hljs-keyword inline">const</span> rect = elementRef.<span class="hljs-property inline">current</span>?.<span class="hljs-title function_ inline">getBoundingClientRect</span>();
    <span class="hljs-title function_ inline">setDragOffset</span>({
        <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - rect.<span class="hljs-property inline">left</span>,
        <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - rect.<span class="hljs-property inline">top</span>
    });
    <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">true</span>);
};

<span class="hljs-comment inline">// 3. 位置更新</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseMove</span> = (<span class="hljs-params inline">e</span>) =&gt; {
    <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;
    <span class="hljs-title function_ inline">setPosition</span>({
        <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,
        <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>
    });
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">圆形布局模式</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20getCircularPosition%20%3D%20(index%2C%20total%2C%20radius%2C%20centerX%2C%20centerY)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%0A%7D%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCircularPosition</span> = (<span class="hljs-params inline">index, total, radius, centerX, centerY</span>) =&gt; {
    <span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;
    <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">x</span>: centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius,
        <span class="hljs-attr inline">y</span>: centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius
    };
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">状态机模式</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E6%98%8E%E7%A1%AE%E7%9A%84%E7%8A%B6%E6%80%81%E5%AE%9A%E4%B9%89%0Aconst%20states%20%3D%20%7B%0AIDLE%3A%20'idle'%2C%0ADRAGGING%3A%20'dragging'%2C%0AEXPANDED%3A%20'expanded'%0A%7D%3B%0A%2F%2F%20%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E9%80%BB%E8%BE%91%0Aconst%20handleStateTransition%20%3D%20(currentState%2C%20action)%20%3D%3E%20%7B%0Aswitch%20(currentState)%20%7B%0Acase%20states.IDLE%3A%0Areturn%20action%20%3D%3D%3D%20'drag'%20%3F%20states.DRAGGING%20%3A%0Aaction%20%3D%3D%3D%20'click'%20%3F%20states.EXPANDED%20%3A%20currentState%3B%0A%2F%2F%20...%20%E5%85%B6%E4%BB%96%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 明确的状态定义</span>
<span class="hljs-keyword inline">const</span> states = {
    <span class="hljs-attr inline">IDLE</span>: <span class="hljs-string inline">&#x27;idle&#x27;</span>,
    <span class="hljs-attr inline">DRAGGING</span>: <span class="hljs-string inline">&#x27;dragging&#x27;</span>,
    <span class="hljs-attr inline">EXPANDED</span>: <span class="hljs-string inline">&#x27;expanded&#x27;</span>
};

<span class="hljs-comment inline">// 状态转换逻辑</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleStateTransition</span> = (<span class="hljs-params inline">currentState, action</span>) =&gt; {
    <span class="hljs-keyword inline">switch</span> (currentState) {
        <span class="hljs-keyword inline">case</span> states.<span class="hljs-property inline">IDLE</span>:
            <span class="hljs-keyword inline">return</span> action === <span class="hljs-string inline">&#x27;drag&#x27;</span> ? states.<span class="hljs-property inline">DRAGGING</span> : 
                   action === <span class="hljs-string inline">&#x27;click&#x27;</span> ? states.<span class="hljs-property inline">EXPANDED</span> : currentState;
        <span class="hljs-comment inline">// ... 其他状态转换</span>
    }
};
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">防抖动画模式</strong>:</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="const%20%5BpendingValue%2C%20setPendingValue%5D%20%3D%20useState(null)%3B%0Aconst%20timerRef%20%3D%20useRef(null)%3B%0Aconst%20debouncedUpdate%20%3D%20(newValue)%20%3D%3E%20%7B%0AsetPendingValue(newValue)%3B%0Aif%20(timerRef.current)%20clearTimeout(timerRef.current)%3B%0AtimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetActualValue(newValue)%3B%0A%7D%2C%20delay)%3B%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">const</span> [pendingValue, setPendingValue] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">null</span>);
<span class="hljs-keyword inline">const</span> timerRef = <span class="hljs-title function_ inline">useRef</span>(<span class="hljs-literal inline">null</span>);

<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">debouncedUpdate</span> = (<span class="hljs-params inline">newValue</span>) =&gt; {
    <span class="hljs-title function_ inline">setPendingValue</span>(newValue);
    
    <span class="hljs-keyword inline">if</span> (timerRef.<span class="hljs-property inline">current</span>) <span class="hljs-built_in inline">clearTimeout</span>(timerRef.<span class="hljs-property inline">current</span>);
    
    timerRef.<span class="hljs-property inline">current</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-title function_ inline">setActualValue</span>(newValue);
    }, delay);
};
</code></pre>
            </div>
        
<h3 id="最佳实践提炼" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#最佳实践提炼" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 最佳实践提炼">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            最佳实践提炼
        </h3>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">事件监听器清理</strong>: 始终在useEffect的返回函数中清理事件监听器</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">坐标计算边界保护</strong>: 使用Math.min/max确保坐标在安全范围内</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">状态同步</strong>: 相关状态的更新要保持同步，避免中间态</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">动画时序</strong>: 复杂动画要考虑各部分的时序关系</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">用户反馈</strong>: 即使在延迟更新的情况下，也要提供即时的视觉反馈</li>
</ol>
<h2 id="完整源码全解析" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#完整源码全解析" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 完整源码全解析">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            完整源码全解析
        </h2>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="'use%20client'%3B%0Aimport%20React%2C%20%7BuseCallback%2C%20useEffect%2C%20useRef%2C%20useState%7D%20from%20'react'%3B%0Aimport%20%7BusePathname%2C%20useRouter%7D%20from%20'next%2Fnavigation'%3B%0Aimport%20%7BuseTheme%7D%20from%20'.%2FThemeProvider'%3B%0Aimport%20%7BuseLocaleStore%7D%20from%20'%40%2Flib%2Fstores%2FlocaleStore'%3B%0Aimport%20%7BLOCALES%7D%20from%20'%40%2Flib%2Futils%2Flocales'%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0Ainterface%20Position%20%7B%0Ax%3A%20number%3B%20%20%2F%2F%20X%E5%9D%90%E6%A0%87%0Ay%3A%20number%3B%20%20%2F%2F%20Y%E5%9D%90%E6%A0%87%0A%7D%0Aexport%20function%20Navigation()%20%7B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F%2F%20%E5%9F%BA%E7%A1%80%E7%8A%B6%E6%80%81%0Aconst%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD%E7%8A%B6%E6%80%81%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%8F%9C%E5%8D%95%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%0A%2F%2F%20%E4%BD%8D%E7%BD%AE%E7%9B%B8%E5%85%B3%E7%8A%B6%E6%80%81%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%2F%2F%20%E5%8E%9F%E5%A7%8B%E4%BD%8D%E7%BD%AE%E8%AE%B0%E5%BD%95%0A%2F%2F%20%E6%8B%96%E6%8B%BD%E7%9B%B8%E5%85%B3%E7%8A%B6%E6%80%81%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E6%A0%87%E8%AE%B0%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%8B%96%E6%8B%BD%E5%81%8F%E7%A7%BB%E9%87%8F%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%2F%2F%20%E6%8B%96%E6%8B%BD%E8%B5%B7%E5%A7%8B%E4%BD%8D%E7%BD%AE%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%BE%E7%A4%BA%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%0A%2F%2F%20%E5%BC%95%E7%94%A8%E5%92%8C%E5%AE%9A%E6%97%B6%E5%99%A8%0Aconst%20debounceTimerRef%20%3D%20useRefNodeJS.Timeout%20%7C%20null%3E(null)%3B%20%20%20%20%20%2F%2F%20%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aconst%20hasDraggedSignificantlyRef%20%3D%20useRef(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%AF%E5%90%A6%E5%8F%91%E7%94%9F%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%0Aconst%20pendingPositionRef%20%3D%20useRefPosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%2F%2F%20%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%0Aconst%20ballRef%20%3D%20useRefHTMLDivElement%3E(null)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%AF%BC%E8%88%AA%E7%90%83%E5%BC%95%E7%94%A8%0A%2F%2F%20Next.js%E5%92%8C%E4%B8%BB%E9%A2%98hooks%0Aconst%20router%20%3D%20useRouter()%3B%0Aconst%20pathname%20%3D%20usePathname()%3B%0Aconst%20%7Btheme%2C%20toggleTheme%7D%20%3D%20useTheme()%3B%0Aconst%20%7Blocale%2C%20toggleLocale%7D%20%3D%20useLocaleStore()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%88%E6%9E%9C%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD%E6%97%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E4%BD%8D%E7%BD%AE%0A*%20%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%B2%E6%9F%93%E6%97%B6%E8%AE%A1%E7%AE%97%E5%88%9D%E5%A7%8B%E4%BD%8D%E7%BD%AE%EF%BC%8C%E9%81%BF%E5%85%8D%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E6%97%B6window%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%97%AE%E9%A2%98%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0AsetMounted(true)%3B%0Aconst%20initialX%20%3D%20window.innerWidth%20-%2080%3B%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E5%8F%B3%E8%BE%B9%E7%BC%9880px%0Aconst%20initialY%20%3D%20100%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E9%A1%B6%E9%83%A8100px%0AsetPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0AsetOriginalPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0ApendingPositionRef.current%20%3D%20%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F**%0A*%20%E6%B8%85%E7%90%86%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%EF%BC%8C%E9%98%B2%E6%AD%A2%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%AF%BC%E8%88%AA%E9%85%8D%E7%BD%AE%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%AF%BC%E8%88%AA%E6%A0%8F%E7%9B%AE%E9%85%8D%E7%BD%AE%0A*%20%E5%AE%9A%E4%B9%89%E6%89%80%E6%9C%89%E5%8F%AF%E5%AF%BC%E8%88%AA%E7%9A%84%E9%A1%B5%E9%9D%A2%E5%92%8C%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6%0A*%2F%0Aconst%20sections%20%3D%20%5B%0A%7B%0Aid%3A%20'personal'%20as%20const%2C%0Alabel%3A%20'Personal'%2C%0Adescription%3A%20'About%20Me'%2C%0Ahref%3A%20'%2Fpersonal'%0A%7D%2C%0A%7B%0Aid%3A%20'works'%20as%20const%2C%0Alabel%3A%20'Works'%2C%0Adescription%3A%20'Portfolio'%2C%0Ahref%3A%20'%2Fworks'%0A%7D%2C%0A%7B%0Aid%3A%20'contributions'%20as%20const%2C%0Alabel%3A%20'Contributions'%2C%0Adescription%3A%20'Open%20Source'%2C%0Ahref%3A%20'%2Fcontributions'%0A%7D%2C%0A%7B%0Aid%3A%20'documents'%20as%20const%2C%0Alabel%3A%20'Documents'%2C%0Adescription%3A%20'Insights'%2C%0Ahref%3A%20'%2Fdocuments'%0A%7D%2C%0A%5D%3B%0A%2F**%0A*%20%E6%A0%B9%E6%8D%AE%E5%BD%93%E5%89%8D%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%B4%BB%E8%B7%83%E7%9A%84%E5%AF%BC%E8%88%AA%E9%A1%B9%0A*%20%40returns%20%E5%BD%93%E5%89%8D%E6%B4%BB%E8%B7%83%E7%9A%84%E5%AF%BC%E8%88%AA%E9%A1%B9ID%E6%88%96null%0A*%2F%0Aconst%20getActiveSection%20%3D%20()%20%3D%3E%20%7B%0Aif%20(pathname%20%3D%3D%3D%20'%2F')%20return%20'personal'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fworks')%20return%20'works'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fcontributions')%20return%20'contributions'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fdocuments')%20return%20'documents'%3B%0Areturn%20null%3B%0A%7D%3B%0Aconst%20activeSection%20%3D%20getActiveSection()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%A0%B8%E5%BF%83%E7%AE%97%E6%B3%95%EF%BC%9A%E8%BE%B9%E7%BC%98%E5%90%B8%E9%99%84%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E8%BE%B9%E7%BC%98%E5%90%B8%E9%99%84%E7%AE%97%E6%B3%95%0A*%20%E8%AE%A1%E7%AE%97%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%E5%88%B0%E5%9B%9B%E4%B8%AA%E8%BE%B9%E7%95%8C%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E7%A7%BB%E5%8A%A8%E5%88%B0%E6%9C%80%E8%BF%91%E7%9A%84%E8%BE%B9%E7%95%8C%0A*%20%40param%20currentPos%20%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%0A*%20%40returns%20%E5%90%B8%E9%99%84%E5%90%8E%E7%9A%84%E4%BD%8D%E7%BD%AE%0A*%2F%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%20%20%2F%2F%20%E5%AF%BC%E8%88%AA%E7%90%83%E5%A4%A7%E5%B0%8F%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E8%BE%B9%E7%BC%98%E7%9A%84%E9%97%B4%E8%B7%9D%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%88%B0%E5%9B%9B%E4%B8%AA%E8%BE%B9%E7%95%8C%E7%9A%84%E8%B7%9D%E7%A6%BB%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20%E6%89%BE%E5%88%B0%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E5%86%B3%E5%AE%9A%E5%90%B8%E9%99%84%E6%96%B9%E5%90%91%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%B7%A6%E8%BE%B9%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%8F%B3%E8%BE%B9%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E9%A1%B6%E9%83%A8%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%BA%95%E9%83%A8%0A%7D%0A%2F%2F%20%E8%BE%B9%E7%95%8C%E7%BA%A6%E6%9D%9F%EF%BC%9A%E7%A1%AE%E4%BF%9D%E4%BD%8D%E7%BD%AE%E5%9C%A8%E5%AE%89%E5%85%A8%E8%8C%83%E5%9B%B4%E5%86%85%0AnewPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%8B%96%E6%8B%BD%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E9%BC%A0%E6%A0%87%E6%8C%89%E4%B8%8B%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%EF%BC%8C%E8%AE%B0%E5%BD%95%E8%B5%B7%E5%A7%8B%E4%BD%8D%E7%BD%AE%E5%92%8C%E5%81%8F%E7%A7%BB%E9%87%8F%0A*%2F%0Aconst%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20%E9%98%B2%E6%AD%A2%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA%EF%BC%88%E5%A6%82%E6%96%87%E6%9C%AC%E9%80%89%E6%8B%A9%EF%BC%89%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A6%81%E7%94%A8%E6%8B%96%E6%8B%BD%0AsetIsDragging(true)%3B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E4%BD%8D%E7%BD%AE%E7%9B%B8%E5%AF%B9%E4%BA%8E%E5%AF%BC%E8%88%AA%E7%90%83%E7%9A%84%E5%81%8F%E7%A7%BB%E9%87%8F%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20%E9%BC%A0%E6%A0%87X%20-%20%E7%90%83%E5%B7%A6%E8%BE%B9%E8%B7%9D%20%3D%20X%E5%81%8F%E7%A7%BB%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%20%E9%BC%A0%E6%A0%87Y%20-%20%E7%90%83%E4%B8%8A%E8%BE%B9%E8%B7%9D%20%3D%20Y%E5%81%8F%E7%A7%BB%0A%7D)%3B%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E9%BC%A0%E6%A0%87%E7%A7%BB%E5%8A%A8%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%EF%BC%88%E4%BD%BF%E7%94%A8%E9%98%B2%E6%8A%96%E7%AD%96%E7%95%A5%EF%BC%89%0A*%20%E5%AE%9E%E6%97%B6%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%EF%BC%8C%E4%BD%86%E4%BD%BF%E7%94%A8%E9%98%B2%E6%8A%96%E9%81%BF%E5%85%8D%E9%A2%91%E7%B9%81%E6%B8%B2%E6%9F%93%0A*%2F%0Aconst%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E9%BC%A0%E6%A0%87%E4%BD%8D%E7%BD%AE%E5%92%8C%E5%88%9D%E5%A7%8B%E5%81%8F%E7%A7%BB%E9%87%8F%E8%AE%A1%E7%AE%97%E6%96%B0%E4%BD%8D%E7%BD%AE%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20%E5%AD%98%E5%82%A8%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%EF%BC%88%E7%94%A8%E4%BA%8E%E9%98%B2%E6%8A%96%E6%9B%B4%E6%96%B0%EF%BC%89%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%EF%BC%8C%E6%8F%90%E4%BE%9B%E5%8D%B3%E6%97%B6%E5%8F%8D%E9%A6%88%0AsetShowRipple(true)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E7%8E%B0%E6%9C%89%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20%E8%AE%BE%E7%BD%AE%E6%96%B0%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%EF%BC%88500ms%E5%BB%B6%E8%BF%9F%EF%BC%89%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E6%8B%96%E6%8B%BD%E8%B7%9D%E7%A6%BB%EF%BC%8C%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0A%2F%2F%20%E8%B6%85%E8%BF%873%E5%83%8F%E7%B4%A0%E8%A7%86%E4%B8%BA%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0A%2F**%0A*%20%E9%BC%A0%E6%A0%87%E9%87%8A%E6%94%BE%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E7%BB%93%E6%9D%9F%E6%8B%96%E6%8B%BD%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%90%B8%E9%99%84%E9%80%BB%E8%BE%91%0A*%2F%0Aconst%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0AdebounceTimerRef.current%20%3D%20null%3B%0A%7D%0A%2F%2F%20%E5%A6%82%E6%9E%9C%E5%8F%91%E7%94%9F%E4%BA%86%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%EF%BC%8C%E6%89%A7%E8%A1%8C%E8%BE%B9%E7%BC%98%E5%90%B8%E9%99%84%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%20%20%2F%2F%20%E6%9B%B4%E6%96%B0%E5%8E%9F%E5%A7%8B%E4%BD%8D%E7%BD%AE%E8%AE%B0%E5%BD%95%0A%7D%0A%2F%2F%20%E5%BB%B6%E8%BF%9F%E9%87%8D%E7%BD%AE%E6%8B%96%E6%8B%BD%E6%A0%87%E8%AE%B0%EF%BC%8C%E9%81%BF%E5%85%8D%E4%B8%8E%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%86%B2%E7%AA%81%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E7%AE%A1%E7%90%86%E5%85%A8%E5%B1%80%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E5%99%A8%0A*%20%E5%8F%AA%E5%9C%A8%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E4%B8%8B%E6%B7%BB%E5%8A%A0%E7%9B%91%E5%90%AC%E5%99%A8%EF%BC%8C%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E7%A1%AE%E4%BF%9D%E5%9C%A8%E9%9D%9E%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A7%BB%E9%99%A4%E7%9B%91%E5%90%AC%E5%99%A8%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E4%BA%A4%E4%BA%92%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%AF%BC%E8%88%AA%E7%90%83%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E5%88%87%E6%8D%A2%E5%B1%95%E5%BC%80%2F%E6%94%B6%E8%B5%B7%E7%8A%B6%E6%80%81%EF%BC%8C%E5%A4%84%E7%90%86%E4%BD%8D%E7%BD%AE%E7%A7%BB%E5%8A%A8%0A*%2F%0Aconst%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0A%2F%2F%20%E5%8F%AA%E6%9C%89%E5%9C%A8%E9%9D%9E%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%E6%97%B6%E6%89%8D%E5%A4%84%E7%90%86%E7%82%B9%E5%87%BB%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20%E5%B1%95%E5%BC%80%EF%BC%9A%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%EF%BC%8C%E7%A7%BB%E5%8A%A8%E5%88%B0%E5%B1%8F%E5%B9%95%E4%B8%AD%E5%A4%AE%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%20%20%20%2F%2F%20%E4%B8%AD%E5%BF%83X%20-%20%E7%90%83%E5%8D%8A%E5%BE%84%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%20%20%2F%2F%20%E4%B8%AD%E5%BF%83Y%20-%20%E7%90%83%E5%8D%8A%E5%BE%84%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E6%94%B6%E8%B5%B7%EF%BC%9A%E5%BB%B6%E8%BF%9F150ms%E5%90%8E%E5%9B%9E%E5%88%B0%E5%8E%9F%E5%A7%8B%E4%BD%8D%E7%BD%AE%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%E5%90%8E%E6%94%B6%E8%B5%B7%E8%8F%9C%E5%8D%95%0A*%2F%0Aconst%20handleMenuItemClick%20%3D%20(action%3A%20()%20%3D%3E%20void)%20%3D%3E%20%7B%0Aaction()%3B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F**%0A*%20%E9%A1%B5%E9%9D%A2%E5%AF%BC%E8%88%AA%E5%A4%84%E7%90%86%0A*%2F%0Aconst%20navigateToPage%20%3D%20(href%3A%20string)%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20router.push(href))%3B%0A%7D%3B%0A%2F**%0A*%20%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2%E5%A4%84%E7%90%86%0A*%2F%0Aconst%20handleThemeToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20toggleTheme())%3B%0A%7D%3B%0A%2F**%0A*%20%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E5%A4%84%E7%90%86%0A*%20%E6%94%AF%E6%8C%81%E6%96%87%E6%A1%A3%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E9%87%8D%E5%AE%9A%E5%90%91%0A*%2F%0Aconst%20handleLocaleToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20%7B%0AtoggleLocale((newLocale)%20%3D%3E%20%7B%0A%2F%2F%20%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%9C%A8%E6%96%87%E6%A1%A3%E9%A1%B5%E9%9D%A2%EF%BC%8C%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E7%9B%B8%E5%90%8C%E6%96%87%E7%AB%A0%E7%9A%84%E6%96%B0%E8%AF%AD%E8%A8%80%E7%89%88%E6%9C%AC%0Aif%20(pathname.startsWith('%2Fdocuments%2F'))%20%7B%0Aconst%20pathSegments%20%3D%20pathname.split('%2F').filter(Boolean)%3B%0Aif%20(pathSegments.length%20%3E%3D%204)%20%7B%0Aconst%20%5B%2C%20currentLang%2C%20category%2C%20fileName%5D%20%3D%20pathSegments%3B%0Aconst%20newPath%20%3D%20%60%2Fdocuments%2F%24%7BnewLocale%7D%2F%24%7Bcategory%7D%2F%24%7BfileName%7D%60%3B%0Arouter.push(newPath)%3B%0A%7D%0A%7D%0A%7D)%3B%0A%7D)%3B%0A%7D%3B%0A%2F**%0A*%20%E8%83%8C%E6%99%AF%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E7%82%B9%E5%87%BB%E8%83%8C%E6%99%AF%E6%94%B6%E8%B5%B7%E8%8F%9C%E5%8D%95%0A*%2F%0Aconst%20handleBackdropClick%20%3D%20()%20%3D%3E%20%7B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%A0%B8%E5%BF%83%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9C%86%E5%BD%A2%E5%B8%83%E5%B1%80%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%9C%86%E5%BD%A2%E8%8F%9C%E5%8D%95%E5%B8%83%E5%B1%80%E7%AE%97%E6%B3%95%0A*%20%E4%BD%BF%E7%94%A8%E6%9E%81%E5%9D%90%E6%A0%87%E8%AE%A1%E7%AE%97%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%9A%84%E4%BD%8D%E7%BD%AE%0A*%20%40param%20index%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%B4%A2%E5%BC%95%0A*%20%40param%20total%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E6%80%BB%E6%95%B0%0A*%20%40param%20radius%20%E5%9C%86%E5%BD%A2%E5%8D%8A%E5%BE%84%0A*%20%40returns%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%9A%84%E5%B1%8F%E5%B9%95%E5%9D%90%E6%A0%87%0A*%2F%0Aconst%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E8%A7%92%E5%BA%A6%EF%BC%9A%E5%B0%86%E5%9C%86%E5%91%A8%E7%AD%89%E5%88%86%EF%BC%8C%E8%B5%B7%E5%A7%8B%E8%A7%92%E5%BA%A6%E4%B8%BA-%CF%80%2F2%EF%BC%8812%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91%EF%BC%89%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0A%2F%2F%20%E5%B1%8F%E5%B9%95%E4%B8%AD%E5%BF%83%E5%9D%90%E6%A0%87%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0A%2F%2F%20%E6%9E%81%E5%9D%90%E6%A0%87%E5%88%B0%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%20%20%2F%2F%20-60%E4%B8%BA%E8%8F%9C%E5%8D%95%E9%A1%B9%E5%AE%BD%E5%BA%A6%E8%B0%83%E6%95%B4%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%20%20%2F%2F%20-30%E4%B8%BA%E8%8F%9C%E5%8D%95%E9%A1%B9%E9%AB%98%E5%BA%A6%E8%B0%83%E6%95%B4%0A%7D%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%A0%B7%E5%BC%8F%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E8%8E%B7%E5%8F%96%E7%BB%9F%E4%B8%80%E7%9A%84%E6%8C%89%E9%92%AE%E6%A0%B7%E5%BC%8F%0A*%2F%0Aconst%20getUniformButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20border%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3B%0A%7D%3B%0A%2F**%0A*%20%E8%8E%B7%E5%8F%96%E4%B8%BB%E9%A2%98%E6%8C%89%E9%92%AE%E6%A0%B7%E5%BC%8F%0A*%2F%0Aconst%20getThemeButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20w-16%20h-12%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20bg-transparent%20hover%3Abg-surface%2F20%22%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20UI%E7%BB%84%E4%BB%B6%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E6%B4%BB%E8%B7%83%E7%8A%B6%E6%80%81%E6%8C%87%E7%A4%BA%E5%99%A8%E7%BB%84%E4%BB%B6%0A*%2F%0Aconst%20ActiveIndicator%20%3D%20(%7BisActive%7D%3A%20%7B%20isActive%3A%20boolean%20%7D)%20%3D%3E%20%7B%0Aif%20(!isActive)%20return%20null%3B%0Areturn%20(%0Adiv%20className%3D%22absolute%20-top-1%20-right-1%20w-3%20h-3%20rounded-full%20shadow-lg%22%3E%0Adiv%20className%3D%22w-full%20h-full%20rounded-full%20bg-primary%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%3B%0A%2F%2F%20%E4%B8%BB%E9%A2%98%E5%9B%BE%E6%A0%87%E7%BB%84%E4%BB%B6%0Aconst%20SunIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20fillRule%3D%22evenodd%22%0Ad%3D%22M10%202a1%201%200%20011%201v1a1%201%200%2011-2%200V3a1%201%200%20011-1zm4%208a4%204%200%2011-8%200%204%204%200%20018%200zm-.464%204.95l.707.707a1%201%200%20001.414-1.414l-.707-.707a1%201%200%2000-1.414%201.414zm2.12-10.607a1%201%200%20010%201.414l-.706.707a1%201%200%2011-1.414-1.414l.707-.707a1%201%200%20011.414%200zM17%2011a1%201%200%20100-2h-1a1%201%200%20100%202h1zm-7%204a1%201%200%20011%201v1a1%201%200%2011-2%200v-1a1%201%200%20011-1zM5.05%206.464A1%201%200%20106.465%205.05l-.708-.707a1%201%200%2000-1.414%201.414l.707.707zm1.414%208.486l-.707.707a1%201%200%2001-1.414-1.414l.707-.707a1%201%200%20011.414%201.414zM4%2011a1%201%200%20100-2H3a1%201%200%20000%202h1z%22%0AclipRule%3D%22evenodd%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0Aconst%20MoonIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20d%3D%22M17.293%2013.293A8%208%200%20016.707%202.707a8.001%208.001%200%201010.586%2010.586z%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E5%9B%BE%E6%A0%87%E7%BB%84%E4%BB%B6%0Aconst%20LocaleIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%20flex%20items-center%20justify-center%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%22%3E%0A%7BLOCALES%5Blocale%5D.flag%7D%0Aspan%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%B8%B2%E6%9F%93%E9%80%BB%E8%BE%91%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%8A%A0%E8%BD%BD%E7%8A%B6%E6%80%81%E6%B8%B2%E6%9F%93%0A*%2F%0Aif%20(!mounted)%20%7B%0Areturn%20(%0Adiv%20className%3D%22fixed%20top-20%20right-5%20z-50%22%3E%0Adiv%0AclassName%3D%22w-16%20h-16%20rounded-full%20backdrop-blur-md%20border%20animate-pulse%20bg-surface%2F60%20border-surface%2F40%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%0A%2F**%0A*%20%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%8F%9C%E5%8D%95%E9%A1%B9%E6%95%B0%E7%BB%84%0A*%2F%0Aconst%20allMenuItems%20%3D%20%5B%0A...sections.map(section%20%3D%3E%20(%7B%0Atype%3A%20'section'%20as%20const%2C%0Asection%2C%0Aaction%3A%20()%20%3D%3E%20navigateToPage(section.id%20%3D%3D%3D%20'personal'%20%3F%20'%2F'%20%3A%20section.href)%2C%0AisActive%3A%20activeSection%20%3D%3D%3D%20section.id%0A%7D))%2C%0A%7B%0Atype%3A%20'theme'%20as%20const%2C%0Aaction%3A%20handleThemeToggle%2C%0AisActive%3A%20false%0A%7D%2C%0A%7B%0Atype%3A%20'locale'%20as%20const%2C%0Aaction%3A%20handleLocaleToggle%2C%0AisActive%3A%20false%0A%7D%0A%5D%3B%0Areturn%20(%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E4%B8%BB%E5%AF%BC%E8%88%AA%E7%90%83%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0Adiv%0Aref%3D%7BballRef%7D%0AclassName%3D%7B%60%0Afixed%20z-50%20transition-all%20duration-500%20cursor-pointer%20select-none%0A%24%7BisDragging%20%3F%20'cursor-grabbing%20scale-110%20duration-0'%20%3A%20'cursor-grab%20hover%3Ascale-105'%7D%0A%24%7BisExpanded%20%3F%20'hover%3Ascale-120'%20%3A%20''%7D%0A%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0Atransform%3A%20%60%24%7BisDragging%20%3F%20'rotate(5deg)'%20%3A%20isExpanded%20%3F%20'rotate(0deg)%20scale(1.1)'%20%3A%20'rotate(0deg)'%7D%60%0A%7D%7D%0AonMouseDown%3D%7BhandleMouseDown%7D%0AonClick%3D%7BhandleBallClick%7D%0A%3E%0A%7B%2F*%20%E7%8E%B0%E4%BB%A3%E5%8C%96%E5%AF%BC%E8%88%AA%E7%90%83%20*%2F%7D%0Adiv%20className%3D%7B%60%0Arelative%20w-16%20h-16%20rounded-full%20transition-all%20duration-500%0A%24%7BisExpanded%20%3F%20'animate-pulse%20shadow-lg'%20%3A%20''%7D%0A%60%7D%3E%0A%7B%2F*%20%E7%90%83%E4%BD%93%E9%98%B4%E5%BD%B1%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20rounded-full%20bg-black%2F20%20blur-lg%20translate-y-2%22%3Ediv%3E%0A%7B%2F*%20%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%20-%20%E6%8B%96%E6%8B%BD%E6%97%B6%E6%98%BE%E7%A4%BA%20*%2F%7D%0A%7BshowRipple%20%26%26%20(%0Adiv%0AclassName%3D%22absolute%20rounded-full%20border-2%20animate-ping%20pointer-events-none%22%0Astyle%3D%7B%7B%0AborderColor%3A%20theme%20%3D%3D%3D%20'dark'%20%3F%20'rgba(78%2C%20205%2C%20196%2C%200.6)'%20%3A%20'rgba(0%2C%20102%2C%20204%2C%200.6)'%2C%0Awidth%3A%20'80px'%2C%0Aheight%3A%20'80px'%2C%0Atop%3A%20'-8px'%2C%0Aleft%3A%20'-8px'%2C%0AanimationDuration%3A%20'1s'%0A%7D%7D%0A%3Ediv%3E%0A)%7D%0A%7B%2F*%20%E4%B8%BB%E7%90%83%E4%BD%93%20*%2F%7D%0Adiv%0AclassName%3D%22relative%20w-full%20h-full%20rounded-full%20shadow-xl%20transform-gpu%20backdrop-blur-md%20border%20transition-all%20duration-300%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3E%0A%7B%2F*%20%E9%AB%98%E5%85%89%E6%95%88%E6%9E%9C%20*%2F%7D%0Adiv%20className%3D%22absolute%20top-2%20left-2%20w-4%20h-4%20rounded-full%20bg-white%2F30%20blur-sm%22%3Ediv%3E%0A%7B%2F*%20%E8%8F%9C%E5%8D%95%E7%AC%A6%E5%8F%B7%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20flex%20items-center%20justify-center%22%3E%0Adiv%20className%3D%7B%60%0Aw-6%20h-6%20rounded-full%20border%20transition-all%20duration-300%20flex%20items-center%20justify-center%20border-foreground%2F40%0A%24%7BisExpanded%20%3F%20'rotate-90%20scale-110'%20%3A%20'rotate-0'%7D%0A%60%7D%3E%0A%7B%0AisExpanded%20%3F%20(%0Adiv%0AclassName%3D%22relative%20transition-all%20duration-300%20w-2%20h-2%20opacity-50%20text-center%20flex%20items-center%20justify-center%20text-foreground%22%0Astyle%3D%7B%7Btransform%3A%20'translateY(-1px)'%7D%7D%0A%3E%C3%97div%3E%0A)%20%3A%20(%0Adiv%0AclassName%3D%22transition-all%20duration-300%20w-1%20h-1%20opacity-50%20rounded-full%20bg-foreground%22%3Ediv%3E%0A)%0A%7D%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%9C%86%E5%BD%A2%E8%8F%9C%E5%8D%95%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7BisExpanded%20%26%26%20(%0A%7B%2F*%20%E8%83%8C%E6%99%AF%E9%81%AE%E7%BD%A9%20*%2F%7D%0Adiv%0AclassName%3D%22fixed%20inset-0%20z-40%20backdrop-blur-md%20transition-all%20duration-300%20bg-background%2F20%22%0AonClick%3D%7BhandleBackdropClick%7D%0A%3Ediv%3E%0A%7B%2F*%20%E5%9C%86%E5%BD%A2%E5%B8%83%E5%B1%80%E7%9A%84%E8%8F%9C%E5%8D%95%E9%A1%B9%20*%2F%7D%0A%7BallMenuItems.map((item%2C%20index)%20%3D%3E%20%7B%0Aconst%20circularPos%20%3D%20getCircularPosition(index%2C%20allMenuItems.length)%3B%0Aif%20(item.type%20%3D%3D%3D%20'section')%20%7B%0Aconst%20section%20%3D%20item.section!%3B%0Areturn%20(%0Abutton%0Akey%3D%7Bsection.id%7D%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7B%60%24%7BgetUniformButtonStyles()%7D%20w-28%20h-14%20%24%7Bitem.isActive%20%3F%20'ring-2%20ring-blue-400%2F60%20scale-105'%20%3A%20''%7D%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20%E6%A0%8F%E7%9B%AE%E5%86%85%E5%AE%B9%20*%2F%7D%0Adiv%0AclassName%3D%22absolute%20inset-0%20flex%20flex-col%20items-center%20justify-center%20text-foreground%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%20leading-tight%20text-center%22%3E%0A%7Bsection.label%7D%0Aspan%3E%0Aspan%20className%3D%22text-xs%20opacity-70%20mt-0.5%20font-medium%22%3E%0A%7Bsection.description%7D%0Aspan%3E%0Adiv%3E%0AActiveIndicator%20isActive%3D%7Bitem.isActive%7D%2F%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20if%20(item.type%20%3D%3D%3D%20'theme')%20%7B%0Areturn%20(%0Abutton%0Akey%3D%22theme%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2%E5%9B%BE%E6%A0%87%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0A%7Btheme%20%3D%3D%3D%20'dark'%20%3F%20SunIcon%2F%3E%20%3A%20MoonIcon%2F%3E%7D%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20%7B%20%2F%2F%20locale%20toggle%0Areturn%20(%0Abutton%0Akey%3D%22locale%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E5%9B%BE%E6%A0%87%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0ALocaleIcon%2F%3E%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%0A%7D)%7D%0A)%7D%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20CSS%E5%8A%A8%E7%94%BB%E5%AE%9A%E4%B9%89%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A%40keyframes%20menuItemDisappear%20%7B%0A0%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.3%3B%0Atransform%3A%20scale(0.6)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D%0A)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-string inline">&#x27;use client&#x27;</span>;
<span class="hljs-keyword inline">import</span> <span class="hljs-title class_ inline">React</span>, {useCallback, useEffect, useRef, useState} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;react&#x27;</span>;
<span class="hljs-keyword inline">import</span> {usePathname, useRouter} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;next/navigation&#x27;</span>;
<span class="hljs-keyword inline">import</span> {useTheme} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;./ThemeProvider&#x27;</span>;
<span class="hljs-keyword inline">import</span> {useLocaleStore} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;@/lib/stores/localeStore&#x27;</span>;
<span class="hljs-keyword inline">import</span> {<span class="hljs-variable constant_ inline">LOCALES</span>} <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;@/lib/utils/locales&#x27;</span>;

<span class="hljs-comment inline">// ==================== 类型定义 ====================</span>
<span class="hljs-keyword inline">interface</span> <span class="hljs-title class_ inline">Position</span> {
    <span class="hljs-attr inline">x</span>: <span class="hljs-built_in inline">number</span>;  <span class="hljs-comment inline">// X坐标</span>
    <span class="hljs-attr inline">y</span>: <span class="hljs-built_in inline">number</span>;  <span class="hljs-comment inline">// Y坐标</span>
}

<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">Navigation</span>(<span class="hljs-params inline"></span>) {
    <span class="hljs-comment inline">// ==================== 状态管理 ====================</span>
    <span class="hljs-comment inline">// 基础状态</span>
    <span class="hljs-keyword inline">const</span> [mounted, setMounted] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);                    <span class="hljs-comment inline">// 组件挂载状态</span>
    <span class="hljs-keyword inline">const</span> [isExpanded, setIsExpanded] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);              <span class="hljs-comment inline">// 菜单展开状态</span>
    
    <span class="hljs-comment inline">// 位置相关状态</span>
    <span class="hljs-keyword inline">const</span> [position, setPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});           <span class="hljs-comment inline">// 当前位置</span>
    <span class="hljs-keyword inline">const</span> [originalPosition, setOriginalPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>}); <span class="hljs-comment inline">// 原始位置记录</span>
    
    <span class="hljs-comment inline">// 拖拽相关状态</span>
    <span class="hljs-keyword inline">const</span> [isDragging, setIsDragging] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);              <span class="hljs-comment inline">// 拖拽状态标记</span>
    <span class="hljs-keyword inline">const</span> [dragOffset, setDragOffset] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>});         <span class="hljs-comment inline">// 拖拽偏移量</span>
    <span class="hljs-keyword inline">const</span> [dragStartPosition, setDragStartPosition] = useState&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">0</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">0</span>}); <span class="hljs-comment inline">// 拖拽起始位置</span>
    <span class="hljs-keyword inline">const</span> [showRipple, setShowRipple] = <span class="hljs-title function_ inline">useState</span>(<span class="hljs-literal inline">false</span>);              <span class="hljs-comment inline">// 显示波纹效果</span>
    
    <span class="hljs-comment inline">// 引用和定时器</span>
    <span class="hljs-keyword inline">const</span> debounceTimerRef = useRef&lt;<span class="hljs-title class_ inline">NodeJS</span>.<span class="hljs-property inline">Timeout</span> | <span class="hljs-literal inline">null</span>&gt;(<span class="hljs-literal inline">null</span>);     <span class="hljs-comment inline">// 防抖定时器</span>
    <span class="hljs-keyword inline">const</span> hasDraggedSignificantlyRef = <span class="hljs-title function_ inline">useRef</span>(<span class="hljs-literal inline">false</span>);                 <span class="hljs-comment inline">// 是否发生显著拖拽</span>
    <span class="hljs-keyword inline">const</span> pendingPositionRef = useRef&lt;<span class="hljs-title class_ inline">Position</span>&gt;({<span class="hljs-attr inline">x</span>: <span class="hljs-number inline">50</span>, <span class="hljs-attr inline">y</span>: <span class="hljs-number inline">50</span>});      <span class="hljs-comment inline">// 待更新位置</span>
    <span class="hljs-keyword inline">const</span> ballRef = useRef&lt;<span class="hljs-title class_ inline">HTMLDivElement</span>&gt;(<span class="hljs-literal inline">null</span>);                     <span class="hljs-comment inline">// 导航球引用</span>
    
    <span class="hljs-comment inline">// Next.js和主题hooks</span>
    <span class="hljs-keyword inline">const</span> router = <span class="hljs-title function_ inline">useRouter</span>();
    <span class="hljs-keyword inline">const</span> pathname = <span class="hljs-title function_ inline">usePathname</span>();
    <span class="hljs-keyword inline">const</span> {theme, toggleTheme} = <span class="hljs-title function_ inline">useTheme</span>();
    <span class="hljs-keyword inline">const</span> {locale, toggleLocale} = <span class="hljs-title function_ inline">useLocaleStore</span>();

    <span class="hljs-comment inline">// ==================== 初始化效果 ====================</span>
    <span class="hljs-comment inline">/**
     * 组件挂载时初始化位置
     * 在客户端渲染时计算初始位置，避免服务端渲染时window未定义的问题
     */</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-title function_ inline">setMounted</span>(<span class="hljs-literal inline">true</span>);
        <span class="hljs-keyword inline">const</span> initialX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> - <span class="hljs-number inline">80</span>;   <span class="hljs-comment inline">// 距离右边缘80px</span>
        <span class="hljs-keyword inline">const</span> initialY = <span class="hljs-number inline">100</span>;                      <span class="hljs-comment inline">// 距离顶部100px</span>
        <span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: initialX, <span class="hljs-attr inline">y</span>: initialY});
        <span class="hljs-title function_ inline">setOriginalPosition</span>({<span class="hljs-attr inline">x</span>: initialX, <span class="hljs-attr inline">y</span>: initialY});
        pendingPositionRef.<span class="hljs-property inline">current</span> = {<span class="hljs-attr inline">x</span>: initialX, <span class="hljs-attr inline">y</span>: initialY};
    }, []);

    <span class="hljs-comment inline">/**
     * 清理防抖定时器，防止内存泄漏
     */</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
                <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
            }
        };
    }, []);

    <span class="hljs-comment inline">// ==================== 导航配置 ====================</span>
    <span class="hljs-comment inline">/**
     * 导航栏目配置
     * 定义所有可导航的页面和对应的标识符
     */</span>
    <span class="hljs-keyword inline">const</span> sections = [
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;personal&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Personal&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;About Me&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/personal&#x27;</span>
        },
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;works&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Works&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;Portfolio&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/works&#x27;</span>
        },
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;contributions&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Contributions&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;Open Source&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/contributions&#x27;</span>
        },
        {
            <span class="hljs-attr inline">id</span>: <span class="hljs-string inline">&#x27;documents&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">label</span>: <span class="hljs-string inline">&#x27;Documents&#x27;</span>,
            <span class="hljs-attr inline">description</span>: <span class="hljs-string inline">&#x27;Insights&#x27;</span>,
            <span class="hljs-attr inline">href</span>: <span class="hljs-string inline">&#x27;/documents&#x27;</span>
        },
    ];

    <span class="hljs-comment inline">/**
     * 根据当前路径获取活跃的导航项
     * <span class="hljs-doctag inline">@returns</span> 当前活跃的导航项ID或null
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getActiveSection</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;personal&#x27;</span>;
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/works&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;works&#x27;</span>;
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/contributions&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;contributions&#x27;</span>;
        <span class="hljs-keyword inline">if</span> (pathname === <span class="hljs-string inline">&#x27;/documents&#x27;</span>) <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&#x27;documents&#x27;</span>;
        <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
    };

    <span class="hljs-keyword inline">const</span> activeSection = <span class="hljs-title function_ inline">getActiveSection</span>();

    <span class="hljs-comment inline">// ==================== 核心算法：边缘吸附 ====================</span>
    <span class="hljs-comment inline">/**
     * 边缘吸附算法
     * 计算当前位置到四个边界的距离，移动到最近的边界
     * <span class="hljs-doctag inline">@param</span> currentPos 当前位置
     * <span class="hljs-doctag inline">@returns</span> 吸附后的位置
     */</span>
    <span class="hljs-keyword inline">const</span> snapToEdge = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">currentPos</span>: <span class="hljs-title class_ inline">Position</span></span>) =&gt;</span> {
        <span class="hljs-keyword inline">const</span> windowWidth = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span>;
        <span class="hljs-keyword inline">const</span> windowHeight = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span>;
        <span class="hljs-keyword inline">const</span> ballSize = <span class="hljs-number inline">70</span>;    <span class="hljs-comment inline">// 导航球大小</span>
        <span class="hljs-keyword inline">const</span> margin = <span class="hljs-number inline">20</span>;      <span class="hljs-comment inline">// 距离边缘的间距</span>
        <span class="hljs-keyword inline">let</span> newPos = {...currentPos};

        <span class="hljs-comment inline">// 计算到四个边界的距离</span>
        <span class="hljs-keyword inline">const</span> distanceToLeft = currentPos.<span class="hljs-property inline">x</span>;
        <span class="hljs-keyword inline">const</span> distanceToRight = windowWidth - currentPos.<span class="hljs-property inline">x</span>;
        <span class="hljs-keyword inline">const</span> distanceToTop = currentPos.<span class="hljs-property inline">y</span>;
        <span class="hljs-keyword inline">const</span> distanceToBottom = windowHeight - currentPos.<span class="hljs-property inline">y</span>;
        
        <span class="hljs-comment inline">// 找到最小距离</span>
        <span class="hljs-keyword inline">const</span> minDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);

        <span class="hljs-comment inline">// 根据最小距离决定吸附方向</span>
        <span class="hljs-keyword inline">if</span> (minDistance === distanceToLeft) {
            newPos.<span class="hljs-property inline">x</span> = margin;  <span class="hljs-comment inline">// 吸附到左边</span>
        } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToRight) {
            newPos.<span class="hljs-property inline">x</span> = windowWidth - ballSize - margin;  <span class="hljs-comment inline">// 吸附到右边</span>
        } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (minDistance === distanceToTop) {
            newPos.<span class="hljs-property inline">y</span> = margin;  <span class="hljs-comment inline">// 吸附到顶部</span>
        } <span class="hljs-keyword inline">else</span> {
            newPos.<span class="hljs-property inline">y</span> = windowHeight - ballSize - margin;  <span class="hljs-comment inline">// 吸附到底部</span>
        }

        <span class="hljs-comment inline">// 边界约束：确保位置在安全范围内</span>
        newPos.<span class="hljs-property inline">x</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowWidth - ballSize - margin, newPos.<span class="hljs-property inline">x</span>));
        newPos.<span class="hljs-property inline">y</span> = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">max</span>(margin, <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(windowHeight - ballSize - margin, newPos.<span class="hljs-property inline">y</span>));
        
        <span class="hljs-keyword inline">return</span> newPos;
    }, []);

    <span class="hljs-comment inline">// ==================== 拖拽事件处理 ====================</span>
    <span class="hljs-comment inline">/**
     * 鼠标按下事件处理
     * 初始化拖拽状态，记录起始位置和偏移量
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMouseDown</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">React</span>.<span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt; {
        e.<span class="hljs-title function_ inline">preventDefault</span>();  <span class="hljs-comment inline">// 防止默认行为（如文本选择）</span>
        <span class="hljs-keyword inline">if</span> (isExpanded) <span class="hljs-keyword inline">return</span>;  <span class="hljs-comment inline">// 展开状态下禁用拖拽</span>

        <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">true</span>);
        hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">false</span>;
        <span class="hljs-title function_ inline">setDragStartPosition</span>({<span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span>, <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span>});
        
        <span class="hljs-comment inline">// 计算鼠标点击位置相对于导航球的偏移量</span>
        <span class="hljs-keyword inline">const</span> rect = ballRef.<span class="hljs-property inline">current</span>?.<span class="hljs-title function_ inline">getBoundingClientRect</span>();
        <span class="hljs-keyword inline">if</span> (rect) {
            <span class="hljs-title function_ inline">setDragOffset</span>({
                <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - rect.<span class="hljs-property inline">left</span>,  <span class="hljs-comment inline">// 鼠标X - 球左边距 = X偏移</span>
                <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - rect.<span class="hljs-property inline">top</span>    <span class="hljs-comment inline">// 鼠标Y - 球上边距 = Y偏移</span>
            });
        }
    };

    <span class="hljs-comment inline">/**
     * 鼠标移动事件处理（使用防抖策略）
     * 实时更新位置，但使用防抖避免频繁渲染
     */</span>
    <span class="hljs-keyword inline">const</span> handleMouseMove = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">e</span>: <span class="hljs-title class_ inline">MouseEvent</span></span>) =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

        <span class="hljs-comment inline">// 根据鼠标位置和初始偏移量计算新位置</span>
        <span class="hljs-keyword inline">const</span> newPos = {
            <span class="hljs-attr inline">x</span>: e.<span class="hljs-property inline">clientX</span> - dragOffset.<span class="hljs-property inline">x</span>,
            <span class="hljs-attr inline">y</span>: e.<span class="hljs-property inline">clientY</span> - dragOffset.<span class="hljs-property inline">y</span>
        };

        <span class="hljs-comment inline">// 存储待更新位置（用于防抖更新）</span>
        pendingPositionRef.<span class="hljs-property inline">current</span> = newPos;

        <span class="hljs-comment inline">// 立即显示波纹效果，提供即时反馈</span>
        <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">true</span>);

        <span class="hljs-comment inline">// 清除现有的防抖定时器</span>
        <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
        }

        <span class="hljs-comment inline">// 设置新的防抖定时器（500ms延迟）</span>
        debounceTimerRef.<span class="hljs-property inline">current</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">setPosition</span>(newPos);
            <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);
        }, <span class="hljs-number inline">500</span>);

        <span class="hljs-comment inline">// 计算拖拽距离，判断是否为显著拖拽</span>
        <span class="hljs-keyword inline">const</span> dragDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sqrt</span>(
            <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientX</span> - dragStartPosition.<span class="hljs-property inline">x</span>, <span class="hljs-number inline">2</span>) +
            <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientY</span> - dragStartPosition.<span class="hljs-property inline">y</span>, <span class="hljs-number inline">2</span>)
        );

        <span class="hljs-comment inline">// 超过3像素视为显著拖拽</span>
        <span class="hljs-keyword inline">if</span> (dragDistance &gt; <span class="hljs-number inline">3</span>) {
            hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">true</span>;
        }
    }, [isDragging, dragOffset, dragStartPosition]);

    <span class="hljs-comment inline">/**
     * 鼠标释放事件处理
     * 结束拖拽，执行吸附逻辑
     */</span>
    <span class="hljs-keyword inline">const</span> handleMouseUp = <span class="hljs-title function_ inline">useCallback</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (!isDragging) <span class="hljs-keyword inline">return</span>;

        <span class="hljs-title function_ inline">setIsDragging</span>(<span class="hljs-literal inline">false</span>);
        <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);

        <span class="hljs-comment inline">// 清除防抖定时器</span>
        <span class="hljs-keyword inline">if</span> (debounceTimerRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-built_in inline">clearTimeout</span>(debounceTimerRef.<span class="hljs-property inline">current</span>);
            debounceTimerRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">null</span>;
        }

        <span class="hljs-comment inline">// 如果发生了显著拖拽，执行边缘吸附</span>
        <span class="hljs-keyword inline">if</span> (hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-keyword inline">const</span> snappedPos = <span class="hljs-title function_ inline">snapToEdge</span>(pendingPositionRef.<span class="hljs-property inline">current</span>);
            <span class="hljs-title function_ inline">setPosition</span>(snappedPos);
            <span class="hljs-title function_ inline">setOriginalPosition</span>(snappedPos);  <span class="hljs-comment inline">// 更新原始位置记录</span>
        }

        <span class="hljs-comment inline">// 延迟重置拖拽标记，避免与点击事件冲突</span>
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">false</span>;
        }, <span class="hljs-number inline">100</span>);
    }, [isDragging]);

    <span class="hljs-comment inline">// ==================== 全局事件监听 ====================</span>
    <span class="hljs-comment inline">/**
     * 管理全局鼠标事件监听器
     * 只在拖拽状态下添加监听器，优化性能
     */</span>
    <span class="hljs-title function_ inline">useEffect</span>(<span class="hljs-function inline">() =&gt;</span> {
        <span class="hljs-keyword inline">if</span> (isDragging) {
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">addEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
            <span class="hljs-keyword inline">return</span> <span class="hljs-function inline">() =&gt;</span> {
                <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
                <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
            };
        } <span class="hljs-keyword inline">else</span> {
            <span class="hljs-comment inline">// 确保在非拖拽状态下移除监听器</span>
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mousemove&#x27;</span>, handleMouseMove);
            <span class="hljs-variable language_ inline">document</span>.<span class="hljs-title function_ inline">removeEventListener</span>(<span class="hljs-string inline">&#x27;mouseup&#x27;</span>, handleMouseUp);
        }
    }, [isDragging]);

    <span class="hljs-comment inline">// ==================== 交互事件处理 ====================</span>
    <span class="hljs-comment inline">/**
     * 导航球点击事件处理
     * 切换展开/收起状态，处理位置移动
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleBallClick</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-comment inline">// 只有在非显著拖拽时才处理点击</span>
        <span class="hljs-keyword inline">if</span> (!hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span>) {
            <span class="hljs-keyword inline">if</span> (!isExpanded) {
                <span class="hljs-comment inline">// 展开：保存当前位置，移动到屏幕中央</span>
                <span class="hljs-title function_ inline">setOriginalPosition</span>(position);
                <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;   <span class="hljs-comment inline">// 中心X - 球半径</span>
                <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span> - <span class="hljs-number inline">35</span>;  <span class="hljs-comment inline">// 中心Y - 球半径</span>
                <span class="hljs-title function_ inline">setPosition</span>({<span class="hljs-attr inline">x</span>: centerX, <span class="hljs-attr inline">y</span>: centerY});
                <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">true</span>);
            } <span class="hljs-keyword inline">else</span> {
                <span class="hljs-comment inline">// 收起：延迟150ms后回到原始位置</span>
                <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
                <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
                    <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
                }, <span class="hljs-number inline">150</span>);
            }
        }
    };

    <span class="hljs-comment inline">/**
     * 菜单项点击事件处理
     * 执行动作后收起菜单
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleMenuItemClick</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">action</span>: () =&gt; <span class="hljs-built_in inline">void</span></span>) =&gt; {
        <span class="hljs-title function_ inline">action</span>();
        <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
        }, <span class="hljs-number inline">150</span>);
    };

    <span class="hljs-comment inline">/**
     * 页面导航处理
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">navigateToPage</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">href</span>: <span class="hljs-built_in inline">string</span></span>) =&gt; {
        <span class="hljs-title function_ inline">handleMenuItemClick</span>(<span class="hljs-function inline">() =&gt;</span> router.<span class="hljs-title function_ inline">push</span>(href));
    };

    <span class="hljs-comment inline">/**
     * 主题切换处理
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleThemeToggle</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-title function_ inline">handleMenuItemClick</span>(<span class="hljs-function inline">() =&gt;</span> <span class="hljs-title function_ inline">toggleTheme</span>());
    };

    <span class="hljs-comment inline">/**
     * 语言切换处理
     * 支持文档页面的语言切换重定向
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleLocaleToggle</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-title function_ inline">handleMenuItemClick</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">toggleLocale</span>(<span class="hljs-function inline">(<span class="hljs-params inline">newLocale</span>) =&gt;</span> {
                <span class="hljs-comment inline">// 检查是否在文档页面，重定向到相同文章的新语言版本</span>
                <span class="hljs-keyword inline">if</span> (pathname.<span class="hljs-title function_ inline">startsWith</span>(<span class="hljs-string inline">&#x27;/documents/&#x27;</span>)) {
                    <span class="hljs-keyword inline">const</span> pathSegments = pathname.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27;/&#x27;</span>).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-title class_ inline">Boolean</span>);
                    <span class="hljs-keyword inline">if</span> (pathSegments.<span class="hljs-property inline">length</span> &gt;= <span class="hljs-number inline">4</span>) {
                        <span class="hljs-keyword inline">const</span> [, currentLang, category, fileName] = pathSegments;
                        <span class="hljs-keyword inline">const</span> newPath = <span class="hljs-string inline">`/documents/<span class="hljs-subst inline">${newLocale}</span>/<span class="hljs-subst inline">${category}</span>/<span class="hljs-subst inline">${fileName}</span>`</span>;
                        router.<span class="hljs-title function_ inline">push</span>(newPath);
                    }
                }
            });
        });
    };

    <span class="hljs-comment inline">/**
     * 背景点击事件处理
     * 点击背景收起菜单
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">handleBackdropClick</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-title function_ inline">setIsExpanded</span>(<span class="hljs-literal inline">false</span>);
        <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
            <span class="hljs-title function_ inline">setPosition</span>(originalPosition);
        }, <span class="hljs-number inline">150</span>);
    };

    <span class="hljs-comment inline">// ==================== 核心算法：圆形布局 ====================</span>
    <span class="hljs-comment inline">/**
     * 圆形菜单布局算法
     * 使用极坐标计算菜单项的位置
     * <span class="hljs-doctag inline">@param</span> index 菜单项索引
     * <span class="hljs-doctag inline">@param</span> total 菜单项总数
     * <span class="hljs-doctag inline">@param</span> radius 圆形半径
     * <span class="hljs-doctag inline">@returns</span> 菜单项的屏幕坐标
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCircularPosition</span> = (<span class="hljs-params inline"><span class="hljs-attr inline">index</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">total</span>: <span class="hljs-built_in inline">number</span>, <span class="hljs-attr inline">radius</span>: <span class="hljs-built_in inline">number</span> = <span class="hljs-number inline">120</span></span>) =&gt; {
        <span class="hljs-comment inline">// 计算角度：将圆周等分，起始角度为-π/2（12点钟方向）</span>
        <span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;
        
        <span class="hljs-comment inline">// 屏幕中心坐标</span>
        <span class="hljs-keyword inline">const</span> centerX = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerWidth</span> / <span class="hljs-number inline">2</span>;
        <span class="hljs-keyword inline">const</span> centerY = <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">innerHeight</span> / <span class="hljs-number inline">2</span>;
        
        <span class="hljs-comment inline">// 极坐标到笛卡尔坐标转换</span>
        <span class="hljs-keyword inline">return</span> {
            <span class="hljs-attr inline">x</span>: centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius - <span class="hljs-number inline">60</span>,  <span class="hljs-comment inline">// -60为菜单项宽度调整</span>
            <span class="hljs-attr inline">y</span>: centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius - <span class="hljs-number inline">30</span>,  <span class="hljs-comment inline">// -30为菜单项高度调整</span>
        };
    };

    <span class="hljs-comment inline">// ==================== 样式工具函数 ====================</span>
    <span class="hljs-comment inline">/**
     * 获取统一的按钮样式
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getUniformButtonStyles</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&quot;fixed z-50 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md border bg-surface/60 border-surface/40 hover:bg-surface/80&quot;</span>;
    };

    <span class="hljs-comment inline">/**
     * 获取主题按钮样式
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getThemeButtonStyles</span> = (<span class="hljs-params inline"></span>) =&gt; {
        <span class="hljs-keyword inline">return</span> <span class="hljs-string inline">&quot;fixed z-50 w-16 h-12 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md bg-transparent hover:bg-surface/20&quot;</span>;
    };

    <span class="hljs-comment inline">// ==================== UI组件 ====================</span>
    <span class="hljs-comment inline">/**
     * 活跃状态指示器组件
     */</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">ActiveIndicator</span> = (<span class="hljs-params inline">{isActive}: { isActive: <span class="hljs-built_in inline">boolean</span> }</span>) =&gt; {
        <span class="hljs-keyword inline">if</span> (!isActive) <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;

        <span class="hljs-keyword inline">return</span> (
            <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute -top-1 -right-1 w-3 h-3 rounded-full shadow-lg&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-full h-full rounded-full bg-primary&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
        );
    };

    <span class="hljs-comment inline">// 主题图标组件</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">SunIcon</span> = (<span class="hljs-params inline"></span>) =&gt; (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-accent transition-all duration-300&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">svg</span> <span class="hljs-attr inline">fill</span>=<span class="hljs-string inline">&quot;currentColor&quot;</span> <span class="hljs-attr inline">viewBox</span>=<span class="hljs-string inline">&quot;0 0 20 20&quot;</span> <span class="hljs-attr inline">xmlns</span>=<span class="hljs-string inline">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">path</span> <span class="hljs-attr inline">fillRule</span>=<span class="hljs-string inline">&quot;evenodd&quot;</span>
                      <span class="hljs-attr inline">d</span>=<span class="hljs-string inline">&quot;M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z&quot;</span>
                      <span class="hljs-attr inline">clipRule</span>=<span class="hljs-string inline">&quot;evenodd&quot;</span>/&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">svg</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
    );

    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">MoonIcon</span> = (<span class="hljs-params inline"></span>) =&gt; (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-accent transition-all duration-300&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">svg</span> <span class="hljs-attr inline">fill</span>=<span class="hljs-string inline">&quot;currentColor&quot;</span> <span class="hljs-attr inline">viewBox</span>=<span class="hljs-string inline">&quot;0 0 20 20&quot;</span> <span class="hljs-attr inline">xmlns</span>=<span class="hljs-string inline">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">path</span> <span class="hljs-attr inline">d</span>=<span class="hljs-string inline">&quot;M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z&quot;</span>/&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">svg</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
    );

    <span class="hljs-comment inline">// 语言切换图标组件</span>
    <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">LocaleIcon</span> = (<span class="hljs-params inline"></span>) =&gt; (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-accent transition-all duration-300 flex items-center justify-center&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;text-sm font-bold&quot;</span>&gt;</span>
                {LOCALES[locale].flag}
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
    );

    <span class="hljs-comment inline">// ==================== 渲染逻辑 ====================</span>
    <span class="hljs-comment inline">/**
     * 加载状态渲染
     */</span>
    <span class="hljs-keyword inline">if</span> (!mounted) {
        <span class="hljs-keyword inline">return</span> (
            <span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;fixed top-20 right-5 z-50&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span></span>
        );
    }

    <span class="hljs-comment inline">/**
     * 构建完整的菜单项数组
     */</span>
    <span class="hljs-keyword inline">const</span> allMenuItems = [
        ...sections.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">section</span> =&gt;</span> ({
            <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;section&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            section,
            <span class="hljs-attr inline">action</span>: <span class="hljs-function inline">() =&gt;</span> <span class="hljs-title function_ inline">navigateToPage</span>(section.<span class="hljs-property inline">id</span> === <span class="hljs-string inline">&#x27;personal&#x27;</span> ? <span class="hljs-string inline">&#x27;/&#x27;</span> : section.<span class="hljs-property inline">href</span>),
            <span class="hljs-attr inline">isActive</span>: activeSection === section.<span class="hljs-property inline">id</span>
        })),
        {
            <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;theme&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">action</span>: handleThemeToggle,
            <span class="hljs-attr inline">isActive</span>: <span class="hljs-literal inline">false</span>
        },
        {
            <span class="hljs-attr inline">type</span>: <span class="hljs-string inline">&#x27;locale&#x27;</span> <span class="hljs-keyword inline">as</span> <span class="hljs-keyword inline">const</span>,
            <span class="hljs-attr inline">action</span>: handleLocaleToggle,
            <span class="hljs-attr inline">isActive</span>: <span class="hljs-literal inline">false</span>
        }
    ];

    <span class="hljs-keyword inline">return</span> (
        <span class="language-xml inline"><span class="hljs-tag inline">&lt;&gt;</span>
            {/* ==================== 主导航球 ==================== */}
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                <span class="hljs-attr inline">ref</span>=<span class="hljs-string inline">{ballRef}</span>
                <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`
          <span class="hljs-attr inline">fixed</span> <span class="hljs-attr inline">z-50</span> <span class="hljs-attr inline">transition-all</span> <span class="hljs-attr inline">duration-500</span> <span class="hljs-attr inline">cursor-pointer</span> <span class="hljs-attr inline">select-none</span>
          ${<span class="hljs-attr inline">isDragging</span> ? &#x27;<span class="hljs-attr inline">cursor-grabbing</span> <span class="hljs-attr inline">scale-110</span> <span class="hljs-attr inline">duration-0</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">cursor-grab</span> <span class="hljs-attr inline">hover:scale-105</span>&#x27;}
          ${<span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">hover:scale-120</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;&#x27;}
        `}
                <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                    <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">position.x</span>}<span class="hljs-attr inline">px</span>`,
                    <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">position.y</span>}<span class="hljs-attr inline">px</span>`,
                    <span class="hljs-attr inline">transform:</span> `${<span class="hljs-attr inline">isDragging</span> ? &#x27;<span class="hljs-attr inline">rotate</span>(<span class="hljs-attr inline">5deg</span>)&#x27; <span class="hljs-attr inline">:</span> <span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">rotate</span>(<span class="hljs-attr inline">0deg</span>) <span class="hljs-attr inline">scale</span>(<span class="hljs-attr inline">1.1</span>)&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">rotate</span>(<span class="hljs-attr inline">0deg</span>)&#x27;}`
                }}
                <span class="hljs-attr inline">onMouseDown</span>=<span class="hljs-string inline">{handleMouseDown}</span>
                <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{handleBallClick}</span>
            &gt;</span>
                {/* 现代化导航球 */}
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`
          <span class="hljs-attr inline">relative</span> <span class="hljs-attr inline">w-16</span> <span class="hljs-attr inline">h-16</span> <span class="hljs-attr inline">rounded-full</span> <span class="hljs-attr inline">transition-all</span> <span class="hljs-attr inline">duration-500</span>
          ${<span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">animate-pulse</span> <span class="hljs-attr inline">shadow-lg</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;&#x27;}
        `}&gt;</span>
                    {/* 球体阴影 */}
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute inset-0 rounded-full bg-black/20 blur-lg translate-y-2&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                    
                    {/* 波纹效果 - 拖拽时显示 */}
                    {showRipple &amp;&amp; (
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute rounded-full border-2 animate-ping pointer-events-none&quot;</span>
                            <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                <span class="hljs-attr inline">borderColor:</span> <span class="hljs-attr inline">theme</span> === <span class="hljs-string inline">&#x27;dark&#x27;</span> ? &#x27;<span class="hljs-attr inline">rgba</span>(<span class="hljs-attr inline">78</span>, <span class="hljs-attr inline">205</span>, <span class="hljs-attr inline">196</span>, <span class="hljs-attr inline">0.6</span>)&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">rgba</span>(<span class="hljs-attr inline">0</span>, <span class="hljs-attr inline">102</span>, <span class="hljs-attr inline">204</span>, <span class="hljs-attr inline">0.6</span>)&#x27;,
                                <span class="hljs-attr inline">width:</span> &#x27;<span class="hljs-attr inline">80px</span>&#x27;,
                                <span class="hljs-attr inline">height:</span> &#x27;<span class="hljs-attr inline">80px</span>&#x27;,
                                <span class="hljs-attr inline">top:</span> &#x27;<span class="hljs-attr inline">-8px</span>&#x27;,
                                <span class="hljs-attr inline">left:</span> &#x27;<span class="hljs-attr inline">-8px</span>&#x27;,
                                <span class="hljs-attr inline">animationDuration:</span> &#x27;<span class="hljs-attr inline">1s</span>&#x27;
                            }}
                        &gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                    )}

                    {/* 主球体 */}
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                        <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;relative w-full h-full rounded-full shadow-xl transform-gpu backdrop-blur-md border transition-all duration-300 bg-surface/60 border-surface/40 hover:bg-surface/80&quot;</span>&gt;</span>
                        {/* 高光效果 */}
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute top-2 left-2 w-4 h-4 rounded-full bg-white/30 blur-sm&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                        
                        {/* 菜单符号 */}
                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute inset-0 flex items-center justify-center&quot;</span>&gt;</span>
                            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`
                <span class="hljs-attr inline">w-6</span> <span class="hljs-attr inline">h-6</span> <span class="hljs-attr inline">rounded-full</span> <span class="hljs-attr inline">border</span> <span class="hljs-attr inline">transition-all</span> <span class="hljs-attr inline">duration-300</span> <span class="hljs-attr inline">flex</span> <span class="hljs-attr inline">items-center</span> <span class="hljs-attr inline">justify-center</span> <span class="hljs-attr inline">border-foreground</span>/<span class="hljs-attr inline">40</span>
                ${<span class="hljs-attr inline">isExpanded</span> ? &#x27;<span class="hljs-attr inline">rotate-90</span> <span class="hljs-attr inline">scale-110</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;<span class="hljs-attr inline">rotate-0</span>&#x27;}
              `}&gt;</span>
                                {
                                    isExpanded ? (
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;relative transition-all duration-300 w-2 h-2 opacity-50 text-center flex items-center justify-center text-foreground&quot;</span>
                                            <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{transform:</span> &#x27;<span class="hljs-attr inline">translateY</span>(<span class="hljs-attr inline">-1px</span>)&#x27;}}
                                        &gt;</span>×<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                    ) : (
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                                            <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;transition-all duration-300 w-1 h-1 opacity-50 rounded-full bg-foreground&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                    )
                                }

                            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

            {/* ==================== 圆形菜单 ==================== */}
            {isExpanded &amp;&amp; (
                <span class="hljs-tag inline">&lt;&gt;</span>
                    {/* 背景遮罩 */}
                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                        <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;fixed inset-0 z-40 backdrop-blur-md transition-all duration-300 bg-background/20&quot;</span>
                        <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{handleBackdropClick}</span>
                    &gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

                    {/* 圆形布局的菜单项 */}
                    {allMenuItems.map((item, index) =&gt; {
                        const circularPos = getCircularPosition(index, allMenuItems.length);

                        if (item.type === &#x27;section&#x27;) {
                            const section = item.section!;

                            return (
                                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                                    <span class="hljs-attr inline">key</span>=<span class="hljs-string inline">{section.id}</span>
                                    <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{item.action}</span>
                                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{</span>`${<span class="hljs-attr inline">getUniformButtonStyles</span>()} <span class="hljs-attr inline">w-28</span> <span class="hljs-attr inline">h-14</span> ${<span class="hljs-attr inline">item.isActive</span> ? &#x27;<span class="hljs-attr inline">ring-2</span> <span class="hljs-attr inline">ring-blue-400</span>/<span class="hljs-attr inline">60</span> <span class="hljs-attr inline">scale-105</span>&#x27; <span class="hljs-attr inline">:</span> &#x27;&#x27;}`}
                                    <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                        <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">circularPos.x</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">circularPos.y</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">animationDelay:</span> `${<span class="hljs-attr inline">index</span> * <span class="hljs-attr inline">120</span>}<span class="hljs-attr inline">ms</span>`
                                    }}
                                &gt;</span>
                                    {/* 栏目内容 */}
                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>
                                        <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;absolute inset-0 flex flex-col items-center justify-center text-foreground&quot;</span>&gt;</span>
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;text-sm font-bold leading-tight text-center&quot;</span>&gt;</span>
                                            {section.label}
                                        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;text-xs opacity-70 mt-0.5 font-medium&quot;</span>&gt;</span>
                                            {section.description}
                                        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
                                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">ActiveIndicator</span> <span class="hljs-attr inline">isActive</span>=<span class="hljs-string inline">{item.isActive}/</span>&gt;</span>
                                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                            );
                        } else if (item.type === &#x27;theme&#x27;) {
                            return (
                                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                                    <span class="hljs-attr inline">key</span>=<span class="hljs-string inline">&quot;theme&quot;</span>
                                    <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{item.action}</span>
                                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{getThemeButtonStyles()}</span>
                                    <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                        <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">circularPos.x</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">circularPos.y</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">animationDelay:</span> `${<span class="hljs-attr inline">index</span> * <span class="hljs-attr inline">120</span>}<span class="hljs-attr inline">ms</span>`
                                    }}
                                &gt;</span>
                                    {/* 主题切换图标 */}
                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;flex items-center justify-center h-full&quot;</span>&gt;</span>
                                        {theme === &#x27;dark&#x27; ? <span class="hljs-tag inline">&lt;<span class="hljs-name inline">SunIcon</span>/&gt;</span> : <span class="hljs-tag inline">&lt;<span class="hljs-name inline">MoonIcon</span>/&gt;</span>}
                                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                            );
                        } else { // locale toggle
                            return (
                                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                                    <span class="hljs-attr inline">key</span>=<span class="hljs-string inline">&quot;locale&quot;</span>
                                    <span class="hljs-attr inline">onClick</span>=<span class="hljs-string inline">{item.action}</span>
                                    <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">{getThemeButtonStyles()}</span>
                                    <span class="hljs-attr inline">style</span>=<span class="hljs-string inline">{{</span>
                                        <span class="hljs-attr inline">left:</span> `${<span class="hljs-attr inline">circularPos.x</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">top:</span> `${<span class="hljs-attr inline">circularPos.y</span>}<span class="hljs-attr inline">px</span>`,
                                        <span class="hljs-attr inline">animationDelay:</span> `${<span class="hljs-attr inline">index</span> * <span class="hljs-attr inline">120</span>}<span class="hljs-attr inline">ms</span>`
                                    }}
                                &gt;</span>
                                    {/* 语言切换图标 */}
                                    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">className</span>=<span class="hljs-string inline">&quot;flex items-center justify-center h-full&quot;</span>&gt;</span>
                                        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">LocaleIcon</span>/&gt;</span>
                                    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                            );
                        }
                    })}
                <span class="hljs-tag inline">&lt;/&gt;</span></span>
            )}

            {<span class="hljs-comment inline">/* ==================== CSS动画定义 ==================== */</span>}
            &lt;style jsx&gt;{<span class="hljs-string inline">`
                @keyframes menuItemAppear {
                    0% {
                        opacity: 0;
                        transform: scale(0) translate(-50%, -50%);
                    }
                    50% {
                        opacity: 0.7;
                        transform: scale(0.8) translate(-25%, -25%);
                    }
                    100% {
                        opacity: 1;
                        transform: scale(1) translate(0%, 0%);
                    }
                }

                @keyframes menuItemDisappear {
                    0% {
                        opacity: 1;
                        transform: scale(1) translate(0%, 0%);
                    }
                    50% {
                        opacity: 0.3;
                        transform: scale(0.6) translate(-25%, -25%);
                    }
                    100% {
                        opacity: 0;
                        transform: scale(0) translate(-50%, -50%);
                    }
                }

                .menu-item {
                    animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
                }
            `</span>}&lt;/style&gt;
        &lt;/&gt;
    );
}
</code></pre>
            </div>
        
<h3 id="核心算法流程图" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#核心算法流程图" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 核心算法流程图">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            核心算法流程图
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="%E7%94%A8%E6%88%B7%E4%BA%A4%E4%BA%92%20%E2%86%92%20%E4%BA%8B%E4%BB%B6%E5%88%A4%E6%96%AD%20%E2%86%92%20%E7%8A%B6%E6%80%81%E6%9B%B4%E6%96%B0%20%E2%86%92%20%E4%BD%8D%E7%BD%AE%E8%AE%A1%E7%AE%97%20%E2%86%92%20%E8%A7%86%E8%A7%89%E5%8F%8D%E9%A6%88%0A%E2%86%93%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E9%BC%A0%E6%A0%87%E6%8C%89%E4%B8%8B%20%20%20%E6%8B%96%E6%8B%BD%2F%E7%82%B9%E5%87%BB%20isDragging%20%20dragOffset%20%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%0A%E2%86%93%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E9%BC%A0%E6%A0%87%E7%A7%BB%E5%8A%A8%20%20%20%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%20%20%20position%E6%9B%B4%E6%96%B0%20%E9%98%B2%E6%8A%96%E6%9B%B4%E6%96%B0%20%20%E5%AE%9E%E6%97%B6%E5%8F%8D%E9%A6%88%0A%E2%86%93%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E9%BC%A0%E6%A0%87%E9%87%8A%E6%94%BE%20%20%20%E5%90%B8%E9%99%84%E7%AE%97%E6%B3%95%20%20%20%E8%BE%B9%E7%95%8C%E7%BA%A6%E6%9D%9F%20%20%20%20%E8%8F%9C%E5%8D%95%E5%B1%95%E5%BC%80%20%20%20%E5%8A%A8%E7%94%BB%E8%BF%87%E6%B8%A1">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>用户交互 → 事件判断 → 状态更新 → 位置计算 → 视觉反馈
    ↓        ↓         ↓         ↓         ↓
鼠标按下   拖拽/点击 isDragging  dragOffset 波纹效果
    ↓        ↓         ↓         ↓         ↓
鼠标移动   距离计算   position更新 防抖更新  实时反馈
    ↓        ↓         ↓         ↓         ↓
鼠标释放   吸附算法   边界约束    菜单展开   动画过渡
</code></pre>
            </div>
        
<h3 id="关键算法解析" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#关键算法解析" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 关键算法解析">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            关键算法解析
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">1. 边缘吸附核心算法</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E8%AE%A1%E7%AE%97%E5%88%B0%E5%9B%9B%E8%BE%B9%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E7%A7%BB%E5%8A%A8%E5%88%B0%E6%9C%80%E8%BF%91%E8%BE%B9%E7%95%8C%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E7%A1%AE%E5%AE%9A%E5%90%B8%E9%99%84%E6%96%B9%E5%90%91%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%B7%A6%E8%BE%B9%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 关键：计算到四边的距离，移动到最近边界</span>
<span class="hljs-keyword inline">const</span> distanceToLeft = currentPos.<span class="hljs-property inline">x</span>;
<span class="hljs-keyword inline">const</span> distanceToRight = windowWidth - currentPos.<span class="hljs-property inline">x</span>;
<span class="hljs-keyword inline">const</span> distanceToTop = currentPos.<span class="hljs-property inline">y</span>;
<span class="hljs-keyword inline">const</span> distanceToBottom = windowHeight - currentPos.<span class="hljs-property inline">y</span>;
<span class="hljs-keyword inline">const</span> minDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);

<span class="hljs-comment inline">// 根据最小距离确定吸附方向</span>
<span class="hljs-keyword inline">if</span> (minDistance === distanceToLeft) {
    newPos.<span class="hljs-property inline">x</span> = margin;  <span class="hljs-comment inline">// 吸附到左边</span>
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">2. 圆形布局数学计算</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E6%9E%81%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%20%2B%20%E8%A7%92%E5%BA%A6%E5%9D%87%E5%88%86%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%20%20%2F%2F%20%E8%A7%92%E5%BA%A6%E8%AE%A1%E7%AE%97%0Aconst%20x%20%3D%20centerX%20%2B%20Math.cos(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20X%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%0Aconst%20y%20%3D%20centerY%20%2B%20Math.sin(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Y%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 关键：极坐标转换 + 角度均分</span>
<span class="hljs-keyword inline">const</span> angle = (<span class="hljs-number inline">2</span> * <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> * index) / total - <span class="hljs-title class_ inline">Math</span>.<span class="hljs-property inline">PI</span> / <span class="hljs-number inline">2</span>;  <span class="hljs-comment inline">// 角度计算</span>
<span class="hljs-keyword inline">const</span> x = centerX + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">cos</span>(angle) * radius;               <span class="hljs-comment inline">// X坐标转换</span>
<span class="hljs-keyword inline">const</span> y = centerY + <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sin</span>(angle) * radius;               <span class="hljs-comment inline">// Y坐标转换</span>
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">3. 防抖拖拽优化</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E5%8D%B3%E6%97%B6%E5%8F%8D%E9%A6%88%20%2B%20%E5%BB%B6%E8%BF%9F%E6%9B%B4%E6%96%B0%0ApendingPositionRef.current%20%3D%20newPos%3B%20%20%20%20%20%2F%2F%20%E5%AD%98%E5%82%A8%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%0AsetShowRipple(true)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E5%8F%8D%E9%A6%88%0AsetTimeout(()%20%3D%3E%20%7B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E9%98%B2%E6%8A%96%E6%9B%B4%E6%96%B0%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 关键：即时反馈 + 延迟更新</span>
pendingPositionRef.<span class="hljs-property inline">current</span> = newPos;     <span class="hljs-comment inline">// 存储待更新位置</span>
<span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">true</span>);                     <span class="hljs-comment inline">// 立即显示反馈</span>
<span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {                       <span class="hljs-comment inline">// 防抖更新</span>
    <span class="hljs-title function_ inline">setPosition</span>(newPos);
    <span class="hljs-title function_ inline">setShowRipple</span>(<span class="hljs-literal inline">false</span>);
}, <span class="hljs-number inline">500</span>);
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">4. 拖拽距离判定</strong></p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%20%20%2F%2F%203%E5%83%8F%E7%B4%A0%E9%98%88%E5%80%BC%E8%BF%87%E6%BB%A4%E6%89%8B%E6%8A%96%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 关键：欧几里得距离计算</span>
<span class="hljs-keyword inline">const</span> dragDistance = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">sqrt</span>(
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientX</span> - dragStartPosition.<span class="hljs-property inline">x</span>, <span class="hljs-number inline">2</span>) +
    <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">pow</span>(e.<span class="hljs-property inline">clientY</span> - dragStartPosition.<span class="hljs-property inline">y</span>, <span class="hljs-number inline">2</span>)
);
<span class="hljs-keyword inline">if</span> (dragDistance &gt; <span class="hljs-number inline">3</span>) {  <span class="hljs-comment inline">// 3像素阈值过滤手抖</span>
    hasDraggedSignificantlyRef.<span class="hljs-property inline">current</span> = <span class="hljs-literal inline">true</span>;
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><em class="italic text-foreground">愿你的导航如北极星般稳定，如流星般灵动。</em> ✨</p>
</div></article><footer class="mt-16 pt-8 border-t border-foreground/20"><div class="flex items-center justify-between"><a class="inline-flex items-center px-4 py-2 bg-primary text-foreground rounded-lg hover:bg-primary/90 transition-colors" href="/documents/">documents.backToDocuments</a><div class="text-sm text-foreground/60"><span>documents.byAuthor<!-- --> <!-- -->MilkWind</span></div></div></footer></div></div><!--$--><!--/$--><!--$--><!--/$--><!--/$--><!--/$--><script src="/_next/static/chunks/webpack-18c0f30037e967de.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[38735,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n3:I[19945,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n4:I[65337,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"default\"]\n5:I[96190,[\"46\",\"static/chunks/46-72724587da45cdb8.js\",\"7177\",\"static/chunks/app/layout-af4a6e723c0ff668.js\"],\"ClientProviders\"]\n6:I[87555,[],\"\"]\n7:I[51901,[\"8039\",\"static/chunks/app/error-dda32be1d095a86c.js\"],\"default\"]\n8:I[31295,[],\"\"]\n9:I[6874,[\"6874\",\"static/chunks/6874-fbe9a08eb79b991c.js\",\"4345\",\"static/chunks/app/not-found-9ff98b2ccf24cac7.js\"],\"\"]\na:I[94970,[],\"ClientSegmentRoot\"]\nb:I[44065,[\"206\",\"static/chunks/206-4f4cbf4d7156f437.js\",\"3092\",\"static/chunks/app/documents/layout-28408791defde09e.js\"],\"default\"]\ne:I[59665,[],\"MetadataBoundary\"]\n10:I[59665,[],\"OutletBoundary\"]\n13:I[74911,[],\"AsyncMetadataOutlet\"]\n15:I[39460,[\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"8610\",\"static/chunks/8610-7bd3f91f3cf2a4d6.js\",\"5650\",\"static/chunks/app/documents/loading-1fa3f98b6e5a8e78.js\"],\"default\"]\n16:I[88610,[\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"8610\",\"static/chunks/8610-7bd3f91f3cf2a4d6.js\",\"4209\",\"static/chunks/app/loading-68f227fb49b3ac8c.js\"],\"default\"]\n17:I[59665,[],\"ViewportBoundary\"]\n19:I[26614,[],\"\"]\n:HL[\"/_next/static/css/704956702722271c.css\",\"style\"]\n:HL[\"/_next/static/css/b226d7ef8e491b72.css\",\"style\"]\n:HL[\"/_next/static/css/5eacd01f773eed7f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"bvFtULB1Kap7EFVJ0gqa4\",\"p\":\"\",\"c\":[\"\",\"documents\",\"zh\",\"dark\",\"personal-website\",\"float-navigation\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"documents\",{\"children\":[[\"slug\",\"zh/dark/personal-website/float-navigation\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/704956702722271c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b226d7ef8e491b72.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_d4c88d __variable_7b4e2b __variable_c3272d font-sans antialiased min-h-screen bg-background text-foreground\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$7\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"z-10 relative min-h-screen flex items-center justify-center bg-background p-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"text-center max-w-md\",\"children\":[[\"$\",\"div\",null,{\"className\":\"text-8xl font-bold text-primary mb-4\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold text-foreground mb-4\",\"children\":\"Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"text-foreground/70 mb-8\",\"children\":\"The page you're looking for doesn't exist or has been moved to a different location.\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col sm:flex-row gap-4 justify-center\",\"children\":[[\"$\",\"$L9\",null,{\"href\":\"/\",\"className\":\"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors\",\"children\":\"Go Home\"}],[\"$\",\"$L9\",null,{\"href\":\"/works\",\"className\":\"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors\",\"children\":\"View Works\"}]]}],[\"$\",\"div\",null,{\"className\":\"absolute inset-0 overflow-hidden pointer-events-none -z-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float\"}],[\"$\",\"div\",null,{\"className\":\"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float\",\"style\":{\"animationDelay\":\"1s\"}}],[\"$\",\"div\",null,{\"className\":\"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float\",\"style\":{\"animationDelay\":\"2s\"}}]]}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]}]]}],{\"children\":[\"documents\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$La\",null,{\"Component\":\"$b\",\"slots\":{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"params\":{},\"promise\":\"$@c\"}]]}],{\"children\":[[\"slug\",\"zh/dark/personal-website/float-navigation\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$Ld\",[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5eacd01f773eed7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L10\",null,{\"children\":[\"$L11\",\"$L12\",[\"$\",\"$L13\",null,{\"promise\":\"$@14\"}]]}]]}],{},null,false]},null,false]},[[\"$\",\"$L15\",\"l\",{}],[],[]],false]},[[\"$\",\"$L16\",\"l\",{}],[],[]],false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"Cl_ncsEkUiMENlW6u5NLc\",{\"children\":[[\"$\",\"$L17\",null,{\"children\":\"$L18\"}],null]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$19\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"1a:\"$Sreact.suspense\"\n1b:I[74911,[],\"AsyncMetadata\"]\nc:{}\nf:[\"$\",\"$1a\",null,{\"fallback\":null,\"children\":[\"$\",\"$L1b\",null,{\"promise\":\"$@1c\"}]}]\n"])</script><script>self.__next_f.push([1,"1d:I[57340,[\"5584\",\"static/chunks/b498d07c-095637f0f10883c6.js\",\"2415\",\"static/chunks/2415-689c103fb3d2c28d.js\",\"6874\",\"static/chunks/6874-fbe9a08eb79b991c.js\",\"9554\",\"static/chunks/9554-b714f9de28e85d30.js\",\"1873\",\"static/chunks/app/documents/%5B...slug%5D/page-8f3efa7e6c6c5377.js\"],\"DocumentPageClient\"]\n1e:T41600,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"浮动导航球：从数学原理到交互实现\" class=\"group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#浮动导航球：从数学原理到交互实现\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 浮动导航球：从数学原理到交互实现\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            浮动导航球：从数学原理到交互实现\n        \u003c/h1\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e编写导航栏菜单的时候我就在想，如何在突破传统布局的基础上表现出现代感与科技感呢？要不整个悬浮球类型的导航栏？…于是我就这么做了。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e想象一下，如果你的网站导航可以像一个智能助手一样，平时安静地待在角落，需要时优雅地滑向屏幕中央展开所有功能，用完后又乖巧地回到原位…嗯，确实挺不错的。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这个浮动导航球集成了复杂的交互逻辑：可拖拽、可吸附到屏幕边缘、可展开为圆形菜单、还有流畅的动画过渡。在这篇文章中，我将从最基础的坐标计算开始，逐步深入每一个实现细节，全面剖析这个看似简单实则复杂的交互系统。\u003c/p\u003e\n\u003ch2 id=\"状态管理\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#状态管理\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 状态管理\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            状态管理\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e任何复杂的交互系统都需要精心设计的状态管理，我们的浮动导航球也不例外。我们可以先快速阅览一下总体的状态成员：\u003c/p\u003e\n\u003ch3 id=\"状态定义\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#状态定义\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 状态定义\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            状态定义\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e为什么需要这么多状态变量？因为每一个状态都承载着特定的职责，它们共同构成了一个完整的交互生态系统。\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [mounted, setMounted] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isExpanded, setIsExpanded] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [originalPosition, setOriginalPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isDragging, setIsDragging] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragOffset, setDragOffset] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragStartPosition, setDragStartPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [showRipple, setShowRipple] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"核心状态详解\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#核心状态详解\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 核心状态详解\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            核心状态详解\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e让我逐一解释这些状态的作用：\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emounted\u003c/strong\u003e: 这是一个\u0026quot;保险丝\u0026quot;状态。在服务端渲染的世界里，\u003ccode\u003ewindow.innerWidth\u003c/code\u003e在初始渲染时是未定义的，所以我们需要等到组件真正挂载到浏览器中后再进行位置计算。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eisExpanded\u003c/strong\u003e: 导航球的\u0026quot;开关\u0026quot;状态。\u003ccode\u003efalse\u003c/code\u003e时是一个小球，\u003ccode\u003etrue\u003c/code\u003e时展开为圆形菜单。这个状态控制着整个UI的形态变化。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eposition\u003c/strong\u003e: 当前的实时位置坐标。这是整个拖拽系统的核心，所有的位置变化都反映在这里。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eoriginalPosition\u003c/strong\u003e: \u0026quot;记忆中的家\u0026quot;。当导航球展开时，它会移动到屏幕中央，但我们需要记住它原来的位置，这样收起时就能回到原地。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eisDragging\u003c/strong\u003e: 拖拽状态的标记。当用户按下鼠标开始拖拽时为\u003ccode\u003etrue\u003c/code\u003e，释放鼠标时为\u003ccode\u003efalse\u003c/code\u003e。这个状态影响着鼠标事件的监听和视觉反馈。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edragOffset\u003c/strong\u003e: 这个是最容易被忽视但又最重要的状态。它记录了鼠标点击位置相对于导航球左上角的偏移量，确保拖拽时球不会\u0026quot;跳跃\u0026quot;到鼠标位置。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edragStartPosition\u003c/strong\u003e: 拖拽起始点的记录员。我们需要它来计算拖拽距离，区分\u0026quot;点击\u0026quot;和\u0026quot;真正的拖拽\u0026quot;。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003eshowRipple\u003c/strong\u003e: 视觉反馈的开关。在拖拽过程中显示波纹效果，让用户知道\u0026quot;我正在移动这个东西\u0026quot;。\u003c/p\u003e\n\u003ch3 id=\"状态机设计\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#状态机设计\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 状态机设计\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            状态机设计\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这些状态之间的关系构成了一个复杂的状态机：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"\" data-code=\"%E6%AD%A3%E5%B8%B8%E7%8A%B6%E6%80%81%20%E2%86%90%E2%86%92%20%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%20%E2%86%92%20%E5%90%B8%E9%99%84%E7%8A%B6%E6%80%81%0A%E2%86%93%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%86%91%0A%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%20%E2%86%90--------------%E2%94%98\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ecode\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode\u003e正常状态 ←→ 拖拽状态 → 吸附状态\n    ↓                  ↑\n展开状态 ←\u003cspan class=\"hljs-comment inline\"\u003e--------------┘\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e关键的状态转换逻辑：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e正常→拖拽\u003c/strong\u003e: \u003ccode\u003emouseDown\u003c/code\u003e事件触发，同时设置\u003ccode\u003eisDragging=true\u003c/code\u003e和记录初始偏移\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e拖拽→吸附\u003c/strong\u003e: \u003ccode\u003emouseUp\u003c/code\u003e事件触发，执行边缘吸附算法\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e正常→展开\u003c/strong\u003e: 点击事件触发（非拖拽），移动到屏幕中央\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e展开→正常\u003c/strong\u003e: 再次点击或点击背景，回到原始位置\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这个状态机的精妙之处在于它能够正确处理边界情况，比如用户在拖拽过程中快速点击，或者在展开状态下开始拖拽等等。\u003c/p\u003e\n\u003ch2 id=\"坐标系统与位置记录\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#坐标系统与位置记录\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 坐标系统与位置记录\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            坐标系统与位置记录\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e在浏览器的世界里，有很多种坐标系统可以选择，我们的选择决定了整个系统的复杂度和性能。\u003c/p\u003e\n\u003ch3 id=\"坐标系统选择\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#坐标系统选择\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 坐标系统选择\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            坐标系统选择\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e我选择了绝对定位(\u003ccode\u003eposition: fixed\u003c/code\u003e) + \u003ccode\u003eleft/top\u003c/code\u003e属性的方案，而不是更现代的\u003ccode\u003etransform\u003c/code\u003e方案。为什么？\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8%E7%9A%84%E6%96%B9%E6%A1%88%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0A%7D%7D%0A%2F%2F%20%E8%80%8C%E4%B8%8D%E6%98%AF%E8%BF%99%E6%A0%B7%0Astyle%3D%7B%7B%0Atransform%3A%20%60translate(%24%7Bposition.x%7Dpx%2C%20%24%7Bposition.y%7Dpx)%60%0A%7D%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 我们使用的方案\u003c/span\u003e\nstyle={{\n    \u003cspan class=\"hljs-attr inline\"\u003eleft\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`\u003cspan class=\"hljs-subst inline\"\u003e${position.x}\u003c/span\u003epx`\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr inline\"\u003etop\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`\u003cspan class=\"hljs-subst inline\"\u003e${position.y}\u003c/span\u003epx`\u003c/span\u003e,\n}}\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 而不是这样\u003c/span\u003e\nstyle={{\n    \u003cspan class=\"hljs-attr inline\"\u003etransform\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`translate(\u003cspan class=\"hljs-subst inline\"\u003e${position.x}\u003c/span\u003epx, \u003cspan class=\"hljs-subst inline\"\u003e${position.y}\u003c/span\u003epx)`\u003c/span\u003e\n}}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cdel class=\"line-through opacity-60\"\u003e（主要是懒）\u003c/del\u003e原因很简单：\u003cstrong class=\"font-bold text-foreground\"\u003e计算的简单性\u003c/strong\u003e。使用\u003ccode\u003eleft/top\u003c/code\u003e时，坐标值就直接对应屏幕位置，我们可以直接用\u003ccode\u003egetBoundingClientRect()\u003c/code\u003e获取元素位置进行计算。而使用\u003ccode\u003etransform\u003c/code\u003e时，元素的实际渲染位置和CSS中记录的位置可能不一致，增加了计算复杂度。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e虽然\u003ccode\u003etransform\u003c/code\u003e在某些情况下性能更好（GPU加速），但对于单个导航球来说，这点性能差异可以忽略不计。有时候，简单就是美。\u003c/p\u003e\n\u003ch3 id=\"位置初始化策略\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#位置初始化策略\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 位置初始化策略\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            位置初始化策略\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20initialX%20%3D%20window.innerWidth%20-%2080%3B%0Aconst%20initialY%20%3D%20100%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e80\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialY = \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003ewindow.innerWidth - 80\u003c/code\u003e确保球完全在屏幕内，80px是球的大小加上一些余量，以确保浮动导航球在各种设备上都具有较高的初始可见性。\u003c/p\u003e\n\u003ch3 id=\"dragoffset的数学原理\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#dragoffset的数学原理\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to dragOffset的数学原理\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            dragOffset的数学原理\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这是整个拖拽系统中最容易出错的部分。让我用一个例子来说明：\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e假设导航球的左上角位置是\u003ccode\u003e(100, 50)\u003c/code\u003e，用户在球的中心位置\u003ccode\u003e(132, 82)\u003c/code\u003e点击开始拖拽（球的大小是64x64px）。\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20132%20-%20100%20%3D%2032%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%2082%20-%2050%20%3D%2032%0A%7D)%3B%0A%7D%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e rect = ballRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e?.\u003cspan class=\"hljs-title function_ inline\"\u003egetBoundingClientRect\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (rect) {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetDragOffset\u003c/span\u003e({\n            \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// 132 - 100 = 32\u003c/span\u003e\n            \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003etop\u003c/span\u003e    \u003cspan class=\"hljs-comment inline\"\u003e// 82 - 50 = 32\u003c/span\u003e\n        });\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e现在，当鼠标移动到\u003ccode\u003e(200, 150)\u003c/code\u003e时，新的球位置应该是：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%20%20%2F%2F%20200%20-%2032%20%3D%20168%0Ay%3A%20e.clientY%20-%20dragOffset.y%20%20%20%2F%2F%20150%20-%2032%20%3D%20118%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPos = {\n    \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// 200 - 32 = 168\u003c/span\u003e\n    \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e   \u003cspan class=\"hljs-comment inline\"\u003e// 150 - 32 = 118\u003c/span\u003e\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这样，球的中心点就会跟随鼠标，而不会产生\u0026quot;跳跃\u0026quot;效果。倘若没有最后修正的-32像素，那么当拖拽实际发生时，光标会指向球的左上角，而非球心位置，造成拖拽偏移误差。\u003c/p\u003e\n\u003ch2 id=\"拖拽系统实现\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#拖拽系统实现\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 拖拽系统实现\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            拖拽系统实现\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e拖拽系统是整个导航球的核心功能，它需要处理复杂的事件序列和状态变化。\u003c/p\u003e\n\u003ch3 id=\"拖拽生命周期\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#拖拽生命周期\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 拖拽生命周期\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            拖拽生命周期\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e一次完整的拖拽操作包含三个阶段：\u003c/p\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emouseDown\u003c/strong\u003e: 初始化拖拽状态\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emouseMove\u003c/strong\u003e: 持续更新位置\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003emouseUp\u003c/strong\u003e: 结束拖拽并执行后续逻辑\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e每个阶段都有其特定的职责和处理逻辑。\u003c/p\u003e\n\u003ch3 id=\"防抖动画实现\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#防抖动画实现\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 防抖动画实现\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            防抖动画实现\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e传统的拖拽实现会在每次\u003ccode\u003emouseMove\u003c/code\u003e时立即更新位置，但这会导致性能问题和视觉上的抖动。我采用了防抖策略：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E6%96%B0%E4%BD%8D%E7%BD%AE%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20%E5%AD%98%E5%82%A8%E5%BE%85%E6%9B%B4%E6%96%B0%E7%9A%84%E4%BD%8D%E7%BD%AE%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%0AsetShowRipple(true)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E5%B7%B2%E6%9C%89%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20%E8%AE%BE%E7%BD%AE%E6%96%B0%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%7D%2C%20%5BisDragging%2C%20dragOffset%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseMove = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 计算新位置\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPos = {\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 存储待更新的位置\u003c/span\u003e\n    pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = newPos;\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 立即显示波纹效果\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 清除已有的防抖定时器\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 设置新的防抖定时器\u003c/span\u003e\n    debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(newPos);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n    }, \u003cspan class=\"hljs-number inline\"\u003e500\u003c/span\u003e);\n}, [isDragging, dragOffset]);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e注意：\u003c/strong\u003e我使用了\u003ccode\u003eref\u003c/code\u003e而非\u003ccode\u003estate\u003c/code\u003e来存储待更新的位置，这是因为\u003ccode\u003euseState\u003c/code\u003e的更新是异步的，当我使用异步更新状态时，会存在读值隐患，即：我在读取\u0026quot;更新后\u0026quot;的值时，异步更新尚未完成，所以实际上读取的是更新前的值，导致实际的结果异常。而\u003ccode\u003eref\u003c/code\u003e的更新策略是同步的，不会存在线程安全问题，这意味着我在\u0026quot;更新后\u0026quot;读取到的值就是更新后的值。\u003c/p\u003e\n\u003ch3 id=\"拖拽距离判定\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#拖拽距离判定\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 拖拽距离判定\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            拖拽距离判定\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e如何区分\u0026quot;点击\u0026quot;和\u0026quot;拖拽\u0026quot;？这是一个经典的UI交互问题。我的解决方案基于欧几里得距离：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E8%AE%B0%E5%BD%95%E6%8B%96%E6%8B%BD%E8%B5%B7%E5%A7%8B%E4%BD%8D%E7%BD%AE%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20%E5%9C%A8mouseMove%E4%B8%AD%E8%AE%A1%E7%AE%97%E8%B7%9D%E7%A6%BB%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 记录拖拽起始位置\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetDragStartPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e});\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 在mouseMove中计算距离\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e dragDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esqrt\u003c/span\u003e(\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) +\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e)\n);\n\n\u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (dragDistance \u0026gt; \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) {\n    hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e只有在浮动导航球移动超过3像素时，才会被视为\u0026quot;拖拽\u0026quot;，否则会视为\u0026quot;点击\u0026quot;。一般来说，人手的自然抖动通常在1-2像素范围内，3像素可以有效过滤掉这些无意的微小移动，同时又不会妨碍真正的拖拽意图。\u003c/p\u003e\n\u003ch3 id=\"拖拽结束的智能处理\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#拖拽结束的智能处理\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 拖拽结束的智能处理\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            拖拽结束的智能处理\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0A%2F%2F%20%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%20-%20%E6%89%A7%E8%A1%8C%E5%90%B8%E9%99%84%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%0A%7D%0A%2F%2F%20%E9%87%8D%E7%BD%AE%E6%8B%96%E6%8B%BD%E6%A0%87%E8%AE%B0%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseUp = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 清除防抖定时器\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    }\n\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment inline\"\u003e// 显著拖拽 - 执行吸附\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snappedPos = \u003cspan class=\"hljs-title function_ inline\"\u003esnapToEdge\u003c/span\u003e(pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(snappedPos);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(snappedPos);\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 重置拖拽标记\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n    }, \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e);\n}, [isDragging]);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这里有个细节：为什么重置拖拽标记要延迟100ms？因为\u003ccode\u003emouseUp\u003c/code\u003e和\u003ccode\u003eclick\u003c/code\u003e事件有时序差异，如果立即重置，可能会导致点击事件错误地被处理为拖拽后的点击。100ms的延迟确保了事件处理的正确顺序。\u003c/p\u003e\n\u003ch2 id=\"边缘吸附算法\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#边缘吸附算法\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 边缘吸附算法\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            边缘吸附算法\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e吸附效果是一种人性化设计，它可以确保在你对导航球\u0026quot;放手\u0026quot;时，它会自动停留在距离屏幕边缘一个固定距离上的位置，解决视觉强迫症用户的核心痛点。\u003cdel class=\"line-through opacity-60\"\u003e（比如说我）\u003c/del\u003e\u003c/p\u003e\n\u003ch3 id=\"吸附算法核心逻辑\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#吸附算法核心逻辑\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 吸附算法核心逻辑\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            吸附算法核心逻辑\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e吸附的数学原理其实很简单：计算当前位置到四个边界的距离，然后移动到距离最近的边界：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%2F%2F%20%E7%90%83%E7%9A%84%E5%A4%A7%E5%B0%8F%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E8%BE%B9%E7%BC%98%E7%9A%84%E9%97%B4%E8%B7%9D%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%88%B0%E5%9B%9B%E4%B8%AA%E8%BE%B9%E7%95%8C%E7%9A%84%E8%B7%9D%E7%A6%BB%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20%E6%89%BE%E5%88%B0%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%0Aconst%20minDistance%20%3D%20Math.min(%0AdistanceToLeft%2C%0AdistanceToRight%2C%0AdistanceToTop%2C%0AdistanceToBottom%0A)%3B%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E5%86%B3%E5%AE%9A%E5%90%B8%E9%99%84%E6%96%B9%E5%90%91%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%0A%7D%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snapToEdge = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ecurrentPos\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowWidth = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowHeight = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e ballSize = \u003cspan class=\"hljs-number inline\"\u003e70\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// 球的大小\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e margin = \u003cspan class=\"hljs-number inline\"\u003e20\u003c/span\u003e;    \u003cspan class=\"hljs-comment inline\"\u003e// 距离边缘的间距\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 计算到四个边界的距离\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToLeft = currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToRight = windowWidth - currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToTop = currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToBottom = windowHeight - currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 找到最小距离\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e minDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(\n        distanceToLeft, \n        distanceToRight, \n        distanceToTop, \n        distanceToBottom\n    );\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003elet\u003c/span\u003e newPos = {...currentPos};\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 根据最小距离决定吸附方向\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToLeft) {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = margin;\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToRight) {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = windowWidth - ballSize - margin;\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToTop) {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = margin;\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = windowHeight - ballSize - margin;\n    }\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e newPos;\n}, []);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"边界计算的数学原理\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#边界计算的数学原理\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 边界计算的数学原理\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            边界计算的数学原理\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e距离计算解释：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToLeft\u003c/strong\u003e: 直接等于\u003ccode\u003ecurrentPos.x\u003c/code\u003e，因为左边界就是x=0\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToRight\u003c/strong\u003e: \u003ccode\u003ewindowWidth - currentPos.x\u003c/code\u003e，因为右边界是窗口宽度\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToTop\u003c/strong\u003e: 直接等于\u003ccode\u003ecurrentPos.y\u003c/code\u003e，因为上边界就是y=0\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003edistanceToBottom\u003c/strong\u003e: \u003ccode\u003ewindowWidth - currentPos.y\u003c/code\u003e，因为下边界是窗口高度\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003eMath.min()\u003c/code\u003e会找到这四个值中的最小值，对应着距离最近的边界。\u003c/p\u003e\n\u003ch3 id=\"边界约束实现\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#边界约束实现\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 边界约束实现\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            边界约束实现\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这是一个防止边界超出的保护逻辑：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"newPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003enewPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowWidth - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e));\nnewPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowHeight - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e));\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u0026quot;双重夹逼\u0026quot;策略：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003ccode\u003eMath.min()\u003c/code\u003e确保位置不会超出右边界和下边界\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003ccode\u003eMath.max()\u003c/code\u003e确保位置不会小于左边界和上边界\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这样，无论算法计算出什么位置，最终的坐标都会被严格限制在安全范围内。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e为什么需要\u003ccode\u003eballSize\u003c/code\u003e？因为CSS的\u003ccode\u003eleft\u003c/code\u003e和\u003ccode\u003etop\u003c/code\u003e属性定位的是元素的左上角，而不是中心点。如果不考虑球的大小，球就可能有一部分跑到屏幕外面。\u003c/p\u003e\n\u003ch2 id=\"展开收起的动画系统\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#展开收起的动画系统\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 展开收起的动画系统\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            展开收起的动画系统\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e导航球的展开收起是一个具有过渡效果的动画过程，涉及位置移动、状态切换和时序控制。\u003c/p\u003e\n\u003ch3 id=\"中心定位算法\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#中心定位算法\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 中心定位算法\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            中心定位算法\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e当用户点击导航球时，它需要移动到屏幕中央进行展开：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n\u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY});\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e为什么要减去35\u003c/strong\u003e？因为导航球的大小是70px，如果我们想让球的\u003cstrong class=\"font-bold text-foreground\"\u003e中心\u003c/strong\u003e对齐屏幕中心，就需要向左向上偏移半个球的大小（70/2 = 35px）。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这是视觉中心和几何中心的区别：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e几何中心\u003c/strong\u003e: 元素边界框的中心点\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e视觉中心\u003c/strong\u003e: 人眼感知到的元素中心点\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e对于圆形元素，这两者是一致的，所以我们使用几何计算即可。\u003c/p\u003e\n\u003ch3 id=\"状态切换的时序控制\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#状态切换的时序控制\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 状态切换的时序控制\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            状态切换的时序控制\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e展开和收起的动画需要精确的时序控制：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20%E5%B1%95%E5%BC%80%EF%BC%9A%E5%85%88%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%EF%BC%8C%E5%86%8D%E7%A7%BB%E5%8A%A8%E5%88%B0%E4%B8%AD%E5%BF%83%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E6%94%B6%E8%B5%B7%EF%BC%9A%E5%85%88%E8%AE%BE%E7%BD%AE%E7%8A%B6%E6%80%81%EF%BC%8C%E5%BB%B6%E8%BF%9F150ms%E5%90%8E%E7%A7%BB%E5%8A%A8%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleBallClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isExpanded) {\n            \u003cspan class=\"hljs-comment inline\"\u003e// 展开：先保存当前位置，再移动到中心\u003c/span\u003e\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(position);\n            \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n            \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY});\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n            \u003cspan class=\"hljs-comment inline\"\u003e// 收起：先设置状态，延迟150ms后移动\u003c/span\u003e\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n            \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n            }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n        }\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这里有个关键的设计决策：收起时为什么要延迟150ms？\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e因为菜单项的消失动画需要时间。如果我们在设置\u003ccode\u003eisExpanded=false\u003c/code\u003e的同时立即移动球的位置，用户会看到菜单项还在消失的过程中，球就开始移动了，视觉效果会很突兀。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e150ms的延迟刚好让菜单项的消失动画完成，然后球再开始移动回原位。这种时序安排让整个动画感觉更加连贯和自然。\u003c/p\u003e\n\u003ch3 id=\"originalposition的保存机制\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#originalposition的保存机制\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to originalPosition的保存机制\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            originalPosition的保存机制\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003eoriginalPosition\u003c/code\u003e的保存时机很关键：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E5%9C%A8%E5%B1%95%E5%BC%80%E4%B9%8B%E5%89%8D%E4%BF%9D%E5%AD%98%0AsetOriginalPosition(position)%3B%0A%2F%2F%20%E5%9C%A8%E6%8B%96%E6%8B%BD%E7%BB%93%E6%9D%9F%E5%90%8E%E6%9B%B4%E6%96%B0%0AsetOriginalPosition(snappedPos)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 在展开之前保存\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(position);\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 在拖拽结束后更新\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(snappedPos);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这确保了无论用户在展开前有没有拖拽过球，收起时都能回到正确的位置。如果用户拖拽球到新位置后再展开，收起时应该回到拖拽后的位置，而不是初始位置。\u003c/p\u003e\n\u003ch2 id=\"圆形菜单布局算法\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#圆形菜单布局算法\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 圆形菜单布局算法\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            圆形菜单布局算法\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e当导航球展开时，菜单项需要均匀分布在一个圆形周围。这是一个典型的极坐标布局问题。\u003c/p\u003e\n\u003ch3 id=\"极坐标布局的数学基础\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#极坐标布局的数学基础\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 极坐标布局的数学基础\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            极坐标布局的数学基础\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e圆形布局的核心是极坐标到笛卡尔坐标的转换：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%0A%7D%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetCircularPosition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003etotal\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003eradius\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e = \u003cspan class=\"hljs-number inline\"\u003e120\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e {\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e60\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e30\u003c/span\u003e,\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e让我逐行解释这个算法：\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e角度计算\u003c/strong\u003e: \u003ccode\u003e(2 * Math.PI * index) / total\u003c/code\u003e将圆周（2π弧度）等分为\u003ccode\u003etotal\u003c/code\u003e份，每个菜单项占据一份。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e起始角度调整\u003c/strong\u003e: \u003ccode\u003e- Math.PI / 2\u003c/code\u003e将起始角度从3点钟方向（0弧度）调整到12点钟方向（-π/2弧度）。这样第一个菜单项会出现在正上方，符合视觉习惯。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e坐标转换\u003c/strong\u003e: \u003ccode\u003eMath.cos(angle) * radius\u003c/code\u003e和\u003ccode\u003eMath.sin(angle) * radius\u003c/code\u003e将极坐标转换为相对于圆心的笛卡尔坐标。\u003c/p\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e位置偏移\u003c/strong\u003e: \u003ccode\u003e- 60\u003c/code\u003e和\u003ccode\u003e- 30\u003c/code\u003e是为了调整菜单项的定位点。这些值是根据菜单项的实际大小计算出来的，确保菜单项的中心点位于圆周上。\u003c/p\u003e\n\u003ch3 id=\"角度分布策略\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#角度分布策略\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 角度分布策略\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            角度分布策略\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e假设我们有6个菜单项，它们的角度分布是这样的：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"\" data-code=\"%E9%A1%B9%E7%9B%AE0%3A%20(2%CF%80%20%C3%97%200)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F2%20%20%20(12%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE1%3A%20(2%CF%80%20%C3%97%201)%20%2F%206%20-%20%CF%80%2F2%20%3D%20-%CF%80%2F6%20%20%20(2%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE2%3A%20(2%CF%80%20%C3%97%202)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F6%20%20%20%20(4%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE3%3A%20(2%CF%80%20%C3%97%203)%20%2F%206%20-%20%CF%80%2F2%20%3D%20%CF%80%2F2%20%20%20%20(6%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE4%3A%20(2%CF%80%20%C3%97%204)%20%2F%206%20-%20%CF%80%2F2%20%3D%205%CF%80%2F6%20%20%20(8%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)%0A%E9%A1%B9%E7%9B%AE5%3A%20(2%CF%80%20%C3%97%205)%20%2F%206%20-%20%CF%80%2F2%20%3D%207%CF%80%2F6%20%20%20(10%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91)\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ecode\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode\u003e项目\u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-symbol inline\"\u003e/\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003eπ\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e12\u003c/span\u003e点钟方向)\n项目\u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e1\u003c/span\u003e) \u003cspan class=\"hljs-symbol inline\"\u003e/\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003eπ\u003cspan class=\"hljs-symbol inline\"\u003e/6\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e点钟方向)\n项目\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) \u003cspan class=\"hljs-symbol inline\"\u003e/\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e=\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/6\u003c/span\u003e    (\u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e点钟方向)\n项目\u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) \u003cspan class=\"hljs-symbol inline\"\u003e/\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e=\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e    (\u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e点钟方向)\n项目\u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-symbol inline\"\u003e/\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e5\u003c/span\u003eπ\u003cspan class=\"hljs-symbol inline\"\u003e/6\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e8\u003c/span\u003e点钟方向)\n项目\u003cspan class=\"hljs-number inline\"\u003e5\u003c/span\u003e: (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003eπ × \u003cspan class=\"hljs-number inline\"\u003e5\u003c/span\u003e) \u003cspan class=\"hljs-symbol inline\"\u003e/\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e-\u003c/span\u003e π\u003cspan class=\"hljs-symbol inline\"\u003e/2\u003c/span\u003e \u003cspan class=\"hljs-operator inline\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-number inline\"\u003e7\u003c/span\u003eπ\u003cspan class=\"hljs-symbol inline\"\u003e/6\u003c/span\u003e   (\u003cspan class=\"hljs-number inline\"\u003e10\u003c/span\u003e点钟方向)\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这样的分布确保了菜单项在视觉上的均匀性和对称性。\u003c/p\u003e\n\u003ch2 id=\"关键帧动画系统\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#关键帧动画系统\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 关键帧动画系统\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            关键帧动画系统\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e菜单项的出现和消失动画是保证流畅性的关键部分。\u003c/p\u003e\n\u003ch3 id=\"css-in-js动画实现\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#css-in-js动画实现\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to CSS-in-JS动画实现\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            CSS-in-JS动画实现\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e我使用CSS-in-JS的动画定义方式来保持组件的封装性：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"jsx\" data-code=\"%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ejsx\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-jsx\"\u003e\u0026lt;style jsx\u0026gt;{\u003cspan class=\"hljs-string inline\"\u003e`\n    @keyframes menuItemAppear {\n        0% {\n            opacity: 0;\n            transform: scale(0) translate(-50%, -50%);\n        }\n        50% {\n            opacity: 0.7;\n            transform: scale(0.8) translate(-25%, -25%);\n        }\n        100% {\n            opacity: 1;\n            transform: scale(1) translate(0%, 0%);\n        }\n    }\n    \n    .menu-item {\n        animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n    }\n`\u003c/span\u003e}\u0026lt;/style\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e这个动画包含了三个关键帧：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e0%\u003c/strong\u003e: 完全透明，零缩放，大幅偏移\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e50%\u003c/strong\u003e: 半透明，80%缩放，小幅偏移\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e100%\u003c/strong\u003e: 完全不透明，正常缩放，无偏移\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e为什么要包含translate偏移\u003c/strong\u003e？纯粹的缩放动画会让菜单项从中心点\u0026quot;爆发\u0026quot;出来，加上translate偏移可以创造一种\u0026quot;从远处飞来\u0026quot;的动态效果。\u003c/p\u003e\n\u003ch3 id=\"动画延迟的层次感\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#动画延迟的层次感\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 动画延迟的层次感\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            动画延迟的层次感\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"style%3D%7B%7B%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003estyle={{\n    \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e`\u003cspan class=\"hljs-subst inline\"\u003e${index * \u003cspan class=\"hljs-number inline\"\u003e120\u003c/span\u003e}\u003c/span\u003ems`\u003c/span\u003e\n}}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e每个菜单项的动画延迟120ms，这创造了一种\u0026quot;波浪式\u0026quot;的出现效果。菜单项不是同时出现，而是按顺序依次出现，就像多米诺骨牌一样。\u003c/p\u003e\n\u003ch3 id=\"缓动函数选择\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#缓动函数选择\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 缓动函数选择\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            缓动函数选择\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003ecubic-bezier(0.4, 0, 0.2, 1)\u003c/code\u003e是Material Design中的\u0026quot;标准\u0026quot;缓动函数，它的特性是：\u003c/p\u003e\n\u003cul class=\"list-disc list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e慢启动\u003c/strong\u003e: 开始时加速较慢，符合物理直觉\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e快结束\u003c/strong\u003e: 结束时快速到达目标状态，避免拖沓感\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e平滑过渡\u003c/strong\u003e: 整个过程没有突兀的速度变化\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"事件处理与性能优化\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#事件处理与性能优化\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 事件处理与性能优化\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            事件处理与性能优化\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e在处理复杂交互时，正确的事件管理和性能优化是必不可少的。\u003c/p\u003e\n\u003ch3 id=\"事件监听器的生命周期管理\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#事件监听器的生命周期管理\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 事件监听器的生命周期管理\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            事件监听器的生命周期管理\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e拖拽功能需要在文档级别监听鼠标事件，但这些监听器必须正确管理，避免内存泄漏：\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"useEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E7%A1%AE%E4%BF%9D%E5%9C%A8%E9%9D%9E%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A7%BB%E9%99%A4%E7%9B%91%E5%90%AC%E5%99%A8%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20handleMouseMove%2C%20handleMouseUp%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isDragging) {\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n        };\n    } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment inline\"\u003e// 确保在非拖拽状态下移除监听器\u003c/span\u003e\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n        \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n    }\n}, [isDragging, handleMouseMove, handleMouseUp]);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e设计特性：\u003c/p\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e条件监听\u003c/strong\u003e: 只在拖拽状态下添加监听器，减少不必要的事件处理\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e自动清理\u003c/strong\u003e: useEffect的返回函数确保组件卸载时清理监听器\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e状态同步\u003c/strong\u003e: 当拖拽状态改变时，监听器也相应更新\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"usecallback的性能优化\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#usecallback的性能优化\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to useCallback的性能优化\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            useCallback的性能优化\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0A%2F%2F%20%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91...%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0A%2F%2F%20%E5%90%B8%E9%99%84%E9%80%BB%E8%BE%91...%0A%7D%2C%20%5B%5D)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseMove = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment inline\"\u003e// 处理逻辑...\u003c/span\u003e\n}, [isDragging, dragOffset, dragStartPosition]);\n\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snapToEdge = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ecurrentPos\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment inline\"\u003e// 吸附逻辑...\u003c/span\u003e\n}, []);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003euseCallback\u003c/code\u003e确保这些函数引用在依赖项不变时保持稳定，避免不必要的重新渲染和事件监听器的频繁添加/移除。\u003c/p\u003e\n\u003ch3 id=\"防止事件冒泡的策略\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#防止事件冒泡的策略\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 防止事件冒泡的策略\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            防止事件冒泡的策略\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20%E9%98%B2%E6%AD%A2%E9%80%89%E4%B8%AD%E6%96%87%E6%9C%AC%E7%AD%89%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A6%81%E7%94%A8%E6%8B%96%E6%8B%BD%0AsetIsDragging(true)%3B%0A%2F%2F%20...%20%E5%85%B6%E4%BB%96%E9%80%BB%E8%BE%91%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n    e.\u003cspan class=\"hljs-title function_ inline\"\u003epreventDefault\u003c/span\u003e();  \u003cspan class=\"hljs-comment inline\"\u003e// 防止选中文本等默认行为\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isExpanded) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// 展开状态下禁用拖拽\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n    \u003cspan class=\"hljs-comment inline\"\u003e// ... 其他逻辑\u003c/span\u003e\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003ccode\u003ee.preventDefault()\u003c/code\u003e防止了一些可能干扰拖拽的默认浏览器行为，比如文本选择、图片拖拽等。\u003c/p\u003e\n\u003ch2 id=\"可复用设计模式总结\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#可复用设计模式总结\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 可复用设计模式总结\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            可复用设计模式总结\n        \u003c/h2\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e通过这次深入的分析，我们可以提取出几个通用的设计模式，它们可以应用到其他类似的交互系统中。\u003c/p\u003e\n\u003ch3 id=\"核心设计模式提取\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#核心设计模式提取\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 核心设计模式提取\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            核心设计模式提取\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e拖拽系统模式\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%201.%20%E7%8A%B6%E6%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useState(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%0A%2F%2F%202.%20%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0Aconst%20handleMouseDown%20%3D%20(e)%20%3D%3E%20%7B%0Aconst%20rect%20%3D%20elementRef.current%3F.getBoundingClientRect()%3B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%0Ay%3A%20e.clientY%20-%20rect.top%0A%7D)%3B%0AsetIsDragging(true)%3B%0A%7D%3B%0A%2F%2F%203.%20%E4%BD%8D%E7%BD%AE%E6%9B%B4%E6%96%B0%0Aconst%20handleMouseMove%20%3D%20(e)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetPosition(%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D)%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 1. 状态初始化\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isDragging, setIsDragging] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragOffset, setDragOffset] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 2. 事件处理\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003ee\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e rect = elementRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e?.\u003cspan class=\"hljs-title function_ inline\"\u003egetBoundingClientRect\u003c/span\u003e();\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetDragOffset\u003c/span\u003e({\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003etop\u003c/span\u003e\n    });\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n};\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 3. 位置更新\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseMove\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003ee\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e\n    });\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e圆形布局模式\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20getCircularPosition%20%3D%20(index%2C%20total%2C%20radius%2C%20centerX%2C%20centerY)%20%3D%3E%20%7B%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%2C%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%0A%7D%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetCircularPosition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003eindex, total, radius, centerX, centerY\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e {\n        \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius,\n        \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius\n    };\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e状态机模式\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E6%98%8E%E7%A1%AE%E7%9A%84%E7%8A%B6%E6%80%81%E5%AE%9A%E4%B9%89%0Aconst%20states%20%3D%20%7B%0AIDLE%3A%20'idle'%2C%0ADRAGGING%3A%20'dragging'%2C%0AEXPANDED%3A%20'expanded'%0A%7D%3B%0A%2F%2F%20%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E9%80%BB%E8%BE%91%0Aconst%20handleStateTransition%20%3D%20(currentState%2C%20action)%20%3D%3E%20%7B%0Aswitch%20(currentState)%20%7B%0Acase%20states.IDLE%3A%0Areturn%20action%20%3D%3D%3D%20'drag'%20%3F%20states.DRAGGING%20%3A%0Aaction%20%3D%3D%3D%20'click'%20%3F%20states.EXPANDED%20%3A%20currentState%3B%0A%2F%2F%20...%20%E5%85%B6%E4%BB%96%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%0A%7D%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 明确的状态定义\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e states = {\n    \u003cspan class=\"hljs-attr inline\"\u003eIDLE\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;idle\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr inline\"\u003eDRAGGING\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;dragging\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr inline\"\u003eEXPANDED\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;expanded\u0026#x27;\u003c/span\u003e\n};\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 状态转换逻辑\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleStateTransition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003ecurrentState, action\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-keyword inline\"\u003eswitch\u003c/span\u003e (currentState) {\n        \u003cspan class=\"hljs-keyword inline\"\u003ecase\u003c/span\u003e states.\u003cspan class=\"hljs-property inline\"\u003eIDLE\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e action === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;drag\u0026#x27;\u003c/span\u003e ? states.\u003cspan class=\"hljs-property inline\"\u003eDRAGGING\u003c/span\u003e : \n                   action === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;click\u0026#x27;\u003c/span\u003e ? states.\u003cspan class=\"hljs-property inline\"\u003eEXPANDED\u003c/span\u003e : currentState;\n        \u003cspan class=\"hljs-comment inline\"\u003e// ... 其他状态转换\u003c/span\u003e\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e防抖动画模式\u003c/strong\u003e:\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"const%20%5BpendingValue%2C%20setPendingValue%5D%20%3D%20useState(null)%3B%0Aconst%20timerRef%20%3D%20useRef(null)%3B%0Aconst%20debouncedUpdate%20%3D%20(newValue)%20%3D%3E%20%7B%0AsetPendingValue(newValue)%3B%0Aif%20(timerRef.current)%20clearTimeout(timerRef.current)%3B%0AtimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetActualValue(newValue)%3B%0A%7D%2C%20delay)%3B%0A%7D%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [pendingValue, setPendingValue] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e timerRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003edebouncedUpdate\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003enewValue\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPendingValue\u003c/span\u003e(newValue);\n    \n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (timerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(timerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n    \n    timerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetActualValue\u003c/span\u003e(newValue);\n    }, delay);\n};\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"最佳实践提炼\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#最佳实践提炼\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 最佳实践提炼\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            最佳实践提炼\n        \u003c/h3\u003e\n\u003col class=\"list-decimal list-inside mb-4 pl-6 space-y-2\"\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e事件监听器清理\u003c/strong\u003e: 始终在useEffect的返回函数中清理事件监听器\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e坐标计算边界保护\u003c/strong\u003e: 使用Math.min/max确保坐标在安全范围内\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e状态同步\u003c/strong\u003e: 相关状态的更新要保持同步，避免中间态\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e动画时序\u003c/strong\u003e: 复杂动画要考虑各部分的时序关系\u003c/li\u003e\n\u003cli class=\"text-foreground leading-relaxed\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e用户反馈\u003c/strong\u003e: 即使在延迟更新的情况下，也要提供即时的视觉反馈\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"完整源码全解析\" class=\"group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight\"\u003e\n            \u003ca href=\"#完整源码全解析\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 完整源码全解析\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            完整源码全解析\n        \u003c/h2\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"'use%20client'%3B%0Aimport%20React%2C%20%7BuseCallback%2C%20useEffect%2C%20useRef%2C%20useState%7D%20from%20'react'%3B%0Aimport%20%7BusePathname%2C%20useRouter%7D%20from%20'next%2Fnavigation'%3B%0Aimport%20%7BuseTheme%7D%20from%20'.%2FThemeProvider'%3B%0Aimport%20%7BuseLocaleStore%7D%20from%20'%40%2Flib%2Fstores%2FlocaleStore'%3B%0Aimport%20%7BLOCALES%7D%20from%20'%40%2Flib%2Futils%2Flocales'%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0Ainterface%20Position%20%7B%0Ax%3A%20number%3B%20%20%2F%2F%20X%E5%9D%90%E6%A0%87%0Ay%3A%20number%3B%20%20%2F%2F%20Y%E5%9D%90%E6%A0%87%0A%7D%0Aexport%20function%20Navigation()%20%7B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F%2F%20%E5%9F%BA%E7%A1%80%E7%8A%B6%E6%80%81%0Aconst%20%5Bmounted%2C%20setMounted%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD%E7%8A%B6%E6%80%81%0Aconst%20%5BisExpanded%2C%20setIsExpanded%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%8F%9C%E5%8D%95%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%0A%2F%2F%20%E4%BD%8D%E7%BD%AE%E7%9B%B8%E5%85%B3%E7%8A%B6%E6%80%81%0Aconst%20%5Bposition%2C%20setPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%0Aconst%20%5BoriginalPosition%2C%20setOriginalPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%2F%2F%20%E5%8E%9F%E5%A7%8B%E4%BD%8D%E7%BD%AE%E8%AE%B0%E5%BD%95%0A%2F%2F%20%E6%8B%96%E6%8B%BD%E7%9B%B8%E5%85%B3%E7%8A%B6%E6%80%81%0Aconst%20%5BisDragging%2C%20setIsDragging%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E6%A0%87%E8%AE%B0%0Aconst%20%5BdragOffset%2C%20setDragOffset%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%8B%96%E6%8B%BD%E5%81%8F%E7%A7%BB%E9%87%8F%0Aconst%20%5BdragStartPosition%2C%20setDragStartPosition%5D%20%3D%20useStatePosition%3E(%7Bx%3A%200%2C%20y%3A%200%7D)%3B%20%2F%2F%20%E6%8B%96%E6%8B%BD%E8%B5%B7%E5%A7%8B%E4%BD%8D%E7%BD%AE%0Aconst%20%5BshowRipple%2C%20setShowRipple%5D%20%3D%20useState(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%BE%E7%A4%BA%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%0A%2F%2F%20%E5%BC%95%E7%94%A8%E5%92%8C%E5%AE%9A%E6%97%B6%E5%99%A8%0Aconst%20debounceTimerRef%20%3D%20useRefNodeJS.Timeout%20%7C%20null%3E(null)%3B%20%20%20%20%20%2F%2F%20%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aconst%20hasDraggedSignificantlyRef%20%3D%20useRef(false)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%AF%E5%90%A6%E5%8F%91%E7%94%9F%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%0Aconst%20pendingPositionRef%20%3D%20useRefPosition%3E(%7Bx%3A%2050%2C%20y%3A%2050%7D)%3B%20%20%20%20%20%20%2F%2F%20%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%0Aconst%20ballRef%20%3D%20useRefHTMLDivElement%3E(null)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%AF%BC%E8%88%AA%E7%90%83%E5%BC%95%E7%94%A8%0A%2F%2F%20Next.js%E5%92%8C%E4%B8%BB%E9%A2%98hooks%0Aconst%20router%20%3D%20useRouter()%3B%0Aconst%20pathname%20%3D%20usePathname()%3B%0Aconst%20%7Btheme%2C%20toggleTheme%7D%20%3D%20useTheme()%3B%0Aconst%20%7Blocale%2C%20toggleLocale%7D%20%3D%20useLocaleStore()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%88%E6%9E%9C%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD%E6%97%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E4%BD%8D%E7%BD%AE%0A*%20%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%B2%E6%9F%93%E6%97%B6%E8%AE%A1%E7%AE%97%E5%88%9D%E5%A7%8B%E4%BD%8D%E7%BD%AE%EF%BC%8C%E9%81%BF%E5%85%8D%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E6%97%B6window%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%97%AE%E9%A2%98%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0AsetMounted(true)%3B%0Aconst%20initialX%20%3D%20window.innerWidth%20-%2080%3B%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E5%8F%B3%E8%BE%B9%E7%BC%9880px%0Aconst%20initialY%20%3D%20100%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E9%A1%B6%E9%83%A8100px%0AsetPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0AsetOriginalPosition(%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D)%3B%0ApendingPositionRef.current%20%3D%20%7Bx%3A%20initialX%2C%20y%3A%20initialY%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F**%0A*%20%E6%B8%85%E7%90%86%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%EF%BC%8C%E9%98%B2%E6%AD%A2%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Areturn%20()%20%3D%3E%20%7B%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%7D%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%AF%BC%E8%88%AA%E9%85%8D%E7%BD%AE%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%AF%BC%E8%88%AA%E6%A0%8F%E7%9B%AE%E9%85%8D%E7%BD%AE%0A*%20%E5%AE%9A%E4%B9%89%E6%89%80%E6%9C%89%E5%8F%AF%E5%AF%BC%E8%88%AA%E7%9A%84%E9%A1%B5%E9%9D%A2%E5%92%8C%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A0%87%E8%AF%86%E7%AC%A6%0A*%2F%0Aconst%20sections%20%3D%20%5B%0A%7B%0Aid%3A%20'personal'%20as%20const%2C%0Alabel%3A%20'Personal'%2C%0Adescription%3A%20'About%20Me'%2C%0Ahref%3A%20'%2Fpersonal'%0A%7D%2C%0A%7B%0Aid%3A%20'works'%20as%20const%2C%0Alabel%3A%20'Works'%2C%0Adescription%3A%20'Portfolio'%2C%0Ahref%3A%20'%2Fworks'%0A%7D%2C%0A%7B%0Aid%3A%20'contributions'%20as%20const%2C%0Alabel%3A%20'Contributions'%2C%0Adescription%3A%20'Open%20Source'%2C%0Ahref%3A%20'%2Fcontributions'%0A%7D%2C%0A%7B%0Aid%3A%20'documents'%20as%20const%2C%0Alabel%3A%20'Documents'%2C%0Adescription%3A%20'Insights'%2C%0Ahref%3A%20'%2Fdocuments'%0A%7D%2C%0A%5D%3B%0A%2F**%0A*%20%E6%A0%B9%E6%8D%AE%E5%BD%93%E5%89%8D%E8%B7%AF%E5%BE%84%E8%8E%B7%E5%8F%96%E6%B4%BB%E8%B7%83%E7%9A%84%E5%AF%BC%E8%88%AA%E9%A1%B9%0A*%20%40returns%20%E5%BD%93%E5%89%8D%E6%B4%BB%E8%B7%83%E7%9A%84%E5%AF%BC%E8%88%AA%E9%A1%B9ID%E6%88%96null%0A*%2F%0Aconst%20getActiveSection%20%3D%20()%20%3D%3E%20%7B%0Aif%20(pathname%20%3D%3D%3D%20'%2F')%20return%20'personal'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fworks')%20return%20'works'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fcontributions')%20return%20'contributions'%3B%0Aif%20(pathname%20%3D%3D%3D%20'%2Fdocuments')%20return%20'documents'%3B%0Areturn%20null%3B%0A%7D%3B%0Aconst%20activeSection%20%3D%20getActiveSection()%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%A0%B8%E5%BF%83%E7%AE%97%E6%B3%95%EF%BC%9A%E8%BE%B9%E7%BC%98%E5%90%B8%E9%99%84%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E8%BE%B9%E7%BC%98%E5%90%B8%E9%99%84%E7%AE%97%E6%B3%95%0A*%20%E8%AE%A1%E7%AE%97%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%E5%88%B0%E5%9B%9B%E4%B8%AA%E8%BE%B9%E7%95%8C%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E7%A7%BB%E5%8A%A8%E5%88%B0%E6%9C%80%E8%BF%91%E7%9A%84%E8%BE%B9%E7%95%8C%0A*%20%40param%20currentPos%20%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%0A*%20%40returns%20%E5%90%B8%E9%99%84%E5%90%8E%E7%9A%84%E4%BD%8D%E7%BD%AE%0A*%2F%0Aconst%20snapToEdge%20%3D%20useCallback((currentPos%3A%20Position)%20%3D%3E%20%7B%0Aconst%20windowWidth%20%3D%20window.innerWidth%3B%0Aconst%20windowHeight%20%3D%20window.innerHeight%3B%0Aconst%20ballSize%20%3D%2070%3B%20%20%20%20%2F%2F%20%E5%AF%BC%E8%88%AA%E7%90%83%E5%A4%A7%E5%B0%8F%0Aconst%20margin%20%3D%2020%3B%20%20%20%20%20%20%2F%2F%20%E8%B7%9D%E7%A6%BB%E8%BE%B9%E7%BC%98%E7%9A%84%E9%97%B4%E8%B7%9D%0Alet%20newPos%20%3D%20%7B...currentPos%7D%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%88%B0%E5%9B%9B%E4%B8%AA%E8%BE%B9%E7%95%8C%E7%9A%84%E8%B7%9D%E7%A6%BB%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0A%2F%2F%20%E6%89%BE%E5%88%B0%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E5%86%B3%E5%AE%9A%E5%90%B8%E9%99%84%E6%96%B9%E5%90%91%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%B7%A6%E8%BE%B9%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToRight)%20%7B%0AnewPos.x%20%3D%20windowWidth%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%8F%B3%E8%BE%B9%0A%7D%20else%20if%20(minDistance%20%3D%3D%3D%20distanceToTop)%20%7B%0AnewPos.y%20%3D%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E9%A1%B6%E9%83%A8%0A%7D%20else%20%7B%0AnewPos.y%20%3D%20windowHeight%20-%20ballSize%20-%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%BA%95%E9%83%A8%0A%7D%0A%2F%2F%20%E8%BE%B9%E7%95%8C%E7%BA%A6%E6%9D%9F%EF%BC%9A%E7%A1%AE%E4%BF%9D%E4%BD%8D%E7%BD%AE%E5%9C%A8%E5%AE%89%E5%85%A8%E8%8C%83%E5%9B%B4%E5%86%85%0AnewPos.x%20%3D%20Math.max(margin%2C%20Math.min(windowWidth%20-%20ballSize%20-%20margin%2C%20newPos.x))%3B%0AnewPos.y%20%3D%20Math.max(margin%2C%20Math.min(windowHeight%20-%20ballSize%20-%20margin%2C%20newPos.y))%3B%0Areturn%20newPos%3B%0A%7D%2C%20%5B%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%8B%96%E6%8B%BD%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E9%BC%A0%E6%A0%87%E6%8C%89%E4%B8%8B%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%EF%BC%8C%E8%AE%B0%E5%BD%95%E8%B5%B7%E5%A7%8B%E4%BD%8D%E7%BD%AE%E5%92%8C%E5%81%8F%E7%A7%BB%E9%87%8F%0A*%2F%0Aconst%20handleMouseDown%20%3D%20(e%3A%20React.MouseEvent)%20%3D%3E%20%7B%0Ae.preventDefault()%3B%20%20%2F%2F%20%E9%98%B2%E6%AD%A2%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA%EF%BC%88%E5%A6%82%E6%96%87%E6%9C%AC%E9%80%89%E6%8B%A9%EF%BC%89%0Aif%20(isExpanded)%20return%3B%20%20%2F%2F%20%E5%B1%95%E5%BC%80%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A6%81%E7%94%A8%E6%8B%96%E6%8B%BD%0AsetIsDragging(true)%3B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0AsetDragStartPosition(%7Bx%3A%20e.clientX%2C%20y%3A%20e.clientY%7D)%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E4%BD%8D%E7%BD%AE%E7%9B%B8%E5%AF%B9%E4%BA%8E%E5%AF%BC%E8%88%AA%E7%90%83%E7%9A%84%E5%81%8F%E7%A7%BB%E9%87%8F%0Aconst%20rect%20%3D%20ballRef.current%3F.getBoundingClientRect()%3B%0Aif%20(rect)%20%7B%0AsetDragOffset(%7B%0Ax%3A%20e.clientX%20-%20rect.left%2C%20%20%2F%2F%20%E9%BC%A0%E6%A0%87X%20-%20%E7%90%83%E5%B7%A6%E8%BE%B9%E8%B7%9D%20%3D%20X%E5%81%8F%E7%A7%BB%0Ay%3A%20e.clientY%20-%20rect.top%20%20%20%20%2F%2F%20%E9%BC%A0%E6%A0%87Y%20-%20%E7%90%83%E4%B8%8A%E8%BE%B9%E8%B7%9D%20%3D%20Y%E5%81%8F%E7%A7%BB%0A%7D)%3B%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E9%BC%A0%E6%A0%87%E7%A7%BB%E5%8A%A8%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%EF%BC%88%E4%BD%BF%E7%94%A8%E9%98%B2%E6%8A%96%E7%AD%96%E7%95%A5%EF%BC%89%0A*%20%E5%AE%9E%E6%97%B6%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%EF%BC%8C%E4%BD%86%E4%BD%BF%E7%94%A8%E9%98%B2%E6%8A%96%E9%81%BF%E5%85%8D%E9%A2%91%E7%B9%81%E6%B8%B2%E6%9F%93%0A*%2F%0Aconst%20handleMouseMove%20%3D%20useCallback((e%3A%20MouseEvent)%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E9%BC%A0%E6%A0%87%E4%BD%8D%E7%BD%AE%E5%92%8C%E5%88%9D%E5%A7%8B%E5%81%8F%E7%A7%BB%E9%87%8F%E8%AE%A1%E7%AE%97%E6%96%B0%E4%BD%8D%E7%BD%AE%0Aconst%20newPos%20%3D%20%7B%0Ax%3A%20e.clientX%20-%20dragOffset.x%2C%0Ay%3A%20e.clientY%20-%20dragOffset.y%0A%7D%3B%0A%2F%2F%20%E5%AD%98%E5%82%A8%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%EF%BC%88%E7%94%A8%E4%BA%8E%E9%98%B2%E6%8A%96%E6%9B%B4%E6%96%B0%EF%BC%89%0ApendingPositionRef.current%20%3D%20newPos%3B%0A%2F%2F%20%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%EF%BC%8C%E6%8F%90%E4%BE%9B%E5%8D%B3%E6%97%B6%E5%8F%8D%E9%A6%88%0AsetShowRipple(true)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E7%8E%B0%E6%9C%89%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0A%7D%0A%2F%2F%20%E8%AE%BE%E7%BD%AE%E6%96%B0%E7%9A%84%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%EF%BC%88500ms%E5%BB%B6%E8%BF%9F%EF%BC%89%0AdebounceTimerRef.current%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E6%8B%96%E6%8B%BD%E8%B7%9D%E7%A6%BB%EF%BC%8C%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0A%2F%2F%20%E8%B6%85%E8%BF%873%E5%83%8F%E7%B4%A0%E8%A7%86%E4%B8%BA%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%0Aif%20(dragDistance%20%3E%203)%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D%0A%7D%2C%20%5BisDragging%2C%20dragOffset%2C%20dragStartPosition%5D)%3B%0A%2F**%0A*%20%E9%BC%A0%E6%A0%87%E9%87%8A%E6%94%BE%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E7%BB%93%E6%9D%9F%E6%8B%96%E6%8B%BD%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%90%B8%E9%99%84%E9%80%BB%E8%BE%91%0A*%2F%0Aconst%20handleMouseUp%20%3D%20useCallback(()%20%3D%3E%20%7B%0Aif%20(!isDragging)%20return%3B%0AsetIsDragging(false)%3B%0AsetShowRipple(false)%3B%0A%2F%2F%20%E6%B8%85%E9%99%A4%E9%98%B2%E6%8A%96%E5%AE%9A%E6%97%B6%E5%99%A8%0Aif%20(debounceTimerRef.current)%20%7B%0AclearTimeout(debounceTimerRef.current)%3B%0AdebounceTimerRef.current%20%3D%20null%3B%0A%7D%0A%2F%2F%20%E5%A6%82%E6%9E%9C%E5%8F%91%E7%94%9F%E4%BA%86%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%EF%BC%8C%E6%89%A7%E8%A1%8C%E8%BE%B9%E7%BC%98%E5%90%B8%E9%99%84%0Aif%20(hasDraggedSignificantlyRef.current)%20%7B%0Aconst%20snappedPos%20%3D%20snapToEdge(pendingPositionRef.current)%3B%0AsetPosition(snappedPos)%3B%0AsetOriginalPosition(snappedPos)%3B%20%20%2F%2F%20%E6%9B%B4%E6%96%B0%E5%8E%9F%E5%A7%8B%E4%BD%8D%E7%BD%AE%E8%AE%B0%E5%BD%95%0A%7D%0A%2F%2F%20%E5%BB%B6%E8%BF%9F%E9%87%8D%E7%BD%AE%E6%8B%96%E6%8B%BD%E6%A0%87%E8%AE%B0%EF%BC%8C%E9%81%BF%E5%85%8D%E4%B8%8E%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%86%B2%E7%AA%81%0AsetTimeout(()%20%3D%3E%20%7B%0AhasDraggedSignificantlyRef.current%20%3D%20false%3B%0A%7D%2C%20100)%3B%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E7%AE%A1%E7%90%86%E5%85%A8%E5%B1%80%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E5%99%A8%0A*%20%E5%8F%AA%E5%9C%A8%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E4%B8%8B%E6%B7%BB%E5%8A%A0%E7%9B%91%E5%90%AC%E5%99%A8%EF%BC%8C%E4%BC%98%E5%8C%96%E6%80%A7%E8%83%BD%0A*%2F%0AuseEffect(()%20%3D%3E%20%7B%0Aif%20(isDragging)%20%7B%0Adocument.addEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.addEventListener('mouseup'%2C%20handleMouseUp)%3B%0Areturn%20()%20%3D%3E%20%7B%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E7%A1%AE%E4%BF%9D%E5%9C%A8%E9%9D%9E%E6%8B%96%E6%8B%BD%E7%8A%B6%E6%80%81%E4%B8%8B%E7%A7%BB%E9%99%A4%E7%9B%91%E5%90%AC%E5%99%A8%0Adocument.removeEventListener('mousemove'%2C%20handleMouseMove)%3B%0Adocument.removeEventListener('mouseup'%2C%20handleMouseUp)%3B%0A%7D%0A%7D%2C%20%5BisDragging%5D)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E4%BA%A4%E4%BA%92%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%AF%BC%E8%88%AA%E7%90%83%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E5%88%87%E6%8D%A2%E5%B1%95%E5%BC%80%2F%E6%94%B6%E8%B5%B7%E7%8A%B6%E6%80%81%EF%BC%8C%E5%A4%84%E7%90%86%E4%BD%8D%E7%BD%AE%E7%A7%BB%E5%8A%A8%0A*%2F%0Aconst%20handleBallClick%20%3D%20()%20%3D%3E%20%7B%0A%2F%2F%20%E5%8F%AA%E6%9C%89%E5%9C%A8%E9%9D%9E%E6%98%BE%E8%91%97%E6%8B%96%E6%8B%BD%E6%97%B6%E6%89%8D%E5%A4%84%E7%90%86%E7%82%B9%E5%87%BB%0Aif%20(!hasDraggedSignificantlyRef.current)%20%7B%0Aif%20(!isExpanded)%20%7B%0A%2F%2F%20%E5%B1%95%E5%BC%80%EF%BC%9A%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%EF%BC%8C%E7%A7%BB%E5%8A%A8%E5%88%B0%E5%B1%8F%E5%B9%95%E4%B8%AD%E5%A4%AE%0AsetOriginalPosition(position)%3B%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%20-%2035%3B%20%20%20%2F%2F%20%E4%B8%AD%E5%BF%83X%20-%20%E7%90%83%E5%8D%8A%E5%BE%84%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%20-%2035%3B%20%20%2F%2F%20%E4%B8%AD%E5%BF%83Y%20-%20%E7%90%83%E5%8D%8A%E5%BE%84%0AsetPosition(%7Bx%3A%20centerX%2C%20y%3A%20centerY%7D)%3B%0AsetIsExpanded(true)%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E6%94%B6%E8%B5%B7%EF%BC%9A%E5%BB%B6%E8%BF%9F150ms%E5%90%8E%E5%9B%9E%E5%88%B0%E5%8E%9F%E5%A7%8B%E4%BD%8D%E7%BD%AE%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E6%89%A7%E8%A1%8C%E5%8A%A8%E4%BD%9C%E5%90%8E%E6%94%B6%E8%B5%B7%E8%8F%9C%E5%8D%95%0A*%2F%0Aconst%20handleMenuItemClick%20%3D%20(action%3A%20()%20%3D%3E%20void)%20%3D%3E%20%7B%0Aaction()%3B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F**%0A*%20%E9%A1%B5%E9%9D%A2%E5%AF%BC%E8%88%AA%E5%A4%84%E7%90%86%0A*%2F%0Aconst%20navigateToPage%20%3D%20(href%3A%20string)%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20router.push(href))%3B%0A%7D%3B%0A%2F**%0A*%20%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2%E5%A4%84%E7%90%86%0A*%2F%0Aconst%20handleThemeToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20toggleTheme())%3B%0A%7D%3B%0A%2F**%0A*%20%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E5%A4%84%E7%90%86%0A*%20%E6%94%AF%E6%8C%81%E6%96%87%E6%A1%A3%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E9%87%8D%E5%AE%9A%E5%90%91%0A*%2F%0Aconst%20handleLocaleToggle%20%3D%20()%20%3D%3E%20%7B%0AhandleMenuItemClick(()%20%3D%3E%20%7B%0AtoggleLocale((newLocale)%20%3D%3E%20%7B%0A%2F%2F%20%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%9C%A8%E6%96%87%E6%A1%A3%E9%A1%B5%E9%9D%A2%EF%BC%8C%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E7%9B%B8%E5%90%8C%E6%96%87%E7%AB%A0%E7%9A%84%E6%96%B0%E8%AF%AD%E8%A8%80%E7%89%88%E6%9C%AC%0Aif%20(pathname.startsWith('%2Fdocuments%2F'))%20%7B%0Aconst%20pathSegments%20%3D%20pathname.split('%2F').filter(Boolean)%3B%0Aif%20(pathSegments.length%20%3E%3D%204)%20%7B%0Aconst%20%5B%2C%20currentLang%2C%20category%2C%20fileName%5D%20%3D%20pathSegments%3B%0Aconst%20newPath%20%3D%20%60%2Fdocuments%2F%24%7BnewLocale%7D%2F%24%7Bcategory%7D%2F%24%7BfileName%7D%60%3B%0Arouter.push(newPath)%3B%0A%7D%0A%7D%0A%7D)%3B%0A%7D)%3B%0A%7D%3B%0A%2F**%0A*%20%E8%83%8C%E6%99%AF%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%0A*%20%E7%82%B9%E5%87%BB%E8%83%8C%E6%99%AF%E6%94%B6%E8%B5%B7%E8%8F%9C%E5%8D%95%0A*%2F%0Aconst%20handleBackdropClick%20%3D%20()%20%3D%3E%20%7B%0AsetIsExpanded(false)%3B%0AsetTimeout(()%20%3D%3E%20%7B%0AsetPosition(originalPosition)%3B%0A%7D%2C%20150)%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%A0%B8%E5%BF%83%E7%AE%97%E6%B3%95%EF%BC%9A%E5%9C%86%E5%BD%A2%E5%B8%83%E5%B1%80%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%9C%86%E5%BD%A2%E8%8F%9C%E5%8D%95%E5%B8%83%E5%B1%80%E7%AE%97%E6%B3%95%0A*%20%E4%BD%BF%E7%94%A8%E6%9E%81%E5%9D%90%E6%A0%87%E8%AE%A1%E7%AE%97%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%9A%84%E4%BD%8D%E7%BD%AE%0A*%20%40param%20index%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%B4%A2%E5%BC%95%0A*%20%40param%20total%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E6%80%BB%E6%95%B0%0A*%20%40param%20radius%20%E5%9C%86%E5%BD%A2%E5%8D%8A%E5%BE%84%0A*%20%40returns%20%E8%8F%9C%E5%8D%95%E9%A1%B9%E7%9A%84%E5%B1%8F%E5%B9%95%E5%9D%90%E6%A0%87%0A*%2F%0Aconst%20getCircularPosition%20%3D%20(index%3A%20number%2C%20total%3A%20number%2C%20radius%3A%20number%20%3D%20120)%20%3D%3E%20%7B%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E8%A7%92%E5%BA%A6%EF%BC%9A%E5%B0%86%E5%9C%86%E5%91%A8%E7%AD%89%E5%88%86%EF%BC%8C%E8%B5%B7%E5%A7%8B%E8%A7%92%E5%BA%A6%E4%B8%BA-%CF%80%2F2%EF%BC%8812%E7%82%B9%E9%92%9F%E6%96%B9%E5%90%91%EF%BC%89%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%0A%2F%2F%20%E5%B1%8F%E5%B9%95%E4%B8%AD%E5%BF%83%E5%9D%90%E6%A0%87%0Aconst%20centerX%20%3D%20window.innerWidth%20%2F%202%3B%0Aconst%20centerY%20%3D%20window.innerHeight%20%2F%202%3B%0A%2F%2F%20%E6%9E%81%E5%9D%90%E6%A0%87%E5%88%B0%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%0Areturn%20%7B%0Ax%3A%20centerX%20%2B%20Math.cos(angle)%20*%20radius%20-%2060%2C%20%20%2F%2F%20-60%E4%B8%BA%E8%8F%9C%E5%8D%95%E9%A1%B9%E5%AE%BD%E5%BA%A6%E8%B0%83%E6%95%B4%0Ay%3A%20centerY%20%2B%20Math.sin(angle)%20*%20radius%20-%2030%2C%20%20%2F%2F%20-30%E4%B8%BA%E8%8F%9C%E5%8D%95%E9%A1%B9%E9%AB%98%E5%BA%A6%E8%B0%83%E6%95%B4%0A%7D%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%A0%B7%E5%BC%8F%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E8%8E%B7%E5%8F%96%E7%BB%9F%E4%B8%80%E7%9A%84%E6%8C%89%E9%92%AE%E6%A0%B7%E5%BC%8F%0A*%2F%0Aconst%20getUniformButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20border%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3B%0A%7D%3B%0A%2F**%0A*%20%E8%8E%B7%E5%8F%96%E4%B8%BB%E9%A2%98%E6%8C%89%E9%92%AE%E6%A0%B7%E5%BC%8F%0A*%2F%0Aconst%20getThemeButtonStyles%20%3D%20()%20%3D%3E%20%7B%0Areturn%20%22fixed%20z-50%20w-16%20h-12%20rounded-xl%20shadow-lg%20hover%3Ascale-110%20transition-all%20duration-300%20group%20opacity-0%20menu-item%20backdrop-blur-md%20bg-transparent%20hover%3Abg-surface%2F20%22%3B%0A%7D%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20UI%E7%BB%84%E4%BB%B6%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E6%B4%BB%E8%B7%83%E7%8A%B6%E6%80%81%E6%8C%87%E7%A4%BA%E5%99%A8%E7%BB%84%E4%BB%B6%0A*%2F%0Aconst%20ActiveIndicator%20%3D%20(%7BisActive%7D%3A%20%7B%20isActive%3A%20boolean%20%7D)%20%3D%3E%20%7B%0Aif%20(!isActive)%20return%20null%3B%0Areturn%20(%0Adiv%20className%3D%22absolute%20-top-1%20-right-1%20w-3%20h-3%20rounded-full%20shadow-lg%22%3E%0Adiv%20className%3D%22w-full%20h-full%20rounded-full%20bg-primary%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%3B%0A%2F%2F%20%E4%B8%BB%E9%A2%98%E5%9B%BE%E6%A0%87%E7%BB%84%E4%BB%B6%0Aconst%20SunIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20fillRule%3D%22evenodd%22%0Ad%3D%22M10%202a1%201%200%20011%201v1a1%201%200%2011-2%200V3a1%201%200%20011-1zm4%208a4%204%200%2011-8%200%204%204%200%20018%200zm-.464%204.95l.707.707a1%201%200%20001.414-1.414l-.707-.707a1%201%200%2000-1.414%201.414zm2.12-10.607a1%201%200%20010%201.414l-.706.707a1%201%200%2011-1.414-1.414l.707-.707a1%201%200%20011.414%200zM17%2011a1%201%200%20100-2h-1a1%201%200%20100%202h1zm-7%204a1%201%200%20011%201v1a1%201%200%2011-2%200v-1a1%201%200%20011-1zM5.05%206.464A1%201%200%20106.465%205.05l-.708-.707a1%201%200%2000-1.414%201.414l.707.707zm1.414%208.486l-.707.707a1%201%200%2001-1.414-1.414l.707-.707a1%201%200%20011.414%201.414zM4%2011a1%201%200%20100-2H3a1%201%200%20000%202h1z%22%0AclipRule%3D%22evenodd%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0Aconst%20MoonIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%22%3E%0Asvg%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0Apath%20d%3D%22M17.293%2013.293A8%208%200%20016.707%202.707a8.001%208.001%200%201010.586%2010.586z%22%2F%3E%0Asvg%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E5%9B%BE%E6%A0%87%E7%BB%84%E4%BB%B6%0Aconst%20LocaleIcon%20%3D%20()%20%3D%3E%20(%0Adiv%20className%3D%22w-5%20h-5%20text-accent%20transition-all%20duration-300%20flex%20items-center%20justify-center%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%22%3E%0A%7BLOCALES%5Blocale%5D.flag%7D%0Aspan%3E%0Adiv%3E%0A)%3B%0A%2F%2F%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E6%B8%B2%E6%9F%93%E9%80%BB%E8%BE%91%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0A%2F**%0A*%20%E5%8A%A0%E8%BD%BD%E7%8A%B6%E6%80%81%E6%B8%B2%E6%9F%93%0A*%2F%0Aif%20(!mounted)%20%7B%0Areturn%20(%0Adiv%20className%3D%22fixed%20top-20%20right-5%20z-50%22%3E%0Adiv%0AclassName%3D%22w-16%20h-16%20rounded-full%20backdrop-blur-md%20border%20animate-pulse%20bg-surface%2F60%20border-surface%2F40%22%3Ediv%3E%0Adiv%3E%0A)%3B%0A%7D%0A%2F**%0A*%20%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%8F%9C%E5%8D%95%E9%A1%B9%E6%95%B0%E7%BB%84%0A*%2F%0Aconst%20allMenuItems%20%3D%20%5B%0A...sections.map(section%20%3D%3E%20(%7B%0Atype%3A%20'section'%20as%20const%2C%0Asection%2C%0Aaction%3A%20()%20%3D%3E%20navigateToPage(section.id%20%3D%3D%3D%20'personal'%20%3F%20'%2F'%20%3A%20section.href)%2C%0AisActive%3A%20activeSection%20%3D%3D%3D%20section.id%0A%7D))%2C%0A%7B%0Atype%3A%20'theme'%20as%20const%2C%0Aaction%3A%20handleThemeToggle%2C%0AisActive%3A%20false%0A%7D%2C%0A%7B%0Atype%3A%20'locale'%20as%20const%2C%0Aaction%3A%20handleLocaleToggle%2C%0AisActive%3A%20false%0A%7D%0A%5D%3B%0Areturn%20(%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E4%B8%BB%E5%AF%BC%E8%88%AA%E7%90%83%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0Adiv%0Aref%3D%7BballRef%7D%0AclassName%3D%7B%60%0Afixed%20z-50%20transition-all%20duration-500%20cursor-pointer%20select-none%0A%24%7BisDragging%20%3F%20'cursor-grabbing%20scale-110%20duration-0'%20%3A%20'cursor-grab%20hover%3Ascale-105'%7D%0A%24%7BisExpanded%20%3F%20'hover%3Ascale-120'%20%3A%20''%7D%0A%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7Bposition.x%7Dpx%60%2C%0Atop%3A%20%60%24%7Bposition.y%7Dpx%60%2C%0Atransform%3A%20%60%24%7BisDragging%20%3F%20'rotate(5deg)'%20%3A%20isExpanded%20%3F%20'rotate(0deg)%20scale(1.1)'%20%3A%20'rotate(0deg)'%7D%60%0A%7D%7D%0AonMouseDown%3D%7BhandleMouseDown%7D%0AonClick%3D%7BhandleBallClick%7D%0A%3E%0A%7B%2F*%20%E7%8E%B0%E4%BB%A3%E5%8C%96%E5%AF%BC%E8%88%AA%E7%90%83%20*%2F%7D%0Adiv%20className%3D%7B%60%0Arelative%20w-16%20h-16%20rounded-full%20transition-all%20duration-500%0A%24%7BisExpanded%20%3F%20'animate-pulse%20shadow-lg'%20%3A%20''%7D%0A%60%7D%3E%0A%7B%2F*%20%E7%90%83%E4%BD%93%E9%98%B4%E5%BD%B1%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20rounded-full%20bg-black%2F20%20blur-lg%20translate-y-2%22%3Ediv%3E%0A%7B%2F*%20%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%20-%20%E6%8B%96%E6%8B%BD%E6%97%B6%E6%98%BE%E7%A4%BA%20*%2F%7D%0A%7BshowRipple%20%26%26%20(%0Adiv%0AclassName%3D%22absolute%20rounded-full%20border-2%20animate-ping%20pointer-events-none%22%0Astyle%3D%7B%7B%0AborderColor%3A%20theme%20%3D%3D%3D%20'dark'%20%3F%20'rgba(78%2C%20205%2C%20196%2C%200.6)'%20%3A%20'rgba(0%2C%20102%2C%20204%2C%200.6)'%2C%0Awidth%3A%20'80px'%2C%0Aheight%3A%20'80px'%2C%0Atop%3A%20'-8px'%2C%0Aleft%3A%20'-8px'%2C%0AanimationDuration%3A%20'1s'%0A%7D%7D%0A%3Ediv%3E%0A)%7D%0A%7B%2F*%20%E4%B8%BB%E7%90%83%E4%BD%93%20*%2F%7D%0Adiv%0AclassName%3D%22relative%20w-full%20h-full%20rounded-full%20shadow-xl%20transform-gpu%20backdrop-blur-md%20border%20transition-all%20duration-300%20bg-surface%2F60%20border-surface%2F40%20hover%3Abg-surface%2F80%22%3E%0A%7B%2F*%20%E9%AB%98%E5%85%89%E6%95%88%E6%9E%9C%20*%2F%7D%0Adiv%20className%3D%22absolute%20top-2%20left-2%20w-4%20h-4%20rounded-full%20bg-white%2F30%20blur-sm%22%3Ediv%3E%0A%7B%2F*%20%E8%8F%9C%E5%8D%95%E7%AC%A6%E5%8F%B7%20*%2F%7D%0Adiv%20className%3D%22absolute%20inset-0%20flex%20items-center%20justify-center%22%3E%0Adiv%20className%3D%7B%60%0Aw-6%20h-6%20rounded-full%20border%20transition-all%20duration-300%20flex%20items-center%20justify-center%20border-foreground%2F40%0A%24%7BisExpanded%20%3F%20'rotate-90%20scale-110'%20%3A%20'rotate-0'%7D%0A%60%7D%3E%0A%7B%0AisExpanded%20%3F%20(%0Adiv%0AclassName%3D%22relative%20transition-all%20duration-300%20w-2%20h-2%20opacity-50%20text-center%20flex%20items-center%20justify-center%20text-foreground%22%0Astyle%3D%7B%7Btransform%3A%20'translateY(-1px)'%7D%7D%0A%3E%C3%97div%3E%0A)%20%3A%20(%0Adiv%0AclassName%3D%22transition-all%20duration-300%20w-1%20h-1%20opacity-50%20rounded-full%20bg-foreground%22%3Ediv%3E%0A)%0A%7D%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20%E5%9C%86%E5%BD%A2%E8%8F%9C%E5%8D%95%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7BisExpanded%20%26%26%20(%0A%7B%2F*%20%E8%83%8C%E6%99%AF%E9%81%AE%E7%BD%A9%20*%2F%7D%0Adiv%0AclassName%3D%22fixed%20inset-0%20z-40%20backdrop-blur-md%20transition-all%20duration-300%20bg-background%2F20%22%0AonClick%3D%7BhandleBackdropClick%7D%0A%3Ediv%3E%0A%7B%2F*%20%E5%9C%86%E5%BD%A2%E5%B8%83%E5%B1%80%E7%9A%84%E8%8F%9C%E5%8D%95%E9%A1%B9%20*%2F%7D%0A%7BallMenuItems.map((item%2C%20index)%20%3D%3E%20%7B%0Aconst%20circularPos%20%3D%20getCircularPosition(index%2C%20allMenuItems.length)%3B%0Aif%20(item.type%20%3D%3D%3D%20'section')%20%7B%0Aconst%20section%20%3D%20item.section!%3B%0Areturn%20(%0Abutton%0Akey%3D%7Bsection.id%7D%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7B%60%24%7BgetUniformButtonStyles()%7D%20w-28%20h-14%20%24%7Bitem.isActive%20%3F%20'ring-2%20ring-blue-400%2F60%20scale-105'%20%3A%20''%7D%60%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20%E6%A0%8F%E7%9B%AE%E5%86%85%E5%AE%B9%20*%2F%7D%0Adiv%0AclassName%3D%22absolute%20inset-0%20flex%20flex-col%20items-center%20justify-center%20text-foreground%22%3E%0Aspan%20className%3D%22text-sm%20font-bold%20leading-tight%20text-center%22%3E%0A%7Bsection.label%7D%0Aspan%3E%0Aspan%20className%3D%22text-xs%20opacity-70%20mt-0.5%20font-medium%22%3E%0A%7Bsection.description%7D%0Aspan%3E%0Adiv%3E%0AActiveIndicator%20isActive%3D%7Bitem.isActive%7D%2F%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20if%20(item.type%20%3D%3D%3D%20'theme')%20%7B%0Areturn%20(%0Abutton%0Akey%3D%22theme%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2%E5%9B%BE%E6%A0%87%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0A%7Btheme%20%3D%3D%3D%20'dark'%20%3F%20SunIcon%2F%3E%20%3A%20MoonIcon%2F%3E%7D%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%20else%20%7B%20%2F%2F%20locale%20toggle%0Areturn%20(%0Abutton%0Akey%3D%22locale%22%0AonClick%3D%7Bitem.action%7D%0AclassName%3D%7BgetThemeButtonStyles()%7D%0Astyle%3D%7B%7B%0Aleft%3A%20%60%24%7BcircularPos.x%7Dpx%60%2C%0Atop%3A%20%60%24%7BcircularPos.y%7Dpx%60%2C%0AanimationDelay%3A%20%60%24%7Bindex%20*%20120%7Dms%60%0A%7D%7D%0A%3E%0A%7B%2F*%20%E8%AF%AD%E8%A8%80%E5%88%87%E6%8D%A2%E5%9B%BE%E6%A0%87%20*%2F%7D%0Adiv%20className%3D%22flex%20items-center%20justify-center%20h-full%22%3E%0ALocaleIcon%2F%3E%0Adiv%3E%0Abutton%3E%0A)%3B%0A%7D%0A%7D)%7D%0A)%7D%0A%7B%2F*%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20CSS%E5%8A%A8%E7%94%BB%E5%AE%9A%E4%B9%89%20%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%20*%2F%7D%0A%7B%60%0A%40keyframes%20menuItemAppear%20%7B%0A0%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.7%3B%0Atransform%3A%20scale(0.8)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A%7D%0A%40keyframes%20menuItemDisappear%20%7B%0A0%25%20%7B%0Aopacity%3A%201%3B%0Atransform%3A%20scale(1)%20translate(0%25%2C%200%25)%3B%0A%7D%0A50%25%20%7B%0Aopacity%3A%200.3%3B%0Atransform%3A%20scale(0.6)%20translate(-25%25%2C%20-25%25)%3B%0A%7D%0A100%25%20%7B%0Aopacity%3A%200%3B%0Atransform%3A%20scale(0)%20translate(-50%25%2C%20-50%25)%3B%0A%7D%0A%7D%0A.menu-item%20%7B%0Aanimation%3A%20menuItemAppear%200.6s%20cubic-bezier(0.4%2C%200%2C%200.2%2C%201)%20forwards%3B%0A%7D%0A%60%7D%0A)%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;use client\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e, {useCallback, useEffect, useRef, useState} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {usePathname, useRouter} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;next/navigation\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {useTheme} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;./ThemeProvider\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {useLocaleStore} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;@/lib/stores/localeStore\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003eimport\u003c/span\u003e {\u003cspan class=\"hljs-variable constant_ inline\"\u003eLOCALES\u003c/span\u003e} \u003cspan class=\"hljs-keyword inline\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;@/lib/utils/locales\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment inline\"\u003e// ==================== 类型定义 ====================\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003einterface\u003c/span\u003e \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// X坐标\u003c/span\u003e\n    \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// Y坐标\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword inline\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eNavigation\u003c/span\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 状态管理 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e// 基础状态\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [mounted, setMounted] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);                    \u003cspan class=\"hljs-comment inline\"\u003e// 组件挂载状态\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isExpanded, setIsExpanded] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);              \u003cspan class=\"hljs-comment inline\"\u003e// 菜单展开状态\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 位置相关状态\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [position, setPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});           \u003cspan class=\"hljs-comment inline\"\u003e// 当前位置\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [originalPosition, setOriginalPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e}); \u003cspan class=\"hljs-comment inline\"\u003e// 原始位置记录\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 拖拽相关状态\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [isDragging, setIsDragging] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);              \u003cspan class=\"hljs-comment inline\"\u003e// 拖拽状态标记\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragOffset, setDragOffset] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e});         \u003cspan class=\"hljs-comment inline\"\u003e// 拖拽偏移量\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [dragStartPosition, setDragStartPosition] = useState\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e0\u003c/span\u003e}); \u003cspan class=\"hljs-comment inline\"\u003e// 拖拽起始位置\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [showRipple, setShowRipple] = \u003cspan class=\"hljs-title function_ inline\"\u003euseState\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);              \u003cspan class=\"hljs-comment inline\"\u003e// 显示波纹效果\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// 引用和定时器\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e debounceTimerRef = useRef\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003eNodeJS\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003eTimeout\u003c/span\u003e | \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);     \u003cspan class=\"hljs-comment inline\"\u003e// 防抖定时器\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e hasDraggedSignificantlyRef = \u003cspan class=\"hljs-title function_ inline\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);                 \u003cspan class=\"hljs-comment inline\"\u003e// 是否发生显著拖拽\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e pendingPositionRef = useRef\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u0026gt;({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: \u003cspan class=\"hljs-number inline\"\u003e50\u003c/span\u003e});      \u003cspan class=\"hljs-comment inline\"\u003e// 待更新位置\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e ballRef = useRef\u0026lt;\u003cspan class=\"hljs-title class_ inline\"\u003eHTMLDivElement\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e);                     \u003cspan class=\"hljs-comment inline\"\u003e// 导航球引用\u003c/span\u003e\n    \n    \u003cspan class=\"hljs-comment inline\"\u003e// Next.js和主题hooks\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e router = \u003cspan class=\"hljs-title function_ inline\"\u003euseRouter\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e pathname = \u003cspan class=\"hljs-title function_ inline\"\u003eusePathname\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e {theme, toggleTheme} = \u003cspan class=\"hljs-title function_ inline\"\u003euseTheme\u003c/span\u003e();\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e {locale, toggleLocale} = \u003cspan class=\"hljs-title function_ inline\"\u003euseLocaleStore\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 初始化效果 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 组件挂载时初始化位置\n     * 在客户端渲染时计算初始位置，避免服务端渲染时window未定义的问题\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetMounted\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e80\u003c/span\u003e;   \u003cspan class=\"hljs-comment inline\"\u003e// 距离右边缘80px\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e initialY = \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e;                      \u003cspan class=\"hljs-comment inline\"\u003e// 距离顶部100px\u003c/span\u003e\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: initialX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: initialY});\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: initialX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: initialY});\n        pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = {\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: initialX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: initialY};\n    }, []);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 清理防抖定时器，防止内存泄漏\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n                \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n            }\n        };\n    }, []);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 导航配置 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 导航栏目配置\n     * 定义所有可导航的页面和对应的标识符\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e sections = [\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;personal\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Personal\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;About Me\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/personal\u0026#x27;\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;works\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Works\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Portfolio\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/works\u0026#x27;\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;contributions\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Contributions\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Open Source\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/contributions\u0026#x27;\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;documents\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003elabel\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Documents\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003edescription\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;Insights\u0026#x27;\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/documents\u0026#x27;\u003c/span\u003e\n        },\n    ];\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 根据当前路径获取活跃的导航项\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@returns\u003c/span\u003e 当前活跃的导航项ID或null\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetActiveSection\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;personal\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/works\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;works\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/contributions\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;contributions\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/documents\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;documents\u0026#x27;\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n    };\n\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e activeSection = \u003cspan class=\"hljs-title function_ inline\"\u003egetActiveSection\u003c/span\u003e();\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 核心算法：边缘吸附 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 边缘吸附算法\n     * 计算当前位置到四个边界的距离，移动到最近的边界\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e currentPos 当前位置\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@returns\u003c/span\u003e 吸附后的位置\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snapToEdge = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ecurrentPos\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003ePosition\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowWidth = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e windowHeight = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e ballSize = \u003cspan class=\"hljs-number inline\"\u003e70\u003c/span\u003e;    \u003cspan class=\"hljs-comment inline\"\u003e// 导航球大小\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e margin = \u003cspan class=\"hljs-number inline\"\u003e20\u003c/span\u003e;      \u003cspan class=\"hljs-comment inline\"\u003e// 距离边缘的间距\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003elet\u003c/span\u003e newPos = {...currentPos};\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 计算到四个边界的距离\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToLeft = currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToRight = windowWidth - currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToTop = currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToBottom = windowHeight - currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// 找到最小距离\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e minDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 根据最小距离决定吸附方向\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToLeft) {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = margin;  \u003cspan class=\"hljs-comment inline\"\u003e// 吸附到左边\u003c/span\u003e\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToRight) {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = windowWidth - ballSize - margin;  \u003cspan class=\"hljs-comment inline\"\u003e// 吸附到右边\u003c/span\u003e\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToTop) {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = margin;  \u003cspan class=\"hljs-comment inline\"\u003e// 吸附到顶部\u003c/span\u003e\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n            newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = windowHeight - ballSize - margin;  \u003cspan class=\"hljs-comment inline\"\u003e// 吸附到底部\u003c/span\u003e\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 边界约束：确保位置在安全范围内\u003c/span\u003e\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowWidth - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e));\n        newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emax\u003c/span\u003e(margin, \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(windowHeight - ballSize - margin, newPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e));\n        \n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e newPos;\n    }, []);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 拖拽事件处理 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 鼠标按下事件处理\n     * 初始化拖拽状态，记录起始位置和偏移量\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMouseDown\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        e.\u003cspan class=\"hljs-title function_ inline\"\u003epreventDefault\u003c/span\u003e();  \u003cspan class=\"hljs-comment inline\"\u003e// 防止默认行为（如文本选择）\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isExpanded) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// 展开状态下禁用拖拽\u003c/span\u003e\n\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n        hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetDragStartPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e});\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// 计算鼠标点击位置相对于导航球的偏移量\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e rect = ballRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e?.\u003cspan class=\"hljs-title function_ inline\"\u003egetBoundingClientRect\u003c/span\u003e();\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (rect) {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetDragOffset\u003c/span\u003e({\n                \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003eleft\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// 鼠标X - 球左边距 = X偏移\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - rect.\u003cspan class=\"hljs-property inline\"\u003etop\u003c/span\u003e    \u003cspan class=\"hljs-comment inline\"\u003e// 鼠标Y - 球上边距 = Y偏移\u003c/span\u003e\n            });\n        }\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 鼠标移动事件处理（使用防抖策略）\n     * 实时更新位置，但使用防抖避免频繁渲染\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseMove = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ee\u003c/span\u003e: \u003cspan class=\"hljs-title class_ inline\"\u003eMouseEvent\u003c/span\u003e\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 根据鼠标位置和初始偏移量计算新位置\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPos = {\n            \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragOffset.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e\n        };\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 存储待更新位置（用于防抖更新）\u003c/span\u003e\n        pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = newPos;\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 立即显示波纹效果，提供即时反馈\u003c/span\u003e\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 清除现有的防抖定时器\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 设置新的防抖定时器（500ms延迟）\u003c/span\u003e\n        debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(newPos);\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        }, \u003cspan class=\"hljs-number inline\"\u003e500\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 计算拖拽距离，判断是否为显著拖拽\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e dragDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esqrt\u003c/span\u003e(\n            \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) +\n            \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e)\n        );\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 超过3像素视为显著拖拽\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (dragDistance \u0026gt; \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) {\n            hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n        }\n    }, [isDragging, dragOffset, dragStartPosition]);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 鼠标释放事件处理\n     * 结束拖拽，执行吸附逻辑\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e handleMouseUp = \u003cspan class=\"hljs-title function_ inline\"\u003euseCallback\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isDragging) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsDragging\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 清除防抖定时器\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-built_in inline\"\u003eclearTimeout\u003c/span\u003e(debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n            debounceTimerRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 如果发生了显著拖拽，执行边缘吸附\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e snappedPos = \u003cspan class=\"hljs-title function_ inline\"\u003esnapToEdge\u003c/span\u003e(pendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e);\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(snappedPos);\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(snappedPos);  \u003cspan class=\"hljs-comment inline\"\u003e// 更新原始位置记录\u003c/span\u003e\n        }\n\n        \u003cspan class=\"hljs-comment inline\"\u003e// 延迟重置拖拽标记，避免与点击事件冲突\u003c/span\u003e\n        \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e;\n        }, \u003cspan class=\"hljs-number inline\"\u003e100\u003c/span\u003e);\n    }, [isDragging]);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 全局事件监听 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 管理全局鼠标事件监听器\n     * 只在拖拽状态下添加监听器，优化性能\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (isDragging) {\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n            \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n                \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n                \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n            };\n        } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n            \u003cspan class=\"hljs-comment inline\"\u003e// 确保在非拖拽状态下移除监听器\u003c/span\u003e\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mousemove\u0026#x27;\u003c/span\u003e, handleMouseMove);\n            \u003cspan class=\"hljs-variable language_ inline\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003eremoveEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;mouseup\u0026#x27;\u003c/span\u003e, handleMouseUp);\n        }\n    }, [isDragging]);\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 交互事件处理 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 导航球点击事件处理\n     * 切换展开/收起状态，处理位置移动\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleBallClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-comment inline\"\u003e// 只有在非显著拖拽时才处理点击\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e) {\n            \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isExpanded) {\n                \u003cspan class=\"hljs-comment inline\"\u003e// 展开：保存当前位置，移动到屏幕中央\u003c/span\u003e\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetOriginalPosition\u003c/span\u003e(position);\n                \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;   \u003cspan class=\"hljs-comment inline\"\u003e// 中心X - 球半径\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e - \u003cspan class=\"hljs-number inline\"\u003e35\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// 中心Y - 球半径\u003c/span\u003e\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e({\u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX, \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY});\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);\n            } \u003cspan class=\"hljs-keyword inline\"\u003eelse\u003c/span\u003e {\n                \u003cspan class=\"hljs-comment inline\"\u003e// 收起：延迟150ms后回到原始位置\u003c/span\u003e\n                \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n                \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n                    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n                }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n            }\n        }\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 菜单项点击事件处理\n     * 执行动作后收起菜单\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: () =\u0026gt; \u003cspan class=\"hljs-built_in inline\"\u003evoid\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003eaction\u003c/span\u003e();\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n        }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 页面导航处理\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003enavigateToPage\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e router.\u003cspan class=\"hljs-title function_ inline\"\u003epush\u003c/span\u003e(href));\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 主题切换处理\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleThemeToggle\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003etoggleTheme\u003c/span\u003e());\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 语言切换处理\n     * 支持文档页面的语言切换重定向\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleLocaleToggle\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003ehandleMenuItemClick\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003etoggleLocale\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e(\u003cspan class=\"hljs-params inline\"\u003enewLocale\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n                \u003cspan class=\"hljs-comment inline\"\u003e// 检查是否在文档页面，重定向到相同文章的新语言版本\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathname.\u003cspan class=\"hljs-title function_ inline\"\u003estartsWith\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/documents/\u0026#x27;\u003c/span\u003e)) {\n                    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e pathSegments = pathname.\u003cspan class=\"hljs-title function_ inline\"\u003esplit\u003c/span\u003e(\u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/\u0026#x27;\u003c/span\u003e).\u003cspan class=\"hljs-title function_ inline\"\u003efilter\u003c/span\u003e(\u003cspan class=\"hljs-title class_ inline\"\u003eBoolean\u003c/span\u003e);\n                    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (pathSegments.\u003cspan class=\"hljs-property inline\"\u003elength\u003c/span\u003e \u0026gt;= \u003cspan class=\"hljs-number inline\"\u003e4\u003c/span\u003e) {\n                        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e [, currentLang, category, fileName] = pathSegments;\n                        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e newPath = \u003cspan class=\"hljs-string inline\"\u003e`/documents/\u003cspan class=\"hljs-subst inline\"\u003e${newLocale}\u003c/span\u003e/\u003cspan class=\"hljs-subst inline\"\u003e${category}\u003c/span\u003e/\u003cspan class=\"hljs-subst inline\"\u003e${fileName}\u003c/span\u003e`\u003c/span\u003e;\n                        router.\u003cspan class=\"hljs-title function_ inline\"\u003epush\u003c/span\u003e(newPath);\n                    }\n                }\n            });\n        });\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 背景点击事件处理\n     * 点击背景收起菜单\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003ehandleBackdropClick\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-title function_ inline\"\u003esetIsExpanded\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n        \u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {\n            \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(originalPosition);\n        }, \u003cspan class=\"hljs-number inline\"\u003e150\u003c/span\u003e);\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 核心算法：圆形布局 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 圆形菜单布局算法\n     * 使用极坐标计算菜单项的位置\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e index 菜单项索引\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e total 菜单项总数\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@param\u003c/span\u003e radius 圆形半径\n     * \u003cspan class=\"hljs-doctag inline\"\u003e@returns\u003c/span\u003e 菜单项的屏幕坐标\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetCircularPosition\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003etotal\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003eradius\u003c/span\u003e: \u003cspan class=\"hljs-built_in inline\"\u003enumber\u003c/span\u003e = \u003cspan class=\"hljs-number inline\"\u003e120\u003c/span\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-comment inline\"\u003e// 计算角度：将圆周等分，起始角度为-π/2（12点钟方向）\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// 屏幕中心坐标\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerX = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerWidth\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e centerY = \u003cspan class=\"hljs-variable language_ inline\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003einnerHeight\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;\n        \n        \u003cspan class=\"hljs-comment inline\"\u003e// 极坐标到笛卡尔坐标转换\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e {\n            \u003cspan class=\"hljs-attr inline\"\u003ex\u003c/span\u003e: centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e60\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// -60为菜单项宽度调整\u003c/span\u003e\n            \u003cspan class=\"hljs-attr inline\"\u003ey\u003c/span\u003e: centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius - \u003cspan class=\"hljs-number inline\"\u003e30\u003c/span\u003e,  \u003cspan class=\"hljs-comment inline\"\u003e// -30为菜单项高度调整\u003c/span\u003e\n        };\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 样式工具函数 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 获取统一的按钮样式\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetUniformButtonStyles\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed z-50 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md border bg-surface/60 border-surface/40 hover:bg-surface/80\u0026quot;\u003c/span\u003e;\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 获取主题按钮样式\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003egetThemeButtonStyles\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed z-50 w-16 h-12 rounded-xl shadow-lg hover:scale-110 transition-all duration-300 group opacity-0 menu-item backdrop-blur-md bg-transparent hover:bg-surface/20\u0026quot;\u003c/span\u003e;\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== UI组件 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 活跃状态指示器组件\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eActiveIndicator\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e{isActive}: { isActive: \u003cspan class=\"hljs-built_in inline\"\u003eboolean\u003c/span\u003e }\u003c/span\u003e) =\u0026gt; {\n        \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!isActive) \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal inline\"\u003enull\u003c/span\u003e;\n\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute -top-1 -right-1 w-3 h-3 rounded-full shadow-lg\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-full h-full rounded-full bg-primary\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        );\n    };\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 主题图标组件\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eSunIcon\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-5 h-5 text-accent transition-all duration-300\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003efill\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;currentColor\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eviewBox\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;0 0 20 20\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003epath\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003efillRule\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;evenodd\u0026quot;\u003c/span\u003e\n                      \u003cspan class=\"hljs-attr inline\"\u003ed\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z\u0026quot;\u003c/span\u003e\n                      \u003cspan class=\"hljs-attr inline\"\u003eclipRule\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;evenodd\u0026quot;\u003c/span\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eMoonIcon\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-5 h-5 text-accent transition-all duration-300\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003efill\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;currentColor\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eviewBox\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;0 0 20 20\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003epath\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ed\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z\u0026quot;\u003c/span\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// 语言切换图标组件\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003eLocaleIcon\u003c/span\u003e = (\u003cspan class=\"hljs-params inline\"\u003e\u003c/span\u003e) =\u0026gt; (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-5 h-5 text-accent transition-all duration-300 flex items-center justify-center\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;text-sm font-bold\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                {LOCALES[locale].flag}\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    );\n\n    \u003cspan class=\"hljs-comment inline\"\u003e// ==================== 渲染逻辑 ====================\u003c/span\u003e\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 加载状态渲染\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (!mounted) {\n        \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed top-20 right-5 z-50\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;w-16 h-16 rounded-full backdrop-blur-md border animate-pulse bg-surface/60 border-surface/40\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        );\n    }\n\n    \u003cspan class=\"hljs-comment inline\"\u003e/**\n     * 构建完整的菜单项数组\n     */\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e allMenuItems = [\n        ...sections.\u003cspan class=\"hljs-title function_ inline\"\u003emap\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e\u003cspan class=\"hljs-params inline\"\u003esection\u003c/span\u003e =\u0026gt;\u003c/span\u003e ({\n            \u003cspan class=\"hljs-attr inline\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;section\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            section,\n            \u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: \u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-title function_ inline\"\u003enavigateToPage\u003c/span\u003e(section.\u003cspan class=\"hljs-property inline\"\u003eid\u003c/span\u003e === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;personal\u0026#x27;\u003c/span\u003e ? \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;/\u0026#x27;\u003c/span\u003e : section.\u003cspan class=\"hljs-property inline\"\u003ehref\u003c/span\u003e),\n            \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e: activeSection === section.\u003cspan class=\"hljs-property inline\"\u003eid\u003c/span\u003e\n        })),\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;theme\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: handleThemeToggle,\n            \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e: \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e\n        },\n        {\n            \u003cspan class=\"hljs-attr inline\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;locale\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003eas\u003c/span\u003e \u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e,\n            \u003cspan class=\"hljs-attr inline\"\u003eaction\u003c/span\u003e: handleLocaleToggle,\n            \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e: \u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e\n        }\n    ];\n\n    \u003cspan class=\"hljs-keyword inline\"\u003ereturn\u003c/span\u003e (\n        \u003cspan class=\"language-xml inline\"\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\n            {/* ==================== 主导航球 ==================== */}\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003eref\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{ballRef}\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`\n          \u003cspan class=\"hljs-attr inline\"\u003efixed\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ez-50\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransition-all\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-500\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ecursor-pointer\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eselect-none\u003c/span\u003e\n          ${\u003cspan class=\"hljs-attr inline\"\u003eisDragging\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ecursor-grabbing\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003escale-110\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-0\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ecursor-grab\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ehover:scale-105\u003c/span\u003e\u0026#x27;}\n          ${\u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ehover:scale-120\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u0026#x27;}\n        `}\n                \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                    \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eposition.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                    \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eposition.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                    \u003cspan class=\"hljs-attr inline\"\u003etransform:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eisDragging\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e5deg\u003c/span\u003e)\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e0deg\u003c/span\u003e) \u003cspan class=\"hljs-attr inline\"\u003escale\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e1.1\u003c/span\u003e)\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e0deg\u003c/span\u003e)\u0026#x27;}`\n                }}\n                \u003cspan class=\"hljs-attr inline\"\u003eonMouseDown\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{handleMouseDown}\u003c/span\u003e\n                \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{handleBallClick}\u003c/span\u003e\n            \u0026gt;\u003c/span\u003e\n                {/* 现代化导航球 */}\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`\n          \u003cspan class=\"hljs-attr inline\"\u003erelative\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ew-16\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eh-16\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003erounded-full\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransition-all\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-500\u003c/span\u003e\n          ${\u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003eanimate-pulse\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eshadow-lg\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u0026#x27;}\n        `}\u0026gt;\u003c/span\u003e\n                    {/* 球体阴影 */}\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute inset-0 rounded-full bg-black/20 blur-lg translate-y-2\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    \n                    {/* 波纹效果 - 拖拽时显示 */}\n                    {showRipple \u0026amp;\u0026amp; (\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                            \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute rounded-full border-2 animate-ping pointer-events-none\u0026quot;\u003c/span\u003e\n                            \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                \u003cspan class=\"hljs-attr inline\"\u003eborderColor:\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etheme\u003c/span\u003e === \u003cspan class=\"hljs-string inline\"\u003e\u0026#x27;dark\u0026#x27;\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ergba\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e78\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e205\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e196\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e0.6\u003c/span\u003e)\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ergba\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e102\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e204\u003c/span\u003e, \u003cspan class=\"hljs-attr inline\"\u003e0.6\u003c/span\u003e)\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003ewidth:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e80px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003eheight:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e80px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e-8px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e-8px\u003c/span\u003e\u0026#x27;,\n                                \u003cspan class=\"hljs-attr inline\"\u003eanimationDuration:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003e1s\u003c/span\u003e\u0026#x27;\n                            }}\n                        \u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    )}\n\n                    {/* 主球体 */}\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;relative w-full h-full rounded-full shadow-xl transform-gpu backdrop-blur-md border transition-all duration-300 bg-surface/60 border-surface/40 hover:bg-surface/80\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                        {/* 高光效果 */}\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute top-2 left-2 w-4 h-4 rounded-full bg-white/30 blur-sm\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                        \n                        {/* 菜单符号 */}\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute inset-0 flex items-center justify-center\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`\n                \u003cspan class=\"hljs-attr inline\"\u003ew-6\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eh-6\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003erounded-full\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eborder\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003etransition-all\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eduration-300\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eflex\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eitems-center\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ejustify-center\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eborder-foreground\u003c/span\u003e/\u003cspan class=\"hljs-attr inline\"\u003e40\u003c/span\u003e\n                ${\u003cspan class=\"hljs-attr inline\"\u003eisExpanded\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate-90\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003escale-110\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003erotate-0\u003c/span\u003e\u0026#x27;}\n              `}\u0026gt;\u003c/span\u003e\n                                {\n                                    isExpanded ? (\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                                            \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;relative transition-all duration-300 w-2 h-2 opacity-50 text-center flex items-center justify-center text-foreground\u0026quot;\u003c/span\u003e\n                                            \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{transform:\u003c/span\u003e \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003etranslateY\u003c/span\u003e(\u003cspan class=\"hljs-attr inline\"\u003e-1px\u003c/span\u003e)\u0026#x27;}}\n                                        \u0026gt;\u003c/span\u003e×\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                    ) : (\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                                            \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;transition-all duration-300 w-1 h-1 opacity-50 rounded-full bg-foreground\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                    )\n                                }\n\n                            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n            {/* ==================== 圆形菜单 ==================== */}\n            {isExpanded \u0026amp;\u0026amp; (\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\n                    {/* 背景遮罩 */}\n                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;fixed inset-0 z-40 backdrop-blur-md transition-all duration-300 bg-background/20\u0026quot;\u003c/span\u003e\n                        \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{handleBackdropClick}\u003c/span\u003e\n                    \u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n                    {/* 圆形布局的菜单项 */}\n                    {allMenuItems.map((item, index) =\u0026gt; {\n                        const circularPos = getCircularPosition(index, allMenuItems.length);\n\n                        if (item.type === \u0026#x27;section\u0026#x27;) {\n                            const section = item.section!;\n\n                            return (\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{section.id}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.action}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{\u003c/span\u003e`${\u003cspan class=\"hljs-attr inline\"\u003egetUniformButtonStyles\u003c/span\u003e()} \u003cspan class=\"hljs-attr inline\"\u003ew-28\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eh-14\u003c/span\u003e ${\u003cspan class=\"hljs-attr inline\"\u003eitem.isActive\u003c/span\u003e ? \u0026#x27;\u003cspan class=\"hljs-attr inline\"\u003ering-2\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003ering-blue-400\u003c/span\u003e/\u003cspan class=\"hljs-attr inline\"\u003e60\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003escale-105\u003c/span\u003e\u0026#x27; \u003cspan class=\"hljs-attr inline\"\u003e:\u003c/span\u003e \u0026#x27;\u0026#x27;}`}\n                                    \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e * \u003cspan class=\"hljs-attr inline\"\u003e120\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003ems\u003c/span\u003e`\n                                    }}\n                                \u0026gt;\u003c/span\u003e\n                                    {/* 栏目内容 */}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;absolute inset-0 flex flex-col items-center justify-center text-foreground\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;text-sm font-bold leading-tight text-center\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                            {section.label}\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;text-xs opacity-70 mt-0.5 font-medium\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                            {section.description}\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003espan\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eActiveIndicator\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eisActive\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.isActive}/\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            );\n                        } else if (item.type === \u0026#x27;theme\u0026#x27;) {\n                            return (\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;theme\u0026quot;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.action}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{getThemeButtonStyles()}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e * \u003cspan class=\"hljs-attr inline\"\u003e120\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003ems\u003c/span\u003e`\n                                    }}\n                                \u0026gt;\u003c/span\u003e\n                                    {/* 主题切换图标 */}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;flex items-center justify-center h-full\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        {theme === \u0026#x27;dark\u0026#x27; ? \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eSunIcon\u003c/span\u003e/\u0026gt;\u003c/span\u003e : \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eMoonIcon\u003c/span\u003e/\u0026gt;\u003c/span\u003e}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            );\n                        } else { // locale toggle\n                            return (\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;locale\u0026quot;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{item.action}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{getThemeButtonStyles()}\u003c/span\u003e\n                                    \u003cspan class=\"hljs-attr inline\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e{{\u003c/span\u003e\n                                        \u003cspan class=\"hljs-attr inline\"\u003eleft:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.x\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003etop:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003ecircularPos.y\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003epx\u003c/span\u003e`,\n                                        \u003cspan class=\"hljs-attr inline\"\u003eanimationDelay:\u003c/span\u003e `${\u003cspan class=\"hljs-attr inline\"\u003eindex\u003c/span\u003e * \u003cspan class=\"hljs-attr inline\"\u003e120\u003c/span\u003e}\u003cspan class=\"hljs-attr inline\"\u003ems\u003c/span\u003e`\n                                    }}\n                                \u0026gt;\u003c/span\u003e\n                                    {/* 语言切换图标 */}\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr inline\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string inline\"\u003e\u0026quot;flex items-center justify-center h-full\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                        \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;\u003cspan class=\"hljs-name inline\"\u003eLocaleIcon\u003c/span\u003e/\u0026gt;\u003c/span\u003e\n                                    \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u003cspan class=\"hljs-name inline\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                            );\n                        }\n                    })}\n                \u003cspan class=\"hljs-tag inline\"\u003e\u0026lt;/\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            )}\n\n            {\u003cspan class=\"hljs-comment inline\"\u003e/* ==================== CSS动画定义 ==================== */\u003c/span\u003e}\n            \u0026lt;style jsx\u0026gt;{\u003cspan class=\"hljs-string inline\"\u003e`\n                @keyframes menuItemAppear {\n                    0% {\n                        opacity: 0;\n                        transform: scale(0) translate(-50%, -50%);\n                    }\n                    50% {\n                        opacity: 0.7;\n                        transform: scale(0.8) translate(-25%, -25%);\n                    }\n                    100% {\n                        opacity: 1;\n                        transform: scale(1) translate(0%, 0%);\n                    }\n                }\n\n                @keyframes menuItemDisappear {\n                    0% {\n                        opacity: 1;\n                        transform: scale(1) translate(0%, 0%);\n                    }\n                    50% {\n                        opacity: 0.3;\n                        transform: scale(0.6) translate(-25%, -25%);\n                    }\n                    100% {\n                        opacity: 0;\n                        transform: scale(0) translate(-50%, -50%);\n                    }\n                }\n\n                .menu-item {\n                    animation: menuItemAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n                }\n            `\u003c/span\u003e}\u0026lt;/style\u0026gt;\n        \u0026lt;/\u0026gt;\n    );\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"核心算法流程图\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#核心算法流程图\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 核心算法流程图\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            核心算法流程图\n        \u003c/h3\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"\" data-code=\"%E7%94%A8%E6%88%B7%E4%BA%A4%E4%BA%92%20%E2%86%92%20%E4%BA%8B%E4%BB%B6%E5%88%A4%E6%96%AD%20%E2%86%92%20%E7%8A%B6%E6%80%81%E6%9B%B4%E6%96%B0%20%E2%86%92%20%E4%BD%8D%E7%BD%AE%E8%AE%A1%E7%AE%97%20%E2%86%92%20%E8%A7%86%E8%A7%89%E5%8F%8D%E9%A6%88%0A%E2%86%93%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E9%BC%A0%E6%A0%87%E6%8C%89%E4%B8%8B%20%20%20%E6%8B%96%E6%8B%BD%2F%E7%82%B9%E5%87%BB%20isDragging%20%20dragOffset%20%E6%B3%A2%E7%BA%B9%E6%95%88%E6%9E%9C%0A%E2%86%93%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E9%BC%A0%E6%A0%87%E7%A7%BB%E5%8A%A8%20%20%20%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%20%20%20position%E6%9B%B4%E6%96%B0%20%E9%98%B2%E6%8A%96%E6%9B%B4%E6%96%B0%20%20%E5%AE%9E%E6%97%B6%E5%8F%8D%E9%A6%88%0A%E2%86%93%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%20%20%20%20%20%20%20%20%20%E2%86%93%0A%E9%BC%A0%E6%A0%87%E9%87%8A%E6%94%BE%20%20%20%E5%90%B8%E9%99%84%E7%AE%97%E6%B3%95%20%20%20%E8%BE%B9%E7%95%8C%E7%BA%A6%E6%9D%9F%20%20%20%20%E8%8F%9C%E5%8D%95%E5%B1%95%E5%BC%80%20%20%20%E5%8A%A8%E7%94%BB%E8%BF%87%E6%B8%A1\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003ecode\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode\u003e用户交互 → 事件判断 → 状态更新 → 位置计算 → 视觉反馈\n    ↓        ↓         ↓         ↓         ↓\n鼠标按下   拖拽/点击 isDragging  dragOffset 波纹效果\n    ↓        ↓         ↓         ↓         ↓\n鼠标移动   距离计算   position更新 防抖更新  实时反馈\n    ↓        ↓         ↓         ↓         ↓\n鼠标释放   吸附算法   边界约束    菜单展开   动画过渡\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003ch3 id=\"关键算法解析\" class=\"group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug\"\u003e\n            \u003ca href=\"#关键算法解析\" class=\"absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary\" aria-label=\"Link to 关键算法解析\"\u003e\n                \u003csvg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                    \u003cpath fill-rule=\"evenodd\" d=\"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z\" clip-rule=\"evenodd\" /\u003e\n                \u003c/svg\u003e\n            \u003c/a\u003e\n            关键算法解析\n        \u003c/h3\u003e\n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e1. 边缘吸附核心算法\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E8%AE%A1%E7%AE%97%E5%88%B0%E5%9B%9B%E8%BE%B9%E7%9A%84%E8%B7%9D%E7%A6%BB%EF%BC%8C%E7%A7%BB%E5%8A%A8%E5%88%B0%E6%9C%80%E8%BF%91%E8%BE%B9%E7%95%8C%0Aconst%20distanceToLeft%20%3D%20currentPos.x%3B%0Aconst%20distanceToRight%20%3D%20windowWidth%20-%20currentPos.x%3B%0Aconst%20distanceToTop%20%3D%20currentPos.y%3B%0Aconst%20distanceToBottom%20%3D%20windowHeight%20-%20currentPos.y%3B%0Aconst%20minDistance%20%3D%20Math.min(distanceToLeft%2C%20distanceToRight%2C%20distanceToTop%2C%20distanceToBottom)%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AE%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E7%A1%AE%E5%AE%9A%E5%90%B8%E9%99%84%E6%96%B9%E5%90%91%0Aif%20(minDistance%20%3D%3D%3D%20distanceToLeft)%20%7B%0AnewPos.x%20%3D%20margin%3B%20%20%2F%2F%20%E5%90%B8%E9%99%84%E5%88%B0%E5%B7%A6%E8%BE%B9%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 关键：计算到四边的距离，移动到最近边界\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToLeft = currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToRight = windowWidth - currentPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToTop = currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e distanceToBottom = windowHeight - currentPos.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e minDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003emin\u003c/span\u003e(distanceToLeft, distanceToRight, distanceToTop, distanceToBottom);\n\n\u003cspan class=\"hljs-comment inline\"\u003e// 根据最小距离确定吸附方向\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (minDistance === distanceToLeft) {\n    newPos.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e = margin;  \u003cspan class=\"hljs-comment inline\"\u003e// 吸附到左边\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e2. 圆形布局数学计算\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E6%9E%81%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%20%2B%20%E8%A7%92%E5%BA%A6%E5%9D%87%E5%88%86%0Aconst%20angle%20%3D%20(2%20*%20Math.PI%20*%20index)%20%2F%20total%20-%20Math.PI%20%2F%202%3B%20%20%2F%2F%20%E8%A7%92%E5%BA%A6%E8%AE%A1%E7%AE%97%0Aconst%20x%20%3D%20centerX%20%2B%20Math.cos(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20X%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%0Aconst%20y%20%3D%20centerY%20%2B%20Math.sin(angle)%20*%20radius%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Y%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 关键：极坐标转换 + 角度均分\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e angle = (\u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e * index) / total - \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-property inline\"\u003ePI\u003c/span\u003e / \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e;  \u003cspan class=\"hljs-comment inline\"\u003e// 角度计算\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e x = centerX + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003ecos\u003c/span\u003e(angle) * radius;               \u003cspan class=\"hljs-comment inline\"\u003e// X坐标转换\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e y = centerY + \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esin\u003c/span\u003e(angle) * radius;               \u003cspan class=\"hljs-comment inline\"\u003e// Y坐标转换\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e3. 防抖拖拽优化\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E5%8D%B3%E6%97%B6%E5%8F%8D%E9%A6%88%20%2B%20%E5%BB%B6%E8%BF%9F%E6%9B%B4%E6%96%B0%0ApendingPositionRef.current%20%3D%20newPos%3B%20%20%20%20%20%2F%2F%20%E5%AD%98%E5%82%A8%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%8D%E7%BD%AE%0AsetShowRipple(true)%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%AB%8B%E5%8D%B3%E6%98%BE%E7%A4%BA%E5%8F%8D%E9%A6%88%0AsetTimeout(()%20%3D%3E%20%7B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E9%98%B2%E6%8A%96%E6%9B%B4%E6%96%B0%0AsetPosition(newPos)%3B%0AsetShowRipple(false)%3B%0A%7D%2C%20500)%3B\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 关键：即时反馈 + 延迟更新\u003c/span\u003e\npendingPositionRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = newPos;     \u003cspan class=\"hljs-comment inline\"\u003e// 存储待更新位置\u003c/span\u003e\n\u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e);                     \u003cspan class=\"hljs-comment inline\"\u003e// 立即显示反馈\u003c/span\u003e\n\u003cspan class=\"hljs-built_in inline\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function inline\"\u003e() =\u0026gt;\u003c/span\u003e {                       \u003cspan class=\"hljs-comment inline\"\u003e// 防抖更新\u003c/span\u003e\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetPosition\u003c/span\u003e(newPos);\n    \u003cspan class=\"hljs-title function_ inline\"\u003esetShowRipple\u003c/span\u003e(\u003cspan class=\"hljs-literal inline\"\u003efalse\u003c/span\u003e);\n}, \u003cspan class=\"hljs-number inline\"\u003e500\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cstrong class=\"font-bold text-foreground\"\u003e4. 拖拽距离判定\u003c/strong\u003e\u003c/p\u003e\n\n            \u003cdiv class=\"enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm\" data-enhanced-codeblock=\"true\" data-language=\"typescript\" data-code=\"%2F%2F%20%E5%85%B3%E9%94%AE%EF%BC%9A%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97%0Aconst%20dragDistance%20%3D%20Math.sqrt(%0AMath.pow(e.clientX%20-%20dragStartPosition.x%2C%202)%20%2B%0AMath.pow(e.clientY%20-%20dragStartPosition.y%2C%202)%0A)%3B%0Aif%20(dragDistance%20%3E%203)%20%7B%20%20%2F%2F%203%E5%83%8F%E7%B4%A0%E9%98%88%E5%80%BC%E8%BF%87%E6%BB%A4%E6%89%8B%E6%8A%96%0AhasDraggedSignificantlyRef.current%20%3D%20true%3B%0A%7D\"\u003e\n                \u003cdiv class=\"codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700\"\u003e\n                    \u003cspan class=\"codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline\"\u003etypescript\u003c/span\u003e\n                    \u003cbutton class=\"codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95\" title=\"复制代码\"\u003e\n                        \u003csvg class=\"copy-icon w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath d=\"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z\" /\u003e\n                            \u003cpath d=\"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z\" /\u003e\n                        \u003c/svg\u003e\n                        \u003csvg class=\"copied-icon w-4 h-4 hidden\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\u003e\n                            \u003cpath fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" /\u003e\n                        \u003c/svg\u003e\n                        \u003cspan class=\"copy-text inline\"\u003e复制\u003c/span\u003e\n                    \u003c/button\u003e\n                \u003c/div\u003e\n                \u003cpre class=\"codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"hljs-comment inline\"\u003e// 关键：欧几里得距离计算\u003c/span\u003e\n\u003cspan class=\"hljs-keyword inline\"\u003econst\u003c/span\u003e dragDistance = \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003esqrt\u003c/span\u003e(\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientX\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ex\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e) +\n    \u003cspan class=\"hljs-title class_ inline\"\u003eMath\u003c/span\u003e.\u003cspan class=\"hljs-title function_ inline\"\u003epow\u003c/span\u003e(e.\u003cspan class=\"hljs-property inline\"\u003eclientY\u003c/span\u003e - dragStartPosition.\u003cspan class=\"hljs-property inline\"\u003ey\u003c/span\u003e, \u003cspan class=\"hljs-number inline\"\u003e2\u003c/span\u003e)\n);\n\u003cspan class=\"hljs-keyword inline\"\u003eif\u003c/span\u003e (dragDistance \u0026gt; \u003cspan class=\"hljs-number inline\"\u003e3\u003c/span\u003e) {  \u003cspan class=\"hljs-comment inline\"\u003e// 3像素阈值过滤手抖\u003c/span\u003e\n    hasDraggedSignificantlyRef.\u003cspan class=\"hljs-property inline\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-literal inline\"\u003etrue\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n            \u003c/div\u003e\n        \n\u003cp class=\"text-base leading-7 mb-4 text-foreground\"\u003e\u003cem class=\"italic text-foreground\"\u003e愿你的导航如北极星般稳定，如流星般灵动。\u003c/em\u003e ✨\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"$L1d\",null,{\"htmlContent\":\"$1e\",\"frontMatter\":{\"title\":\"浮动导航球：从数学原理到交互实现\",\"description\":\"详细解析可拖拽、可吸附、可展开的圆形菜单系统\",\"date\":\"2025-06-22\",\"author\":\"MilkWind\",\"tags\":[\"导航设计\",\"交互设计\"],\"references\":{}},\"readingTime\":\"40 min read\",\"category\":\"personal-website\",\"tocItems\":[{\"id\":\"浮动导航球：从数学原理到交互实现\",\"text\":\"浮动导航球：从数学原理到交互实现\",\"level\":1},{\"id\":\"状态管理\",\"text\":\"状态管理\",\"level\":2},{\"id\":\"状态定义\",\"text\":\"状态定义\",\"level\":3},{\"id\":\"核心状态详解\",\"text\":\"核心状态详解\",\"level\":3},{\"id\":\"状态机设计\",\"text\":\"状态机设计\",\"level\":3},{\"id\":\"坐标系统与位置记录\",\"text\":\"坐标系统与位置记录\",\"level\":2},{\"id\":\"坐标系统选择\",\"text\":\"坐标系统选择\",\"level\":3},{\"id\":\"位置初始化策略\",\"text\":\"位置初始化策略\",\"level\":3},{\"id\":\"dragoffset的数学原理\",\"text\":\"dragOffset的数学原理\",\"level\":3},{\"id\":\"拖拽系统实现\",\"text\":\"拖拽系统实现\",\"level\":2},{\"id\":\"拖拽生命周期\",\"text\":\"拖拽生命周期\",\"level\":3},{\"id\":\"防抖动画实现\",\"text\":\"防抖动画实现\",\"level\":3},{\"id\":\"拖拽距离判定\",\"text\":\"拖拽距离判定\",\"level\":3},{\"id\":\"拖拽结束的智能处理\",\"text\":\"拖拽结束的智能处理\",\"level\":3},{\"id\":\"边缘吸附算法\",\"text\":\"边缘吸附算法\",\"level\":2},{\"id\":\"吸附算法核心逻辑\",\"text\":\"吸附算法核心逻辑\",\"level\":3},{\"id\":\"边界计算的数学原理\",\"text\":\"边界计算的数学原理\",\"level\":3},{\"id\":\"边界约束实现\",\"text\":\"边界约束实现\",\"level\":3},{\"id\":\"展开收起的动画系统\",\"text\":\"展开收起的动画系统\",\"level\":2},{\"id\":\"中心定位算法\",\"text\":\"中心定位算法\",\"level\":3},{\"id\":\"状态切换的时序控制\",\"text\":\"状态切换的时序控制\",\"level\":3},{\"id\":\"originalposition的保存机制\",\"text\":\"originalPosition的保存机制\",\"level\":3},{\"id\":\"圆形菜单布局算法\",\"text\":\"圆形菜单布局算法\",\"level\":2},{\"id\":\"极坐标布局的数学基础\",\"text\":\"极坐标布局的数学基础\",\"level\":3},{\"id\":\"角度分布策略\",\"text\":\"角度分布策略\",\"level\":3},{\"id\":\"关键帧动画系统\",\"text\":\"关键帧动画系统\",\"level\":2},{\"id\":\"css-in-js动画实现\",\"text\":\"CSS-in-JS动画实现\",\"level\":3},{\"id\":\"动画延迟的层次感\",\"text\":\"动画延迟的层次感\",\"level\":3},{\"id\":\"缓动函数选择\",\"text\":\"缓动函数选择\",\"level\":3},{\"id\":\"事件处理与性能优化\",\"text\":\"事件处理与性能优化\",\"level\":2},{\"id\":\"事件监听器的生命周期管理\",\"text\":\"事件监听器的生命周期管理\",\"level\":3},{\"id\":\"usecallback的性能优化\",\"text\":\"useCallback的性能优化\",\"level\":3},{\"id\":\"防止事件冒泡的策略\",\"text\":\"防止事件冒泡的策略\",\"level\":3},{\"id\":\"可复用设计模式总结\",\"text\":\"可复用设计模式总结\",\"level\":2},{\"id\":\"核心设计模式提取\",\"text\":\"核心设计模式提取\",\"level\":3},{\"id\":\"最佳实践提炼\",\"text\":\"最佳实践提炼\",\"level\":3},{\"id\":\"完整源码全解析\",\"text\":\"完整源码全解析\",\"level\":2},{\"id\":\"核心算法流程图\",\"text\":\"核心算法流程图\",\"level\":3},{\"id\":\"关键算法解析\",\"text\":\"关键算法解析\",\"level\":3}],\"translations\":{\"common\":{\"welcome\":\"欢迎\",\"loading\":\"加载中...\",\"error\":\"出现了一些问题\",\"retry\":\"重试\",\"theme\":\"主题\",\"language\":\"语言\",\"light\":\"浅色\",\"dark\":\"深色\"},\"navigation\":{\"home\":\"首页\",\"personal\":\"个人\",\"works\":\"作品\",\"contributions\":\"贡献\",\"documents\":\"文档\",\"about\":\"关于\",\"contact\":\"联系\"},\"personal\":{\"technicalSkills\":\"技术技能\",\"email\":\"邮箱\",\"github\":\"代码仓库\",\"resume\":\"简历\",\"codeRepository\":\"代码仓库\",\"loadingPersonalInfo\":\"加载个人信息中...\",\"loadingResume\":\"加载简历中...\",\"closeResume\":\"关闭简历\",\"emailCopied\":\"邮箱已复制到剪贴板！\",\"galaxyDefaultDescription\":\"精通全栈开发技术，具备跨平台架构能力，擅长AI技术整合与高性能系统优化\",\"skillGalaxy\":\"技能星系\",\"stirGalaxy\":\"搅动星系\",\"stirring\":\"搅动中...\",\"fullStackEngineer\":\"MilkWind - 全栈工程师\",\"professionalProfile\":\"关于我\"},\"documents\":{\"technicalDocuments\":\"技术文档\",\"description\":\"基本原理、代码拆分以及一些碎碎念。\",\"articles\":\"文章\",\"categories\":\"分类\",\"allCategories\":\"所有分类\",\"noArticlesFound\":\"未找到文章\",\"noArticlesAvailable\":\"中文暂无文章。\",\"noArticlesInCategory\":\"该分类下未找到文章。\",\"readMore\":\"阅读更多\",\"loadingDocuments\":\"加载文档中...\",\"backToDocuments\":\"← 返回文档\",\"documentNotFound\":\"文档未找到\",\"documentNotFoundDescription\":\"请求的文档无法找到。\",\"technicalInsights\":\"技术拆解\",\"untitledDocument\":\"无标题文档\",\"byAuthor\":\"作者：\",\"search\":\"搜索文章...\",\"searchByTags\":\"按标签筛选\",\"searching\":\"搜索中...\",\"noSearchResults\":\"没有找到符合搜索条件的文章\",\"clearSearch\":\"清除搜索\",\"selectedTags\":\"已选标签\",\"allTags\":\"所有标签\",\"searchInTitle\":\"在标题、描述和内容中搜索\",\"enterImmersiveMode\":\"沉浸阅读\",\"exitImmersiveMode\":\"退出沉浸模式\",\"immersiveReading\":\"沉浸阅读模式\",\"exploreContent\":\"按分类探索内容\",\"browseBy\":\"浏览方式\",\"exploreAll\":\"所有内容汇总\",\"categoryDescription\":\"该分类下的文章\",\"totalArticles\":\"文章\",\"totalCategories\":\"分类\",\"foundArticles\":\"找到文章\",\"categoriesWithResults\":\"有结果的分类\"},\"works\":{\"workCases\":\"作品案例\",\"projects\":\"作品集\",\"loadingProjects\":\"加载项目中...\",\"grid\":\"网格\",\"stack\":\"堆叠\",\"of\":\"共\",\"workCasesPageTitle\":\"作品案例页面\",\"pageWorkingCorrectly\":\"此页面运行正常！路由配置正确。\",\"try3DVersion\":\"尝试3D版本\",\"dragToScroll\":\"拖拽滚动\",\"dragToChange\":\"拖拽切换\",\"swipeCards\":\"切换卡片\",\"keyboardNav\":\"键盘导航\"},\"contributions\":{\"contributionCases\":\"开源项目\",\"contributions\":\"贡献\",\"loadingContributions\":\"加载贡献中...\",\"grid\":\"网格\",\"stack\":\"堆叠\",\"of\":\"共\",\"contributionCasesPageTitle\":\"贡献案例页面\",\"pageWorkingCorrectly\":\"此页面运行正常！路由配置正确。\",\"try3DVersion\":\"尝试3D版本\",\"dragToScroll\":\"拖拽滚动\",\"dragToChange\":\"拖拽切换\",\"swipeCards\":\"切换卡片\",\"keyboardNav\":\"键盘导航\"},\"contribution\":{\"contributionPreview\":\"贡献预览\",\"accessible\":\"可访问\",\"code\":\"代码\",\"maintenance\":\"维护\",\"enhancement\":\"增强\",\"documentation\":\"文档\",\"community\":\"社区\",\"moreItems\":\"更多\",\"technicalDetails\":\"技术详情\",\"technologies\":\"技术栈：\",\"contributionDetail\":\"贡献详情\",\"description\":\"描述：\",\"seeDetails\":\"查看详情\",\"github\":\"代码仓库\",\"viewContribution\":\"查看贡献\",\"viewCode\":\"查看代码\"},\"project\":{\"projectPreview\":\"项目预览\",\"accessible\":\"可访问\",\"tool\":\"工具\",\"plugin\":\"插件\",\"toy\":\"小玩意\",\"moreItems\":\"更多\",\"technicalDetails\":\"技术详情\",\"technologies\":\"技术栈：\",\"description\":\"描述：\",\"seeDetails\":\"查看详情\",\"github\":\"GitHub\",\"gitee\":\"Gitee\",\"viewLiveDemo\":\"查看演示\",\"viewCode\":\"查看代码\",\"access\":\"访问\",\"videos\":\"视频\",\"watchVideo\":\"观看视频\",\"hasVideo\":\"有视频\"},\"codeblock\":{\"copy\":\"复制\",\"copySuccess\":\"代码已复制到剪贴板！\",\"copyError\":\"复制代码失败\",\"copyTooltip\":\"复制代码\"},\"toc\":{\"contents\":\"目录\",\"autoScroll\":\"自动滚动到章节\",\"collapse\":\"折叠\",\"expand\":\"展开\"},\"loading\":{\"loading\":\"加载中\",\"preparingExperience\":\"准备体验中\"}},\"lang\":\"zh\",\"theme\":\"dark\"}]\n"])</script><script>self.__next_f.push([1,"12:null\n"])</script><script>self.__next_f.push([1,"18:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n11:null\n"])</script><script>self.__next_f.push([1,"1c:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"浮动导航球：从数学原理到交互实现 | Interactive Portfolio\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"详细解析可拖拽、可吸附、可展开的圆形菜单系统\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"Developer\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"portfolio,3D,interactive,web development,Three.js,Next.js\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"浮动导航球：从数学原理到交互实现 | Interactive Portfolio\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"详细解析可拖拽、可吸附、可展开的圆形菜单系统\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"7\",{\"property\":\"article:published_time\",\"content\":\"2025-06-22\"}],[\"$\",\"meta\",\"8\",{\"property\":\"article:tag\",\"content\":\"导航设计\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:tag\",\"content\":\"交互设计\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"浮动导航球：从数学原理到交互实现 | Interactive Portfolio\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"详细解析可拖拽、可吸附、可展开的圆形菜单系统\"}],[\"$\",\"link\",\"13\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"32x32\"}]],\"error\":null,\"digest\":\"$undefined\"}\n14:{\"metadata\":\"$1c:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>