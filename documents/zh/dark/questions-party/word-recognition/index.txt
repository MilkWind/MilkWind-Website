1:"$Sreact.fragment"
2:I[38735,["1899","static/chunks/1899-6f0bb42883f79753.js","7177","static/chunks/app/layout-5c95b441a38f3a56.js"],"default"]
3:I[19945,["1899","static/chunks/1899-6f0bb42883f79753.js","7177","static/chunks/app/layout-5c95b441a38f3a56.js"],"default"]
4:I[65337,["1899","static/chunks/1899-6f0bb42883f79753.js","7177","static/chunks/app/layout-5c95b441a38f3a56.js"],"default"]
5:I[96190,["1899","static/chunks/1899-6f0bb42883f79753.js","7177","static/chunks/app/layout-5c95b441a38f3a56.js"],"ClientProviders"]
6:I[87555,[],""]
7:I[51901,["8039","static/chunks/app/error-10ebab2e11865aaf.js"],"default"]
8:I[31295,[],""]
9:I[6874,["6874","static/chunks/6874-fbe9a08eb79b991c.js","4345","static/chunks/app/not-found-38b9d1a0bc95ac08.js"],""]
a:I[94970,[],"ClientSegmentRoot"]
b:I[44065,["206","static/chunks/206-4f4cbf4d7156f437.js","3092","static/chunks/app/documents/layout-5f4e66d848ce7829.js"],"default"]
e:I[59665,[],"MetadataBoundary"]
10:I[59665,[],"OutletBoundary"]
13:I[74911,[],"AsyncMetadataOutlet"]
15:I[39460,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","5650","static/chunks/app/documents/loading-552c4cd17346a076.js"],"default"]
16:I[88610,["2415","static/chunks/2415-689c103fb3d2c28d.js","8610","static/chunks/8610-7bd3f91f3cf2a4d6.js","4209","static/chunks/app/loading-0c530d99d5132c05.js"],"default"]
17:I[59665,[],"ViewportBoundary"]
19:I[26614,[],""]
:HL["/_next/static/css/de70bee13400563f.css","style"]
:HL["/_next/static/css/38943437573ce53c.css","style"]
:HL["/_next/static/css/5eacd01f773eed7f.css","style"]
0:{"P":null,"b":"xMcHYm_FvwjrVB7JmFp9i","p":"","c":["","documents","zh","dark","questions-party","word-recognition",""],"i":false,"f":[[["",{"children":["documents",{"children":[["slug","zh/dark/questions-party/word-recognition","c"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/de70bee13400563f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/38943437573ce53c.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_188709 __variable_9a8899 font-sans antialiased min-h-screen bg-background text-foreground","suppressHydrationWarning":true,"children":[["$","$L2",null,{}],["$","$L3",null,{}],["$","$L4",null,{}],["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$7","errorStyles":[],"errorScripts":[],"template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"z-10 relative min-h-screen flex items-center justify-center bg-background p-8","children":["$","div",null,{"className":"text-center max-w-md","children":[["$","div",null,{"className":"text-8xl font-bold text-primary mb-4","children":"404"}],["$","h2",null,{"className":"text-2xl font-bold text-foreground mb-4","children":"Page Not Found"}],["$","p",null,{"className":"text-foreground/70 mb-8","children":"The page you're looking for doesn't exist or has been moved to a different location."}],["$","div",null,{"className":"flex flex-col sm:flex-row gap-4 justify-center","children":[["$","$L9",null,{"href":"/","className":"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary/80 transition-colors","children":"Go Home"}],["$","$L9",null,{"href":"/works","className":"px-6 py-2 border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors","children":"View Works"}]]}],["$","div",null,{"className":"absolute inset-0 overflow-hidden pointer-events-none -z-10","children":[["$","div",null,{"className":"absolute top-1/4 left-1/4 w-2 h-2 bg-primary/20 rounded-full animate-float"}],["$","div",null,{"className":"absolute top-3/4 right-1/4 w-3 h-3 bg-accent/20 rounded-full animate-float","style":{"animationDelay":"1s"}}],["$","div",null,{"className":"absolute bottom-1/4 left-1/3 w-1 h-1 bg-secondary/20 rounded-full animate-float","style":{"animationDelay":"2s"}}]]}]]}]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}]}]]}],{"children":["documents",["$","$1","c",{"children":[null,["$","$La",null,{"Component":"$b","slots":{"children":["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@c"}]]}],{"children":[["slug","zh/dark/questions-party/word-recognition","c"],["$","$1","c",{"children":[null,["$","$L6",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$Ld",["$","$Le",null,{"children":"$Lf"}],[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5eacd01f773eed7f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L10",null,{"children":["$L11","$L12",["$","$L13",null,{"promise":"$@14"}]]}]]}],{},null,false]},null,false]},[["$","$L15","l",{}],[],[]],false]},[["$","$L16","l",{}],[],[]],false],["$","$1","h",{"children":[null,["$","$1","t7eY3XPPpxmjwhBk7yRst",{"children":[["$","$L17",null,{"children":"$L18"}],null]}],null]}],false]],"m":"$undefined","G":["$19","$undefined"],"s":false,"S":true}
1a:"$Sreact.suspense"
1b:I[74911,[],"AsyncMetadata"]
c:{}
f:["$","$1a",null,{"fallback":null,"children":["$","$L1b",null,{"promise":"$@1c"}]}]
1d:I[57340,["5584","static/chunks/b498d07c-095637f0f10883c6.js","2415","static/chunks/2415-689c103fb3d2c28d.js","6874","static/chunks/6874-fbe9a08eb79b991c.js","9554","static/chunks/9554-b714f9de28e85d30.js","1873","static/chunks/app/documents/%5B...slug%5D/page-9ee3d086bd3810e0.js"],"DocumentPageClient"]
1e:T5739f,<h1 id="词汇摘录：共筑单词之海" class="group relative text-4xl font-bold mt-8 mb-4 text-foreground leading-tight">
            <a href="#词汇摘录：共筑单词之海" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 词汇摘录：共筑单词之海">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            词汇摘录：共筑单词之海
        </h1>
<p class="text-base leading-7 mb-4 text-foreground">你有没有好奇过为什么只有在你输入的单词拼写正确的情况下才能添加成功呢？以及…添加成功后，回显的单词词义又是从哪儿来的呢？</p>
<p class="text-base leading-7 mb-4 text-foreground">本文将全面解析Questions Party项目中的词汇识别与存储系统，从用户在前端输入一个单词，到后端通过AI技术识别其词性和含义，再到数据库存储的完整链路。</p>
<h2 id="系统架构概览" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#系统架构概览" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 系统架构概览">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            系统架构概览
        </h2>
<h3 id="整体数据流向" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#整体数据流向" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 整体数据流向">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            整体数据流向
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5%20%E2%86%92%20%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81%20%E2%86%92%20%E5%90%8E%E7%AB%AF%E6%A0%A1%E9%AA%8C%20%E2%86%92%20%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%20%E2%86%92%20%E8%AF%8D%E6%80%A7%E5%88%86%E6%9E%90%20%E2%86%92%20%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%20%E2%86%92%20%E5%89%8D%E7%AB%AF%E5%B1%95%E7%A4%BA">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>用户输入 → 前端验证 → 后端校验 → 拼写检查 → 词性分析 → 数据存储 → 前端展示
</code></pre>
            </div>
        
<h3 id="mvc架构的现代化应用" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mvc架构的现代化应用" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to MVC架构的现代化应用">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            MVC架构的现代化应用
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">单词管理系统采用了经典的MVC架构模式：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Model（模型层）</strong>: MongoDB + Mongoose ODM</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">View（视图层）</strong>: Vue 3 + TypeScript + Pinia</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">Controller（控制器层）</strong>: Node.js + Express + 中间件</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%8E%A7%E5%88%B6%E5%99%A8%E5%B1%82%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%93%E6%9E%84%0Aconst%20wordController%20%3D%20%7B%0AgetUserWords%3A%20async%20(req%2C%20res)%20%3D%3E%20%7B%20%2F*%20%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E8%AF%8D%E6%B1%87%20*%2F%20%7D%2C%0AaddWord%3A%20async%20(req%2C%20res)%20%3D%3E%20%7B%20%2F*%20%E6%B7%BB%E5%8A%A0%E6%96%B0%E8%AF%8D%E6%B1%87%20*%2F%20%7D%2C%0AdeleteWord%3A%20async%20(req%2C%20res)%20%3D%3E%20%7B%20%2F*%20%E5%88%A0%E9%99%A4%E8%AF%8D%E6%B1%87%20*%2F%20%7D%2C%0AgetRandomWords%3A%20async%20(req%2C%20res)%20%3D%3E%20%7B%20%2F*%20%E6%99%BA%E8%83%BD%E6%8E%A8%E8%8D%90%20*%2F%20%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 控制器层的核心结构</span>
<span class="hljs-keyword inline">const</span> wordController = {
  <span class="hljs-attr inline">getUserWords</span>: <span class="hljs-title function_ inline">async</span> (req, res) =&gt; { <span class="hljs-comment inline">/* 获取用户词汇 */</span> },
  <span class="hljs-attr inline">addWord</span>: <span class="hljs-title function_ inline">async</span> (req, res) =&gt; { <span class="hljs-comment inline">/* 添加新词汇 */</span> },
  <span class="hljs-attr inline">deleteWord</span>: <span class="hljs-title function_ inline">async</span> (req, res) =&gt; { <span class="hljs-comment inline">/* 删除词汇 */</span> },
  <span class="hljs-attr inline">getRandomWords</span>: <span class="hljs-title function_ inline">async</span> (req, res) =&gt; { <span class="hljs-comment inline">/* 智能推荐 */</span> }
};
</code></pre>
            </div>
        
<h2 id="前端交互界面设计" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#前端交互界面设计" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 前端交互界面设计">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            前端交互界面设计
        </h2>
<h3 id="composition-api的状态管理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#composition-api的状态管理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Composition API的状态管理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Composition API的状态管理
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">前端使用Vue 3的Composition API：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Words.vue%20%E4%B8%AD%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%0Aconst%20showAddForm%20%3D%20ref(false)%0Aconst%20loadingRandom%20%3D%20ref(false)%0Aconst%20randomWords%20%3D%20ref(%5B%5D)%0A%2F%2F%20%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%0Aconst%20spellingError%20%3D%20ref(false)%0Aconst%20spellingSuggestions%20%3D%20ref(%5B%5D)%0A%2F%2F%20%E8%BF%87%E6%BB%A4%E5%92%8C%E6%90%9C%E7%B4%A2%0Aconst%20searchQuery%20%3D%20ref('')%0Aconst%20selectedFilter%20%3D%20ref('all')">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Words.vue 中的响应式状态管理</span>
<span class="hljs-keyword inline">const</span> showAddForm = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)
<span class="hljs-keyword inline">const</span> loadingRandom = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)
<span class="hljs-keyword inline">const</span> randomWords = ref&lt;any[]&gt;([])

<span class="hljs-comment inline">// 拼写错误处理</span>
<span class="hljs-keyword inline">const</span> spellingError = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)
<span class="hljs-keyword inline">const</span> spellingSuggestions = ref&lt;string[]&gt;([])

<span class="hljs-comment inline">// 过滤和搜索</span>
<span class="hljs-keyword inline">const</span> searchQuery = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-string inline">&#x27;&#x27;</span>)
<span class="hljs-keyword inline">const</span> selectedFilter = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-string inline">&#x27;all&#x27;</span>)
</code></pre>
            </div>
        
<h3 id="防抖搜索" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#防抖搜索" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 防抖搜索">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            防抖搜索
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E9%98%B2%E6%8A%96%E6%90%9C%E7%B4%A2%E5%87%BD%E6%95%B0%0Aconst%20debouncedSearch%20%3D%20()%20%3D%3E%20%7B%0Aif%20(searchTimeout.value)%20%7B%0AclearTimeout(searchTimeout.value)%0A%7D%0AsearchTimeout.value%20%3D%20setTimeout(()%20%3D%3E%20%7B%0AwordsStore.setSearchQuery(searchQuery.value)%0A%7D%2C%20300)%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 防抖搜索函数</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">debouncedSearch</span> = (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (searchTimeout.<span class="hljs-property inline">value</span>) {
    <span class="hljs-built_in inline">clearTimeout</span>(searchTimeout.<span class="hljs-property inline">value</span>)
  }
  
  searchTimeout.<span class="hljs-property inline">value</span> = <span class="hljs-built_in inline">setTimeout</span>(<span class="hljs-function inline">() =&gt;</span> {
    wordsStore.<span class="hljs-title function_ inline">setSearchQuery</span>(searchQuery.<span class="hljs-property inline">value</span>)
  }, <span class="hljs-number inline">300</span>)
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">防抖原理</strong>：</p>
<p class="text-base leading-7 mb-4 text-foreground">假设用户在300ms内连续输入n个字符，传统方案会发起n次请求，防抖方案只发起1次请求。</p>
<h3 id="pinia状态管理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#pinia状态管理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Pinia状态管理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Pinia状态管理
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20stores%2Fwords.ts%20-%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E7%9A%84%E6%A0%B8%E5%BF%83%E9%80%BB%E8%BE%91%0Aexport%20const%20useWordsStore%20%3D%20defineStore('words'%2C%20()%20%3D%3E%20%7B%0Aconst%20words%20%3D%20refWord%5B%5D%3E(%5B%5D)%0Aconst%20selectedWords%20%3D%20refSetstring%3E%3E(new%20Set())%0Aconst%20loading%20%3D%20ref(false)%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%EF%BC%9A%E6%99%BA%E8%83%BD%E8%BF%87%E6%BB%A4%0Aconst%20filteredWords%20%3D%20computed(()%20%3D%3E%20%7B%0Alet%20filtered%20%3D%20words.value%0A%2F%2F%20%E8%AF%8D%E6%80%A7%E8%BF%87%E6%BB%A4%0Aif%20(currentFilter.value%20%26%26%20currentFilter.value%20!%3D%3D%20'all')%20%7B%0Afiltered%20%3D%20filtered.filter(word%20%3D%3E%0Aword.primaryPartOfSpeech%20%3D%3D%3D%20currentFilter.value%0A)%0A%7D%0A%2F%2F%20%E6%90%9C%E7%B4%A2%E8%BF%87%E6%BB%A4%0Aif%20(searchQuery.value.trim())%20%7B%0Aconst%20query%20%3D%20searchQuery.value.toLowerCase().trim()%0Afiltered%20%3D%20filtered.filter(word%20%3D%3E%0Aword.word.toLowerCase().includes(query)%20%7C%7C%0Aword.primaryDefinition%3F.toLowerCase().includes(query)%0A)%0A%7D%0Areturn%20filtered%0A%7D)%0Areturn%20%7B%0Awords%2C%0AselectedWords%2C%0Aloading%2C%0AfilteredWords%2C%0A%2F%2F%20...%20%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95%0A%7D%0A%7D)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// stores/words.ts - 状态管理的核心逻辑</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">const</span> useWordsStore = <span class="hljs-title function_ inline">defineStore</span>(<span class="hljs-string inline">&#x27;words&#x27;</span>, <span class="hljs-function inline">() =&gt;</span> {
  <span class="hljs-keyword inline">const</span> words = ref&lt;<span class="hljs-title class_ inline">Word</span>[]&gt;([])
  <span class="hljs-keyword inline">const</span> selectedWords = ref&lt;<span class="hljs-title class_ inline">Set</span>&lt;<span class="hljs-built_in inline">string</span>&gt;&gt;(<span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Set</span>())
  <span class="hljs-keyword inline">const</span> loading = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)
  
  <span class="hljs-comment inline">// 计算属性：智能过滤</span>
  <span class="hljs-keyword inline">const</span> filteredWords = <span class="hljs-title function_ inline">computed</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">let</span> filtered = words.<span class="hljs-property inline">value</span>
    
    <span class="hljs-comment inline">// 词性过滤</span>
    <span class="hljs-keyword inline">if</span> (currentFilter.<span class="hljs-property inline">value</span> &amp;&amp; currentFilter.<span class="hljs-property inline">value</span> !== <span class="hljs-string inline">&#x27;all&#x27;</span>) {
      filtered = filtered.<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">word</span> =&gt;</span> 
        word.<span class="hljs-property inline">primaryPartOfSpeech</span> === currentFilter.<span class="hljs-property inline">value</span>
      )
    }
    
    <span class="hljs-comment inline">// 搜索过滤</span>
    <span class="hljs-keyword inline">if</span> (searchQuery.<span class="hljs-property inline">value</span>.<span class="hljs-title function_ inline">trim</span>()) {
      <span class="hljs-keyword inline">const</span> query = searchQuery.<span class="hljs-property inline">value</span>.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>()
      filtered = filtered.<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">word</span> =&gt;</span> 
        word.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">includes</span>(query) ||
        word.<span class="hljs-property inline">primaryDefinition</span>?.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">includes</span>(query)
      )
    }
    
    <span class="hljs-keyword inline">return</span> filtered
  })
  
  <span class="hljs-keyword inline">return</span> {
    words,
    selectedWords,
    loading,
    filteredWords,
    <span class="hljs-comment inline">// ... 其他方法</span>
  }
})
</code></pre>
            </div>
        
<h3 id="前端拼写建议ui设计" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#前端拼写建议ui设计" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 前端拼写建议UI设计">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            前端拼写建议UI设计
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="vue" data-code="div%20v-if%3D%22spellingError%20%26%26%20spellingSuggestions.length%20%3E%200%22%0Aclass%3D%22bg-blue-50%20dark%3Abg-blue-900%2F20%20border%20border-blue-200%20dark%3Aborder-blue-800%20rounded-md%20p-4%22%3E%0Adiv%20class%3D%22flex%20items-start%20space-x-2%22%3E%0Adiv%20class%3D%22flex-shrink-0%20mt-0.5%22%3E%0Asvg%20class%3D%22w-5%20h-5%20text-blue-600%20dark%3Atext-blue-400%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20viewBox%3D%220%200%2024%2024%22%3E%0Apath%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%222%22%20d%3D%22M13%2016h-1v-4h-1m1-4h.01M21%2012a9%209%200%2011-18%200%209%209%200%200118%200z%22%3Epath%3E%0Asvg%3E%0Adiv%3E%0Adiv%20class%3D%22flex-1%22%3E%0Ap%20class%3D%22text-sm%20font-medium%20text-blue-800%20dark%3Atext-blue-200%20mb-2%22%3E%0A%7B%7B%20%24t('words.spellingNotRecognized')%20%7D%7D%0Ap%3E%0Ap%20class%3D%22text-sm%20text-blue-700%20dark%3Atext-blue-300%20mb-3%22%3E%0A%7B%7B%20%24t('words.didYouMean')%20%7D%7D%0Ap%3E%0Adiv%20class%3D%22flex%20flex-wrap%20gap-2%22%3E%0Abutton%0Av-for%3D%22suggestion%20in%20spellingSuggestions%22%0A%3Akey%3D%22suggestion%22%0Aclass%3D%22inline-flex%20items-center%20px-3%20py-1.5%20text-sm%20font-medium%20text-blue-700%20dark%3Atext-blue-200%20bg-blue-100%20dark%3Abg-blue-800%20rounded-md%20hover%3Abg-blue-200%20dark%3Ahover%3Abg-blue-700%20transition-colors%20focus%3Aoutline-none%20focus%3Aring-2%20focus%3Aring-blue-500%20focus%3Aring-offset-2%22%0A%40click%3D%22selectSuggestion(suggestion)%22%0A%3E%0A%7B%7B%20suggestion%20%7D%7D%0Abutton%3E%0Adiv%3E%0Adiv%20class%3D%22mt-3%20flex%20items-center%20space-x-2%22%3E%0Abutton%0Aclass%3D%22text-xs%20text-blue-600%20dark%3Atext-blue-400%20hover%3Atext-blue-800%20dark%3Ahover%3Atext-blue-200%20underline%22%0A%40click%3D%22addWordAnyway%22%0A%3E%0A%7B%7B%20%24t('words.addAnyway')%20%7D%7D%0Abutton%3E%0Aspan%20class%3D%22text-xs%20text-blue-500%20dark%3Atext-blue-400%22%3E%7B%7B%20%24t('words.or')%20%7D%7Dspan%3E%0Abutton%0Aclass%3D%22text-xs%20text-blue-600%20dark%3Atext-blue-400%20hover%3Atext-blue-800%20dark%3Ahover%3Atext-blue-200%20underline%22%0A%40click%3D%22cancelSpelling%22%0A%3E%0A%7B%7B%20%24t('words.tryAgain')%20%7D%7D%0Abutton%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">vue</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-vue"><span class="language-xml inline"><span class="hljs-comment inline">&lt;!-- Words.vue - 拼写建议UI组件 --&gt;</span>
<span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">v-if</span>=<span class="hljs-string inline">&quot;spellingError &amp;&amp; spellingSuggestions.length &gt; 0&quot;</span>
     <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4&quot;</span>&gt;</span>
  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex items-start space-x-2&quot;</span>&gt;</span>
    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex-shrink-0 mt-0.5&quot;</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">svg</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-blue-600 dark:text-blue-400&quot;</span> <span class="hljs-attr inline">fill</span>=<span class="hljs-string inline">&quot;none&quot;</span> <span class="hljs-attr inline">stroke</span>=<span class="hljs-string inline">&quot;currentColor&quot;</span> <span class="hljs-attr inline">viewBox</span>=<span class="hljs-string inline">&quot;0 0 24 24&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">path</span> <span class="hljs-attr inline">stroke-linecap</span>=<span class="hljs-string inline">&quot;round&quot;</span> <span class="hljs-attr inline">stroke-linejoin</span>=<span class="hljs-string inline">&quot;round&quot;</span> <span class="hljs-attr inline">stroke-width</span>=<span class="hljs-string inline">&quot;2&quot;</span> <span class="hljs-attr inline">d</span>=<span class="hljs-string inline">&quot;M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">path</span>&gt;</span>
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">svg</span>&gt;</span>
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex-1&quot;</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">p</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-sm font-medium text-blue-800 dark:text-blue-200 mb-2&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.spellingNotRecognized&#x27;</span>) }}</span><span class="language-xml inline">
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">p</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">p</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-sm text-blue-700 dark:text-blue-300 mb-3&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.didYouMean&#x27;</span>) }}</span><span class="language-xml inline">
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">p</span>&gt;</span>
      <span class="hljs-comment inline">&lt;!-- 拼写建议按钮 --&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex flex-wrap gap-2&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
            <span class="hljs-attr inline">v-for</span>=<span class="hljs-string inline">&quot;suggestion in spellingSuggestions&quot;</span>
            <span class="hljs-attr inline">:key</span>=<span class="hljs-string inline">&quot;suggestion&quot;</span>
            <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-700 dark:text-blue-200 bg-blue-100 dark:bg-blue-800 rounded-md hover:bg-blue-200 dark:hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2&quot;</span>
            @<span class="hljs-attr inline">click</span>=<span class="hljs-string inline">&quot;selectSuggestion(suggestion)&quot;</span>
        &gt;</span>
          </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">suggestion</span> }}</span><span class="language-xml inline">
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
      <span class="hljs-comment inline">&lt;!-- 用户操作选项 --&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;mt-3 flex items-center space-x-2&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
            <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 underline&quot;</span>
            @<span class="hljs-attr inline">click</span>=<span class="hljs-string inline">&quot;addWordAnyway&quot;</span>
        &gt;</span>
          </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.addAnyway&#x27;</span>) }}</span><span class="language-xml inline">
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-blue-500 dark:text-blue-400&quot;</span>&gt;</span></span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.or&#x27;</span>) }}</span><span class="language-xml inline"><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
            <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 underline&quot;</span>
            @<span class="hljs-attr inline">click</span>=<span class="hljs-string inline">&quot;cancelSpelling&quot;</span>
        &gt;</span>
          </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.tryAgain&#x27;</span>) }}</span><span class="language-xml inline">
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
  <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
</span></code></pre>
            </div>
        
<h3 id="前端拼写建议处理逻辑" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#前端拼写建议处理逻辑" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 前端拼写建议处理逻辑">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            前端拼写建议处理逻辑
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20Words.vue%20-%20%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%E5%A4%84%E7%90%86%E7%9A%84%E5%AE%8C%E6%95%B4%E9%80%BB%E8%BE%91%0Aconst%20addWord%20%3D%20async%20()%20%3D%3E%20%7B%0Aif%20(!newWord.word.trim())%20return%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0Aconst%20result%20%3D%20await%20wordsStore.addWord(%7B%0Aword%3A%20newWord.word.trim()%0A%7D)%0Aif%20(result.success)%20%7B%0A%2F%2F%20%E6%88%90%E5%8A%9F%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%0AnewWord.word%20%3D%20''%0AshowAddForm.value%20%3D%20false%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%7D%20else%20if%20(result.spellingError%20%26%26%20result.suggestions%3F.length%20%3E%200)%20%7B%0A%2F%2F%20%E6%98%BE%E7%A4%BA%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%0AspellingError.value%20%3D%20true%0AspellingSuggestions.value%20%3D%20result.suggestions%0A%7D%0A%7D%0A%2F%2F%20%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE%E7%9A%84%E5%8D%95%E8%AF%8D%0Aconst%20selectSuggestion%20%3D%20(suggestion%3A%20string)%20%3D%3E%20%7B%0AnewWord.word%20%3D%20suggestion%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%7D%0A%2F%2F%20%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%0Aconst%20addWordAnyway%20%3D%20async%20()%20%3D%3E%20%7B%0Aif%20(!newWord.word.trim())%20return%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%2F%2F%20%E9%80%9A%E8%BF%87forceAdd%E6%A0%87%E5%BF%97%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%0Aconst%20result%20%3D%20await%20wordsStore.addWord(%7B%0Aword%3A%20newWord.word.trim()%2C%0AforceAdd%3A%20true%0A%7D)%0Aif%20(result.success)%20%7B%0AnewWord.word%20%3D%20''%0AshowAddForm.value%20%3D%20false%0A%7D%0A%7D%0A%2F%2F%20%E5%8F%96%E6%B6%88%E5%B9%B6%E9%87%8D%E8%AF%95%0Aconst%20cancelSpelling%20%3D%20()%20%3D%3E%20%7B%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0AnewWord.word%20%3D%20''%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// Words.vue - 拼写建议处理的完整逻辑</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">addWord</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()) <span class="hljs-keyword inline">return</span>

  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []

  <span class="hljs-keyword inline">const</span> result = <span class="hljs-keyword inline">await</span> wordsStore.<span class="hljs-title function_ inline">addWord</span>({
    <span class="hljs-attr inline">word</span>: newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()
  })

  <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">success</span>) {
    <span class="hljs-comment inline">// 成功添加单词</span>
    newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
    showAddForm.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
    spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
    spellingSuggestions.<span class="hljs-property inline">value</span> = []
  } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">spellingError</span> &amp;&amp; result.<span class="hljs-property inline">suggestions</span>?.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>) {
    <span class="hljs-comment inline">// 显示拼写建议</span>
    spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">true</span>
    spellingSuggestions.<span class="hljs-property inline">value</span> = result.<span class="hljs-property inline">suggestions</span>
  }
}

<span class="hljs-comment inline">// 选择建议的单词</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">selectSuggestion</span> = (<span class="hljs-params inline">suggestion: string</span>) =&gt; {
  newWord.<span class="hljs-property inline">word</span> = suggestion
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
}

<span class="hljs-comment inline">// 强制添加单词</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">addWordAnyway</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()) <span class="hljs-keyword inline">return</span>
  
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
  
  <span class="hljs-comment inline">// 通过forceAdd标志强制添加</span>
  <span class="hljs-keyword inline">const</span> result = <span class="hljs-keyword inline">await</span> wordsStore.<span class="hljs-title function_ inline">addWord</span>({
    <span class="hljs-attr inline">word</span>: newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>(),
    <span class="hljs-attr inline">forceAdd</span>: <span class="hljs-literal inline">true</span>
  })
  
  <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">success</span>) {
    newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
    showAddForm.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  }
}

<span class="hljs-comment inline">// 取消并重试</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">cancelSpelling</span> = (<span class="hljs-params inline"></span>) =&gt; {
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
  newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
}
</code></pre>
            </div>
        
<h2 id="国际化机制" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#国际化机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 国际化机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            国际化机制
        </h2>
<h3 id="前端语言指定流程" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#前端语言指定流程" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 前端语言指定流程">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            前端语言指定流程
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">前端通过HTTP请求头来指定后端返回的语言：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20services%2Fapi.ts%20-%20%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA%E5%99%A8%0Aapi.interceptors.request.use(%0A(config)%20%3D%3E%20%7B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%0Aconst%20locale%20%3D%20getCurrentLocale()%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E8%AF%AD%E8%A8%80%E5%A4%B4%0Aif%20(locale)%20%7B%0Aconfig.headers%5B'x-language'%5D%20%3D%20locale%0A%7D%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E8%AE%A4%E8%AF%81token%0Aconst%20token%20%3D%20localStorage.getItem('token')%0Aif%20(token)%20%7B%0Aconfig.headers.Authorization%20%3D%20%60Bearer%20%24%7Btoken%7D%60%0A%7D%0Areturn%20config%0A%7D%2C%0A(error)%20%3D%3E%20%7B%0Areturn%20Promise.reject(error)%0A%7D%0A)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// services/api.ts - 请求拦截器</span>
api.<span class="hljs-property inline">interceptors</span>.<span class="hljs-property inline">request</span>.<span class="hljs-title function_ inline">use</span>(
  <span class="hljs-function inline">(<span class="hljs-params inline">config</span>) =&gt;</span> {
    <span class="hljs-comment inline">// 获取当前语言环境</span>
    <span class="hljs-keyword inline">const</span> locale = <span class="hljs-title function_ inline">getCurrentLocale</span>()
    
    <span class="hljs-comment inline">// 添加语言头</span>
    <span class="hljs-keyword inline">if</span> (locale) {
      config.<span class="hljs-property inline">headers</span>[<span class="hljs-string inline">&#x27;x-language&#x27;</span>] = locale
    }
    
    <span class="hljs-comment inline">// 添加认证token</span>
    <span class="hljs-keyword inline">const</span> token = <span class="hljs-variable language_ inline">localStorage</span>.<span class="hljs-title function_ inline">getItem</span>(<span class="hljs-string inline">&#x27;token&#x27;</span>)
    <span class="hljs-keyword inline">if</span> (token) {
      config.<span class="hljs-property inline">headers</span>.<span class="hljs-property inline">Authorization</span> = <span class="hljs-string inline">`Bearer <span class="hljs-subst inline">${token}</span>`</span>
    }
    
    <span class="hljs-keyword inline">return</span> config
  },
  <span class="hljs-function inline">(<span class="hljs-params inline">error</span>) =&gt;</span> {
    <span class="hljs-keyword inline">return</span> <span class="hljs-title class_ inline">Promise</span>.<span class="hljs-title function_ inline">reject</span>(error)
  }
)
</code></pre>
            </div>
        
<h3 id="后端语言处理机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#后端语言处理机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 后端语言处理机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            后端语言处理机制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">后端通过中间件来识别和处理语言设置：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%90%8E%E7%AB%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%9B%BD%E9%99%85%E5%8C%96%E5%A4%84%E7%90%86%0Aconst%20i18nMiddleware%20%3D%20(req%2C%20res%2C%20next)%20%3D%3E%20%7B%0Aconst%20locale%20%3D%20req.headers%5B'x-language'%5D%20%7C%7C%20'en'%0Areq.locale%20%3D%20locale%0Areq.t%20%3D%20(key%2C%20options)%20%3D%3E%20i18n.t(key%2C%20%7B%20locale%2C%20...options%20%7D)%0Anext()%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 后端中间件的国际化处理</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">i18nMiddleware</span> = (<span class="hljs-params inline">req, res, next</span>) =&gt; {
  <span class="hljs-keyword inline">const</span> locale = req.<span class="hljs-property inline">headers</span>[<span class="hljs-string inline">&#x27;x-language&#x27;</span>] || <span class="hljs-string inline">&#x27;en&#x27;</span>
  req.<span class="hljs-property inline">locale</span> = locale
  req.<span class="hljs-property inline">t</span> = <span class="hljs-function inline">(<span class="hljs-params inline">key, options</span>) =&gt;</span> i18n.<span class="hljs-title function_ inline">t</span>(key, { locale, ...options })
  <span class="hljs-title function_ inline">next</span>()
}
</code></pre>
            </div>
        
<h3 id="词性翻译的动态实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#词性翻译的动态实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 词性翻译的动态实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            词性翻译的动态实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">系统支持实时的词性翻译：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20wordController.js%20-%20%E8%AF%8D%E6%80%A7%E7%BF%BB%E8%AF%91%E7%9A%84%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%0Aconst%20wordsWithTranslation%20%3D%20words.map(word%20%3D%3E%20%7B%0Aconst%20wordObj%20%3D%20word.toObject()%0Aif%20(wordObj.primaryPartOfSpeech)%20%7B%0A%2F%2F%20%E5%8A%A8%E6%80%81%E7%BF%BB%E8%AF%91%E8%AF%8D%E6%80%A7%0AwordObj.primaryPartOfSpeechTranslated%20%3D%20req.t(%60words.%24%7BwordObj.primaryPartOfSpeech%7D%60)%0A%7D%0Areturn%20wordObj%0A%7D)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// wordController.js - 词性翻译的动态加载</span>
<span class="hljs-keyword inline">const</span> wordsWithTranslation = words.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">word</span> =&gt;</span> {
  <span class="hljs-keyword inline">const</span> wordObj = word.<span class="hljs-title function_ inline">toObject</span>()
  <span class="hljs-keyword inline">if</span> (wordObj.<span class="hljs-property inline">primaryPartOfSpeech</span>) {
    <span class="hljs-comment inline">// 动态翻译词性</span>
    wordObj.<span class="hljs-property inline">primaryPartOfSpeechTranslated</span> = req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">`words.<span class="hljs-subst inline">${wordObj.primaryPartOfSpeech}</span>`</span>)
  }
  <span class="hljs-keyword inline">return</span> wordObj
})
</code></pre>
            </div>
        
<h2 id="拼写检查引擎解析：typojs" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#拼写检查引擎解析：typojs" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 拼写检查引擎解析：Typo.js">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            拼写检查引擎解析：Typo.js
        </h2>
<h3 id="hunspell算法的javascript实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#hunspell算法的javascript实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Hunspell算法的JavaScript实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Hunspell算法的JavaScript实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Typo.js基于著名的Hunspell拼写检查引擎，这是一个在OpenOffice、Mozilla等项目中被广泛使用的算法：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20wordUtils.js%20-%20%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E7%9A%84%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%0Aconst%20Typo%20%3D%20require('typo-js')%0A%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E5%99%A8%0Alet%20spellChecker%0Atry%20%7B%0AspellChecker%20%3D%20new%20Typo('en_US')%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Failed%20to%20initialize%20spell%20checker%3A'%2C%20error)%0A%7D%0A%2F%2F%20%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E5%87%BD%E6%95%B0%0Aconst%20isWordSpelledCorrectly%20%3D%20(word)%20%3D%3E%20%7B%0Aif%20(!spellChecker)%20%7B%0Aconsole.warn('Spell%20checker%20not%20available%2C%20assuming%20word%20is%20correct')%0Areturn%20true%0A%7D%0Atry%20%7B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%0Areturn%20spellChecker.check(cleanWord)%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20checking%20spelling%3A'%2C%20error)%0Areturn%20true%20%2F%2F%20%E9%98%B2%E5%BE%A1%E6%80%A7%E7%BC%96%E7%A8%8B%EF%BC%9A%E9%BB%98%E8%AE%A4%E4%B8%BA%E6%AD%A3%E7%A1%AE%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// wordUtils.js - 拼写检查的核心实现</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title class_ inline">Typo</span> = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;typo-js&#x27;</span>)

<span class="hljs-comment inline">// 初始化拼写检查器</span>
<span class="hljs-keyword inline">let</span> spellChecker
<span class="hljs-keyword inline">try</span> {
  spellChecker = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Typo</span>(<span class="hljs-string inline">&#x27;en_US&#x27;</span>)
} <span class="hljs-keyword inline">catch</span> (error) {
  <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Failed to initialize spell checker:&#x27;</span>, error)
}

<span class="hljs-comment inline">// 拼写检查函数</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">isWordSpelledCorrectly</span> = (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!spellChecker) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;Spell checker not available, assuming word is correct&#x27;</span>)
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">true</span>
  }
  
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>()
    <span class="hljs-keyword inline">return</span> spellChecker.<span class="hljs-title function_ inline">check</span>(cleanWord)
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error checking spelling:&#x27;</span>, error)
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">true</span> <span class="hljs-comment inline">// 防御性编程：默认为正确</span>
  }
}
</code></pre>
            </div>
        
<h3 id="智能拼写建议系统" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#智能拼写建议系统" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 智能拼写建议系统">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            智能拼写建议系统
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">当用户输入错误单词时，系统会自动提供拼写建议，而不是直接抛出错误：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%90%8E%E7%AB%AF%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%AD%E7%9A%84%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%E5%A4%84%E7%90%86%0Aif%20(!wordProcessing.success)%20%7B%0A%2F%2F%20%E8%BF%94%E5%9B%9E%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%EF%BC%88200%E7%8A%B6%E6%80%81%E7%A0%81%EF%BC%8C%E4%B8%8D%E6%98%AF%E9%94%99%E8%AF%AF%EF%BC%89%0Areturn%20res.status(200).json(%7B%0Asuccess%3A%20false%2C%0AneedsConfirmation%3A%20true%2C%0AspellingError%3A%20true%2C%0Amessage%3A%20req.t('words.spellingError')%2C%0Asuggestions%3A%20wordProcessing.suggestions%20%7C%7C%20%5B%5D%2C%0AoriginalWord%3A%20wordProcessing.word%2C%0AsuggestedCorrection%3A%20wordProcessing.suggestions%20%26%26%20wordProcessing.suggestions.length%20%3E%200%0A%3F%20wordProcessing.suggestions%5B0%5D%20%3A%20null%0A%7D)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 后端控制器中的拼写建议处理</span>
<span class="hljs-keyword inline">if</span> (!wordProcessing.<span class="hljs-property inline">success</span>) {
  <span class="hljs-comment inline">// 返回拼写建议（200状态码，不是错误）</span>
  <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">200</span>).<span class="hljs-title function_ inline">json</span>({
    <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
    <span class="hljs-attr inline">needsConfirmation</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">spellingError</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.spellingError&#x27;</span>),
    <span class="hljs-attr inline">suggestions</span>: wordProcessing.<span class="hljs-property inline">suggestions</span> || [],
    <span class="hljs-attr inline">originalWord</span>: wordProcessing.<span class="hljs-property inline">word</span>,
    <span class="hljs-attr inline">suggestedCorrection</span>: wordProcessing.<span class="hljs-property inline">suggestions</span> &amp;&amp; wordProcessing.<span class="hljs-property inline">suggestions</span>.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
      ? wordProcessing.<span class="hljs-property inline">suggestions</span>[<span class="hljs-number inline">0</span>] : <span class="hljs-literal inline">null</span>
  });
}
</code></pre>
            </div>
        
<h3 id="强制添加机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#强制添加机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 强制添加机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            强制添加机制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">系统支持用户强制添加拼写&quot;错误&quot;的单词，比如专有名词或新词：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%94%AF%E6%8C%81%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E7%9A%84%E9%AA%8C%E8%AF%81Schema%0Aconst%20addWordSchema%20%3D%20Joi.object(%7B%0Aword%3A%20Joi.string().min(1).max(50).pattern(%2F%5E%5Ba-zA-Z%5C-'%5D%2B%24%2F).required()%2C%0AforceAdd%3A%20Joi.boolean().default(false)%20%2F%2F%20%E6%96%B0%E5%A2%9E%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E6%A0%87%E5%BF%97%0A%7D)%3B%0A%2F%2F%20%E6%A0%B9%E6%8D%AEforceAdd%E5%8F%82%E6%95%B0%E5%86%B3%E5%AE%9A%E6%98%AF%E5%90%A6%E8%B7%B3%E8%BF%87%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%0Aif%20(forceAdd)%20%7B%0A%2F%2F%20%E8%B7%B3%E8%BF%87%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%EF%BC%8C%E7%9B%B4%E6%8E%A5%E8%8E%B7%E5%8F%96WordNet%E6%95%B0%E6%8D%AE%0Aconst%20wordNetData%20%3D%20await%20require('..%2Futils%2FwordUtils').getWordNetData(cleanWord)%3B%0AwordProcessing%20%3D%20%7B%0Asuccess%3A%20true%2C%0Aword%3A%20cleanWord%2C%0A...wordNetData%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E6%AD%A3%E5%B8%B8%E7%9A%84%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E6%B5%81%E7%A8%8B%0AwordProcessing%20%3D%20await%20processWord(cleanWord)%3B%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 支持强制添加的验证Schema</span>
<span class="hljs-keyword inline">const</span> addWordSchema = <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">object</span>({
  <span class="hljs-attr inline">word</span>: <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">string</span>().<span class="hljs-title function_ inline">min</span>(<span class="hljs-number inline">1</span>).<span class="hljs-title function_ inline">max</span>(<span class="hljs-number inline">50</span>).<span class="hljs-title function_ inline">pattern</span>(<span class="hljs-regexp inline">/^[a-zA-Z\-&#x27;]+$/</span>).<span class="hljs-title function_ inline">required</span>(),
  <span class="hljs-attr inline">forceAdd</span>: <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">boolean</span>().<span class="hljs-title function_ inline">default</span>(<span class="hljs-literal inline">false</span>) <span class="hljs-comment inline">// 新增强制添加标志</span>
});

<span class="hljs-comment inline">// 根据forceAdd参数决定是否跳过拼写检查</span>
<span class="hljs-keyword inline">if</span> (forceAdd) {
  <span class="hljs-comment inline">// 跳过拼写检查，直接获取WordNet数据</span>
  <span class="hljs-keyword inline">const</span> wordNetData = <span class="hljs-keyword inline">await</span> <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../utils/wordUtils&#x27;</span>).<span class="hljs-title function_ inline">getWordNetData</span>(cleanWord);
  wordProcessing = {
    <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">word</span>: cleanWord,
    ...wordNetData
  };
} <span class="hljs-keyword inline">else</span> {
  <span class="hljs-comment inline">// 正常的拼写检查流程</span>
  wordProcessing = <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">processWord</span>(cleanWord);
}
</code></pre>
            </div>
        
<h3 id="编辑距离算法" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#编辑距离算法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 编辑距离算法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            编辑距离算法
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">拼写建议的生成基于编辑距离算法（Levenshtein Distance），这是一个经典的动态规划问题：</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">编辑距离的数学定义</strong>：</p>
<p class="text-base leading-7 mb-4 text-foreground">编辑距离是指将字符串A转换成字符串B所需的最少单字符编辑操作次数。这些操作包括：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">插入</strong>一个字符</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">删除</strong>一个字符</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">替换</strong>一个字符</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">对于字符串A和B，编辑距离D(A,B)的递推公式为：</p>
<p class="text-base leading-7 mb-4 text-foreground"><span class="katex-display inline"><span class="katex inline"><span class="katex-mathml inline"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>B</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>(删除A[i])</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>B</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>(插入B[j])</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>B</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>(替换A[i]为B[j])</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">D(A,B) = \min \begin{cases} D(A_{i-1}, B_j) + 1 &amp; \text{(删除A[i])} \\ D(A_i, B_{j-1}) + 1 &amp; \text{(插入B[j])} \\ D(A_{i-1}, B_{j-1}) + cost &amp; \text{(替换A[i]为B[j])} \end{cases}</annotation></semantics></math></span><span class="katex-html inline" aria-hidden="true" style="display:none"><span class="base inline"><span class="strut inline" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal inline" style="margin-right:0.02778em;">D</span><span class="mopen inline">(</span><span class="mord mathnormal inline">A</span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord mathnormal inline" style="margin-right:0.05017em;">B</span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2778em;"></span><span class="mrel inline">=</span><span class="mspace inline" style="margin-right:0.2778em;"></span></span><span class="base inline"><span class="strut inline" style="height:4.32em;vertical-align:-1.91em;"></span><span class="mop inline">min</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="minner inline"><span class="mopen inline"><span class="delimsizing mult inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:2.35em;"><span style="top:-2.2em;" class="inline"><span class="pstrut inline" style="height:3.15em;"></span><span class="delimsizinginner delim-size4 inline"><span class="inline">⎩</span></span></span><span style="top:-2.192em;" class="inline"><span class="pstrut inline" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;" class="inline"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-3.15em;" class="inline"><span class="pstrut inline" style="height:3.15em;"></span><span class="delimsizinginner delim-size4 inline"><span class="inline">⎨</span></span></span><span style="top:-4.292em;" class="inline"><span class="pstrut inline" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;" class="inline"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"/></svg></span></span><span style="top:-4.6em;" class="inline"><span class="pstrut inline" style="height:3.15em;"></span><span class="delimsizinginner delim-size4 inline"><span class="inline">⎧</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:1.85em;"><span class="inline"></span></span></span></span></span></span><span class="mord inline"><span class="mtable inline"><span class="col-align-l inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:2.41em;"><span style="top:-4.41em;" class="inline"><span class="pstrut inline" style="height:3.008em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.02778em;">D</span><span class="mopen inline">(</span><span class="mord inline"><span class="mord mathnormal inline">A</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">i</span><span class="mbin mtight inline">−</span><span class="mord mtight inline">1</span></span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.2083em;"><span class="inline"></span></span></span></span></span></span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.05017em;">B</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.2861em;"><span class="inline"></span></span></span></span></span></span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mord inline">1</span></span></span><span style="top:-2.97em;" class="inline"><span class="pstrut inline" style="height:3.008em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.02778em;">D</span><span class="mopen inline">(</span><span class="mord inline"><span class="mord mathnormal inline">A</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mathnormal mtight inline">i</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.15em;"><span class="inline"></span></span></span></span></span></span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.05017em;">B</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.05724em;">j</span><span class="mbin mtight inline">−</span><span class="mord mtight inline">1</span></span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.2861em;"><span class="inline"></span></span></span></span></span></span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mord inline">1</span></span></span><span style="top:-1.53em;" class="inline"><span class="pstrut inline" style="height:3.008em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.02778em;">D</span><span class="mopen inline">(</span><span class="mord inline"><span class="mord mathnormal inline">A</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline">i</span><span class="mbin mtight inline">−</span><span class="mord mtight inline">1</span></span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.2083em;"><span class="inline"></span></span></span></span></span></span><span class="mpunct inline">,</span><span class="mspace inline" style="margin-right:0.1667em;"></span><span class="mord inline"><span class="mord mathnormal inline" style="margin-right:0.05017em;">B</span><span class="msupsub inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;" class="inline"><span class="pstrut inline" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight inline"><span class="mord mtight inline"><span class="mord mathnormal mtight inline" style="margin-right:0.05724em;">j</span><span class="mbin mtight inline">−</span><span class="mord mtight inline">1</span></span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:0.2861em;"><span class="inline"></span></span></span></span></span></span><span class="mclose inline">)</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mbin inline">+</span><span class="mspace inline" style="margin-right:0.2222em;"></span><span class="mord mathnormal inline">cos</span><span class="mord mathnormal inline">t</span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:1.91em;"><span class="inline"></span></span></span></span></span><span class="arraycolsep inline" style="width:1em;"></span><span class="col-align-l inline"><span class="vlist-t vlist-t2 inline"><span class="vlist-r inline"><span class="vlist inline" style="height:2.41em;"><span style="top:-4.41em;" class="inline"><span class="pstrut inline" style="height:3.008em;"></span><span class="mord inline"><span class="mord text inline"><span class="mord inline">(</span><span class="mord cjk_fallback inline">删除</span><span class="mord inline">A[i])</span></span></span></span><span style="top:-2.97em;" class="inline"><span class="pstrut inline" style="height:3.008em;"></span><span class="mord inline"><span class="mord text inline"><span class="mord inline">(</span><span class="mord cjk_fallback inline">插入</span><span class="mord inline">B[j])</span></span></span></span><span style="top:-1.53em;" class="inline"><span class="pstrut inline" style="height:3.008em;"></span><span class="mord inline"><span class="mord text inline"><span class="mord inline">(</span><span class="mord cjk_fallback inline">替换</span><span class="mord inline">A[i]</span><span class="mord cjk_fallback inline">为</span><span class="mord inline">B[j])</span></span></span></span></span><span class="vlist-s inline">​</span></span><span class="vlist-r inline"><span class="vlist inline" style="height:1.91em;"><span class="inline"></span></span></span></span></span></span></span><span class="mclose nulldelimiter inline"></span></span></span></span></span></span></p>
<p class="text-base leading-7 mb-4 text-foreground">其中：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">cost = 0（如果A[i] = B[j]，字符相同无需操作）</li>
<li class="text-foreground leading-relaxed">cost = 1（如果A[i] ≠ B[j]，需要替换操作）</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">举一个具体的例子</strong>：</p>
<p class="text-base leading-7 mb-4 text-foreground">假设我们要计算&quot;cat&quot;和&quot;cut&quot;的编辑距离：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="" data-code="%22%22%20%20c%20%20u%20%20t%0A%22%22%20%20%200%20%201%20%202%20%203%0Ac%20%20%20%201%20%200%20%201%20%202%0Aa%20%20%20%202%20%201%20%201%20%202%0At%20%20%20%203%20%202%20%202%20%201">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">code</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code>    &quot;&quot;  c  u  t
&quot;&quot;  <span class="hljs-number inline"> 0 </span><span class="hljs-number inline"> 1 </span><span class="hljs-number inline"> 2 </span> 3
c   <span class="hljs-number inline"> 1 </span><span class="hljs-number inline"> 0 </span><span class="hljs-number inline"> 1 </span> 2
a   <span class="hljs-number inline"> 2 </span><span class="hljs-number inline"> 1 </span><span class="hljs-number inline"> 1 </span> 2
t   <span class="hljs-number inline"> 3 </span><span class="hljs-number inline"> 2 </span><span class="hljs-number inline"> 2 </span> 1
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">计算过程</strong>：</p>
<ol class="list-decimal list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">初始化：空字符串到任何字符串的距离等于目标字符串的长度</li>
<li class="text-foreground leading-relaxed">逐步填充表格：
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">D(&quot;c&quot;, “c”) = 0 (字符相同)</li>
<li class="text-foreground leading-relaxed">D(&quot;ca&quot;, “c”) = 1 (删除’a’)</li>
<li class="text-foreground leading-relaxed">D(&quot;ca&quot;, “cu”) = 1 (替换’a’为’u’)</li>
<li class="text-foreground leading-relaxed">D(&quot;cat&quot;, “cut”) = 1 (替换’a’为’u’)</li>
</ul></li>
</ol>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">算法实现思路</strong>：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="function%20editDistance(str1%2C%20str2)%20%7B%0Aconst%20m%20%3D%20str1.length%0Aconst%20n%20%3D%20str2.length%0A%2F%2F%20%E5%88%9B%E5%BB%BADP%E8%A1%A8%0Aconst%20dp%20%3D%20Array(m%20%2B%201).fill().map(()%20%3D%3E%20Array(n%20%2B%201).fill(0))%0A%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BE%B9%E7%95%8C%E6%9D%A1%E4%BB%B6%0Afor%20(let%20i%20%3D%200%3B%20i%200%5D%20%3D%20i%0Afor%20(let%20j%20%3D%200%3B%20j%200%5D%5Bj%5D%20%3D%20j%0A%2F%2F%20%E5%A1%AB%E5%85%85DP%E8%A1%A8%0Afor%20(let%20i%20%3D%201%3B%20i%20for%20(let%20j%20%3D%201%3B%20j%20if%20(str1%5Bi-1%5D%20%3D%3D%3D%20str2%5Bj-1%5D)%20%7B%0Adp%5Bi%5D%5Bj%5D%20%3D%20dp%5Bi-1%5D%5Bj-1%5D%20%20%2F%2F%20%E5%AD%97%E7%AC%A6%E7%9B%B8%E5%90%8C%EF%BC%8C%E6%97%A0%E9%9C%80%E6%93%8D%E4%BD%9C%0A%7D%20else%20%7B%0Adp%5Bi%5D%5Bj%5D%20%3D%20Math.min(%0Adp%5Bi-1%5D%5Bj%5D%20%2B%201%2C%20%20%20%20%20%20%2F%2F%20%E5%88%A0%E9%99%A4%0Adp%5Bi%5D%5Bj-1%5D%20%2B%201%2C%20%20%20%20%20%20%2F%2F%20%E6%8F%92%E5%85%A5%0Adp%5Bi-1%5D%5Bj-1%5D%20%2B%201%20%20%20%20%20%2F%2F%20%E6%9B%BF%E6%8D%A2%0A)%0A%7D%0A%7D%0A%7D%0Areturn%20dp%5Bm%5D%5Bn%5D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">function</span> <span class="hljs-title function_ inline">editDistance</span>(<span class="hljs-params inline">str1, str2</span>) {
  <span class="hljs-keyword inline">const</span> m = str1.<span class="hljs-property inline">length</span>
  <span class="hljs-keyword inline">const</span> n = str2.<span class="hljs-property inline">length</span>
  
  <span class="hljs-comment inline">// 创建DP表</span>
  <span class="hljs-keyword inline">const</span> dp = <span class="hljs-title class_ inline">Array</span>(m + <span class="hljs-number inline">1</span>).<span class="hljs-title function_ inline">fill</span>().<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline">() =&gt;</span> <span class="hljs-title class_ inline">Array</span>(n + <span class="hljs-number inline">1</span>).<span class="hljs-title function_ inline">fill</span>(<span class="hljs-number inline">0</span>))
  
  <span class="hljs-comment inline">// 初始化边界条件</span>
  <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> i = <span class="hljs-number inline">0</span>; i &lt;= m; i++) dp[i][<span class="hljs-number inline">0</span>] = i
  <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> j = <span class="hljs-number inline">0</span>; j &lt;= n; j++) dp[<span class="hljs-number inline">0</span>][j] = j
  
  <span class="hljs-comment inline">// 填充DP表</span>
  <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> i = <span class="hljs-number inline">1</span>; i &lt;= m; i++) {
    <span class="hljs-keyword inline">for</span> (<span class="hljs-keyword inline">let</span> j = <span class="hljs-number inline">1</span>; j &lt;= n; j++) {
      <span class="hljs-keyword inline">if</span> (str1[i-<span class="hljs-number inline">1</span>] === str2[j-<span class="hljs-number inline">1</span>]) {
        dp[i][j] = dp[i-<span class="hljs-number inline">1</span>][j-<span class="hljs-number inline">1</span>]  <span class="hljs-comment inline">// 字符相同，无需操作</span>
      } <span class="hljs-keyword inline">else</span> {
        dp[i][j] = <span class="hljs-title class_ inline">Math</span>.<span class="hljs-title function_ inline">min</span>(
          dp[i-<span class="hljs-number inline">1</span>][j] + <span class="hljs-number inline">1</span>,      <span class="hljs-comment inline">// 删除</span>
          dp[i][j-<span class="hljs-number inline">1</span>] + <span class="hljs-number inline">1</span>,      <span class="hljs-comment inline">// 插入</span>
          dp[i-<span class="hljs-number inline">1</span>][j-<span class="hljs-number inline">1</span>] + <span class="hljs-number inline">1</span>     <span class="hljs-comment inline">// 替换</span>
        )
      }
    }
  }
  
  <span class="hljs-keyword inline">return</span> dp[m][n]
}
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">在拼写检查中的应用</strong>：</p>
<p class="text-base leading-7 mb-4 text-foreground">当用户输入&quot;teh&quot;时，系统会计算它与词典中所有单词的编辑距离：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">“teh” vs &quot;the&quot;: 距离为1（交换e和h）</li>
<li class="text-foreground leading-relaxed">“teh” vs &quot;ten&quot;: 距离为1（替换h为n）</li>
<li class="text-foreground leading-relaxed">“teh” vs &quot;tea&quot;: 距离为1（替换h为a）</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground">然后系统会推荐编辑距离最小的单词作为拼写建议。</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">算法复杂度</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">时间复杂度：O(m × n)，其中m和n分别是两个字符串的长度</li>
<li class="text-foreground leading-relaxed">空间复杂度：O(m × n)，可以优化至O(min(m, n))</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%E7%94%9F%E6%88%90%0Aconst%20getSpellingSuggestions%20%3D%20(word)%20%3D%3E%20%7B%0Aif%20(!spellChecker)%20%7B%0Areturn%20%5B%5D%0A%7D%0Atry%20%7B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%0Areturn%20spellChecker.suggest(cleanWord)%20%7C%7C%20%5B%5D%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20getting%20spelling%20suggestions%3A'%2C%20error)%0Areturn%20%5B%5D%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 拼写建议生成</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getSpellingSuggestions</span> = (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!spellChecker) {
    <span class="hljs-keyword inline">return</span> []
  }
  
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>()
    <span class="hljs-keyword inline">return</span> spellChecker.<span class="hljs-title function_ inline">suggest</span>(cleanWord) || []
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error getting spelling suggestions:&#x27;</span>, error)
    <span class="hljs-keyword inline">return</span> []
  }
}
</code></pre>
            </div>
        
<h3 id="容错机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#容错机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 容错机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            容错机制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">拼写检查模块采用了&quot;宽进严出&quot;的设计：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">宽进</strong>：即使拼写检查器初始化失败，系统依然能正常工作</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">严出</strong>：对于用户输入进行严格的验证和反馈</li>
</ul>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%AE%B9%E9%94%99%E6%9C%BA%E5%88%B6%E7%9A%84%E5%AE%9E%E7%8E%B0%0Aconst%20processWord%20%3D%20async%20(word)%20%3D%3E%20%7B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%0A%2F%2F%20%E7%AC%AC%E4%B8%80%E5%85%B3%EF%BC%9A%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%0Aconst%20isSpelledCorrectly%20%3D%20isWordSpelledCorrectly(cleanWord)%0Aif%20(!isSpelledCorrectly)%20%7B%0Aconst%20suggestions%20%3D%20getSpellingSuggestions(cleanWord)%0Areturn%20%7B%0Asuccess%3A%20false%2C%0Aerror%3A%20'SPELLING_ERROR'%2C%0Asuggestions%2C%0Aword%3A%20cleanWord%0A%7D%0A%7D%0A%2F%2F%20%E7%AC%AC%E4%BA%8C%E5%85%B3%EF%BC%9A%E8%AF%8D%E6%80%A7%E5%88%86%E6%9E%90%0Aconst%20wordNetData%20%3D%20await%20getWordNetData(cleanWord)%0Areturn%20%7B%0Asuccess%3A%20true%2C%0Aword%3A%20cleanWord%2C%0A...wordNetData%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 容错机制的实现</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">processWord</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>()
  
  <span class="hljs-comment inline">// 第一关：拼写检查</span>
  <span class="hljs-keyword inline">const</span> isSpelledCorrectly = <span class="hljs-title function_ inline">isWordSpelledCorrectly</span>(cleanWord)
  
  <span class="hljs-keyword inline">if</span> (!isSpelledCorrectly) {
    <span class="hljs-keyword inline">const</span> suggestions = <span class="hljs-title function_ inline">getSpellingSuggestions</span>(cleanWord)
    <span class="hljs-keyword inline">return</span> {
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">error</span>: <span class="hljs-string inline">&#x27;SPELLING_ERROR&#x27;</span>,
      suggestions,
      <span class="hljs-attr inline">word</span>: cleanWord
    }
  }
  
  <span class="hljs-comment inline">// 第二关：词性分析</span>
  <span class="hljs-keyword inline">const</span> wordNetData = <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">getWordNetData</span>(cleanWord)
  
  <span class="hljs-keyword inline">return</span> {
    <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">word</span>: cleanWord,
    ...wordNetData
  }
}
</code></pre>
            </div>
        
<h2 id="wordnet词汇数据库集成：语义网络" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#wordnet词汇数据库集成：语义网络" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to WordNet词汇数据库集成：语义网络">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            WordNet词汇数据库集成：语义网络
        </h2>
<h3 id="wordnet的数据结构" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#wordnet的数据结构" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to WordNet的数据结构">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            WordNet的数据结构
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">WordNet是一个基于语义关系的英语词汇数据库，它将词汇组织成同义词集（synsets）的形式：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20wordUtils.js%20-%20WordNet%E5%88%9D%E5%A7%8B%E5%8C%96%0Aconst%20wordnet%20%3D%20require('wordnet')%0Alet%20wordnetInitialized%20%3D%20false%0Aconst%20initializeWordNet%20%3D%20async%20()%20%3D%3E%20%7B%0Aif%20(!wordnetInitialized)%20%7B%0Atry%20%7B%0Aawait%20wordnet.init()%0AwordnetInitialized%20%3D%20true%0Aconsole.log('WordNet%20initialized%20successfully')%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Failed%20to%20initialize%20WordNet%3A'%2C%20error)%0A%7D%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// wordUtils.js - WordNet初始化</span>
<span class="hljs-keyword inline">const</span> wordnet = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;wordnet&#x27;</span>)

<span class="hljs-keyword inline">let</span> wordnetInitialized = <span class="hljs-literal inline">false</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">initializeWordNet</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!wordnetInitialized) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">await</span> wordnet.<span class="hljs-title function_ inline">init</span>()
      wordnetInitialized = <span class="hljs-literal inline">true</span>
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;WordNet initialized successfully&#x27;</span>)
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Failed to initialize WordNet:&#x27;</span>, error)
    }
  }
}
</code></pre>
            </div>
        
<h3 id="词性识别的自动化实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#词性识别的自动化实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 词性识别的自动化实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            词性识别的自动化实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">WordNet能够通过语义网络分析实现自动识别单词的词性：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%AF%8D%E6%80%A7%E6%98%A0%E5%B0%84%E5%87%BD%E6%95%B0%0Aconst%20mapWordNetPoS%20%3D%20(wordnetPos)%20%3D%3E%20%7B%0Aif%20(!wordnetPos)%20return%20null%0Aconst%20mapping%20%3D%20%7B%0A'noun'%3A%20'noun'%2C%0A'verb'%3A%20'verb'%2C%0A'adjective'%3A%20'adjective'%2C%0A'adverb'%3A%20'adverb'%2C%0A'n'%3A%20'noun'%2C%0A'v'%3A%20'verb'%2C%0A'a'%3A%20'adjective'%2C%0A's'%3A%20'adjective'%2C%20%2F%2F%20adjective%20satellite%0A'r'%3A%20'adverb'%0A%7D%0Areturn%20mapping%5BwordnetPos.toLowerCase()%5D%20%7C%7C%20null%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 词性映射函数</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">mapWordNetPoS</span> = (<span class="hljs-params inline">wordnetPos</span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!wordnetPos) <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>
  
  <span class="hljs-keyword inline">const</span> mapping = {
    <span class="hljs-string inline">&#x27;noun&#x27;</span>: <span class="hljs-string inline">&#x27;noun&#x27;</span>,
    <span class="hljs-string inline">&#x27;verb&#x27;</span>: <span class="hljs-string inline">&#x27;verb&#x27;</span>, 
    <span class="hljs-string inline">&#x27;adjective&#x27;</span>: <span class="hljs-string inline">&#x27;adjective&#x27;</span>,
    <span class="hljs-string inline">&#x27;adverb&#x27;</span>: <span class="hljs-string inline">&#x27;adverb&#x27;</span>,
    <span class="hljs-string inline">&#x27;n&#x27;</span>: <span class="hljs-string inline">&#x27;noun&#x27;</span>,
    <span class="hljs-string inline">&#x27;v&#x27;</span>: <span class="hljs-string inline">&#x27;verb&#x27;</span>,
    <span class="hljs-string inline">&#x27;a&#x27;</span>: <span class="hljs-string inline">&#x27;adjective&#x27;</span>,
    <span class="hljs-string inline">&#x27;s&#x27;</span>: <span class="hljs-string inline">&#x27;adjective&#x27;</span>, <span class="hljs-comment inline">// adjective satellite</span>
    <span class="hljs-string inline">&#x27;r&#x27;</span>: <span class="hljs-string inline">&#x27;adverb&#x27;</span>
  }
  
  <span class="hljs-keyword inline">return</span> mapping[wordnetPos.<span class="hljs-title function_ inline">toLowerCase</span>()] || <span class="hljs-literal inline">null</span>
}
</code></pre>
            </div>
        
<h3 id="异步初始化" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#异步初始化" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 异步初始化">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            异步初始化
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">WordNet的初始化是一个异步过程，采用了懒加载策略：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%8E%B7%E5%8F%96WordNet%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%8C%E6%95%B4%E5%AE%9E%E7%8E%B0%0Aconst%20getWordNetData%20%3D%20async%20(word)%20%3D%3E%20%7B%0Atry%20%7B%0A%2F%2F%20%E7%A1%AE%E4%BF%9DWordNet%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%0Aawait%20initializeWordNet()%0Aif%20(!wordnetInitialized)%20%7B%0Aconsole.warn('WordNet%20not%20available')%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20false%0A%7D%0A%7D%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%0Atry%20%7B%0Aconst%20definitions%20%3D%20await%20wordnet.lookup(cleanWord)%0Aif%20(!definitions%20%7C%7C%20definitions.length%20%3D%3D%3D%200)%20%7B%0Aconsole.log(%60No%20WordNet%20data%20found%20for%3A%20%24%7BcleanWord%7D%60)%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20true%0A%7D%0A%7D%0A%2F%2F%20%E5%A4%84%E7%90%86WordNet%E5%AE%9A%E4%B9%89%0Aconst%20processedDefinitions%20%3D%20definitions.map(def%20%3D%3E%20(%7B%0Atext%3A%20def.glossary%20%7C%7C%20def.gloss%20%7C%7C%20''%2C%0ApartOfSpeech%3A%20mapWordNetPoS(def.meta%3F.synsetType)%0A%7D)).filter(def%20%3D%3E%20def.text%20%26%26%20def.partOfSpeech)%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E4%B8%BB%E8%A6%81%E5%AE%9A%E4%B9%89%E5%92%8C%E8%AF%8D%E6%80%A7%0Aconst%20primaryDefinition%20%3D%20processedDefinitions.length%20%3E%200%0A%3F%20processedDefinitions%5B0%5D.text%0A%3A%20null%0Aconst%20primaryPartOfSpeech%20%3D%20processedDefinitions.length%20%3E%200%0A%3F%20processedDefinitions%5B0%5D.partOfSpeech%0A%3A%20null%0Areturn%20%7B%0Adefinitions%3A%20processedDefinitions.slice(0%2C%2010)%2C%20%2F%2F%20%E9%99%90%E5%88%B6%E4%B8%BA10%E4%B8%AA%E5%AE%9A%E4%B9%89%0AprimaryDefinition%2C%0AprimaryPartOfSpeech%2C%0AwordNetProcessed%3A%20true%0A%7D%0A%7D%20catch%20(lookupError)%20%7B%0Aconsole.error('Error%20looking%20up%20word%20in%20WordNet%3A'%2C%20lookupError)%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20true%0A%7D%0A%7D%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20in%20getWordNetData%3A'%2C%20error)%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20false%0A%7D%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 获取WordNet数据的完整实现</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getWordNetData</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-comment inline">// 确保WordNet已初始化</span>
    <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">initializeWordNet</span>()
    
    <span class="hljs-keyword inline">if</span> (!wordnetInitialized) {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;WordNet not available&#x27;</span>)
      <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">definitions</span>: [],
        <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">false</span>
      }
    }
    
    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>()
    
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">const</span> definitions = <span class="hljs-keyword inline">await</span> wordnet.<span class="hljs-title function_ inline">lookup</span>(cleanWord)
      
      <span class="hljs-keyword inline">if</span> (!definitions || definitions.<span class="hljs-property inline">length</span> === <span class="hljs-number inline">0</span>) {
        <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">`No WordNet data found for: <span class="hljs-subst inline">${cleanWord}</span>`</span>)
        <span class="hljs-keyword inline">return</span> {
          <span class="hljs-attr inline">definitions</span>: [],
          <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
          <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
          <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">true</span>
        }
      }
      
      <span class="hljs-comment inline">// 处理WordNet定义</span>
      <span class="hljs-keyword inline">const</span> processedDefinitions = definitions.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">def</span> =&gt;</span> ({
        <span class="hljs-attr inline">text</span>: def.<span class="hljs-property inline">glossary</span> || def.<span class="hljs-property inline">gloss</span> || <span class="hljs-string inline">&#x27;&#x27;</span>,
        <span class="hljs-attr inline">partOfSpeech</span>: <span class="hljs-title function_ inline">mapWordNetPoS</span>(def.<span class="hljs-property inline">meta</span>?.<span class="hljs-property inline">synsetType</span>)
      })).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">def</span> =&gt;</span> def.<span class="hljs-property inline">text</span> &amp;&amp; def.<span class="hljs-property inline">partOfSpeech</span>)
      
      <span class="hljs-comment inline">// 获取主要定义和词性</span>
      <span class="hljs-keyword inline">const</span> primaryDefinition = processedDefinitions.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
        ? processedDefinitions[<span class="hljs-number inline">0</span>].<span class="hljs-property inline">text</span> 
        : <span class="hljs-literal inline">null</span>
      <span class="hljs-keyword inline">const</span> primaryPartOfSpeech = processedDefinitions.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
        ? processedDefinitions[<span class="hljs-number inline">0</span>].<span class="hljs-property inline">partOfSpeech</span> 
        : <span class="hljs-literal inline">null</span>
      
      <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">definitions</span>: processedDefinitions.<span class="hljs-title function_ inline">slice</span>(<span class="hljs-number inline">0</span>, <span class="hljs-number inline">10</span>), <span class="hljs-comment inline">// 限制为10个定义</span>
        primaryDefinition,
        primaryPartOfSpeech,
        <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">true</span>
      }
    } <span class="hljs-keyword inline">catch</span> (lookupError) {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error looking up word in WordNet:&#x27;</span>, lookupError)
      <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">definitions</span>: [],
        <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">true</span>
      }
    }
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error in getWordNetData:&#x27;</span>, error)
    <span class="hljs-keyword inline">return</span> {
      <span class="hljs-attr inline">definitions</span>: [],
      <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
      <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
      <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">false</span>
    }
  }
}
</code></pre>
            </div>
        
<h2 id="数据模型与存储设计：mongodb文档" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#数据模型与存储设计：mongodb文档" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 数据模型与存储设计：MongoDB文档">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            数据模型与存储设计：MongoDB文档
        </h2>
<h3 id="优化的schema设计" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#优化的schema设计" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 优化的Schema设计">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            优化的Schema设计
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">MongoDB的文档结构设计是整个系统的基础：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20models%2FWord.js%20-%20%E5%AE%8C%E6%95%B4%E7%9A%84Schema%E8%AE%BE%E8%AE%A1%0Aconst%20wordSchema%20%3D%20new%20mongoose.Schema(%7B%0Aword%3A%20%7B%0Atype%3A%20String%2C%0Arequired%3A%20true%2C%0Atrim%3A%20true%2C%0Alowercase%3A%20true%2C%0Amaxlength%3A%2050%0A%7D%2C%0AuserIds%3A%20%5B%7B%0Atype%3A%20mongoose.Schema.Types.ObjectId%2C%0Aref%3A%20'User'%2C%0Arequired%3A%20true%0A%7D%5D%2C%0A%2F%2F%20WordNet%E6%A3%80%E7%B4%A2%E7%9A%84%E6%95%B0%E6%8D%AE%0Adefinitions%3A%20%5B%7B%0Atext%3A%20%7B%0Atype%3A%20String%2C%0Atrim%3A%20true%2C%0Amaxlength%3A%201000%0A%7D%2C%0ApartOfSpeech%3A%20%7B%0Atype%3A%20String%2C%0Aenum%3A%20%5B'noun'%2C%20'verb'%2C%20'adjective'%2C%20'adverb'%2C%20'preposition'%2C%0A'conjunction'%2C%20'interjection'%2C%20'pronoun'%2C%20'determiner'%2C%0A'adjective%20satellite'%5D%0A%7D%0A%7D%5D%2C%0A%2F%2F%20%E4%B8%BB%E8%A6%81%E8%AF%8D%E6%80%A7%EF%BC%88%E6%9C%80%E5%B8%B8%E8%A7%81%E7%9A%84%EF%BC%89%0AprimaryPartOfSpeech%3A%20%7B%0Atype%3A%20String%2C%0Aenum%3A%20%5B'noun'%2C%20'verb'%2C%20'adjective'%2C%20'adverb'%2C%20'preposition'%2C%0A'conjunction'%2C%20'interjection'%2C%20'pronoun'%2C%20'determiner'%2C%0A'adjective%20satellite'%5D%0A%7D%2C%0A%2F%2F%20%E4%B8%BB%E8%A6%81%E5%AE%9A%E4%B9%89%EF%BC%88%E7%AC%AC%E4%B8%80%E4%B8%AA%2F%E6%9C%80%E5%B8%B8%E8%A7%81%E7%9A%84%EF%BC%89%0AprimaryDefinition%3A%20%7B%0Atype%3A%20String%2C%0Atrim%3A%20true%2C%0Amaxlength%3A%201000%0A%7D%2C%0AusageCount%3A%20%7B%0Atype%3A%20Number%2C%0Adefault%3A%200%2C%0Amin%3A%200%0A%7D%2C%0A%2F%2F%20%E8%B7%9F%E8%B8%AAWordNet%E6%9F%A5%E6%89%BE%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F%0AwordNetProcessed%3A%20%7B%0Atype%3A%20Boolean%2C%0Adefault%3A%20false%0A%7D%0A%7D%2C%20%7B%0Atimestamps%3A%20true%0A%7D)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// models/Word.js - 完整的Schema设计</span>
<span class="hljs-keyword inline">const</span> wordSchema = <span class="hljs-keyword inline">new</span> mongoose.<span class="hljs-title class_ inline">Schema</span>({
  <span class="hljs-attr inline">word</span>: {
    <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">String</span>,
    <span class="hljs-attr inline">required</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">trim</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">lowercase</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">maxlength</span>: <span class="hljs-number inline">50</span>
  },
  <span class="hljs-attr inline">userIds</span>: [{
    <span class="hljs-attr inline">type</span>: mongoose.<span class="hljs-property inline">Schema</span>.<span class="hljs-property inline">Types</span>.<span class="hljs-property inline">ObjectId</span>,
    <span class="hljs-attr inline">ref</span>: <span class="hljs-string inline">&#x27;User&#x27;</span>,
    <span class="hljs-attr inline">required</span>: <span class="hljs-literal inline">true</span>
  }],
  <span class="hljs-comment inline">// WordNet检索的数据</span>
  <span class="hljs-attr inline">definitions</span>: [{
    <span class="hljs-attr inline">text</span>: {
      <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">String</span>,
      <span class="hljs-attr inline">trim</span>: <span class="hljs-literal inline">true</span>,
      <span class="hljs-attr inline">maxlength</span>: <span class="hljs-number inline">1000</span>
    },
    <span class="hljs-attr inline">partOfSpeech</span>: {
      <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">String</span>,
      <span class="hljs-attr inline">enum</span>: [<span class="hljs-string inline">&#x27;noun&#x27;</span>, <span class="hljs-string inline">&#x27;verb&#x27;</span>, <span class="hljs-string inline">&#x27;adjective&#x27;</span>, <span class="hljs-string inline">&#x27;adverb&#x27;</span>, <span class="hljs-string inline">&#x27;preposition&#x27;</span>, 
             <span class="hljs-string inline">&#x27;conjunction&#x27;</span>, <span class="hljs-string inline">&#x27;interjection&#x27;</span>, <span class="hljs-string inline">&#x27;pronoun&#x27;</span>, <span class="hljs-string inline">&#x27;determiner&#x27;</span>, 
             <span class="hljs-string inline">&#x27;adjective satellite&#x27;</span>]
    }
  }],
  <span class="hljs-comment inline">// 主要词性（最常见的）</span>
  <span class="hljs-attr inline">primaryPartOfSpeech</span>: {
    <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">String</span>,
    <span class="hljs-attr inline">enum</span>: [<span class="hljs-string inline">&#x27;noun&#x27;</span>, <span class="hljs-string inline">&#x27;verb&#x27;</span>, <span class="hljs-string inline">&#x27;adjective&#x27;</span>, <span class="hljs-string inline">&#x27;adverb&#x27;</span>, <span class="hljs-string inline">&#x27;preposition&#x27;</span>, 
           <span class="hljs-string inline">&#x27;conjunction&#x27;</span>, <span class="hljs-string inline">&#x27;interjection&#x27;</span>, <span class="hljs-string inline">&#x27;pronoun&#x27;</span>, <span class="hljs-string inline">&#x27;determiner&#x27;</span>, 
           <span class="hljs-string inline">&#x27;adjective satellite&#x27;</span>]
  },
  <span class="hljs-comment inline">// 主要定义（第一个/最常见的）</span>
  <span class="hljs-attr inline">primaryDefinition</span>: {
    <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">String</span>,
    <span class="hljs-attr inline">trim</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">maxlength</span>: <span class="hljs-number inline">1000</span>
  },
  <span class="hljs-attr inline">usageCount</span>: {
    <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">Number</span>,
    <span class="hljs-attr inline">default</span>: <span class="hljs-number inline">0</span>,
    <span class="hljs-attr inline">min</span>: <span class="hljs-number inline">0</span>
  },
  <span class="hljs-comment inline">// 跟踪WordNet查找是否成功</span>
  <span class="hljs-attr inline">wordNetProcessed</span>: {
    <span class="hljs-attr inline">type</span>: <span class="hljs-title class_ inline">Boolean</span>,
    <span class="hljs-attr inline">default</span>: <span class="hljs-literal inline">false</span>
  }
}, {
  <span class="hljs-attr inline">timestamps</span>: <span class="hljs-literal inline">true</span>
})
</code></pre>
            </div>
        
<h3 id="复合索引的性能优化" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#复合索引的性能优化" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 复合索引的性能优化">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            复合索引的性能优化
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">索引设计是数据库性能的关键：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95%E9%98%B2%E6%AD%A2%E6%AF%8F%E5%90%8D%E7%94%A8%E6%88%B7%E4%B8%8A%E4%BC%A0%E7%9A%84%E9%87%8D%E5%A4%8D%E5%8D%95%E8%AF%8D%0AwordSchema.index(%7B%20word%3A%201%2C%20userIds%3A%201%20%7D%2C%20%7B%20unique%3A%20true%20%7D)%0A%2F%2F%20%E6%8F%90%E9%AB%98%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E7%9A%84%E7%B4%A2%E5%BC%95%0AwordSchema.index(%7B%20userIds%3A%201%2C%20createdAt%3A%20-1%20%7D)%0AwordSchema.index(%7B%20usageCount%3A%20-1%20%7D)%0AwordSchema.index(%7B%20primaryPartOfSpeech%3A%201%20%7D)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 复合索引防止每名用户上传的重复单词</span>
wordSchema.<span class="hljs-title function_ inline">index</span>({ <span class="hljs-attr inline">word</span>: <span class="hljs-number inline">1</span>, <span class="hljs-attr inline">userIds</span>: <span class="hljs-number inline">1</span> }, { <span class="hljs-attr inline">unique</span>: <span class="hljs-literal inline">true</span> })

<span class="hljs-comment inline">// 提高查询性能的索引</span>
wordSchema.<span class="hljs-title function_ inline">index</span>({ <span class="hljs-attr inline">userIds</span>: <span class="hljs-number inline">1</span>, <span class="hljs-attr inline">createdAt</span>: -<span class="hljs-number inline">1</span> })
wordSchema.<span class="hljs-title function_ inline">index</span>({ <span class="hljs-attr inline">usageCount</span>: -<span class="hljs-number inline">1</span> })
wordSchema.<span class="hljs-title function_ inline">index</span>({ <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-number inline">1</span> })
</code></pre>
            </div>
        
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">索引性能分析</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">无索引查询</strong>：O(n) 时间复杂度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">有索引查询</strong>：O(log n) 时间复杂度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">复合索引</strong>：支持多字段查询优化</li>
</ul>
<h3 id="多用户数据共享机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#多用户数据共享机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 多用户数据共享机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            多用户数据共享机制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">同一个单词可以被多个用户共享：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E9%9A%94%E7%A6%BB%E4%B8%8E%E5%85%B1%E4%BA%AB%E7%9A%84%E5%B9%B3%E8%A1%A1%0Aconst%20query%20%3D%20%7B%20userIds%3A%20req.user.id%20%7D%0A%2F%2F%20%E5%A6%82%E6%9E%9C%E5%8D%95%E8%AF%8D%E5%B7%B2%E5%AD%98%E5%9C%A8%EF%BC%8C%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E5%85%B1%E4%BA%AB%E5%88%97%E8%A1%A8%0Aif%20(existingWord)%20%7B%0Aif%20(existingWord.userIds.includes(req.user.id))%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('words.wordAlreadyExists')%0A%7D)%0A%7D%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%88%B0%E7%8E%B0%E6%9C%89%E5%8D%95%E8%AF%8D%0AexistingWord.userIds.push(req.user.id)%0Aawait%20existingWord.save()%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 用户数据隔离与共享的平衡</span>
<span class="hljs-keyword inline">const</span> query = { <span class="hljs-attr inline">userIds</span>: req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span> }

<span class="hljs-comment inline">// 如果单词已存在，添加用户到共享列表</span>
<span class="hljs-keyword inline">if</span> (existingWord) {
  <span class="hljs-keyword inline">if</span> (existingWord.<span class="hljs-property inline">userIds</span>.<span class="hljs-title function_ inline">includes</span>(req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>)) {
    <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordAlreadyExists&#x27;</span>)
    })
  }
  
  <span class="hljs-comment inline">// 添加用户到现有单词</span>
  existingWord.<span class="hljs-property inline">userIds</span>.<span class="hljs-title function_ inline">push</span>(req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>)
  <span class="hljs-keyword inline">await</span> existingWord.<span class="hljs-title function_ inline">save</span>()
}
</code></pre>
            </div>
        
<h2 id="后端控制器逻辑深度剖析：restful" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#后端控制器逻辑深度剖析：restful" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 后端控制器逻辑深度剖析：RESTful">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            后端控制器逻辑深度剖析：RESTful
        </h2>
<h3 id="数据验证schema设计" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#数据验证schema设计" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 数据验证Schema设计">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            数据验证Schema设计
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">Joi数据验证：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%BE%93%E5%85%A5%E9%AA%8C%E8%AF%81Schema%0Aconst%20addWordSchema%20%3D%20Joi.object(%7B%0Aword%3A%20Joi.string()%0A.min(1)%0A.max(50)%0A.pattern(%2F%5E%5Ba-zA-Z%5C-'%5D%2B%24%2F)%0A.required()%0A%7D)%0A%2F%2F%20%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%AD%E4%BD%BF%E7%94%A8%0Aconst%20%7B%20error%20%7D%20%3D%20addWordSchema.validate(req.body)%0Aif%20(error)%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20error.details%5B0%5D.message%0A%7D)%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 输入验证Schema</span>
<span class="hljs-keyword inline">const</span> addWordSchema = <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">object</span>({
  <span class="hljs-attr inline">word</span>: <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">string</span>()
    .<span class="hljs-title function_ inline">min</span>(<span class="hljs-number inline">1</span>)
    .<span class="hljs-title function_ inline">max</span>(<span class="hljs-number inline">50</span>)
    .<span class="hljs-title function_ inline">pattern</span>(<span class="hljs-regexp inline">/^[a-zA-Z\-&#x27;]+$/</span>)
    .<span class="hljs-title function_ inline">required</span>()
})

<span class="hljs-comment inline">// 在控制器中使用</span>
<span class="hljs-keyword inline">const</span> { error } = addWordSchema.<span class="hljs-title function_ inline">validate</span>(req.<span class="hljs-property inline">body</span>)
<span class="hljs-keyword inline">if</span> (error) {
  <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
    <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
    <span class="hljs-attr inline">message</span>: error.<span class="hljs-property inline">details</span>[<span class="hljs-number inline">0</span>].<span class="hljs-property inline">message</span>
  })
}
</code></pre>
            </div>
        
<h3 id="分页查询" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#分页查询" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 分页查询">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            分页查询
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20getUserWords%20-%20%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%AE%9E%E7%8E%B0%0Aconst%20%7B%20page%20%3D%201%2C%20limit%20%3D%2050%2C%20sortBy%20%3D%20'recent'%2C%20search%2C%20partOfSpeech%20%7D%20%3D%20req.query%0Aconst%20skip%20%3D%20(page%20-%201)%20*%20limit%0A%2F%2F%20%E6%9E%84%E5%BB%BA%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6%0Aconst%20query%20%3D%20%7B%20userIds%3A%20req.user.id%20%7D%0A%2F%2F%20%E6%90%9C%E7%B4%A2%E8%BF%87%E6%BB%A4%0Aif%20(search)%20%7B%0Aquery.word%20%3D%20%7B%20%24regex%3A%20search.trim()%2C%20%24options%3A%20'i'%20%7D%0A%7D%0A%2F%2F%20%E8%AF%8D%E6%80%A7%E8%BF%87%E6%BB%A4%0Aif%20(partOfSpeech%20%26%26%20partOfSpeech%20!%3D%3D%20'all')%20%7B%0Aquery.primaryPartOfSpeech%20%3D%20partOfSpeech%0A%7D%0A%2F%2F%20%E6%8E%92%E5%BA%8F%E6%9D%A1%E4%BB%B6%0Alet%20sortCriteria%0Aswitch%20(sortBy)%20%7B%0Acase%20'alphabetical'%3A%0AsortCriteria%20%3D%20%7B%20word%3A%201%20%7D%0Abreak%0Acase%20'usage'%3A%0AsortCriteria%20%3D%20%7B%20usageCount%3A%20-1%2C%20createdAt%3A%20-1%20%7D%0Abreak%0Adefault%3A%0AsortCriteria%20%3D%20%7B%20createdAt%3A%20-1%20%7D%0A%7D%0A%2F%2F%20%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%0Aconst%20words%20%3D%20await%20Word.find(query)%0A.sort(sortCriteria)%0A.skip(skip)%0A.limit(parseInt(limit))%0A%2F%2F%20%E6%80%BB%E6%95%B0%E7%BB%9F%E8%AE%A1%0Aconst%20total%20%3D%20await%20Word.countDocuments(query)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// getUserWords - 分页查询实现</span>
<span class="hljs-keyword inline">const</span> { page = <span class="hljs-number inline">1</span>, limit = <span class="hljs-number inline">50</span>, sortBy = <span class="hljs-string inline">&#x27;recent&#x27;</span>, search, partOfSpeech } = req.<span class="hljs-property inline">query</span>
<span class="hljs-keyword inline">const</span> skip = (page - <span class="hljs-number inline">1</span>) * limit

<span class="hljs-comment inline">// 构建查询条件</span>
<span class="hljs-keyword inline">const</span> query = { <span class="hljs-attr inline">userIds</span>: req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span> }

<span class="hljs-comment inline">// 搜索过滤</span>
<span class="hljs-keyword inline">if</span> (search) {
  query.<span class="hljs-property inline">word</span> = { <span class="hljs-attr inline">$regex</span>: search.<span class="hljs-title function_ inline">trim</span>(), <span class="hljs-attr inline">$options</span>: <span class="hljs-string inline">&#x27;i&#x27;</span> }
}

<span class="hljs-comment inline">// 词性过滤</span>
<span class="hljs-keyword inline">if</span> (partOfSpeech &amp;&amp; partOfSpeech !== <span class="hljs-string inline">&#x27;all&#x27;</span>) {
  query.<span class="hljs-property inline">primaryPartOfSpeech</span> = partOfSpeech
}

<span class="hljs-comment inline">// 排序条件</span>
<span class="hljs-keyword inline">let</span> sortCriteria
<span class="hljs-keyword inline">switch</span> (sortBy) {
  <span class="hljs-keyword inline">case</span> <span class="hljs-string inline">&#x27;alphabetical&#x27;</span>:
    sortCriteria = { <span class="hljs-attr inline">word</span>: <span class="hljs-number inline">1</span> }
    <span class="hljs-keyword inline">break</span>
  <span class="hljs-keyword inline">case</span> <span class="hljs-string inline">&#x27;usage&#x27;</span>:
    sortCriteria = { <span class="hljs-attr inline">usageCount</span>: -<span class="hljs-number inline">1</span>, <span class="hljs-attr inline">createdAt</span>: -<span class="hljs-number inline">1</span> }
    <span class="hljs-keyword inline">break</span>
  <span class="hljs-attr inline">default</span>:
    sortCriteria = { <span class="hljs-attr inline">createdAt</span>: -<span class="hljs-number inline">1</span> }
}

<span class="hljs-comment inline">// 分页查询</span>
<span class="hljs-keyword inline">const</span> words = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">Word</span>.<span class="hljs-title function_ inline">find</span>(query)
  .<span class="hljs-title function_ inline">sort</span>(sortCriteria)
  .<span class="hljs-title function_ inline">skip</span>(skip)
  .<span class="hljs-title function_ inline">limit</span>(<span class="hljs-built_in inline">parseInt</span>(limit))

<span class="hljs-comment inline">// 总数统计</span>
<span class="hljs-keyword inline">const</span> total = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">Word</span>.<span class="hljs-title function_ inline">countDocuments</span>(query)
</code></pre>
            </div>
        
<h3 id="错误处理的标准化实现" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#错误处理的标准化实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 错误处理的标准化实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            错误处理的标准化实现
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">统一的错误处理机制：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E6%A0%87%E5%87%86%E5%8C%96%E7%9A%84%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%0Atry%20%7B%0A%2F%2F%20%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%0A%7D%20catch%20(error)%20%7B%0Aif%20(error.code%20%3D%3D%3D%2011000)%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('words.wordAlreadyExists')%0A%7D)%0A%7D%0Aconsole.error('Add%20word%20error%3A'%2C%20error)%0Ares.status(500).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('words.serverErrorAddingWord')%0A%7D)%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 标准化的错误处理</span>
<span class="hljs-keyword inline">try</span> {
  <span class="hljs-comment inline">// 业务逻辑</span>
} <span class="hljs-keyword inline">catch</span> (error) {
  <span class="hljs-keyword inline">if</span> (error.<span class="hljs-property inline">code</span> === <span class="hljs-number inline">11000</span>) {
    <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordAlreadyExists&#x27;</span>)
    })
  }
  <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Add word error:&#x27;</span>, error)
  res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">500</span>).<span class="hljs-title function_ inline">json</span>({
    <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
    <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.serverErrorAddingWord&#x27;</span>)
  })
}
</code></pre>
            </div>
        
<h2 id="智能推荐：mongodb聚合" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#智能推荐：mongodb聚合" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 智能推荐：MongoDB聚合">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            智能推荐：MongoDB聚合
        </h2>
<h3 id="随机单词推荐算法" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#随机单词推荐算法" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 随机单词推荐算法">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            随机单词推荐算法
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">使用MongoDB的聚合管道实现智能的单词推荐功能：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20getRandomWords%20-%20%E6%99%BA%E8%83%BD%E6%8E%A8%E8%8D%90%E5%AE%9E%E7%8E%B0%0Aconst%20%7B%20count%2C%20excludeUserWords%2C%20partOfSpeech%20%7D%20%3D%20value%0A%2F%2F%20%E6%9E%84%E5%BB%BA%E8%81%9A%E5%90%88%E7%AE%A1%E9%81%93%0Alet%20aggregationPipeline%20%3D%20%5B%5D%0A%2F%2F%20%E6%9E%84%E5%BB%BA%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6%0Alet%20matchCriteria%20%3D%20%7B%7D%0A%2F%2F%20%E6%8E%92%E9%99%A4%E7%94%A8%E6%88%B7%E5%B7%B2%E6%9C%89%E5%8D%95%E8%AF%8D%0Aif%20(excludeUserWords)%20%7B%0AmatchCriteria.userIds%20%3D%20%7B%20%24ne%3A%20req.user.id%20%7D%0A%7D%0A%2F%2F%20%E8%AF%8D%E6%80%A7%E8%BF%87%E6%BB%A4%0Aif%20(partOfSpeech)%20%7B%0AmatchCriteria.primaryPartOfSpeech%20%3D%20partOfSpeech%0A%7D%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E5%8C%B9%E9%85%8D%E9%98%B6%E6%AE%B5%0Aif%20(Object.keys(matchCriteria).length%20%3E%200)%20%7B%0AaggregationPipeline.push(%7B%20%24match%3A%20matchCriteria%20%7D)%0A%7D%0A%2F%2F%20%E9%9A%8F%E6%9C%BA%E9%87%87%E6%A0%B7%0AaggregationPipeline.push(%7B%0A%24sample%3A%20%7B%20size%3A%20count%20*%202%20%7D%20%2F%2F%20%E8%8E%B7%E5%8F%96%E6%AF%94%E9%9C%80%E8%A6%81%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BB%A5%E5%BA%94%E5%AF%B9%E8%BF%87%E6%BB%A4%0A%7D)%0A%2F%2F%20%E6%8A%95%E5%BD%B1%E6%89%80%E9%9C%80%E5%AD%97%E6%AE%B5%0AaggregationPipeline.push(%7B%0A%24project%3A%20%7B%0A_id%3A%201%2C%0Aword%3A%201%2C%0AprimaryDefinition%3A%201%2C%0AprimaryPartOfSpeech%3A%201%2C%0AusageCount%3A%201%0A%7D%0A%7D)%0A%2F%2F%20%E6%89%A7%E8%A1%8C%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2%0Alet%20randomWords%20%3D%20await%20Word.aggregate(aggregationPipeline)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// getRandomWords - 智能推荐实现</span>
<span class="hljs-keyword inline">const</span> { count, excludeUserWords, partOfSpeech } = value

<span class="hljs-comment inline">// 构建聚合管道</span>
<span class="hljs-keyword inline">let</span> aggregationPipeline = []

<span class="hljs-comment inline">// 构建匹配条件</span>
<span class="hljs-keyword inline">let</span> matchCriteria = {}

<span class="hljs-comment inline">// 排除用户已有单词</span>
<span class="hljs-keyword inline">if</span> (excludeUserWords) {
  matchCriteria.<span class="hljs-property inline">userIds</span> = { <span class="hljs-attr inline">$ne</span>: req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span> }
}

<span class="hljs-comment inline">// 词性过滤</span>
<span class="hljs-keyword inline">if</span> (partOfSpeech) {
  matchCriteria.<span class="hljs-property inline">primaryPartOfSpeech</span> = partOfSpeech
}

<span class="hljs-comment inline">// 添加匹配阶段</span>
<span class="hljs-keyword inline">if</span> (<span class="hljs-title class_ inline">Object</span>.<span class="hljs-title function_ inline">keys</span>(matchCriteria).<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>) {
  aggregationPipeline.<span class="hljs-title function_ inline">push</span>({ <span class="hljs-attr inline">$match</span>: matchCriteria })
}

<span class="hljs-comment inline">// 随机采样</span>
aggregationPipeline.<span class="hljs-title function_ inline">push</span>({
  <span class="hljs-attr inline">$sample</span>: { <span class="hljs-attr inline">size</span>: count * <span class="hljs-number inline">2</span> } <span class="hljs-comment inline">// 获取比需要更多的数据以应对过滤</span>
})

<span class="hljs-comment inline">// 投影所需字段</span>
aggregationPipeline.<span class="hljs-title function_ inline">push</span>({
  <span class="hljs-attr inline">$project</span>: {
    <span class="hljs-attr inline">_id</span>: <span class="hljs-number inline">1</span>,
    <span class="hljs-attr inline">word</span>: <span class="hljs-number inline">1</span>,
    <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-number inline">1</span>,
    <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-number inline">1</span>,
    <span class="hljs-attr inline">usageCount</span>: <span class="hljs-number inline">1</span>
  }
})

<span class="hljs-comment inline">// 执行聚合查询</span>
<span class="hljs-keyword inline">let</span> randomWords = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">Word</span>.<span class="hljs-title function_ inline">aggregate</span>(aggregationPipeline)
</code></pre>
            </div>
        
<h3 id="推荐算法的性能优化" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#推荐算法的性能优化" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 推荐算法的性能优化">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            推荐算法的性能优化
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">MongoDB的<code>$sample</code>操作符使用了高效的随机采样算法：</p>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">算法复杂度分析</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">随机采样</strong>：O(1) 时间复杂度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">传统排序</strong>：O(n log n) 时间复杂度</li>
<li class="text-foreground leading-relaxed"><strong class="font-bold text-foreground">性能提升</strong>：当n=100万时，提升约3000倍</li>
</ul>
<h3 id="个性化过滤机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#个性化过滤机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 个性化过滤机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            个性化过滤机制
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">系统支持多层次的个性化过滤：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%A4%9A%E5%B1%82%E8%BF%87%E6%BB%A4%E6%9C%BA%E5%88%B6%0Aconst%20fallbackWords%20%3D%20await%20Word.aggregate(fallbackPipeline)%0A%2F%2F%20%E5%90%88%E5%B9%B6%E7%BB%93%E6%9E%9C%EF%BC%8C%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%0Aconst%20existingWordIds%20%3D%20new%20Set(randomWords.map(w%20%3D%3E%20w._id.toString()))%0Aconst%20newWords%20%3D%20fallbackWords.filter(w%20%3D%3E%20!existingWordIds.has(w._id.toString()))%0ArandomWords%20%3D%20%5B...randomWords%2C%20...newWords%5D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 多层过滤机制</span>
<span class="hljs-keyword inline">const</span> fallbackWords = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">Word</span>.<span class="hljs-title function_ inline">aggregate</span>(fallbackPipeline)

<span class="hljs-comment inline">// 合并结果，避免重复</span>
<span class="hljs-keyword inline">const</span> existingWordIds = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Set</span>(randomWords.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">w</span> =&gt;</span> w.<span class="hljs-property inline">_id</span>.<span class="hljs-title function_ inline">toString</span>()))
<span class="hljs-keyword inline">const</span> newWords = fallbackWords.<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">w</span> =&gt;</span> !existingWordIds.<span class="hljs-title function_ inline">has</span>(w.<span class="hljs-property inline">_id</span>.<span class="hljs-title function_ inline">toString</span>()))

randomWords = [...randomWords, ...newWords]
</code></pre>
            </div>
        
<h2 id="完整数据流向分析：从输入到存储" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#完整数据流向分析：从输入到存储" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 完整数据流向分析：从输入到存储">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            完整数据流向分析：从输入到存储
        </h2>
<h3 id="完整流程图" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#完整流程图" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 完整流程图">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            完整流程图
        </h3>
<div class="mermaid block" id="mermaid-1765738202639-hj6v6vd">graph TD
    A[用户输入单词] --> B[前端验证]
    B --> C[发送API请求]
    C --> D[后端接收请求]
    D --> E[Joi数据验证]
    E --> F[拼写检查Typo.js]
    F --> G{拼写正确?}
    G -->|否| H[返回拼写建议]
    G -->|是| I[WordNet词性分析]
    I --> J[数据库查询]
    J --> K{单词存在?}
    K -->|是| L[添加用户到共享列表]
    K -->|否| M[创建新单词记录]
    L --> N[返回成功响应]
    M --> N
    N --> O[前端更新状态]
    O --> P[界面刷新展示]
    H --> Q[用户选择建议]
    Q --> C</div>
<h2 id="技术库工具链" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#技术库工具链" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 技术库工具链">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            技术库工具链
        </h2>
<h3 id="typojs" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#typojs" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Typo.js">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Typo.js
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">技术特点</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">基于Hunspell算法</li>
<li class="text-foreground leading-relaxed">支持离线工作</li>
<li class="text-foreground leading-relaxed">轻量级（约100KB）</li>
<li class="text-foreground leading-relaxed">多语言支持</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">使用场景</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">实时拼写验证</li>
<li class="text-foreground leading-relaxed">用户输入纠错</li>
<li class="text-foreground leading-relaxed">批量文本处理</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">性能特点</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">初始化时间：50-100ms</li>
<li class="text-foreground leading-relaxed">单词检查：&lt;1ms</li>
<li class="text-foreground leading-relaxed">建议生成：1-5ms</li>
</ul>
<h3 id="wordnet：语义网络的数字化" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#wordnet：语义网络的数字化" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to WordNet：语义网络的数字化">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            WordNet：语义网络的数字化
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">数据结构</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">名词：约117,000个</li>
<li class="text-foreground leading-relaxed">动词：约11,500个</li>
<li class="text-foreground leading-relaxed">形容词：约22,000个</li>
<li class="text-foreground leading-relaxed">副词：约4,600个</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">语义关系</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">同义词（synonyms）</li>
<li class="text-foreground leading-relaxed">反义词（antonyms）</li>
<li class="text-foreground leading-relaxed">上下位关系（hypernyms/hyponyms）</li>
<li class="text-foreground leading-relaxed">部分整体关系（meronyms/holonyms）</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">使用优势</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">准确的词性标注</li>
<li class="text-foreground leading-relaxed">丰富的语义信息</li>
<li class="text-foreground leading-relaxed">标准化的定义</li>
</ul>
<h3 id="joi：数据验证的艺术" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#joi：数据验证的艺术" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Joi：数据验证的艺术">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Joi：数据验证的艺术
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">设计理念</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">声明式验证</li>
<li class="text-foreground leading-relaxed">链式API</li>
<li class="text-foreground leading-relaxed">丰富的内置规则</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">性能优势</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">验证速度：微秒级</li>
<li class="text-foreground leading-relaxed">内存占用：轻量级</li>
<li class="text-foreground leading-relaxed">错误信息：友好明确</li>
</ul>
<h3 id="mongoose：mongodb的查询构建器" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#mongoose：mongodb的查询构建器" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to Mongoose：MongoDB的查询构建器">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            Mongoose：MongoDB的查询构建器
        </h3>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">ORM特点</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">类型安全的模型定义</li>
<li class="text-foreground leading-relaxed">中间件支持</li>
<li class="text-foreground leading-relaxed">查询构建器</li>
<li class="text-foreground leading-relaxed">自动类型转换</li>
</ul>
<p class="text-base leading-7 mb-4 text-foreground"><strong class="font-bold text-foreground">性能优化</strong>：</p>
<ul class="list-disc list-inside mb-4 pl-6 space-y-2">
<li class="text-foreground leading-relaxed">连接池管理</li>
<li class="text-foreground leading-relaxed">查询优化</li>
<li class="text-foreground leading-relaxed">索引建议</li>
</ul>
<h2 id="后端国际化响应实现" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#后端国际化响应实现" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 后端国际化响应实现">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            后端国际化响应实现
        </h2>
<h3 id="请求头的语言协商" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#请求头的语言协商" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 请求头的语言协商">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            请求头的语言协商
        </h3>
<p class="text-base leading-7 mb-4 text-foreground">前端通过HTTP请求头来实现语言协商：</p>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="%2F%2F%20%E8%AF%AD%E8%A8%80%E5%8D%8F%E5%95%86%E7%9A%84%E5%AE%8C%E6%95%B4%E5%AE%9E%E7%8E%B0%0Aconst%20getCurrentLocale%20%3D%20()%20%3D%3E%20%7B%0Areturn%20localStorage.getItem('locale')%20%7C%7C%0Anavigator.language.split('-')%5B0%5D%20%7C%7C%0A'en'%0A%7D%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA%E5%99%A8%E4%B8%AD%E7%9A%84%E8%AF%AD%E8%A8%80%E8%AE%BE%E7%BD%AE%0Aif%20(locale)%20%7B%0Aconfig.headers%5B'x-language'%5D%20%3D%20locale%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-comment inline">// 语言协商的完整实现</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getCurrentLocale</span> = (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">return</span> <span class="hljs-variable language_ inline">localStorage</span>.<span class="hljs-title function_ inline">getItem</span>(<span class="hljs-string inline">&#x27;locale&#x27;</span>) || 
         navigator.<span class="hljs-property inline">language</span>.<span class="hljs-title function_ inline">split</span>(<span class="hljs-string inline">&#x27;-&#x27;</span>)[<span class="hljs-number inline">0</span>] || 
         <span class="hljs-string inline">&#x27;en&#x27;</span>
}

<span class="hljs-comment inline">// 请求拦截器中的语言设置</span>
<span class="hljs-keyword inline">if</span> (locale) {
  config.<span class="hljs-property inline">headers</span>[<span class="hljs-string inline">&#x27;x-language&#x27;</span>] = locale
}
</code></pre>
            </div>
        
<h3 id="后端中间件的国际化处理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#后端中间件的国际化处理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 后端中间件的国际化处理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            后端中间件的国际化处理
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%9B%BD%E9%99%85%E5%8C%96%E4%B8%AD%E9%97%B4%E4%BB%B6%0Aconst%20i18nMiddleware%20%3D%20(req%2C%20res%2C%20next)%20%3D%3E%20%7B%0Aconst%20locale%20%3D%20req.headers%5B'x-language'%5D%20%7C%7C%20'en'%0A%2F%2F%20%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E8%AF%B7%E6%B1%82%E7%9A%84%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%0Areq.locale%20%3D%20locale%0A%2F%2F%20%E5%88%9B%E5%BB%BA%E7%BF%BB%E8%AF%91%E5%87%BD%E6%95%B0%0Areq.t%20%3D%20(key%2C%20options)%20%3D%3E%20%7B%0Areturn%20i18n.t(key%2C%20%7B%20locale%2C%20...options%20%7D)%0A%7D%0Anext()%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 国际化中间件</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">i18nMiddleware</span> = (<span class="hljs-params inline">req, res, next</span>) =&gt; {
  <span class="hljs-keyword inline">const</span> locale = req.<span class="hljs-property inline">headers</span>[<span class="hljs-string inline">&#x27;x-language&#x27;</span>] || <span class="hljs-string inline">&#x27;en&#x27;</span>
  
  <span class="hljs-comment inline">// 设置当前请求的语言环境</span>
  req.<span class="hljs-property inline">locale</span> = locale
  
  <span class="hljs-comment inline">// 创建翻译函数</span>
  req.<span class="hljs-property inline">t</span> = <span class="hljs-function inline">(<span class="hljs-params inline">key, options</span>) =&gt;</span> {
    <span class="hljs-keyword inline">return</span> i18n.<span class="hljs-title function_ inline">t</span>(key, { locale, ...options })
  }
  
  <span class="hljs-title function_ inline">next</span>()
}
</code></pre>
            </div>
        
<h3 id="实时语言切换的技术方案" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#实时语言切换的技术方案" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 实时语言切换的技术方案">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            实时语言切换的技术方案
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E8%AF%8D%E6%80%A7%E7%BF%BB%E8%AF%91%E7%9A%84%E5%AE%9E%E6%97%B6%E6%9B%B4%E6%96%B0%0Aconst%20updateWordTranslations%20%3D%20(words%2C%20locale)%20%3D%3E%20%7B%0Areturn%20words.map(word%20%3D%3E%20%7B%0Aif%20(word.primaryPartOfSpeech)%20%7B%0Aword.primaryPartOfSpeechTranslated%20%3D%0Ai18n.t(%60words.%24%7Bword.primaryPartOfSpeech%7D%60%2C%20%7B%20locale%20%7D)%0A%7D%0Areturn%20word%0A%7D)%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 词性翻译的实时更新</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">updateWordTranslations</span> = (<span class="hljs-params inline">words, locale</span>) =&gt; {
  <span class="hljs-keyword inline">return</span> words.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">word</span> =&gt;</span> {
    <span class="hljs-keyword inline">if</span> (word.<span class="hljs-property inline">primaryPartOfSpeech</span>) {
      word.<span class="hljs-property inline">primaryPartOfSpeechTranslated</span> = 
        i18n.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">`words.<span class="hljs-subst inline">${word.primaryPartOfSpeech}</span>`</span>, { locale })
    }
    <span class="hljs-keyword inline">return</span> word
  })
}
</code></pre>
            </div>
        
<h2 id="用户体验" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#用户体验" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 用户体验">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            用户体验
        </h2>
<h3 id="实时反馈机制" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#实时反馈机制" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 实时反馈机制">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            实时反馈机制
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%AE%9E%E6%97%B6%E7%9A%84%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88%0Aconst%20addWord%20%3D%20async%20()%20%3D%3E%20%7B%0Aif%20(!newWord.word.trim())%20return%0A%2F%2F%20%E6%B8%85%E9%99%A4%E4%B9%8B%E5%89%8D%E7%9A%84%E9%94%99%E8%AF%AF%E7%8A%B6%E6%80%81%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0Aconst%20result%20%3D%20await%20wordsStore.addWord(%7B%0Aword%3A%20newWord.word.trim()%0A%7D)%0Aif%20(result.success)%20%7B%0A%2F%2F%20%E6%88%90%E5%8A%9F%E5%8F%8D%E9%A6%88%0AnewWord.word%20%3D%20''%0AshowAddForm.value%20%3D%20false%0A%7D%20else%20if%20(result.suggestions)%20%7B%0A%2F%2F%20%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%E5%8F%8D%E9%A6%88%0AspellingError.value%20%3D%20true%0AspellingSuggestions.value%20%3D%20result.suggestions%0A%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 实时的用户反馈</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">addWord</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()) <span class="hljs-keyword inline">return</span>
  
  <span class="hljs-comment inline">// 清除之前的错误状态</span>
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
  
  <span class="hljs-keyword inline">const</span> result = <span class="hljs-keyword inline">await</span> wordsStore.<span class="hljs-title function_ inline">addWord</span>({
    <span class="hljs-attr inline">word</span>: newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()
  })
  
  <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">success</span>) {
    <span class="hljs-comment inline">// 成功反馈</span>
    newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
    showAddForm.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">suggestions</span>) {
    <span class="hljs-comment inline">// 拼写错误反馈</span>
    spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">true</span>
    spellingSuggestions.<span class="hljs-property inline">value</span> = result.<span class="hljs-property inline">suggestions</span>
  }
}
</code></pre>
            </div>
        
<h3 id="错误处理" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#错误处理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 错误处理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            错误处理
        </h3>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="%2F%2F%20%E5%8F%8B%E5%A5%BD%E7%9A%84%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%0Atry%20%7B%0Aconst%20response%20%3D%20await%20wordsAPI.addWord(newWord)%0A%2F%2F%20...%0A%7D%20catch%20(error)%20%7B%0Aconst%20message%20%3D%20error.response%3F.data%3F.message%20%7C%7C%20t('common.error')%0A%2F%2F%20%E7%89%B9%E6%AE%8A%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%0Aif%20(error.response%3F.data%3F.error%20%3D%3D%3D%20'SPELLING_ERROR')%20%7B%0Aconst%20suggestions%20%3D%20error.response.data.suggestions%20%7C%7C%20%5B%5D%0Aconst%20suggestionText%20%3D%20suggestions.length%20%3E%200%0A%3F%20t('words.spellingErrorWithSuggestions'%2C%20%7B%0Asuggestions%3A%20suggestions.join('%2C%20')%0A%7D)%0A%3A%20t('words.spellingError')%0Atoast.error(suggestionText)%0Areturn%20%7B%20success%3A%20false%2C%20message%3A%20suggestionText%2C%20suggestions%20%7D%0A%7D%0Atoast.error(message)%0Areturn%20%7B%20success%3A%20false%2C%20message%20%7D%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-comment inline">// 友好的错误处理</span>
<span class="hljs-keyword inline">try</span> {
  <span class="hljs-keyword inline">const</span> response = <span class="hljs-keyword inline">await</span> wordsAPI.<span class="hljs-title function_ inline">addWord</span>(newWord)
  <span class="hljs-comment inline">// ...</span>
} <span class="hljs-keyword inline">catch</span> (error) {
  <span class="hljs-keyword inline">const</span> message = error.<span class="hljs-property inline">response</span>?.<span class="hljs-property inline">data</span>?.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;common.error&#x27;</span>)
  
  <span class="hljs-comment inline">// 特殊错误处理</span>
  <span class="hljs-keyword inline">if</span> (error.<span class="hljs-property inline">response</span>?.<span class="hljs-property inline">data</span>?.<span class="hljs-property inline">error</span> === <span class="hljs-string inline">&#x27;SPELLING_ERROR&#x27;</span>) {
    <span class="hljs-keyword inline">const</span> suggestions = error.<span class="hljs-property inline">response</span>.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">suggestions</span> || []
    <span class="hljs-keyword inline">const</span> suggestionText = suggestions.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
      ? <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.spellingErrorWithSuggestions&#x27;</span>, { 
          <span class="hljs-attr inline">suggestions</span>: suggestions.<span class="hljs-title function_ inline">join</span>(<span class="hljs-string inline">&#x27;, &#x27;</span>) 
        })
      : <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.spellingError&#x27;</span>)
    
    toast.<span class="hljs-title function_ inline">error</span>(suggestionText)
    <span class="hljs-keyword inline">return</span> { <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, <span class="hljs-attr inline">message</span>: suggestionText, suggestions }
  }
  
  toast.<span class="hljs-title function_ inline">error</span>(message)
  <span class="hljs-keyword inline">return</span> { <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, message }
}
</code></pre>
            </div>
        
<h2 id="完整源码全解析" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#完整源码全解析" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 完整源码全解析">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            完整源码全解析
        </h2>
<h3 id="后端核心文件" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#后端核心文件" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 后端核心文件">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            后端核心文件
        </h3>
<h4 id="1-wordcontrollerjs-单词控制器" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#1-wordcontrollerjs-单词控制器" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 1. wordController.js - 单词控制器">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            1. wordController.js - 单词控制器
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20Word%20%3D%20require('..%2Fmodels%2FWord')%3B%0Aconst%20Joi%20%3D%20require('joi')%3B%0Aconst%20%7B%20processWord%20%7D%20%3D%20require('..%2Futils%2FwordUtils')%3B%0A%2F%2F%20%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81Schema%20-%20%E5%A2%9E%E5%8A%A0forceAdd%E5%8F%82%E6%95%B0%E6%94%AF%E6%8C%81%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%0Aconst%20addWordSchema%20%3D%20Joi.object(%7B%0Aword%3A%20Joi.string().min(1).max(50).pattern(%2F%5E%5Ba-zA-Z%5C-'%5D%2B%24%2F).required()%2C%0AforceAdd%3A%20Joi.boolean().default(false)%20%2F%2F%20%E6%96%B0%E5%A2%9E%EF%BC%9A%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E6%A0%87%E5%BF%97%0A%7D)%3B%0A%2F%2F%20%40desc%20%20%20%20%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%8D%95%E8%AF%8D%0A%2F%2F%20%40route%20%20%20POST%20%2Fapi%2Fwords%0A%2F%2F%20%40access%20%20Private%0Aexports.addWord%20%3D%20async%20(req%2C%20res)%20%3D%3E%20%7B%0Atry%20%7B%0A%2F%2F%20%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E9%AA%8C%E8%AF%81%E8%BE%93%E5%85%A5%E6%95%B0%E6%8D%AE%0Aconst%20%7B%20error%20%7D%20%3D%20addWordSchema.validate(req.body)%3B%0Aif%20(error)%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20error.details%5B0%5D.message%0A%7D)%3B%0A%7D%0A%2F%2F%20%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E6%8F%90%E5%8F%96%E5%8F%82%E6%95%B0%E5%B9%B6%E6%B8%85%E7%90%86%E8%BE%93%E5%85%A5%0Aconst%20%7B%20word%2C%20forceAdd%20%7D%20%3D%20req.body%3B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%3B%0A%2F%2F%20%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%A0%B9%E6%8D%AEforceAdd%E6%A0%87%E5%BF%97%E5%86%B3%E5%AE%9A%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%0Alet%20wordProcessing%3B%0Aif%20(forceAdd)%20%7B%0A%2F%2F%20%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E6%A8%A1%E5%BC%8F%EF%BC%9A%E8%B7%B3%E8%BF%87%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%EF%BC%8C%E7%9B%B4%E6%8E%A5%E8%8E%B7%E5%8F%96WordNet%E6%95%B0%E6%8D%AE%0Aconst%20wordNetData%20%3D%20await%20require('..%2Futils%2FwordUtils').getWordNetData(cleanWord)%3B%0AwordProcessing%20%3D%20%7B%0Asuccess%3A%20true%2C%0Aword%3A%20cleanWord%2C%0A...wordNetData%0A%7D%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E6%AD%A3%E5%B8%B8%E6%A8%A1%E5%BC%8F%EF%BC%9A%E8%BF%9B%E8%A1%8C%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E5%92%8CWordNet%E6%9F%A5%E8%AF%A2%0AwordProcessing%20%3D%20await%20processWord(cleanWord)%3B%0Aif%20(!wordProcessing.success)%20%7B%0A%2F%2F%20%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%E6%97%B6%E8%BF%94%E5%9B%9E%E5%BB%BA%E8%AE%AE%EF%BC%88200%E7%8A%B6%E6%80%81%E7%A0%81%EF%BC%8C%E9%9D%9E%E9%94%99%E8%AF%AF%E5%93%8D%E5%BA%94%EF%BC%89%0Areturn%20res.status(200).json(%7B%0Asuccess%3A%20false%2C%0AneedsConfirmation%3A%20true%2C%20%20%20%20%20%20%20%20%2F%2F%20%E9%9C%80%E8%A6%81%E7%94%A8%E6%88%B7%E7%A1%AE%E8%AE%A4%0AspellingError%3A%20true%2C%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%A0%87%E8%AE%B0%E4%B8%BA%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%0Amessage%3A%20req.t('words.spellingError')%2C%0Asuggestions%3A%20wordProcessing.suggestions%20%7C%7C%20%5B%5D%2C%0AoriginalWord%3A%20wordProcessing.word%2C%0AsuggestedCorrection%3A%20wordProcessing.suggestions%20%26%26%20wordProcessing.suggestions.length%20%3E%200%0A%3F%20wordProcessing.suggestions%5B0%5D%20%3A%20null%0A%7D)%3B%0A%7D%0A%7D%0A%2F%2F%20%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E6%A3%80%E6%9F%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%98%AF%E5%90%A6%E5%B7%B2%E5%AD%98%E5%9C%A8%E8%AF%A5%E5%8D%95%E8%AF%8D%0Aconst%20existingWord%20%3D%20await%20Word.findOne(%7B%0Aword%3A%20cleanWord%0A%7D)%3B%0Aif%20(existingWord)%20%7B%0A%2F%2F%20%E5%8D%95%E8%AF%8D%E5%B7%B2%E5%AD%98%E5%9C%A8%EF%BC%8C%E6%A3%80%E6%9F%A5%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E5%B7%B2%E6%8B%A5%E6%9C%89%0Aif%20(existingWord.userIds.includes(req.user.id))%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('words.wordAlreadyExists')%0A%7D)%3B%0A%7D%0A%2F%2F%20%E5%B0%86%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E5%88%B0%E7%8E%B0%E6%9C%89%E5%8D%95%E8%AF%8D%E7%9A%84%E5%85%B1%E4%BA%AB%E5%88%97%E8%A1%A8%0AexistingWord.userIds.push(req.user.id)%3B%0Aawait%20existingWord.save()%3B%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E7%BF%BB%E8%AF%91%E5%90%8E%E7%9A%84%E8%AF%8D%E6%80%A7%E4%BF%A1%E6%81%AF%0Aconst%20wordObj%20%3D%20existingWord.toObject()%3B%0Aif%20(wordObj.primaryPartOfSpeech)%20%7B%0AwordObj.primaryPartOfSpeechTranslated%20%3D%20req.t(%60words.%24%7BwordObj.primaryPartOfSpeech%7D%60)%3B%0A%7D%0Ares.status(201).json(%7B%0Asuccess%3A%20true%2C%0Aword%3A%20wordObj%0A%7D)%3B%0A%7D%20else%20%7B%0A%2F%2F%20%E5%88%9B%E5%BB%BA%E6%96%B0%E5%8D%95%E8%AF%8D%E8%AE%B0%E5%BD%95%0Aconst%20newWord%20%3D%20await%20Word.create(%7B%0Aword%3A%20cleanWord%2C%0AuserIds%3A%20%5Breq.user.id%5D%2C%0Adefinitions%3A%20wordProcessing.definitions%20%7C%7C%20%5B%5D%2C%0AprimaryDefinition%3A%20wordProcessing.primaryDefinition%2C%0AprimaryPartOfSpeech%3A%20wordProcessing.primaryPartOfSpeech%2C%0AwordNetProcessed%3A%20wordProcessing.wordNetProcessed%0A%7D)%3B%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E7%BF%BB%E8%AF%91%E5%90%8E%E7%9A%84%E8%AF%8D%E6%80%A7%E4%BF%A1%E6%81%AF%0Aconst%20wordObj%20%3D%20newWord.toObject()%3B%0Aif%20(wordObj.primaryPartOfSpeech)%20%7B%0AwordObj.primaryPartOfSpeechTranslated%20%3D%20req.t(%60words.%24%7BwordObj.primaryPartOfSpeech%7D%60)%3B%0A%7D%0Ares.status(201).json(%7B%0Asuccess%3A%20true%2C%0Aword%3A%20wordObj%0A%7D)%3B%0A%7D%0A%7D%20catch%20(error)%20%7B%0A%2F%2F%20%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%EF%BC%9A%E5%A4%84%E7%90%86%E9%87%8D%E5%A4%8D%E9%94%AE%E7%AD%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%94%99%E8%AF%AF%0Aif%20(error.code%20%3D%3D%3D%2011000)%20%7B%0Areturn%20res.status(400).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('words.wordAlreadyExists')%0A%7D)%3B%0A%7D%0Aconsole.error('Add%20word%20error%3A'%2C%20error)%3B%0Ares.status(500).json(%7B%0Asuccess%3A%20false%2C%0Amessage%3A%20req.t('words.serverErrorAddingWord')%0A%7D)%3B%0A%7D%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> <span class="hljs-title class_ inline">Word</span> = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../models/Word&#x27;</span>);
<span class="hljs-keyword inline">const</span> <span class="hljs-title class_ inline">Joi</span> = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;joi&#x27;</span>);
<span class="hljs-keyword inline">const</span> { processWord } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../utils/wordUtils&#x27;</span>);

<span class="hljs-comment inline">// 数据验证Schema - 增加forceAdd参数支持强制添加</span>
<span class="hljs-keyword inline">const</span> addWordSchema = <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">object</span>({
  <span class="hljs-attr inline">word</span>: <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">string</span>().<span class="hljs-title function_ inline">min</span>(<span class="hljs-number inline">1</span>).<span class="hljs-title function_ inline">max</span>(<span class="hljs-number inline">50</span>).<span class="hljs-title function_ inline">pattern</span>(<span class="hljs-regexp inline">/^[a-zA-Z\-&#x27;]+$/</span>).<span class="hljs-title function_ inline">required</span>(),
  <span class="hljs-attr inline">forceAdd</span>: <span class="hljs-title class_ inline">Joi</span>.<span class="hljs-title function_ inline">boolean</span>().<span class="hljs-title function_ inline">default</span>(<span class="hljs-literal inline">false</span>) <span class="hljs-comment inline">// 新增：强制添加标志</span>
});

<span class="hljs-comment inline">// @desc    添加新单词</span>
<span class="hljs-comment inline">// @route   POST /api/words</span>
<span class="hljs-comment inline">// @access  Private</span>
<span class="hljs-built_in inline">exports</span>.<span class="hljs-property inline">addWord</span> = <span class="hljs-title function_ inline">async</span> (req, res) =&gt; {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-comment inline">// 第一步：验证输入数据</span>
    <span class="hljs-keyword inline">const</span> { error } = addWordSchema.<span class="hljs-title function_ inline">validate</span>(req.<span class="hljs-property inline">body</span>);
    <span class="hljs-keyword inline">if</span> (error) {
      <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
        <span class="hljs-attr inline">message</span>: error.<span class="hljs-property inline">details</span>[<span class="hljs-number inline">0</span>].<span class="hljs-property inline">message</span>
      });
    }

    <span class="hljs-comment inline">// 第二步：提取参数并清理输入</span>
    <span class="hljs-keyword inline">const</span> { word, forceAdd } = req.<span class="hljs-property inline">body</span>;
    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>();

    <span class="hljs-comment inline">// 第三步：根据forceAdd标志决定处理方式</span>
    <span class="hljs-keyword inline">let</span> wordProcessing;
    
    <span class="hljs-keyword inline">if</span> (forceAdd) {
      <span class="hljs-comment inline">// 强制添加模式：跳过拼写检查，直接获取WordNet数据</span>
      <span class="hljs-keyword inline">const</span> wordNetData = <span class="hljs-keyword inline">await</span> <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../utils/wordUtils&#x27;</span>).<span class="hljs-title function_ inline">getWordNetData</span>(cleanWord);
      wordProcessing = {
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
        <span class="hljs-attr inline">word</span>: cleanWord,
        ...wordNetData
      };
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-comment inline">// 正常模式：进行拼写检查和WordNet查询</span>
      wordProcessing = <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">processWord</span>(cleanWord);
      
      <span class="hljs-keyword inline">if</span> (!wordProcessing.<span class="hljs-property inline">success</span>) {
        <span class="hljs-comment inline">// 拼写错误时返回建议（200状态码，非错误响应）</span>
        <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">200</span>).<span class="hljs-title function_ inline">json</span>({
          <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
          <span class="hljs-attr inline">needsConfirmation</span>: <span class="hljs-literal inline">true</span>,        <span class="hljs-comment inline">// 需要用户确认</span>
          <span class="hljs-attr inline">spellingError</span>: <span class="hljs-literal inline">true</span>,            <span class="hljs-comment inline">// 标记为拼写错误</span>
          <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.spellingError&#x27;</span>),
          <span class="hljs-attr inline">suggestions</span>: wordProcessing.<span class="hljs-property inline">suggestions</span> || [],
          <span class="hljs-attr inline">originalWord</span>: wordProcessing.<span class="hljs-property inline">word</span>,
          <span class="hljs-attr inline">suggestedCorrection</span>: wordProcessing.<span class="hljs-property inline">suggestions</span> &amp;&amp; wordProcessing.<span class="hljs-property inline">suggestions</span>.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
            ? wordProcessing.<span class="hljs-property inline">suggestions</span>[<span class="hljs-number inline">0</span>] : <span class="hljs-literal inline">null</span>
        });
      }
    }

    <span class="hljs-comment inline">// 第四步：检查数据库中是否已存在该单词</span>
    <span class="hljs-keyword inline">const</span> existingWord = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">Word</span>.<span class="hljs-title function_ inline">findOne</span>({
      <span class="hljs-attr inline">word</span>: cleanWord
    });

    <span class="hljs-keyword inline">if</span> (existingWord) {
      <span class="hljs-comment inline">// 单词已存在，检查当前用户是否已拥有</span>
      <span class="hljs-keyword inline">if</span> (existingWord.<span class="hljs-property inline">userIds</span>.<span class="hljs-title function_ inline">includes</span>(req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>)) {
        <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
          <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
          <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordAlreadyExists&#x27;</span>)
        });
      }

      <span class="hljs-comment inline">// 将用户添加到现有单词的共享列表</span>
      existingWord.<span class="hljs-property inline">userIds</span>.<span class="hljs-title function_ inline">push</span>(req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>);
      <span class="hljs-keyword inline">await</span> existingWord.<span class="hljs-title function_ inline">save</span>();

      <span class="hljs-comment inline">// 添加翻译后的词性信息</span>
      <span class="hljs-keyword inline">const</span> wordObj = existingWord.<span class="hljs-title function_ inline">toObject</span>();
      <span class="hljs-keyword inline">if</span> (wordObj.<span class="hljs-property inline">primaryPartOfSpeech</span>) {
        wordObj.<span class="hljs-property inline">primaryPartOfSpeechTranslated</span> = req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">`words.<span class="hljs-subst inline">${wordObj.primaryPartOfSpeech}</span>`</span>);
      }

      res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">201</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
        <span class="hljs-attr inline">word</span>: wordObj
      });
    } <span class="hljs-keyword inline">else</span> {
      <span class="hljs-comment inline">// 创建新单词记录</span>
      <span class="hljs-keyword inline">const</span> newWord = <span class="hljs-keyword inline">await</span> <span class="hljs-title class_ inline">Word</span>.<span class="hljs-title function_ inline">create</span>({
        <span class="hljs-attr inline">word</span>: cleanWord,
        <span class="hljs-attr inline">userIds</span>: [req.<span class="hljs-property inline">user</span>.<span class="hljs-property inline">id</span>],
        <span class="hljs-attr inline">definitions</span>: wordProcessing.<span class="hljs-property inline">definitions</span> || [],
        <span class="hljs-attr inline">primaryDefinition</span>: wordProcessing.<span class="hljs-property inline">primaryDefinition</span>,
        <span class="hljs-attr inline">primaryPartOfSpeech</span>: wordProcessing.<span class="hljs-property inline">primaryPartOfSpeech</span>,
        <span class="hljs-attr inline">wordNetProcessed</span>: wordProcessing.<span class="hljs-property inline">wordNetProcessed</span>
      });

      <span class="hljs-comment inline">// 添加翻译后的词性信息</span>
      <span class="hljs-keyword inline">const</span> wordObj = newWord.<span class="hljs-title function_ inline">toObject</span>();
      <span class="hljs-keyword inline">if</span> (wordObj.<span class="hljs-property inline">primaryPartOfSpeech</span>) {
        wordObj.<span class="hljs-property inline">primaryPartOfSpeechTranslated</span> = req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">`words.<span class="hljs-subst inline">${wordObj.primaryPartOfSpeech}</span>`</span>);
      }

      res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">201</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
        <span class="hljs-attr inline">word</span>: wordObj
      });
    }
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-comment inline">// 错误处理：处理重复键等数据库错误</span>
    <span class="hljs-keyword inline">if</span> (error.<span class="hljs-property inline">code</span> === <span class="hljs-number inline">11000</span>) {
      <span class="hljs-keyword inline">return</span> res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">400</span>).<span class="hljs-title function_ inline">json</span>({
        <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
        <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordAlreadyExists&#x27;</span>)
      });
    }
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Add word error:&#x27;</span>, error);
    res.<span class="hljs-title function_ inline">status</span>(<span class="hljs-number inline">500</span>).<span class="hljs-title function_ inline">json</span>({
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">message</span>: req.<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.serverErrorAddingWord&#x27;</span>)
    });
  }
};
</code></pre>
            </div>
        
<h4 id="2-wordutilsjs-单词处理工具" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#2-wordutilsjs-单词处理工具" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 2. wordUtils.js - 单词处理工具">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            2. wordUtils.js - 单词处理工具
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20Typo%20%3D%20require('typo-js')%3B%0Aconst%20wordnet%20%3D%20require('wordnet')%3B%0A%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E5%99%A8%0Alet%20spellChecker%3B%0Atry%20%7B%0AspellChecker%20%3D%20new%20Typo('en_US')%3B%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Failed%20to%20initialize%20spell%20checker%3A'%2C%20error)%3B%0A%7D%0A%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96WordNet%0Alet%20wordnetInitialized%20%3D%20false%3B%0Aconst%20initializeWordNet%20%3D%20async%20()%20%3D%3E%20%7B%0Aif%20(!wordnetInitialized)%20%7B%0Atry%20%7B%0Aawait%20wordnet.init()%3B%0AwordnetInitialized%20%3D%20true%3B%0Aconsole.log('WordNet%20initialized%20successfully')%3B%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Failed%20to%20initialize%20WordNet%3A'%2C%20error)%3B%0A%7D%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E6%A0%B8%E5%BF%83%E5%87%BD%E6%95%B0%0A*%20%40param%20%7Bstring%7D%20word%20-%20%E5%BE%85%E6%A3%80%E6%9F%A5%E7%9A%84%E5%8D%95%E8%AF%8D%0A*%20%40returns%20%7Bboolean%7D%20-%20%E6%8B%BC%E5%86%99%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A1%AE%0A*%2F%0Aconst%20isWordSpelledCorrectly%20%3D%20(word)%20%3D%3E%20%7B%0A%2F%2F%20%E9%98%B2%E5%BE%A1%E6%80%A7%E7%BC%96%E7%A8%8B%EF%BC%9A%E6%A3%80%E6%9F%A5%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E5%99%A8%E6%98%AF%E5%90%A6%E5%8F%AF%E7%94%A8%0Aif%20(!spellChecker)%20%7B%0Aconsole.warn('Spell%20checker%20not%20available%2C%20assuming%20word%20is%20correct')%3B%0Areturn%20true%3B%0A%7D%0Atry%20%7B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%3B%0Areturn%20spellChecker.check(cleanWord)%3B%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20checking%20spelling%3A'%2C%20error)%3B%0Areturn%20true%3B%20%2F%2F%20%E9%BB%98%E8%AE%A4%E4%B8%BA%E6%AD%A3%E7%A1%AE%EF%BC%8C%E7%A1%AE%E4%BF%9D%E7%B3%BB%E7%BB%9F%E5%8F%AF%E7%94%A8%E6%80%A7%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E8%8E%B7%E5%8F%96%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%0A*%20%40param%20%7Bstring%7D%20word%20-%20%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%E7%9A%84%E5%8D%95%E8%AF%8D%0A*%20%40returns%20%7Bstring%5B%5D%7D%20-%20%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%E6%95%B0%E7%BB%84%0A*%2F%0Aconst%20getSpellingSuggestions%20%3D%20(word)%20%3D%3E%20%7B%0Aif%20(!spellChecker)%20%7B%0Areturn%20%5B%5D%3B%0A%7D%0Atry%20%7B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%3B%0Areturn%20spellChecker.suggest(cleanWord)%20%7C%7C%20%5B%5D%3B%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20getting%20spelling%20suggestions%3A'%2C%20error)%3B%0Areturn%20%5B%5D%3B%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E8%8E%B7%E5%8F%96WordNet%E8%AF%8D%E6%B1%87%E6%95%B0%E6%8D%AE%0A*%20%40param%20%7Bstring%7D%20word%20-%20%E5%BE%85%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%8D%95%E8%AF%8D%0A*%20%40returns%20%7BPromise%7D%20-%20%E5%8C%85%E5%90%AB%E5%AE%9A%E4%B9%89%E5%92%8C%E8%AF%8D%E6%80%A7%E7%9A%84%E5%AF%B9%E8%B1%A1%0A*%2F%0Aconst%20getWordNetData%20%3D%20async%20(word)%20%3D%3E%20%7B%0Atry%20%7B%0A%2F%2F%20%E7%A1%AE%E4%BF%9DWordNet%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%0Aawait%20initializeWordNet()%3B%0Aif%20(!wordnetInitialized)%20%7B%0Aconsole.warn('WordNet%20not%20available')%3B%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20false%0A%7D%3B%0A%7D%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%3B%0Atry%20%7B%0A%2F%2F%20%E4%BB%8EWordNet%E6%9F%A5%E8%AF%A2%E5%8D%95%E8%AF%8D%E5%AE%9A%E4%B9%89%0Aconst%20definitions%20%3D%20await%20wordnet.lookup(cleanWord)%3B%0Aif%20(!definitions%20%7C%7C%20definitions.length%20%3D%3D%3D%200)%20%7B%0Aconsole.log(%60No%20WordNet%20data%20found%20for%3A%20%24%7BcleanWord%7D%60)%3B%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20true%0A%7D%3B%0A%7D%0A%2F%2F%20%E5%A4%84%E7%90%86WordNet%E8%BF%94%E5%9B%9E%E7%9A%84%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%0Aconst%20processedDefinitions%20%3D%20definitions.map(def%20%3D%3E%20(%7B%0Atext%3A%20def.glossary%20%7C%7C%20def.gloss%20%7C%7C%20''%2C%0ApartOfSpeech%3A%20mapWordNetPoS(def.meta%3F.synsetType)%0A%7D)).filter(def%20%3D%3E%20def.text%20%26%26%20def.partOfSpeech)%3B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E4%B8%BB%E8%A6%81%E5%AE%9A%E4%B9%89%EF%BC%88%E7%AC%AC%E4%B8%80%E4%B8%AA%2F%E6%9C%80%E5%B8%B8%E8%A7%81%E7%9A%84%EF%BC%89%0Aconst%20primaryDefinition%20%3D%20processedDefinitions.length%20%3E%200%0A%3F%20processedDefinitions%5B0%5D.text%0A%3A%20null%3B%0Aconst%20primaryPartOfSpeech%20%3D%20processedDefinitions.length%20%3E%200%0A%3F%20processedDefinitions%5B0%5D.partOfSpeech%0A%3A%20null%3B%0Areturn%20%7B%0Adefinitions%3A%20processedDefinitions.slice(0%2C%2010)%2C%20%2F%2F%20%E9%99%90%E5%88%B6%E6%9C%80%E5%A4%9A10%E4%B8%AA%E5%AE%9A%E4%B9%89%0AprimaryDefinition%2C%0AprimaryPartOfSpeech%2C%0AwordNetProcessed%3A%20true%0A%7D%3B%0A%7D%20catch%20(lookupError)%20%7B%0Aconsole.error('Error%20looking%20up%20word%20in%20WordNet%3A'%2C%20lookupError)%3B%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20true%0A%7D%3B%0A%7D%0A%7D%20catch%20(error)%20%7B%0Aconsole.error('Error%20in%20getWordNetData%3A'%2C%20error)%3B%0Areturn%20%7B%0Adefinitions%3A%20%5B%5D%2C%0AprimaryDefinition%3A%20null%2C%0AprimaryPartOfSpeech%3A%20null%2C%0AwordNetProcessed%3A%20false%0A%7D%3B%0A%7D%0A%7D%3B%0A%2F**%0A*%20%E6%98%A0%E5%B0%84WordNet%E8%AF%8D%E6%80%A7%E4%BB%A3%E7%A0%81%E5%88%B0%E7%B3%BB%E7%BB%9F%E8%AF%8D%E6%80%A7%0A*%20%40param%20%7Bstring%7D%20wordnetPos%20-%20WordNet%E8%AF%8D%E6%80%A7%E4%BB%A3%E7%A0%81%0A*%20%40returns%20%7Bstring%7Cnull%7D%20-%20%E6%98%A0%E5%B0%84%E5%90%8E%E7%9A%84%E8%AF%8D%E6%80%A7%0A*%2F%0Aconst%20mapWordNetPoS%20%3D%20(wordnetPos)%20%3D%3E%20%7B%0Aif%20(!wordnetPos)%20return%20null%3B%0Aconst%20mapping%20%3D%20%7B%0A'noun'%3A%20'noun'%2C%0A'verb'%3A%20'verb'%2C%0A'adjective'%3A%20'adjective'%2C%0A'adverb'%3A%20'adverb'%2C%0A'n'%3A%20'noun'%2C%0A'v'%3A%20'verb'%2C%0A'a'%3A%20'adjective'%2C%0A's'%3A%20'adjective'%2C%20%2F%2F%20adjective%20satellite%0A'r'%3A%20'adverb'%0A%7D%3B%0Areturn%20mapping%5BwordnetPos.toLowerCase()%5D%20%7C%7C%20null%3B%0A%7D%3B%0A%2F**%0A*%20%E5%A4%84%E7%90%86%E5%8D%95%E8%AF%8D%E7%9A%84%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B%0A*%20%40param%20%7Bstring%7D%20word%20-%20%E5%BE%85%E5%A4%84%E7%90%86%E7%9A%84%E5%8D%95%E8%AF%8D%0A*%20%40returns%20%7BPromise%7D%20-%20%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%9C%0A*%2F%0Aconst%20processWord%20%3D%20async%20(word)%20%3D%3E%20%7B%0Aconst%20cleanWord%20%3D%20word.toLowerCase().trim()%3B%0A%2F%2F%20%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%0Aconst%20isSpelledCorrectly%20%3D%20isWordSpelledCorrectly(cleanWord)%3B%0Aif%20(!isSpelledCorrectly)%20%7B%0A%2F%2F%20%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%BB%BA%E8%AE%AE%0Aconst%20suggestions%20%3D%20getSpellingSuggestions(cleanWord)%3B%0Areturn%20%7B%0Asuccess%3A%20false%2C%0Aerror%3A%20'SPELLING_ERROR'%2C%0Asuggestions%2C%0Aword%3A%20cleanWord%0A%7D%3B%0A%7D%0A%2F%2F%20%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96WordNet%E6%95%B0%E6%8D%AE%0Aconst%20wordNetData%20%3D%20await%20getWordNetData(cleanWord)%3B%0Areturn%20%7B%0Asuccess%3A%20true%2C%0Aword%3A%20cleanWord%2C%0A...wordNetData%0A%7D%3B%0A%7D%3B%0Amodule.exports%20%3D%20%7B%0AisWordSpelledCorrectly%2C%0AgetSpellingSuggestions%2C%0AgetWordNetData%2C%0AprocessWord%0A%7D%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> <span class="hljs-title class_ inline">Typo</span> = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;typo-js&#x27;</span>);
<span class="hljs-keyword inline">const</span> wordnet = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;wordnet&#x27;</span>);

<span class="hljs-comment inline">// 初始化拼写检查器</span>
<span class="hljs-keyword inline">let</span> spellChecker;
<span class="hljs-keyword inline">try</span> {
  spellChecker = <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Typo</span>(<span class="hljs-string inline">&#x27;en_US&#x27;</span>);
} <span class="hljs-keyword inline">catch</span> (error) {
  <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Failed to initialize spell checker:&#x27;</span>, error);
}

<span class="hljs-comment inline">// 初始化WordNet</span>
<span class="hljs-keyword inline">let</span> wordnetInitialized = <span class="hljs-literal inline">false</span>;
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">initializeWordNet</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!wordnetInitialized) {
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-keyword inline">await</span> wordnet.<span class="hljs-title function_ inline">init</span>();
      wordnetInitialized = <span class="hljs-literal inline">true</span>;
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">&#x27;WordNet initialized successfully&#x27;</span>);
    } <span class="hljs-keyword inline">catch</span> (error) {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Failed to initialize WordNet:&#x27;</span>, error);
    }
  }
};

<span class="hljs-comment inline">/**
 * 拼写检查核心函数
 * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">string</span>} <span class="hljs-variable inline">word</span> - 待检查的单词
 * <span class="hljs-doctag inline">@returns</span> {<span class="hljs-type inline">boolean</span>} - 拼写是否正确
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">isWordSpelledCorrectly</span> = (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-comment inline">// 防御性编程：检查拼写检查器是否可用</span>
  <span class="hljs-keyword inline">if</span> (!spellChecker) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;Spell checker not available, assuming word is correct&#x27;</span>);
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">true</span>;
  }

  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>();
    <span class="hljs-keyword inline">return</span> spellChecker.<span class="hljs-title function_ inline">check</span>(cleanWord);
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error checking spelling:&#x27;</span>, error);
    <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">true</span>; <span class="hljs-comment inline">// 默认为正确，确保系统可用性</span>
  }
};

<span class="hljs-comment inline">/**
 * 获取拼写建议
 * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">string</span>} <span class="hljs-variable inline">word</span> - 拼写错误的单词
 * <span class="hljs-doctag inline">@returns</span> {<span class="hljs-type inline">string[]</span>} - 拼写建议数组
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getSpellingSuggestions</span> = (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!spellChecker) {
    <span class="hljs-keyword inline">return</span> [];
  }

  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>();
    <span class="hljs-keyword inline">return</span> spellChecker.<span class="hljs-title function_ inline">suggest</span>(cleanWord) || [];
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error getting spelling suggestions:&#x27;</span>, error);
    <span class="hljs-keyword inline">return</span> [];
  }
};

<span class="hljs-comment inline">/**
 * 获取WordNet词汇数据
 * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">string</span>} <span class="hljs-variable inline">word</span> - 待查询的单词
 * <span class="hljs-doctag inline">@returns</span> {<span class="hljs-type inline">Promise&lt;Object&gt;</span>} - 包含定义和词性的对象
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">getWordNetData</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">try</span> {
    <span class="hljs-comment inline">// 确保WordNet已初始化</span>
    <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">initializeWordNet</span>();
    
    <span class="hljs-keyword inline">if</span> (!wordnetInitialized) {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">warn</span>(<span class="hljs-string inline">&#x27;WordNet not available&#x27;</span>);
      <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">definitions</span>: [],
        <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">false</span>
      };
    }

    <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>();
    
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-comment inline">// 从WordNet查询单词定义</span>
      <span class="hljs-keyword inline">const</span> definitions = <span class="hljs-keyword inline">await</span> wordnet.<span class="hljs-title function_ inline">lookup</span>(cleanWord);
      
      <span class="hljs-keyword inline">if</span> (!definitions || definitions.<span class="hljs-property inline">length</span> === <span class="hljs-number inline">0</span>) {
        <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">log</span>(<span class="hljs-string inline">`No WordNet data found for: <span class="hljs-subst inline">${cleanWord}</span>`</span>);
        <span class="hljs-keyword inline">return</span> {
          <span class="hljs-attr inline">definitions</span>: [],
          <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
          <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
          <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">true</span>
        };
      }

      <span class="hljs-comment inline">// 处理WordNet返回的定义数据</span>
      <span class="hljs-keyword inline">const</span> processedDefinitions = definitions.<span class="hljs-title function_ inline">map</span>(<span class="hljs-function inline"><span class="hljs-params inline">def</span> =&gt;</span> ({
        <span class="hljs-attr inline">text</span>: def.<span class="hljs-property inline">glossary</span> || def.<span class="hljs-property inline">gloss</span> || <span class="hljs-string inline">&#x27;&#x27;</span>,
        <span class="hljs-attr inline">partOfSpeech</span>: <span class="hljs-title function_ inline">mapWordNetPoS</span>(def.<span class="hljs-property inline">meta</span>?.<span class="hljs-property inline">synsetType</span>)
      })).<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">def</span> =&gt;</span> def.<span class="hljs-property inline">text</span> &amp;&amp; def.<span class="hljs-property inline">partOfSpeech</span>);

      <span class="hljs-comment inline">// 获取主要定义（第一个/最常见的）</span>
      <span class="hljs-keyword inline">const</span> primaryDefinition = processedDefinitions.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
        ? processedDefinitions[<span class="hljs-number inline">0</span>].<span class="hljs-property inline">text</span> 
        : <span class="hljs-literal inline">null</span>;
      <span class="hljs-keyword inline">const</span> primaryPartOfSpeech = processedDefinitions.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span> 
        ? processedDefinitions[<span class="hljs-number inline">0</span>].<span class="hljs-property inline">partOfSpeech</span> 
        : <span class="hljs-literal inline">null</span>;

      <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">definitions</span>: processedDefinitions.<span class="hljs-title function_ inline">slice</span>(<span class="hljs-number inline">0</span>, <span class="hljs-number inline">10</span>), <span class="hljs-comment inline">// 限制最多10个定义</span>
        primaryDefinition,
        primaryPartOfSpeech,
        <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">true</span>
      };
    } <span class="hljs-keyword inline">catch</span> (lookupError) {
      <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error looking up word in WordNet:&#x27;</span>, lookupError);
      <span class="hljs-keyword inline">return</span> {
        <span class="hljs-attr inline">definitions</span>: [],
        <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
        <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">true</span>
      };
    }
  } <span class="hljs-keyword inline">catch</span> (error) {
    <span class="hljs-variable language_ inline">console</span>.<span class="hljs-title function_ inline">error</span>(<span class="hljs-string inline">&#x27;Error in getWordNetData:&#x27;</span>, error);
    <span class="hljs-keyword inline">return</span> {
      <span class="hljs-attr inline">definitions</span>: [],
      <span class="hljs-attr inline">primaryDefinition</span>: <span class="hljs-literal inline">null</span>,
      <span class="hljs-attr inline">primaryPartOfSpeech</span>: <span class="hljs-literal inline">null</span>,
      <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-literal inline">false</span>
    };
  }
};

<span class="hljs-comment inline">/**
 * 映射WordNet词性代码到系统词性
 * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">string</span>} <span class="hljs-variable inline">wordnetPos</span> - WordNet词性代码
 * <span class="hljs-doctag inline">@returns</span> {<span class="hljs-type inline">string|null</span>} - 映射后的词性
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">mapWordNetPoS</span> = (<span class="hljs-params inline">wordnetPos</span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!wordnetPos) <span class="hljs-keyword inline">return</span> <span class="hljs-literal inline">null</span>;
  
  <span class="hljs-keyword inline">const</span> mapping = {
    <span class="hljs-string inline">&#x27;noun&#x27;</span>: <span class="hljs-string inline">&#x27;noun&#x27;</span>,
    <span class="hljs-string inline">&#x27;verb&#x27;</span>: <span class="hljs-string inline">&#x27;verb&#x27;</span>,
    <span class="hljs-string inline">&#x27;adjective&#x27;</span>: <span class="hljs-string inline">&#x27;adjective&#x27;</span>,
    <span class="hljs-string inline">&#x27;adverb&#x27;</span>: <span class="hljs-string inline">&#x27;adverb&#x27;</span>,
    <span class="hljs-string inline">&#x27;n&#x27;</span>: <span class="hljs-string inline">&#x27;noun&#x27;</span>,
    <span class="hljs-string inline">&#x27;v&#x27;</span>: <span class="hljs-string inline">&#x27;verb&#x27;</span>,
    <span class="hljs-string inline">&#x27;a&#x27;</span>: <span class="hljs-string inline">&#x27;adjective&#x27;</span>,
    <span class="hljs-string inline">&#x27;s&#x27;</span>: <span class="hljs-string inline">&#x27;adjective&#x27;</span>, <span class="hljs-comment inline">// adjective satellite</span>
    <span class="hljs-string inline">&#x27;r&#x27;</span>: <span class="hljs-string inline">&#x27;adverb&#x27;</span>
  };

  <span class="hljs-keyword inline">return</span> mapping[wordnetPos.<span class="hljs-title function_ inline">toLowerCase</span>()] || <span class="hljs-literal inline">null</span>;
};

<span class="hljs-comment inline">/**
 * 处理单词的完整流程
 * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">string</span>} <span class="hljs-variable inline">word</span> - 待处理的单词
 * <span class="hljs-doctag inline">@returns</span> {<span class="hljs-type inline">Promise&lt;Object&gt;</span>} - 处理结果
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">processWord</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline">word</span>) =&gt; {
  <span class="hljs-keyword inline">const</span> cleanWord = word.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>();
  
  <span class="hljs-comment inline">// 第一步：拼写检查</span>
  <span class="hljs-keyword inline">const</span> isSpelledCorrectly = <span class="hljs-title function_ inline">isWordSpelledCorrectly</span>(cleanWord);
  
  <span class="hljs-keyword inline">if</span> (!isSpelledCorrectly) {
    <span class="hljs-comment inline">// 拼写错误，返回建议</span>
    <span class="hljs-keyword inline">const</span> suggestions = <span class="hljs-title function_ inline">getSpellingSuggestions</span>(cleanWord);
    <span class="hljs-keyword inline">return</span> {
      <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>,
      <span class="hljs-attr inline">error</span>: <span class="hljs-string inline">&#x27;SPELLING_ERROR&#x27;</span>,
      suggestions,
      <span class="hljs-attr inline">word</span>: cleanWord
    };
  }

  <span class="hljs-comment inline">// 第二步：获取WordNet数据</span>
  <span class="hljs-keyword inline">const</span> wordNetData = <span class="hljs-keyword inline">await</span> <span class="hljs-title function_ inline">getWordNetData</span>(cleanWord);
  
  <span class="hljs-keyword inline">return</span> {
    <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>,
    <span class="hljs-attr inline">word</span>: cleanWord,
    ...wordNetData
  };
};

<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = {
  isWordSpelledCorrectly,
  getSpellingSuggestions,
  getWordNetData,
  processWord
};
</code></pre>
            </div>
        
<h4 id="3-wordsjs-路由定义" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#3-wordsjs-路由定义" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 3. words.js - 路由定义">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            3. words.js - 路由定义
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="javascript" data-code="const%20express%20%3D%20require('express')%3B%0Aconst%20%7B%0AgetUserWords%2C%0AaddWord%2C%0AdeleteWord%2C%0AgetRandomWords%2C%0AgetWordStats%2C%0AgetPartsOfSpeech%0A%7D%20%3D%20require('..%2Fcontrollers%2FwordController')%3B%0Aconst%20%7B%20auth%20%7D%20%3D%20require('..%2Fmiddleware%2Fauth')%3B%0Aconst%20router%20%3D%20express.Router()%3B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA%E5%8D%95%E8%AF%8D%E6%8E%A8%E8%8D%90%0Arouter.get('%2Frandom'%2C%20auth%2C%20getRandomWords)%3B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%8D%95%E8%AF%8D%E7%BB%9F%E8%AE%A1%0Arouter.get('%2Fstats'%2C%20auth%2C%20getWordStats)%3B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E5%8F%AF%E7%94%A8%E8%AF%8D%E6%80%A7%E5%88%97%E8%A1%A8%0Arouter.get('%2Fparts-of-speech'%2C%20auth%2C%20getPartsOfSpeech)%3B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E7%9A%84%E5%8D%95%E8%AF%8D%E5%88%97%E8%A1%A8%0Arouter.get('%2F'%2C%20auth%2C%20getUserWords)%3B%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%8D%95%E8%AF%8D%EF%BC%88%E6%94%AF%E6%8C%81%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%EF%BC%89%0Arouter.post('%2F'%2C%20auth%2C%20addWord)%3B%0A%2F%2F%20%E5%88%A0%E9%99%A4%E5%8D%95%E8%AF%8D%0Arouter.delete('%2F%3Aid'%2C%20auth%2C%20deleteWord)%3B%0Amodule.exports%20%3D%20router%3B">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">javascript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-javascript"><span class="hljs-keyword inline">const</span> express = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;express&#x27;</span>);
<span class="hljs-keyword inline">const</span> {
  getUserWords,
  addWord,
  deleteWord,
  getRandomWords,
  getWordStats,
  getPartsOfSpeech
} = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../controllers/wordController&#x27;</span>);
<span class="hljs-keyword inline">const</span> { auth } = <span class="hljs-built_in inline">require</span>(<span class="hljs-string inline">&#x27;../middleware/auth&#x27;</span>);

<span class="hljs-keyword inline">const</span> router = express.<span class="hljs-title class_ inline">Router</span>();

<span class="hljs-comment inline">// 获取随机单词推荐</span>
router.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/random&#x27;</span>, auth, getRandomWords);

<span class="hljs-comment inline">// 获取用户单词统计</span>
router.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/stats&#x27;</span>, auth, getWordStats);

<span class="hljs-comment inline">// 获取可用词性列表</span>
router.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/parts-of-speech&#x27;</span>, auth, getPartsOfSpeech);

<span class="hljs-comment inline">// 获取用户的单词列表</span>
router.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/&#x27;</span>, auth, getUserWords);

<span class="hljs-comment inline">// 添加新单词（支持拼写建议）</span>
router.<span class="hljs-title function_ inline">post</span>(<span class="hljs-string inline">&#x27;/&#x27;</span>, auth, addWord);

<span class="hljs-comment inline">// 删除单词</span>
router.<span class="hljs-title function_ inline">delete</span>(<span class="hljs-string inline">&#x27;/:id&#x27;</span>, auth, deleteWord);

<span class="hljs-variable language_ inline">module</span>.<span class="hljs-property inline">exports</span> = router;
</code></pre>
            </div>
        
<h3 id="前端核心文件" class="group relative text-2xl font-semibold mt-5 mb-2 text-foreground leading-snug">
            <a href="#前端核心文件" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 前端核心文件">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            前端核心文件
        </h3>
<h4 id="4-wordsvue-单词管理视图" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#4-wordsvue-单词管理视图" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 4. Words.vue - 单词管理视图">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            4. Words.vue - 单词管理视图
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="vue" data-code="template%3E%0Adiv%20class%3D%22space-y-6%22%3E%0Adiv%20v-if%3D%22showAddForm%22%20class%3D%22card%22%3E%0Adiv%20class%3D%22card-header%22%3E%0Ah3%20class%3D%22text-lg%20font-semibold%22%3E%7B%7B%20%24t('words.add')%20%7D%7Dh3%3E%0Adiv%3E%0Adiv%20class%3D%22card-body%22%3E%0Aform%20class%3D%22space-y-4%22%20%40submit.prevent%3D%22addWord%22%3E%0Adiv%20class%3D%22grid%20grid-cols-1%20gap-4%22%3E%0Adiv%3E%0Alabel%20class%3D%22block%20text-sm%20font-medium%20text-primary%22%20for%3D%22word%22%3E%0A%7B%7B%20%24t('words.word')%20%7D%7D%20*%0Alabel%3E%0Ainput%0Aid%3D%22word%22%0Av-model%3D%22newWord.word%22%0A%3Aplaceholder%3D%22%24t('words.enterWord')%22%0Aclass%3D%22input%20mt-1%22%0Arequired%0Atype%3D%22text%22%0A%2F%3E%0Ap%20class%3D%22text-xs%20text-secondary%20mt-1%22%3E%0A%7B%7B%20%24t('words.spellingWillBeChecked')%20%7D%7D%0Ap%3E%0Adiv%3E%0Adiv%20class%3D%22flex%20items-end%20md%3Aitems-center%22%3E%0Abutton%0A%3Adisabled%3D%22wordsStore.loading%20%7C%7C%20!newWord.word.trim()%22%0Aclass%3D%22btn%20btn-primary%20w-full%22%0Atype%3D%22submit%22%0A%3E%0Adiv%20v-if%3D%22wordsStore.loading%22%20class%3D%22spinner%20mr-2%22%3Ediv%3E%0A%7B%7B%20%24t('words.add')%20%7D%7D%0Abutton%3E%0Adiv%3E%0Adiv%3E%0Adiv%20v-if%3D%22spellingError%20%26%26%20spellingSuggestions.length%20%3E%200%22%0Aclass%3D%22bg-blue-50%20dark%3Abg-blue-900%2F20%20border%20border-blue-200%20dark%3Aborder-blue-800%20rounded-md%20p-4%22%3E%0Adiv%20class%3D%22flex%20items-start%20space-x-2%22%3E%0Adiv%20class%3D%22flex-shrink-0%20mt-0.5%22%3E%0Asvg%20class%3D%22w-5%20h-5%20text-blue-600%20dark%3Atext-blue-400%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20viewBox%3D%220%200%2024%2024%22%3E%0Apath%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%222%22%20d%3D%22M13%2016h-1v-4h-1m1-4h.01M21%2012a9%209%200%2011-18%200%209%209%200%200118%200z%22%3Epath%3E%0Asvg%3E%0Adiv%3E%0Adiv%20class%3D%22flex-1%22%3E%0Ap%20class%3D%22text-sm%20font-medium%20text-blue-800%20dark%3Atext-blue-200%20mb-2%22%3E%0A%7B%7B%20%24t('words.spellingNotRecognized')%20%7D%7D%0Ap%3E%0Ap%20class%3D%22text-sm%20text-blue-700%20dark%3Atext-blue-300%20mb-3%22%3E%0A%7B%7B%20%24t('words.didYouMean')%20%7D%7D%0Ap%3E%0Adiv%20class%3D%22flex%20flex-wrap%20gap-2%22%3E%0Abutton%0Av-for%3D%22suggestion%20in%20spellingSuggestions%22%0A%3Akey%3D%22suggestion%22%0Aclass%3D%22inline-flex%20items-center%20px-3%20py-1.5%20text-sm%20font-medium%20text-blue-700%20dark%3Atext-blue-200%20bg-blue-100%20dark%3Abg-blue-800%20rounded-md%20hover%3Abg-blue-200%20dark%3Ahover%3Abg-blue-700%20transition-colors%20focus%3Aoutline-none%20focus%3Aring-2%20focus%3Aring-blue-500%20focus%3Aring-offset-2%22%0A%40click%3D%22selectSuggestion(suggestion)%22%0A%3E%0A%7B%7B%20suggestion%20%7D%7D%0Abutton%3E%0Adiv%3E%0Adiv%20class%3D%22mt-3%20flex%20items-center%20space-x-2%22%3E%0Abutton%0Aclass%3D%22text-xs%20text-blue-600%20dark%3Atext-blue-400%20hover%3Atext-blue-800%20dark%3Ahover%3Atext-blue-200%20underline%22%0A%40click%3D%22addWordAnyway%22%0A%3E%0A%7B%7B%20%24t('words.addAnyway')%20%7D%7D%0Abutton%3E%0Aspan%20class%3D%22text-xs%20text-blue-500%20dark%3Atext-blue-400%22%3E%7B%7B%20%24t('words.or')%20%7D%7Dspan%3E%0Abutton%0Aclass%3D%22text-xs%20text-blue-600%20dark%3Atext-blue-400%20hover%3Atext-blue-800%20dark%3Ahover%3Atext-blue-200%20underline%22%0A%40click%3D%22cancelSpelling%22%0A%3E%0A%7B%7B%20%24t('words.tryAgain')%20%7D%7D%0Abutton%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Aform%3E%0Adiv%3E%0Adiv%3E%0Adiv%3E%0Atemplate%3E%0Ascript%20lang%3D%22ts%22%20setup%3E%0Aimport%20%7B%20onMounted%2C%20reactive%2C%20ref%20%7D%20from%20'vue'%0Aimport%20%7B%20useWordsStore%20%7D%20from%20'..%2Fstores%2Fwords.ts'%0Aimport%20%7B%20useI18n%20%7D%20from%20'vue-i18n'%0Aconst%20wordsStore%20%3D%20useWordsStore()%0Aconst%20%7B%20t%20%7D%20%3D%20useI18n()%0A%2F%2F%20%E5%93%8D%E5%BA%94%E5%BC%8F%E7%8A%B6%E6%80%81%0Aconst%20showAddForm%20%3D%20ref(false)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%AF%E5%90%A6%E6%98%BE%E7%A4%BA%E6%B7%BB%E5%8A%A0%E8%A1%A8%E5%8D%95%0Aconst%20spellingError%20%3D%20ref(false)%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%AF%E5%90%A6%E6%9C%89%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%0Aconst%20spellingSuggestions%20%3D%20ref(%5B%5D)%20%2F%2F%20%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%E6%95%B0%E7%BB%84%0A%2F%2F%20%E6%96%B0%E5%8D%95%E8%AF%8D%E6%95%B0%E6%8D%AE%0Aconst%20newWord%20%3D%20reactive(%7B%0Aword%3A%20''%0A%7D)%0A%2F%2F%20%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD%E6%97%B6%E5%88%9D%E5%A7%8B%E5%8C%96%0AonMounted(()%20%3D%3E%20%7B%0AwordsStore.fetchWords()%0AwordsStore.fetchPartsOfSpeech()%0A%7D)%0A%2F**%0A*%20%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%E7%9A%84%E4%B8%BB%E8%A6%81%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0%0A*%2F%0Aconst%20addWord%20%3D%20async%20()%20%3D%3E%20%7B%0A%2F%2F%20%E9%AA%8C%E8%AF%81%E8%BE%93%E5%85%A5%0Aif%20(!newWord.word.trim())%20return%0A%2F%2F%20%E9%87%8D%E7%BD%AE%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%E7%8A%B6%E6%80%81%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%2F%2F%20%E8%B0%83%E7%94%A8store%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%0Aconst%20result%20%3D%20await%20wordsStore.addWord(%7B%0Aword%3A%20newWord.word.trim()%0A%7D)%0Aif%20(result.success)%20%7B%0A%2F%2F%20%E6%88%90%E5%8A%9F%EF%BC%9A%E9%87%8D%E7%BD%AE%E8%A1%A8%E5%8D%95%0AnewWord.word%20%3D%20''%0AshowAddForm.value%20%3D%20false%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%7D%20else%20if%20(result.spellingError%20%26%26%20result.suggestions%3F.length%20%3E%200)%20%7B%0A%2F%2F%20%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%EF%BC%9A%E6%98%BE%E7%A4%BA%E5%BB%BA%E8%AE%AE%0AspellingError.value%20%3D%20true%0AspellingSuggestions.value%20%3D%20result.suggestions%0A%7D%0A%7D%0A%2F**%0A*%20%E7%94%A8%E6%88%B7%E9%80%89%E6%8B%A9%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%0A*%20%40param%20%7Bstring%7D%20suggestion%20-%20%E9%80%89%E6%8B%A9%E7%9A%84%E5%BB%BA%E8%AE%AE%E5%8D%95%E8%AF%8D%0A*%2F%0Aconst%20selectSuggestion%20%3D%20(suggestion%3A%20string)%20%3D%3E%20%7B%0AnewWord.word%20%3D%20suggestion%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%7D%0A%2F**%0A*%20%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%EF%BC%88%E8%B7%B3%E8%BF%87%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%EF%BC%89%0A*%2F%0Aconst%20addWordAnyway%20%3D%20async%20()%20%3D%3E%20%7B%0Aif%20(!newWord.word.trim())%20return%0A%2F%2F%20%E9%87%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E7%8A%B6%E6%80%81%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0A%2F%2F%20%E9%80%9A%E8%BF%87forceAdd%E5%8F%82%E6%95%B0%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%0Aconst%20result%20%3D%20await%20wordsStore.addWord(%7B%0Aword%3A%20newWord.word.trim()%2C%0AforceAdd%3A%20true%0A%7D)%0Aif%20(result.success)%20%7B%0AnewWord.word%20%3D%20''%0AshowAddForm.value%20%3D%20false%0A%7D%0A%7D%0A%2F**%0A*%20%E5%8F%96%E6%B6%88%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%EF%BC%8C%E9%87%8D%E6%96%B0%E8%BE%93%E5%85%A5%0A*%2F%0Aconst%20cancelSpelling%20%3D%20()%20%3D%3E%20%7B%0AspellingError.value%20%3D%20false%0AspellingSuggestions.value%20%3D%20%5B%5D%0AnewWord.word%20%3D%20''%0A%7D%0Ascript%3E">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">vue</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-vue"><span class="language-xml inline"><span class="hljs-tag inline">&lt;<span class="hljs-name inline">template</span>&gt;</span>
  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;space-y-6&quot;</span>&gt;</span>
    <span class="hljs-comment inline">&lt;!-- 添加单词表单 --&gt;</span>
    <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">v-if</span>=<span class="hljs-string inline">&quot;showAddForm&quot;</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;card&quot;</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;card-header&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">h3</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-lg font-semibold&quot;</span>&gt;</span></span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.add&#x27;</span>) }}</span><span class="language-xml inline"><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">h3</span>&gt;</span>
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
      <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;card-body&quot;</span>&gt;</span>
        <span class="hljs-tag inline">&lt;<span class="hljs-name inline">form</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;space-y-4&quot;</span> @<span class="hljs-attr inline">submit.prevent</span>=<span class="hljs-string inline">&quot;addWord&quot;</span>&gt;</span>
          <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;grid grid-cols-1 gap-4&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span>&gt;</span>
              <span class="hljs-tag inline">&lt;<span class="hljs-name inline">label</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;block text-sm font-medium text-primary&quot;</span> <span class="hljs-attr inline">for</span>=<span class="hljs-string inline">&quot;word&quot;</span>&gt;</span>
                </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.word&#x27;</span>) }}</span><span class="language-xml inline"> *
              <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">label</span>&gt;</span>
              <span class="hljs-tag inline">&lt;<span class="hljs-name inline">input</span>
                  <span class="hljs-attr inline">id</span>=<span class="hljs-string inline">&quot;word&quot;</span>
                  <span class="hljs-attr inline">v-model</span>=<span class="hljs-string inline">&quot;newWord.word&quot;</span>
                  <span class="hljs-attr inline">:placeholder</span>=<span class="hljs-string inline">&quot;$t(&#x27;words.enterWord&#x27;)&quot;</span>
                  <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;input mt-1&quot;</span>
                  <span class="hljs-attr inline">required</span>
                  <span class="hljs-attr inline">type</span>=<span class="hljs-string inline">&quot;text&quot;</span>
              /&gt;</span>
              <span class="hljs-tag inline">&lt;<span class="hljs-name inline">p</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-secondary mt-1&quot;</span>&gt;</span>
                </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.spellingWillBeChecked&#x27;</span>) }}</span><span class="language-xml inline">
              <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">p</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex items-end md:items-center&quot;</span>&gt;</span>
              <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                  <span class="hljs-attr inline">:disabled</span>=<span class="hljs-string inline">&quot;wordsStore.loading || !newWord.word.trim()&quot;</span>
                  <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;btn btn-primary w-full&quot;</span>
                  <span class="hljs-attr inline">type</span>=<span class="hljs-string inline">&quot;submit&quot;</span>
              &gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">v-if</span>=<span class="hljs-string inline">&quot;wordsStore.loading&quot;</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;spinner mr-2&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.add&#x27;</span>) }}</span><span class="language-xml inline">
              <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
          <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>

          <span class="hljs-comment inline">&lt;!-- 拼写建议UI --&gt;</span>
          <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">v-if</span>=<span class="hljs-string inline">&quot;spellingError &amp;&amp; spellingSuggestions.length &gt; 0&quot;</span>
               <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-4&quot;</span>&gt;</span>
            <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex items-start space-x-2&quot;</span>&gt;</span>
              <span class="hljs-comment inline">&lt;!-- 信息图标 --&gt;</span>
              <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex-shrink-0 mt-0.5&quot;</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">svg</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;w-5 h-5 text-blue-600 dark:text-blue-400&quot;</span> <span class="hljs-attr inline">fill</span>=<span class="hljs-string inline">&quot;none&quot;</span> <span class="hljs-attr inline">stroke</span>=<span class="hljs-string inline">&quot;currentColor&quot;</span> <span class="hljs-attr inline">viewBox</span>=<span class="hljs-string inline">&quot;0 0 24 24&quot;</span>&gt;</span>
                  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">path</span> <span class="hljs-attr inline">stroke-linecap</span>=<span class="hljs-string inline">&quot;round&quot;</span> <span class="hljs-attr inline">stroke-linejoin</span>=<span class="hljs-string inline">&quot;round&quot;</span> <span class="hljs-attr inline">stroke-width</span>=<span class="hljs-string inline">&quot;2&quot;</span> <span class="hljs-attr inline">d</span>=<span class="hljs-string inline">&quot;M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span>&gt;</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">path</span>&gt;</span>
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">svg</span>&gt;</span>
              <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
              <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex-1&quot;</span>&gt;</span>
                <span class="hljs-comment inline">&lt;!-- 提示文本 --&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">p</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-sm font-medium text-blue-800 dark:text-blue-200 mb-2&quot;</span>&gt;</span>
                  </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.spellingNotRecognized&#x27;</span>) }}</span><span class="language-xml inline">
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">p</span>&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">p</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-sm text-blue-700 dark:text-blue-300 mb-3&quot;</span>&gt;</span>
                  </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.didYouMean&#x27;</span>) }}</span><span class="language-xml inline">
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">p</span>&gt;</span>
                
                <span class="hljs-comment inline">&lt;!-- 拼写建议按钮组 --&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;flex flex-wrap gap-2&quot;</span>&gt;</span>
                  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                      <span class="hljs-attr inline">v-for</span>=<span class="hljs-string inline">&quot;suggestion in spellingSuggestions&quot;</span>
                      <span class="hljs-attr inline">:key</span>=<span class="hljs-string inline">&quot;suggestion&quot;</span>
                      <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;inline-flex items-center px-3 py-1.5 text-sm font-medium text-blue-700 dark:text-blue-200 bg-blue-100 dark:bg-blue-800 rounded-md hover:bg-blue-200 dark:hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2&quot;</span>
                      @<span class="hljs-attr inline">click</span>=<span class="hljs-string inline">&quot;selectSuggestion(suggestion)&quot;</span>
                  &gt;</span>
                    </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">suggestion</span> }}</span><span class="language-xml inline">
                  <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
                
                <span class="hljs-comment inline">&lt;!-- 用户操作选项 --&gt;</span>
                <span class="hljs-tag inline">&lt;<span class="hljs-name inline">div</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;mt-3 flex items-center space-x-2&quot;</span>&gt;</span>
                  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                      <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 underline&quot;</span>
                      @<span class="hljs-attr inline">click</span>=<span class="hljs-string inline">&quot;addWordAnyway&quot;</span>
                  &gt;</span>
                    </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.addAnyway&#x27;</span>) }}</span><span class="language-xml inline">
                  <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">span</span> <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-blue-500 dark:text-blue-400&quot;</span>&gt;</span></span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.or&#x27;</span>) }}</span><span class="language-xml inline"><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">span</span>&gt;</span>
                  <span class="hljs-tag inline">&lt;<span class="hljs-name inline">button</span>
                      <span class="hljs-attr inline">class</span>=<span class="hljs-string inline">&quot;text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 underline&quot;</span>
                      @<span class="hljs-attr inline">click</span>=<span class="hljs-string inline">&quot;cancelSpelling&quot;</span>
                  &gt;</span>
                    </span><span class="hljs-template-variable inline">{{ <span class="hljs-name inline">$t</span>(<span class="hljs-name inline">&#x27;words.tryAgain&#x27;</span>) }}</span><span class="language-xml inline">
                  <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">button</span>&gt;</span>
                <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
              <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
            <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
          <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
        <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">form</span>&gt;</span>
      <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
    <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
    
    <span class="hljs-comment inline">&lt;!-- 其他UI组件... --&gt;</span>
  <span class="hljs-tag inline">&lt;/<span class="hljs-name inline">div</span>&gt;</span>
<span class="hljs-tag inline">&lt;/<span class="hljs-name inline">template</span>&gt;</span>

<span class="hljs-tag inline">&lt;<span class="hljs-name inline">script</span> <span class="hljs-attr inline">lang</span>=<span class="hljs-string inline">&quot;ts&quot;</span> <span class="hljs-attr inline">setup</span>&gt;</span><span class="language-javascript inline">
<span class="hljs-keyword inline">import</span> { onMounted, reactive, ref } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;vue&#x27;</span>
<span class="hljs-keyword inline">import</span> { useWordsStore } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;../stores/words.ts&#x27;</span>
<span class="hljs-keyword inline">import</span> { useI18n } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;vue-i18n&#x27;</span>

<span class="hljs-keyword inline">const</span> wordsStore = <span class="hljs-title function_ inline">useWordsStore</span>()
<span class="hljs-keyword inline">const</span> { t } = <span class="hljs-title function_ inline">useI18n</span>()

<span class="hljs-comment inline">// 响应式状态</span>
<span class="hljs-keyword inline">const</span> showAddForm = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)              <span class="hljs-comment inline">// 是否显示添加表单</span>
<span class="hljs-keyword inline">const</span> spellingError = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)            <span class="hljs-comment inline">// 是否有拼写错误</span>
<span class="hljs-keyword inline">const</span> spellingSuggestions = ref&lt;string[]&gt;([]) <span class="hljs-comment inline">// 拼写建议数组</span>

<span class="hljs-comment inline">// 新单词数据</span>
<span class="hljs-keyword inline">const</span> newWord = <span class="hljs-title function_ inline">reactive</span>({
  <span class="hljs-attr inline">word</span>: <span class="hljs-string inline">&#x27;&#x27;</span>
})

<span class="hljs-comment inline">// 组件挂载时初始化</span>
<span class="hljs-title function_ inline">onMounted</span>(<span class="hljs-function inline">() =&gt;</span> {
  wordsStore.<span class="hljs-title function_ inline">fetchWords</span>()
  wordsStore.<span class="hljs-title function_ inline">fetchPartsOfSpeech</span>()
})

<span class="hljs-comment inline">/**
 * 添加单词的主要处理函数
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">addWord</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-comment inline">// 验证输入</span>
  <span class="hljs-keyword inline">if</span> (!newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()) <span class="hljs-keyword inline">return</span>

  <span class="hljs-comment inline">// 重置拼写错误状态</span>
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []

  <span class="hljs-comment inline">// 调用store添加单词</span>
  <span class="hljs-keyword inline">const</span> result = <span class="hljs-keyword inline">await</span> wordsStore.<span class="hljs-title function_ inline">addWord</span>({
    <span class="hljs-attr inline">word</span>: newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()
  })

  <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">success</span>) {
    <span class="hljs-comment inline">// 成功：重置表单</span>
    newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
    showAddForm.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
    spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
    spellingSuggestions.<span class="hljs-property inline">value</span> = []
  } <span class="hljs-keyword inline">else</span> <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">spellingError</span> &amp;&amp; result.<span class="hljs-property inline">suggestions</span>?.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>) {
    <span class="hljs-comment inline">// 拼写错误：显示建议</span>
    spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">true</span>
    spellingSuggestions.<span class="hljs-property inline">value</span> = result.<span class="hljs-property inline">suggestions</span>
  }
}

<span class="hljs-comment inline">/**
 * 用户选择拼写建议
 * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">string</span>} <span class="hljs-variable inline">suggestion</span> - 选择的建议单词
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">selectSuggestion</span> = (<span class="hljs-params inline">suggestion: string</span>) =&gt; {
  newWord.<span class="hljs-property inline">word</span> = suggestion
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
}

<span class="hljs-comment inline">/**
 * 强制添加单词（跳过拼写检查）
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">addWordAnyway</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"></span>) =&gt; {
  <span class="hljs-keyword inline">if</span> (!newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>()) <span class="hljs-keyword inline">return</span>
  
  <span class="hljs-comment inline">// 重置错误状态</span>
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
  
  <span class="hljs-comment inline">// 通过forceAdd参数强制添加</span>
  <span class="hljs-keyword inline">const</span> result = <span class="hljs-keyword inline">await</span> wordsStore.<span class="hljs-title function_ inline">addWord</span>({
    <span class="hljs-attr inline">word</span>: newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">trim</span>(),
    <span class="hljs-attr inline">forceAdd</span>: <span class="hljs-literal inline">true</span>
  })
  
  <span class="hljs-keyword inline">if</span> (result.<span class="hljs-property inline">success</span>) {
    newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
    showAddForm.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  }
}

<span class="hljs-comment inline">/**
 * 取消拼写建议，重新输入
 */</span>
<span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">cancelSpelling</span> = (<span class="hljs-params inline"></span>) =&gt; {
  spellingError.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
  spellingSuggestions.<span class="hljs-property inline">value</span> = []
  newWord.<span class="hljs-property inline">word</span> = <span class="hljs-string inline">&#x27;&#x27;</span>
}
</span><span class="hljs-tag inline">&lt;/<span class="hljs-name inline">script</span>&gt;</span>
</span></code></pre>
            </div>
        
<h4 id="5-wordsts-pinia状态管理" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#5-wordsts-pinia状态管理" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 5. words.ts - Pinia状态管理">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            5. words.ts - Pinia状态管理
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="import%20%7B%20defineStore%20%7D%20from%20'pinia'%0Aimport%20%7B%20ref%2C%20computed%20%7D%20from%20'vue'%0Aimport%20%7B%20useToast%20%7D%20from%20'vue-toastification'%0Aimport%20%7B%20useI18n%20%7D%20from%20'vue-i18n'%0Aimport%20%7B%20wordsAPI%20%7D%20from%20'..%2Fservices%2Fapi.ts'%0A%2F%2F%20%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%0Ainterface%20NewWord%20%7B%0Aword%3A%20string%0AforceAdd%3F%3A%20boolean%20%20%2F%2F%20%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%E6%A0%87%E5%BF%97%0A%7D%0Ainterface%20Word%20%7B%0A_id%3A%20string%0Aword%3A%20string%0AuserIds%3A%20string%5B%5D%0Adefinitions%3A%20Arraytext%3A%20string%0ApartOfSpeech%3A%20string%0A%7D%3E%0AprimaryDefinition%3F%3A%20string%0AprimaryPartOfSpeech%3F%3A%20string%0AprimaryPartOfSpeechTranslated%3F%3A%20string%0AusageCount%3A%20number%0AwordNetProcessed%3A%20boolean%0AcreatedAt%3A%20string%0AupdatedAt%3A%20string%0A%7D%0Aexport%20const%20useWordsStore%20%3D%20defineStore('words'%2C%20()%20%3D%3E%20%7B%0A%2F%2F%20%E5%93%8D%E5%BA%94%E5%BC%8F%E7%8A%B6%E6%80%81%0Aconst%20words%20%3D%20refWord%5B%5D%3E(%5B%5D)%0Aconst%20selectedWords%20%3D%20refSetstring%3E%3E(new%20Set())%0Aconst%20loading%20%3D%20ref(false)%0Aconst%20currentFilter%20%3D%20refstring%3E('all')%0Aconst%20searchQuery%20%3D%20refstring%3E('')%0A%2F%2F%20%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%0Aconst%20toast%20%3D%20useToast()%0Aconst%20%7B%20t%20%7D%20%3D%20useI18n()%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%EF%BC%9A%E8%BF%87%E6%BB%A4%E5%90%8E%E7%9A%84%E5%8D%95%E8%AF%8D%E5%88%97%E8%A1%A8%0Aconst%20filteredWords%20%3D%20computed(()%20%3D%3E%20%7B%0Alet%20filtered%20%3D%20words.value%0A%2F%2F%20%E8%AF%8D%E6%80%A7%E8%BF%87%E6%BB%A4%0Aif%20(currentFilter.value%20%26%26%20currentFilter.value%20!%3D%3D%20'all')%20%7B%0Afiltered%20%3D%20filtered.filter(word%20%3D%3E%0Aword.primaryPartOfSpeech%20%3D%3D%3D%20currentFilter.value%0A)%0A%7D%0A%2F%2F%20%E6%90%9C%E7%B4%A2%E8%BF%87%E6%BB%A4%0Aif%20(searchQuery.value.trim())%20%7B%0Aconst%20query%20%3D%20searchQuery.value.toLowerCase().trim()%0Afiltered%20%3D%20filtered.filter(word%20%3D%3E%0Aword.word.toLowerCase().includes(query)%20%7C%7C%0Aword.primaryDefinition%3F.toLowerCase().includes(query)%0A)%0A%7D%0Areturn%20filtered%0A%7D)%0A%2F%2F%20%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%EF%BC%9A%E6%8E%92%E5%BA%8F%E5%90%8E%E7%9A%84%E5%8D%95%E8%AF%8D%E5%88%97%E8%A1%A8%0Aconst%20sortedWords%20%3D%20computed(()%20%3D%3E%20%7B%0Areturn%20%5B...filteredWords.value%5D.sort((a%2C%20b)%20%3D%3E%0Anew%20Date(b.createdAt).getTime()%20-%20new%20Date(a.createdAt).getTime()%0A)%0A%7D)%0A%2F**%0A*%20%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%E7%9A%84%E6%A0%B8%E5%BF%83%E9%80%BB%E8%BE%91%0A*%20%40param%20%7BNewWord%7D%20newWord%20-%20%E6%96%B0%E5%8D%95%E8%AF%8D%E5%AF%B9%E8%B1%A1%0A*%20%40returns%20%7BPromise%7D%20%E5%A4%84%E7%90%86%E7%BB%93%E6%9E%9C%0A*%2F%0Aconst%20addWord%20%3D%20async%20(newWord%3A%20NewWord)%20%3D%3E%20%7B%0A%2F%2F%20%E6%A3%80%E6%9F%A5%E9%87%8D%E5%A4%8D%0Aconst%20existingWord%20%3D%20words.value.find(w%20%3D%3E%0Aw.word.toLowerCase()%20%3D%3D%3D%20newWord.word.toLowerCase()%0A)%0Aif%20(existingWord)%20%7B%0Atoast.error(t('words.wordExists'))%0Areturn%20%7B%20success%3A%20false%2C%20message%3A%20t('words.wordExists')%20%7D%0A%7D%0Aloading.value%20%3D%20true%0Atry%20%7B%0A%2F%2F%20%E8%B0%83%E7%94%A8API%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%0Aconst%20response%20%3D%20await%20wordsAPI.addWord(newWord)%0Aif%20(response.data.success)%20%7B%0A%2F%2F%20%E6%88%90%E5%8A%9F%EF%BC%9A%E6%9B%B4%E6%96%B0%E6%9C%AC%E5%9C%B0%E7%8A%B6%E6%80%81%0Awords.value.unshift(response.data.word)%0Atoast.success(t('words.wordAdded'))%0Areturn%20%7B%20success%3A%20true%2C%20word%3A%20response.data.word%20%7D%0A%7D%20else%20%7B%0A%2F%2F%20%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E4%B8%BA%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%0Aif%20(response.data.spellingError%20%26%26%20response.data.suggestions%3F.length%20%3E%200)%20%7B%0A%2F%2F%20%E4%B8%8D%E6%98%BE%E7%A4%BA%E9%94%99%E8%AF%AF%E6%8F%90%E7%A4%BA%EF%BC%8C%E8%AE%A9UI%E7%BB%84%E4%BB%B6%E5%A4%84%E7%90%86%0Areturn%20%7B%0Asuccess%3A%20false%2C%0AspellingError%3A%20true%2C%0Asuggestions%3A%20response.data.suggestions%2C%0AoriginalWord%3A%20response.data.originalWord%2C%0AsuggestedCorrection%3A%20response.data.suggestedCorrection%2C%0Amessage%3A%20response.data.message%20%7C%7C%20t('words.spellingError')%0A%7D%0A%7D%0A%2F%2F%20%E5%85%B6%E4%BB%96%E9%94%99%E8%AF%AF%0Aconst%20message%20%3D%20response.data.message%20%7C%7C%20t('common.error')%0Atoast.error(message)%0Areturn%20%7B%20success%3A%20false%2C%20message%20%7D%0A%7D%0A%7D%20catch%20(error%3A%20any)%20%7B%0A%2F%2F%20%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%0Aconst%20message%20%3D%20error.response%3F.data%3F.message%20%7C%7C%20t('common.error')%0Atoast.error(message)%0Areturn%20%7B%20success%3A%20false%2C%20message%20%7D%0A%7D%20finally%20%7B%0Aloading.value%20%3D%20false%0A%7D%0A%7D%0Areturn%20%7B%0A%2F%2F%20%E7%8A%B6%E6%80%81%0Awords%3A%20sortedWords%2C%0AselectedWords%2C%0Aloading%2C%0AcurrentFilter%2C%0AsearchQuery%2C%0A%2F%2F%20%E6%96%B9%E6%B3%95%0AaddWord%2C%0A%2F%2F%20...%20%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95%0A%7D%0A%7D)">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">import</span> { defineStore } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;pinia&#x27;</span>
<span class="hljs-keyword inline">import</span> { ref, computed } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;vue&#x27;</span>
<span class="hljs-keyword inline">import</span> { useToast } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;vue-toastification&#x27;</span>
<span class="hljs-keyword inline">import</span> { useI18n } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;vue-i18n&#x27;</span>
<span class="hljs-keyword inline">import</span> { wordsAPI } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;../services/api.ts&#x27;</span>

<span class="hljs-comment inline">// 类型定义</span>
<span class="hljs-keyword inline">interface</span> <span class="hljs-title class_ inline">NewWord</span> {
  <span class="hljs-attr inline">word</span>: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">forceAdd</span>?: <span class="hljs-built_in inline">boolean</span>  <span class="hljs-comment inline">// 强制添加标志</span>
}

<span class="hljs-keyword inline">interface</span> <span class="hljs-title class_ inline">Word</span> {
  <span class="hljs-attr inline">_id</span>: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">word</span>: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">userIds</span>: <span class="hljs-built_in inline">string</span>[]
  <span class="hljs-attr inline">definitions</span>: <span class="hljs-title class_ inline">Array</span>&lt;{
    <span class="hljs-attr inline">text</span>: <span class="hljs-built_in inline">string</span>
    <span class="hljs-attr inline">partOfSpeech</span>: <span class="hljs-built_in inline">string</span>
  }&gt;
  <span class="hljs-attr inline">primaryDefinition</span>?: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">primaryPartOfSpeech</span>?: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">primaryPartOfSpeechTranslated</span>?: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">usageCount</span>: <span class="hljs-built_in inline">number</span>
  <span class="hljs-attr inline">wordNetProcessed</span>: <span class="hljs-built_in inline">boolean</span>
  <span class="hljs-attr inline">createdAt</span>: <span class="hljs-built_in inline">string</span>
  <span class="hljs-attr inline">updatedAt</span>: <span class="hljs-built_in inline">string</span>
}

<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">const</span> useWordsStore = <span class="hljs-title function_ inline">defineStore</span>(<span class="hljs-string inline">&#x27;words&#x27;</span>, <span class="hljs-function inline">() =&gt;</span> {
  <span class="hljs-comment inline">// 响应式状态</span>
  <span class="hljs-keyword inline">const</span> words = ref&lt;<span class="hljs-title class_ inline">Word</span>[]&gt;([])
  <span class="hljs-keyword inline">const</span> selectedWords = ref&lt;<span class="hljs-title class_ inline">Set</span>&lt;<span class="hljs-built_in inline">string</span>&gt;&gt;(<span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Set</span>())
  <span class="hljs-keyword inline">const</span> loading = <span class="hljs-title function_ inline">ref</span>(<span class="hljs-literal inline">false</span>)
  <span class="hljs-keyword inline">const</span> currentFilter = ref&lt;<span class="hljs-built_in inline">string</span>&gt;(<span class="hljs-string inline">&#x27;all&#x27;</span>)
  <span class="hljs-keyword inline">const</span> searchQuery = ref&lt;<span class="hljs-built_in inline">string</span>&gt;(<span class="hljs-string inline">&#x27;&#x27;</span>)
  
  <span class="hljs-comment inline">// 依赖注入</span>
  <span class="hljs-keyword inline">const</span> toast = <span class="hljs-title function_ inline">useToast</span>()
  <span class="hljs-keyword inline">const</span> { t } = <span class="hljs-title function_ inline">useI18n</span>()

  <span class="hljs-comment inline">// 计算属性：过滤后的单词列表</span>
  <span class="hljs-keyword inline">const</span> filteredWords = <span class="hljs-title function_ inline">computed</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">let</span> filtered = words.<span class="hljs-property inline">value</span>

    <span class="hljs-comment inline">// 词性过滤</span>
    <span class="hljs-keyword inline">if</span> (currentFilter.<span class="hljs-property inline">value</span> &amp;&amp; currentFilter.<span class="hljs-property inline">value</span> !== <span class="hljs-string inline">&#x27;all&#x27;</span>) {
      filtered = filtered.<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">word</span> =&gt;</span> 
        word.<span class="hljs-property inline">primaryPartOfSpeech</span> === currentFilter.<span class="hljs-property inline">value</span>
      )
    }

    <span class="hljs-comment inline">// 搜索过滤</span>
    <span class="hljs-keyword inline">if</span> (searchQuery.<span class="hljs-property inline">value</span>.<span class="hljs-title function_ inline">trim</span>()) {
      <span class="hljs-keyword inline">const</span> query = searchQuery.<span class="hljs-property inline">value</span>.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">trim</span>()
      filtered = filtered.<span class="hljs-title function_ inline">filter</span>(<span class="hljs-function inline"><span class="hljs-params inline">word</span> =&gt;</span> 
        word.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">includes</span>(query) ||
        word.<span class="hljs-property inline">primaryDefinition</span>?.<span class="hljs-title function_ inline">toLowerCase</span>().<span class="hljs-title function_ inline">includes</span>(query)
      )
    }

    <span class="hljs-keyword inline">return</span> filtered
  })

  <span class="hljs-comment inline">// 计算属性：排序后的单词列表</span>
  <span class="hljs-keyword inline">const</span> sortedWords = <span class="hljs-title function_ inline">computed</span>(<span class="hljs-function inline">() =&gt;</span> {
    <span class="hljs-keyword inline">return</span> [...filteredWords.<span class="hljs-property inline">value</span>].<span class="hljs-title function_ inline">sort</span>(<span class="hljs-function inline">(<span class="hljs-params inline">a, b</span>) =&gt;</span> 
      <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Date</span>(b.<span class="hljs-property inline">createdAt</span>).<span class="hljs-title function_ inline">getTime</span>() - <span class="hljs-keyword inline">new</span> <span class="hljs-title class_ inline">Date</span>(a.<span class="hljs-property inline">createdAt</span>).<span class="hljs-title function_ inline">getTime</span>()
    )
  })

  <span class="hljs-comment inline">/**
   * 添加单词的核心逻辑
   * <span class="hljs-doctag inline">@param</span> {<span class="hljs-type inline">NewWord</span>} <span class="hljs-variable inline">newWord</span> - 新单词对象
   * <span class="hljs-doctag inline">@returns</span> {<span class="hljs-type inline">Promise&lt;Object&gt;</span>} 处理结果
   */</span>
  <span class="hljs-keyword inline">const</span> <span class="hljs-title function_ inline">addWord</span> = <span class="hljs-keyword inline">async</span> (<span class="hljs-params inline"><span class="hljs-attr inline">newWord</span>: <span class="hljs-title class_ inline">NewWord</span></span>) =&gt; {
    <span class="hljs-comment inline">// 检查重复</span>
    <span class="hljs-keyword inline">const</span> existingWord = words.<span class="hljs-property inline">value</span>.<span class="hljs-title function_ inline">find</span>(<span class="hljs-function inline"><span class="hljs-params inline">w</span> =&gt;</span> 
      w.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">toLowerCase</span>() === newWord.<span class="hljs-property inline">word</span>.<span class="hljs-title function_ inline">toLowerCase</span>()
    )
    <span class="hljs-keyword inline">if</span> (existingWord) {
      toast.<span class="hljs-title function_ inline">error</span>(<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordExists&#x27;</span>))
      <span class="hljs-keyword inline">return</span> { <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, <span class="hljs-attr inline">message</span>: <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordExists&#x27;</span>) }
    }

    loading.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">true</span>
    <span class="hljs-keyword inline">try</span> {
      <span class="hljs-comment inline">// 调用API添加单词</span>
      <span class="hljs-keyword inline">const</span> response = <span class="hljs-keyword inline">await</span> wordsAPI.<span class="hljs-title function_ inline">addWord</span>(newWord)
      
      <span class="hljs-keyword inline">if</span> (response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">success</span>) {
        <span class="hljs-comment inline">// 成功：更新本地状态</span>
        words.<span class="hljs-property inline">value</span>.<span class="hljs-title function_ inline">unshift</span>(response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">word</span>)
        toast.<span class="hljs-title function_ inline">success</span>(<span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.wordAdded&#x27;</span>))
        <span class="hljs-keyword inline">return</span> { <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">true</span>, <span class="hljs-attr inline">word</span>: response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">word</span> }
      } <span class="hljs-keyword inline">else</span> {
        <span class="hljs-comment inline">// 检查是否为拼写错误</span>
        <span class="hljs-keyword inline">if</span> (response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">spellingError</span> &amp;&amp; response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">suggestions</span>?.<span class="hljs-property inline">length</span> &gt; <span class="hljs-number inline">0</span>) {
          <span class="hljs-comment inline">// 不显示错误提示，让UI组件处理</span>
          <span class="hljs-keyword inline">return</span> { 
            <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, 
            <span class="hljs-attr inline">spellingError</span>: <span class="hljs-literal inline">true</span>,
            <span class="hljs-attr inline">suggestions</span>: response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">suggestions</span>,
            <span class="hljs-attr inline">originalWord</span>: response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">originalWord</span>,
            <span class="hljs-attr inline">suggestedCorrection</span>: response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">suggestedCorrection</span>,
            <span class="hljs-attr inline">message</span>: response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;words.spellingError&#x27;</span>)
          }
        }
        
        <span class="hljs-comment inline">// 其他错误</span>
        <span class="hljs-keyword inline">const</span> message = response.<span class="hljs-property inline">data</span>.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;common.error&#x27;</span>)
        toast.<span class="hljs-title function_ inline">error</span>(message)
        <span class="hljs-keyword inline">return</span> { <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, message }
      }
    } <span class="hljs-keyword inline">catch</span> (<span class="hljs-attr inline">error</span>: <span class="hljs-built_in inline">any</span>) {
      <span class="hljs-comment inline">// 异常处理</span>
      <span class="hljs-keyword inline">const</span> message = error.<span class="hljs-property inline">response</span>?.<span class="hljs-property inline">data</span>?.<span class="hljs-property inline">message</span> || <span class="hljs-title function_ inline">t</span>(<span class="hljs-string inline">&#x27;common.error&#x27;</span>)
      toast.<span class="hljs-title function_ inline">error</span>(message)
      <span class="hljs-keyword inline">return</span> { <span class="hljs-attr inline">success</span>: <span class="hljs-literal inline">false</span>, message }
    } <span class="hljs-keyword inline">finally</span> {
      loading.<span class="hljs-property inline">value</span> = <span class="hljs-literal inline">false</span>
    }
  }

  <span class="hljs-keyword inline">return</span> {
    <span class="hljs-comment inline">// 状态</span>
    <span class="hljs-attr inline">words</span>: sortedWords,
    selectedWords,
    loading,
    currentFilter,
    searchQuery,
    
    <span class="hljs-comment inline">// 方法</span>
    addWord,
    <span class="hljs-comment inline">// ... 其他方法</span>
  }
})
</code></pre>
            </div>
        
<h4 id="6-apits-api服务层" class="group relative text-xl font-medium mt-4 mb-2 text-foreground leading-snug">
            <a href="#6-apits-api服务层" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 6. api.ts - API服务层">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            6. api.ts - API服务层
        </h4>

            <div class="enhanced-codeblock relative mb-6 rounded-lg border bg-background border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm" data-enhanced-codeblock="true" data-language="typescript" data-code="import%20axios%20from%20'axios'%0Aimport%20%7B%20getCurrentLocale%20%7D%20from%20'..%2Futils%2Fi18n.js'%0Aconst%20API_BASE_URL%20%3D%20import.meta.env.VITE_API_BASE_URL%0A%2F%2F%20%E5%88%9B%E5%BB%BAaxios%E5%AE%9E%E4%BE%8B%0Aconst%20api%20%3D%20axios.create(%7B%0AbaseURL%3A%20API_BASE_URL%2C%0Atimeout%3A%2030000%2C%0Aheaders%3A%20%7B%0A'Content-Type'%3A%20'application%2Fjson'%0A%7D%0A%7D)%0A%2F%2F%20%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9A%E6%B7%BB%E5%8A%A0%E8%AF%AD%E8%A8%80%E5%92%8C%E8%AE%A4%E8%AF%81%E5%A4%B4%0Aapi.interceptors.request.use(%0A(config)%20%3D%3E%20%7B%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E8%AF%AD%E8%A8%80%E5%A4%B4%0Aconst%20locale%20%3D%20getCurrentLocale()%0Aif%20(locale)%20%7B%0Aconfig.headers%5B'x-language'%5D%20%3D%20locale%0A%7D%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E8%AE%A4%E8%AF%81%E5%A4%B4%0Aconst%20token%20%3D%20localStorage.getItem('token')%0Aif%20(token)%20%7B%0Aconfig.headers.Authorization%20%3D%20%60Bearer%20%24%7Btoken%7D%60%0A%7D%0Areturn%20config%0A%7D%2C%0A(error)%20%3D%3E%20%7B%0Areturn%20Promise.reject(error)%0A%7D%0A)%0A%2F%2F%20%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9A%E5%A4%84%E7%90%86%E8%AE%A4%E8%AF%81%E5%A4%B1%E8%B4%A5%0Aapi.interceptors.response.use(%0A(response)%20%3D%3E%20response%2C%0A(error)%20%3D%3E%20%7B%0A%2F%2F%20%E5%A4%84%E7%90%86401%E9%94%99%E8%AF%AF%EF%BC%88%E6%9C%AA%E8%AE%A4%E8%AF%81%EF%BC%89%0Aif%20(error.response%3F.status%20%3D%3D%3D%20401)%20%7B%0AlocalStorage.removeItem('token')%0Adelete%20api.defaults.headers.common%5B'Authorization'%5D%0Aif%20(window.location.pathname%20!%3D%3D%20'%2Flogin')%20%7B%0Awindow.location.href%20%3D%20'%2Flogin'%0A%7D%0A%7D%0Areturn%20Promise.reject(error)%0A%7D%0A)%0A%2F%2F%20%E5%AF%BC%E5%87%BA%E5%8D%95%E8%AF%8D%E7%9B%B8%E5%85%B3API%0Aexport%20const%20wordsAPI%20%3D%20%7B%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E5%8D%95%E8%AF%8D%E5%88%97%E8%A1%A8%0AgetWords%3A%20(params%3F%3A%20any)%20%3D%3E%20api.get('%2Fwords'%2C%20%7B%20params%20%7D)%2C%0A%2F%2F%20%E6%B7%BB%E5%8A%A0%E5%8D%95%E8%AF%8D%EF%BC%88%E6%94%AF%E6%8C%81%E6%8B%BC%E5%86%99%E5%BB%BA%E8%AE%AE%E5%92%8C%E5%BC%BA%E5%88%B6%E6%B7%BB%E5%8A%A0%EF%BC%89%0AaddWord%3A%20(word%3A%20any)%20%3D%3E%20api.post('%2Fwords'%2C%20word)%2C%0A%2F%2F%20%E5%88%A0%E9%99%A4%E5%8D%95%E8%AF%8D%0AdeleteWord%3A%20(id%3A%20string)%20%3D%3E%20api.delete(%60%2Fwords%2F%24%7Bid%7D%60)%2C%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E5%8D%95%E8%AF%8D%E7%BB%9F%E8%AE%A1%0AgetStats%3A%20()%20%3D%3E%20api.get('%2Fwords%2Fstats')%2C%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E8%AF%8D%E6%80%A7%E5%88%97%E8%A1%A8%0AgetPartsOfSpeech%3A%20()%20%3D%3E%20api.get('%2Fwords%2Fparts-of-speech')%2C%0A%2F%2F%20%E8%8E%B7%E5%8F%96%E9%9A%8F%E6%9C%BA%E5%8D%95%E8%AF%8D%0AgetRandomWords%3A%20(params%3F%3A%20any)%20%3D%3E%20api.get('%2Fwords%2Frandom'%2C%20%7B%20params%20%7D)%0A%7D">
                <div class="codeblock-header flex items-center justify-between px-4 py-2 bg-surface border-b border-gray-200 dark:border-gray-700">
                    <span class="codeblock-language text-xs font-medium uppercase tracking-wide text-foreground opacity-70 inline">typescript</span>
                    <button class="codeblock-copy-btn inline-flex items-center gap-1.5 px-2 py-1 text-xs font-medium border rounded transition-all duration-200 bg-background hover:bg-surface text-foreground hover:text-primary border-gray-300 dark:border-gray-600 hover:scale-105 active:scale-95" title="复制代码">
                        <svg class="copy-icon w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                            <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
                        </svg>
                        <svg class="copied-icon w-4 h-4 hidden" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                        <span class="copy-text inline">复制</span>
                    </button>
                </div>
                <pre class="codeblock-content p-4 overflow-x-auto font-mono text-sm leading-relaxed bg-surface text-foreground"><code class="language-typescript"><span class="hljs-keyword inline">import</span> axios <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;axios&#x27;</span>
<span class="hljs-keyword inline">import</span> { getCurrentLocale } <span class="hljs-keyword inline">from</span> <span class="hljs-string inline">&#x27;../utils/i18n.js&#x27;</span>

<span class="hljs-keyword inline">const</span> <span class="hljs-variable constant_ inline">API_BASE_URL</span> = <span class="hljs-keyword inline">import</span>.<span class="hljs-property inline">meta</span>.<span class="hljs-property inline">env</span>.<span class="hljs-property inline">VITE_API_BASE_URL</span>

<span class="hljs-comment inline">// 创建axios实例</span>
<span class="hljs-keyword inline">const</span> api = axios.<span class="hljs-title function_ inline">create</span>({
  <span class="hljs-attr inline">baseURL</span>: <span class="hljs-variable constant_ inline">API_BASE_URL</span>,
  <span class="hljs-attr inline">timeout</span>: <span class="hljs-number inline">30000</span>,
  <span class="hljs-attr inline">headers</span>: {
    <span class="hljs-string inline">&#x27;Content-Type&#x27;</span>: <span class="hljs-string inline">&#x27;application/json&#x27;</span>
  }
})

<span class="hljs-comment inline">// 请求拦截器：添加语言和认证头</span>
api.<span class="hljs-property inline">interceptors</span>.<span class="hljs-property inline">request</span>.<span class="hljs-title function_ inline">use</span>(
  <span class="hljs-function inline">(<span class="hljs-params inline">config</span>) =&gt;</span> {
    <span class="hljs-comment inline">// 添加语言头</span>
    <span class="hljs-keyword inline">const</span> locale = <span class="hljs-title function_ inline">getCurrentLocale</span>()
    <span class="hljs-keyword inline">if</span> (locale) {
      config.<span class="hljs-property inline">headers</span>[<span class="hljs-string inline">&#x27;x-language&#x27;</span>] = locale
    }

    <span class="hljs-comment inline">// 添加认证头</span>
    <span class="hljs-keyword inline">const</span> token = <span class="hljs-variable language_ inline">localStorage</span>.<span class="hljs-title function_ inline">getItem</span>(<span class="hljs-string inline">&#x27;token&#x27;</span>)
    <span class="hljs-keyword inline">if</span> (token) {
      config.<span class="hljs-property inline">headers</span>.<span class="hljs-property inline">Authorization</span> = <span class="hljs-string inline">`Bearer <span class="hljs-subst inline">${token}</span>`</span>
    }

    <span class="hljs-keyword inline">return</span> config
  },
  <span class="hljs-function inline">(<span class="hljs-params inline">error</span>) =&gt;</span> {
    <span class="hljs-keyword inline">return</span> <span class="hljs-title class_ inline">Promise</span>.<span class="hljs-title function_ inline">reject</span>(error)
  }
)

<span class="hljs-comment inline">// 响应拦截器：处理认证失败</span>
api.<span class="hljs-property inline">interceptors</span>.<span class="hljs-property inline">response</span>.<span class="hljs-title function_ inline">use</span>(
  <span class="hljs-function inline">(<span class="hljs-params inline">response</span>) =&gt;</span> response,
  <span class="hljs-function inline">(<span class="hljs-params inline">error</span>) =&gt;</span> {
    <span class="hljs-comment inline">// 处理401错误（未认证）</span>
    <span class="hljs-keyword inline">if</span> (error.<span class="hljs-property inline">response</span>?.<span class="hljs-property inline">status</span> === <span class="hljs-number inline">401</span>) {
      <span class="hljs-variable language_ inline">localStorage</span>.<span class="hljs-title function_ inline">removeItem</span>(<span class="hljs-string inline">&#x27;token&#x27;</span>)
      <span class="hljs-keyword inline">delete</span> api.<span class="hljs-property inline">defaults</span>.<span class="hljs-property inline">headers</span>.<span class="hljs-property inline">common</span>[<span class="hljs-string inline">&#x27;Authorization&#x27;</span>]
      
      <span class="hljs-keyword inline">if</span> (<span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">location</span>.<span class="hljs-property inline">pathname</span> !== <span class="hljs-string inline">&#x27;/login&#x27;</span>) {
        <span class="hljs-variable language_ inline">window</span>.<span class="hljs-property inline">location</span>.<span class="hljs-property inline">href</span> = <span class="hljs-string inline">&#x27;/login&#x27;</span>
      }
    }
    
    <span class="hljs-keyword inline">return</span> <span class="hljs-title class_ inline">Promise</span>.<span class="hljs-title function_ inline">reject</span>(error)
  }
)

<span class="hljs-comment inline">// 导出单词相关API</span>
<span class="hljs-keyword inline">export</span> <span class="hljs-keyword inline">const</span> wordsAPI = {
  <span class="hljs-comment inline">// 获取单词列表</span>
  <span class="hljs-attr inline">getWords</span>: <span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">params</span>?: <span class="hljs-built_in inline">any</span></span>) =&gt;</span> api.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/words&#x27;</span>, { params }),

  <span class="hljs-comment inline">// 添加单词（支持拼写建议和强制添加）</span>
  <span class="hljs-attr inline">addWord</span>: <span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">word</span>: <span class="hljs-built_in inline">any</span></span>) =&gt;</span> api.<span class="hljs-title function_ inline">post</span>(<span class="hljs-string inline">&#x27;/words&#x27;</span>, word),

  <span class="hljs-comment inline">// 删除单词</span>
  <span class="hljs-attr inline">deleteWord</span>: <span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">id</span>: <span class="hljs-built_in inline">string</span></span>) =&gt;</span> api.<span class="hljs-title function_ inline">delete</span>(<span class="hljs-string inline">`/words/<span class="hljs-subst inline">${id}</span>`</span>),

  <span class="hljs-comment inline">// 获取单词统计</span>
  <span class="hljs-attr inline">getStats</span>: <span class="hljs-function inline">() =&gt;</span> api.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/words/stats&#x27;</span>),

  <span class="hljs-comment inline">// 获取词性列表</span>
  <span class="hljs-attr inline">getPartsOfSpeech</span>: <span class="hljs-function inline">() =&gt;</span> api.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/words/parts-of-speech&#x27;</span>),

  <span class="hljs-comment inline">// 获取随机单词</span>
  <span class="hljs-attr inline">getRandomWords</span>: <span class="hljs-function inline">(<span class="hljs-params inline"><span class="hljs-attr inline">params</span>?: <span class="hljs-built_in inline">any</span></span>) =&gt;</span> api.<span class="hljs-title function_ inline">get</span>(<span class="hljs-string inline">&#x27;/words/random&#x27;</span>, { params })
}
</code></pre>
            </div>
        
<h2 id="写在最后" class="group relative text-3xl font-semibold mt-6 mb-3 text-foreground leading-tight">
            <a href="#写在最后" class="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 transition-opacity text-primary/60 hover:text-primary" aria-label="Link to 写在最后">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 11.414-1.414 4 4 0 105.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 10-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
                </svg>
            </a>
            写在最后
        </h2>
<p class="text-base leading-7 mb-4 text-foreground">单词的检查主要是为了解决“单词库被污染“的问题。最初我的设想是由各种各样的用户来逐步扩充Questions Party的单词库，给人一种”共同学习“的氛围，但随后我想到”如果有人不小心，或是故意输入错误单词，导致单词库被污染了，该怎么办呢？“的问题，在经过一番调查后，我发现了Typo.js和WordNet。</p>
<p class="text-base leading-7 mb-4 text-foreground"><em class="italic text-foreground">愿众生构建的知识脉络永世长存，愿每一个单词都能找到它的归宿</em>。 ✨</p>
d:["$","$L1d",null,{"htmlContent":"$1e","frontMatter":{"title":"词汇摘录：共筑单词之海","description":"深度解析智能单词识别与存储系统的全栈实现原理，从前端输入到后端AI处理的完整技术链路","date":"2025-06-22","author":"MilkWind","tags":["词性分析","拼写检查"],"references":{}},"readingTime":"37 min read","category":"questions-party","tocItems":[{"id":"词汇摘录：共筑单词之海","text":"词汇摘录：共筑单词之海","level":1},{"id":"系统架构概览","text":"系统架构概览","level":2},{"id":"整体数据流向","text":"整体数据流向","level":3},{"id":"mvc架构的现代化应用","text":"MVC架构的现代化应用","level":3},{"id":"前端交互界面设计","text":"前端交互界面设计","level":2},{"id":"composition-api的状态管理","text":"Composition API的状态管理","level":3},{"id":"防抖搜索","text":"防抖搜索","level":3},{"id":"pinia状态管理","text":"Pinia状态管理","level":3},{"id":"前端拼写建议ui设计","text":"前端拼写建议UI设计","level":3},{"id":"前端拼写建议处理逻辑","text":"前端拼写建议处理逻辑","level":3},{"id":"国际化机制","text":"国际化机制","level":2},{"id":"前端语言指定流程","text":"前端语言指定流程","level":3},{"id":"后端语言处理机制","text":"后端语言处理机制","level":3},{"id":"词性翻译的动态实现","text":"词性翻译的动态实现","level":3},{"id":"拼写检查引擎解析：typojs","text":"拼写检查引擎解析：Typo.js","level":2},{"id":"hunspell算法的javascript实现","text":"Hunspell算法的JavaScript实现","level":3},{"id":"智能拼写建议系统","text":"智能拼写建议系统","level":3},{"id":"强制添加机制","text":"强制添加机制","level":3},{"id":"编辑距离算法","text":"编辑距离算法","level":3},{"id":"容错机制","text":"容错机制","level":3},{"id":"wordnet词汇数据库集成：语义网络","text":"WordNet词汇数据库集成：语义网络","level":2},{"id":"wordnet的数据结构","text":"WordNet的数据结构","level":3},{"id":"词性识别的自动化实现","text":"词性识别的自动化实现","level":3},{"id":"异步初始化","text":"异步初始化","level":3},{"id":"数据模型与存储设计：mongodb文档","text":"数据模型与存储设计：MongoDB文档","level":2},{"id":"优化的schema设计","text":"优化的Schema设计","level":3},{"id":"复合索引的性能优化","text":"复合索引的性能优化","level":3},{"id":"多用户数据共享机制","text":"多用户数据共享机制","level":3},{"id":"后端控制器逻辑深度剖析：restful","text":"后端控制器逻辑深度剖析：RESTful","level":2},{"id":"数据验证schema设计","text":"数据验证Schema设计","level":3},{"id":"分页查询","text":"分页查询","level":3},{"id":"错误处理的标准化实现","text":"错误处理的标准化实现","level":3},{"id":"智能推荐：mongodb聚合","text":"智能推荐：MongoDB聚合","level":2},{"id":"随机单词推荐算法","text":"随机单词推荐算法","level":3},{"id":"推荐算法的性能优化","text":"推荐算法的性能优化","level":3},{"id":"个性化过滤机制","text":"个性化过滤机制","level":3},{"id":"完整数据流向分析：从输入到存储","text":"完整数据流向分析：从输入到存储","level":2},{"id":"完整流程图","text":"完整流程图","level":3},{"id":"技术库工具链","text":"技术库工具链","level":2},{"id":"typojs","text":"Typo.js","level":3},{"id":"wordnet：语义网络的数字化","text":"WordNet：语义网络的数字化","level":3},{"id":"joi：数据验证的艺术","text":"Joi：数据验证的艺术","level":3},{"id":"mongoose：mongodb的查询构建器","text":"Mongoose：MongoDB的查询构建器","level":3},{"id":"后端国际化响应实现","text":"后端国际化响应实现","level":2},{"id":"请求头的语言协商","text":"请求头的语言协商","level":3},{"id":"后端中间件的国际化处理","text":"后端中间件的国际化处理","level":3},{"id":"实时语言切换的技术方案","text":"实时语言切换的技术方案","level":3},{"id":"用户体验","text":"用户体验","level":2},{"id":"实时反馈机制","text":"实时反馈机制","level":3},{"id":"错误处理","text":"错误处理","level":3},{"id":"完整源码全解析","text":"完整源码全解析","level":2},{"id":"后端核心文件","text":"后端核心文件","level":3},{"id":"1-wordcontrollerjs-单词控制器","text":"1. wordController.js - 单词控制器","level":4},{"id":"2-wordutilsjs-单词处理工具","text":"2. wordUtils.js - 单词处理工具","level":4},{"id":"3-wordsjs-路由定义","text":"3. words.js - 路由定义","level":4},{"id":"前端核心文件","text":"前端核心文件","level":3},{"id":"4-wordsvue-单词管理视图","text":"4. Words.vue - 单词管理视图","level":4},{"id":"5-wordsts-pinia状态管理","text":"5. words.ts - Pinia状态管理","level":4},{"id":"6-apits-api服务层","text":"6. api.ts - API服务层","level":4},{"id":"写在最后","text":"写在最后","level":2}],"translations":{"common":{"welcome":"欢迎","loading":"加载中...","error":"出现了一些问题","retry":"重试","theme":"主题","language":"语言","light":"浅色","dark":"深色"},"navigation":{"home":"首页","personal":"个人","works":"作品","contributions":"贡献","documents":"文档","about":"关于","contact":"联系"},"personal":{"technicalSkills":"技术技能","email":"邮箱","github":"代码仓库","resume":"简历","codeRepository":"代码仓库","loadingPersonalInfo":"加载个人信息中...","loadingResume":"加载简历中...","closeResume":"关闭简历","emailCopied":"邮箱已复制到剪贴板！","galaxyDefaultDescription":"精通全栈开发技术，具备跨平台架构能力，擅长AI技术整合与高性能系统优化","skillGalaxy":"技能星系","stirGalaxy":"搅动星系","stirring":"搅动中...","fullStackEngineer":"MilkWind - 全栈工程师","professionalProfile":"关于我"},"documents":{"technicalDocuments":"技术文档","description":"基本原理、代码拆分以及一些碎碎念。","articles":"文章","categories":"分类","allCategories":"所有分类","noArticlesFound":"未找到文章","noArticlesAvailable":"中文暂无文章。","noArticlesInCategory":"该分类下未找到文章。","readMore":"阅读更多","loadingDocuments":"加载文档中...","backToDocuments":"← 返回文档","documentNotFound":"文档未找到","documentNotFoundDescription":"请求的文档无法找到。","technicalInsights":"技术拆解","untitledDocument":"无标题文档","byAuthor":"作者：","search":"搜索文章...","searchByTags":"按标签筛选","searching":"搜索中...","noSearchResults":"没有找到符合搜索条件的文章","clearSearch":"清除搜索","selectedTags":"已选标签","allTags":"所有标签","searchInTitle":"在标题、描述和内容中搜索","enterImmersiveMode":"沉浸阅读","exitImmersiveMode":"退出沉浸模式","immersiveReading":"沉浸阅读模式","exploreContent":"按分类探索内容","browseBy":"浏览方式","exploreAll":"所有内容汇总","categoryDescription":"该分类下的文章","totalArticles":"文章","totalCategories":"分类","foundArticles":"找到文章","categoriesWithResults":"有结果的分类"},"works":{"workCases":"作品案例","projects":"作品集","loadingProjects":"加载项目中...","grid":"网格","stack":"堆叠","of":"共","workCasesPageTitle":"作品案例页面","pageWorkingCorrectly":"此页面运行正常！路由配置正确。","try3DVersion":"尝试3D版本","dragToScroll":"拖拽滚动","dragToChange":"拖拽切换","swipeCards":"切换卡片","keyboardNav":"键盘导航"},"contributions":{"contributionCases":"开源项目","contributions":"贡献","loadingContributions":"加载贡献中...","grid":"网格","stack":"堆叠","of":"共","contributionCasesPageTitle":"贡献案例页面","pageWorkingCorrectly":"此页面运行正常！路由配置正确。","try3DVersion":"尝试3D版本","dragToScroll":"拖拽滚动","dragToChange":"拖拽切换","swipeCards":"切换卡片","keyboardNav":"键盘导航"},"contribution":{"contributionPreview":"贡献预览","accessible":"可访问","code":"代码","maintenance":"维护","enhancement":"增强","documentation":"文档","community":"社区","moreItems":"更多","technicalDetails":"技术详情","technologies":"技术栈：","contributionDetail":"贡献详情","description":"描述：","seeDetails":"查看详情","github":"代码仓库","viewContribution":"查看贡献","viewCode":"查看代码"},"project":{"projectPreview":"项目预览","accessible":"可访问","tool":"工具","plugin":"插件","toy":"小玩意","moreItems":"更多","technicalDetails":"技术详情","technologies":"技术栈：","description":"描述：","seeDetails":"查看详情","github":"GitHub","gitee":"Gitee","viewLiveDemo":"查看演示","viewCode":"查看代码","access":"访问","videos":"视频","watchVideo":"观看视频","hasVideo":"有视频"},"codeblock":{"copy":"复制","copySuccess":"代码已复制到剪贴板！","copyError":"复制代码失败","copyTooltip":"复制代码"},"toc":{"contents":"目录","autoScroll":"自动滚动到章节","collapse":"折叠","expand":"展开"},"loading":{"loading":"加载中","preparingExperience":"准备体验中"}},"lang":"zh","theme":"dark"}]
12:null
18:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
11:null
1c:{"metadata":[["$","title","0",{"children":"词汇摘录：共筑单词之海 | Interactive Portfolio"}],["$","meta","1",{"name":"description","content":"深度解析智能单词识别与存储系统的全栈实现原理，从前端输入到后端AI处理的完整技术链路"}],["$","meta","2",{"name":"author","content":"Developer"}],["$","meta","3",{"name":"keywords","content":"portfolio,3D,interactive,web development,Three.js,Next.js"}],["$","meta","4",{"property":"og:title","content":"词汇摘录：共筑单词之海 | Interactive Portfolio"}],["$","meta","5",{"property":"og:description","content":"深度解析智能单词识别与存储系统的全栈实现原理，从前端输入到后端AI处理的完整技术链路"}],["$","meta","6",{"property":"og:type","content":"article"}],["$","meta","7",{"property":"article:published_time","content":"2025-06-22"}],["$","meta","8",{"property":"article:tag","content":"词性分析"}],["$","meta","9",{"property":"article:tag","content":"拼写检查"}],["$","meta","10",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","11",{"name":"twitter:title","content":"词汇摘录：共筑单词之海 | Interactive Portfolio"}],["$","meta","12",{"name":"twitter:description","content":"深度解析智能单词识别与存储系统的全栈实现原理，从前端输入到后端AI处理的完整技术链路"}],["$","link","13",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"32x32"}]],"error":null,"digest":"$undefined"}
14:{"metadata":"$1c:metadata","error":null,"digest":"$undefined"}
